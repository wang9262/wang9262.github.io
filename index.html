<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Vong"/><link rel="canonical" href="https://wang9262.github.io"/><meta name="twitter:url" content="https://wang9262.github.io"/><meta name="og:url" content="https://wang9262.github.io"/><title>Vong</title><meta name="twitter:title" content="Vong"/><meta name="og:title" content="Vong"/><meta name="description" content="Vong,iOS,Performance,性能,Swift,SwiftUI,Objective-C"/><meta name="twitter:description" content="Vong,iOS,Performance,性能,Swift,SwiftUI,Objective-C"/><meta name="og:description" content="Vong,iOS,Performance,性能,Swift,SwiftUI,Objective-C"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@Vong_HUST"/><meta name="twitter:creator" content="@Vong_HUST"/><meta name="referrer" content="no-referrer"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Vong"/><meta name="twitter:image" content="https://wang9262.github.io/media"/><meta name="og:image" content="https://wang9262.github.io/media"/><script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script></head><body class="index"><header><div class="wrapper"><div class="logo"><a href="/"><h2>Vong</h2></a></div><div><div class="headerIcons"><a class="icon headIconWeixin"><script>    var weixinHeadButton = $('.headIconWeixin');
    weixinHeadButton.hover(
    function(){
    $('.weixinHeadQcode').css('display','block');
    },
    function(){
    $('.weixinHeadQcode').css('display','none');
    })</script></a><a class="icon headIconTwitter" href="https://www.twitter.com/Vong_HUST" target="_blank" rel="noreferrer"></a><a class="icon headIconEmail" href="mailto:Vong9262@gmail.com" target="_blank" rel="noreferrer"></a><a class="icon headIconGithub" href="https://github.com/wang9262/" target="_blank" rel="noreferrer"></a><a class="icon headIconRss" href="/feed.rss" target="_blank" rel="noreferrer"></a></div></div><nav><ul><li><a class="selected" href="/">首页</a></li><li><a href="/posts">所有文章</a></li><li><a href="/about">关于</a></li><li><a href="/tags">搜索</a></li></ul><div class="weixinHeadQcode" onclick="$('.weixinHeadQcode').css('display','none');"></div></nav></div></header><div class="container"><div class="wrapper"><div class="viewContainer"><div class="side-nav"><div class="sideTags"><ul class="all-tags"><li class="tag variant-0"><a href="/tags/avfoundation">AVFoundation (1)</a></li><li class="tag variant-0"><a href="/tags/blog">Blog (1)</a></li><li class="tag variant-0"><a href="/tags/crash">Crash (2)</a></li><li class="tag variant-1"><a href="/tags/gpuimage">GPUImage (1)</a></li><li class="tag variant-1"><a href="/tags/objectivec">Objective-C (1)</a></li><li class="tag variant-2"><a href="/tags/pod">Pod (1)</a></li><li class="tag variant-2"><a href="/tags/uicollectionview">UICollectionView (3)</a></li><li class="tag variant-3"><a href="/tags/wwdc">WWDC (4)</a></li><li class="tag variant-3"><a href="/tags/webview">WebView (1)</a></li><li class="tag variant-4"><a href="/tags/xcode">Xcode (5)</a></li><li class="tag variant-4"><a href="/tags/xcode8">Xcode8 (2)</a></li><li class="tag variant-5"><a href="/tags/原创">原创 (10)</a></li><li class="tag variant-5"><a href="/tags/后台任务">后台任务 (1)</a></li><li class="tag variant-6"><a href="/tags/插件">插件 (2)</a></li><li class="tag variant-6"><a href="/tags/杂谈">杂谈 (5)</a></li><li class="tag variant-7"><a href="/tags/笔记">笔记 (1)</a></li><li class="tag variant-7"><a href="/tags/翻译">翻译 (6)</a></li></ul></div></div><div class="leftContent"><div class="index-list"><ul class="indexul"><li class="indexli"><div class="index-title"><a href="/posts/Blog-based-on-Publish"><h1>基于 Publish 搭建博客</h1></a></div><div><ul class="tag-list"><li class="tag variant-0"><a href="/tags/blog">Blog</a></li><li class="tag tagdate">发布于2021年08月08日</li></ul></div><div class="content"><article><h2>遇到的问题</h2><ul><li>make报错</li></ul><pre data-language="shell"><code>swift build -c release
/Users/Vong/Publish: error: manifest parse error(s):
&lt;module-includes&gt;:1:9: note: in file included from &lt;module-includes&gt;:1:
<span class="hljs-meta">#</span><span class="bash">import <span class="hljs-string">"Headers/CoreFoundation.h"</span></span>
^
/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX11...</code></pre></article><div class="index-item-more float-container"><a href="/posts/Blog-based-on-Publish">查看全文</a></div></div></li><li class="indexli"><div class="index-title"><a href="/posts/Xcode-Condition-Build"><h1>iOS 中资源的条件编译</h1></a></div><div><ul class="tag-list"><li class="tag variant-4"><a href="/tags/xcode">Xcode</a></li><li class="tag tagdate">发布于2020年11月21日</li></ul></div><div class="content"><article><p>日常开发中常常遇到某些类及其引用的资源文件仅在 <code>Debug</code> 或内测版本中生效，而不希望带到线上版本。因为一来会增加包体积，二来会把一些内部功能的相关接口暴露，导致可能的一些动态调试。那么有没有避免的方案呢？</p><h2>Pod</h2><p>答案肯定是有的，通常的做法是把对应功能抽成单独的 <code>pod</code> 库，然后仅 <code>Debug</code> 模式才集成到主工程，发出去的版本不集成。通常方式如下，以 <code>FLEX</code> 为例：</p><pre data-language="ruby"><code>pod <span class="hljs-string">'FLEX'</span>, <span class="hljs-string">'~&gt; 2.0'</span>, <span class="hljs-symbol">:configurations</span> =&gt; [<span class="hljs-string">'Debug'</span>]
</code></pre><p>但是如果某些强耦合主工程无法拆成独立 <code>pod</code> 的功能，这种方式可能就不再适用了。</p><h2>条件编译</h2><p><code>pod</code> 这条路走不通，有没有其...</p></article><div class="index-item-more float-container"><a href="/posts/Xcode-Condition-Build">查看全文</a></div></div></li><li class="indexli"><div class="index-title"><a href="/posts/An-Abnormal-Swift-Crash"><h1>聊聊最近遇到的一个Crash</h1></a></div><div><ul class="tag-list"><li class="tag variant-0"><a href="/tags/crash">Crash</a></li><li class="tag tagdate">发布于2020年09月20日</li></ul></div><div class="content"><article><h2>卖个关子</h2><pre data-language="swift"><code><span class="hljs-comment">// 代码段1</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Manager</span>: <span class="hljs-title">NSObject</span> </span>{
    <span class="hljs-keyword">deinit</span> {
         <span class="hljs-built_in">print</span>(<span class="hljs-string">"deinit "</span> + <span class="hljs-type">String</span>(format: <span class="hljs-string">"%p"</span>, <span class="hljs-keyword">self</span>))
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ViewController</span>: <span class="hljs-title">UIViewController</span> </span>{
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">viewDidLoad</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.viewDidLoad()
        <span class="hljs-keyword">var</span> x: <span class="hljs-type">Manager?</span> = <span class="hljs-type">Manager</span>()
        x = <span class="hljs-literal">nil</span>
    }
}
</code></pre><pre data-language="objectivec"><code><span class="hljs-comment">// 代码段2</span>
<span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">Man...</span></span></code></pre></article><div class="index-item-more float-container"><a href="/posts/An-Abnormal-Swift-Crash">查看全文</a></div></div></li><li class="indexli"><div class="index-title"><a href="/posts/Eliminate-animation-hitches-with-XCTest"><h1>WWDC20 10077 - 使用 XCTest 消除动画卡顿</h1></a></div><div><ul class="tag-list"><li class="tag variant-3"><a href="/tags/wwdc">WWDC</a></li><li class="tag tagdate">发布于2020年06月20日</li></ul></div><div class="content"><article><blockquote><p>本文基于 <a href="https://developer.apple.com/videos/play/wwdc2020/10077/" target="_blank">Session 10077 - Eliminate animation hitches with XCTest</a></p></blockquote><h2>概述</h2><p>iOS中动画无处不在，应用中优雅流畅的动画可以显著提升用户体验，同理卡顿也会影响用户体验。通过这个 WWDC Session，我们将学会如何通过 XCTest 来检测滑动和动画过程中的掉帧，进而在开发阶段就能解决问题，避免糟糕的用户体验。</p><h2>如何定义卡顿（Hitches）</h2><p>当用户在页面上操作时，比如上下滑或者点击导航栏上的返回按钮时，主要焦点集中在手势的交互上。良好的交互体验是提供“众享丝滑”的响应速度，反之用户将会感知到明显的卡顿。我们将这些用户可感知的“抖动”称之为卡顿（H...</p></article><div class="index-item-more float-container"><a href="/posts/Eliminate-animation-hitches-with-XCTest">查看全文</a></div></div></li><li class="indexli"><div class="index-title"><a href="/posts/Attention-to-Category"><h1>一个不规范的 Category 写法导致的“血案”</h1></a></div><div><ul class="tag-list"><li class="tag variant-0"><a href="/tags/crash">Crash</a></li><li class="tag tagdate">发布于2020年04月20日</li></ul></div><div class="content"><article><p>名字取得有点标题党，不然没人愿意点进来😂😂😂</p><h3>1.背景</h3><p>项目前后两个版本，线上监控显示整体启动时间缩短了近 <strong>300ms</strong>，而且包体积也变小了 <strong>5M</strong>（提交到 App Store 的ipa包）。但是新版本没有大的需求插入，只是 <code>bugfix</code> 版本，启动阶段的代码也没有相关改动。为何会引起包体积和启动时间的变化呢？</p><img src="/media/2020-03-11/15839096586934.jpg" alt="启动耗时&amp;包体积变化"/><p>使用 <code>Instrument</code> 多次跑耗时分析，发现两个版本启动阶段的 <code>getMethodNoSuper_nolock()</code> 函数的耗时的差异非常明显。关键是这个还是系统函数，看起来是消息发送阶段的耗时增加了。</p><img src="/media/2020-03-11/15839137733724.jpg" alt="Instrument 启动阶段耗时对比"/><h3>2.继续分析</h3><p>上面 <code>Instrument</code> 的方法耗时在设置隐藏系统库之后，对比发现没有明...</p></article><div class="index-item-more float-container"><a href="/posts/Attention-to-Category">查看全文</a></div></div></li></ul></div><div class="section-header float-container"><a class="browse-all" href="/posts/">显示全部文章(27)</a></div></div></div></div></div><footer><p>Copyright &copy; Vong 2022 </p><p>Generated using <a href="https://github.com/johnsundell/publish" target="_blank">Publish</a></p><ul class="icon"><li><a href="https://twitter.com/Vong_HUST" target="_blank"><img class="twitter" src="/images/twitter.svg"/></a></li><li><a href="https://github.com/wang9262/" target="_blank"><img src="/images/github.svg"/></a></li><li><a href="/feed.rss"><img src="/images/rss.svg"/></a></li></ul><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZHSZ71NFYK"></script><script src="/Script/google_analyse.js"></script><script src="/Script/baidu_analyse.js"></script></footer></body></html>