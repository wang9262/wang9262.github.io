<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[å…¨æ–°åå°ä»»åŠ¡æ¡†æ¶åŠæœ€ä½³å®è·µ]]></title>
    <url>%2F2019%2F10%2F20%2FBackgroundTask%2F</url>
    <content type="text"><![CDATA[WWDC 19 ä¸“æ æ–‡ç« ç›®å½•WWDC 2019 Session 707: Advances in App Background Execution 2010å¹´ iOS4 æ—¶ä»£ï¼ŒiOS çš„å¤šä»»åŠ¡ç³»ç»Ÿé¢ä¸–ï¼Œè‡³ä»Šå·²ç»9ä¸ªå¹´å¤´ï¼ŒæœŸé—´åå°æ¨¡å¼åŠåœºæ™¯ä¹Ÿé€æ¸å¢å¤šï¼Œè¿™ä¸ºå¼€å‘è€…å’Œç”¨æˆ·å¸¦æ¥äº†å¾ˆå¤šå¯èƒ½æ€§ã€‚éšç€ iOS ç‰ˆæœ¬çš„è¿­ä»£ï¼Œæ…¢æ…¢çš„è¶Šæ¥è¶Šå¤šçš„åå°è¿è¡Œåœºæ™¯è¢«è‹¹æœæ‰€æ”¯æŒã€‚ä¸æ­¤åŒæ—¶ä¸ºäº†æ”¹å–„ç”¨æˆ·ä½“éªŒä»¥åŠå»¶é•¿ç”µæ± å¯¿å‘½ï¼Œè‹¹æœå¯¹äºåº”ç”¨åå°ä»»åŠ¡æœ‰ç€æ¯”è¾ƒä¸¥è‹›çš„é™åˆ¶åŠå®¡æ ¸è§„åˆ™ï¼Œåªæœ‰ç‰¹å®šä½¿ç”¨åœºæ™¯ï¼Œåº”ç”¨æ‰å¯èƒ½åœ¨åå°æŒç»­è¿è¡Œï¼Œæ¯”å¦‚å¯¼èˆªã€éŸ³ä¹æ’­æ”¾ï¼ŒVoIP ç­‰ã€‚å¦‚æœæˆ‘ä»¬çš„åº”ç”¨æ°å¥½ç¬¦åˆåå°æ¨¡å¼çš„åœºæ™¯ï¼Œé‚£ä¹ˆåº”è¯¥æ€æ ·åˆ©ç”¨å¥½è¿™ä¸€ç‚¹æ¥ç»™ç”¨æˆ·å¥½çš„ä½“éªŒå‘¢ï¼Ÿç›¸ä¿¡é€šè¿‡è¿™ä¸€é›† Sessionï¼Œä½ å¿ƒä¸­åº”è¯¥ä¼šæœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜ç¡®çš„ç­”æ¡ˆ~ æ¦‚è§ˆç›®å‰è‹¹æœæ”¯æŒ9ç§åå°æ¨¡å¼ï¼Œå…·ä½“ç±»å‹å¯ä½¿ç”¨ Xcode çš„ Capabilities æ¥æŸ¥çœ‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º é€šè¿‡ä¸Šå›¾å¯¹æ¯”å¯ä»¥çœ‹åˆ° Xcode11 å°† Newsstand downloads è¿™ç§åå°æ¨¡å¼ç§»é™¤ï¼Œå¹¶æ–°å¢äº†ä¸€ä¸ª Background processing(åé¢ä¼šå…·ä½“è¯´)ã€‚è¿™äº›åå°æ¨¡å¼éƒ½æœ‰ API ä¸ä¹‹å¯¹åº”ï¼Œè‹¹æœåœ¨è®¾è®¡åå°ä»»åŠ¡ç›¸å…³ API æ—¶ï¼Œå°†ä»¥ä¸‹3ç‚¹ä½œä¸ºä¸»è¦è€ƒè™‘å› ç´ æ¥ç¡®ä¿æµç•…çš„ç”¨æˆ·ä½“éªŒã€‚ ç”µæ±  ç”µé‡å‡ ä¹æ—¶åˆ»éƒ½åœ¨è¢«æ¶ˆè€—ï¼Œé‚£ä¹ˆå¦‚ä½•ä¿è¯åå°ä»»åŠ¡å°½å¯èƒ½çš„å‡å°ç”µé‡çš„æ¶ˆè€—å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯åœ¨åå°ä»»åŠ¡å®Œæˆæ—¶åŠæ—¶è°ƒç”¨å¯¹åº”çš„ completion é€šçŸ¥ç³»ç»Ÿä»»åŠ¡å·²ç»“æŸï¼Œä»¥æ­¤æ¥å‡å°ç”µé‡çš„æ¶ˆè€—ã€‚ æ€§èƒ½ åœ¨æ—¥å¸¸ä½¿ç”¨æƒ…å†µä¸‹ï¼Œæ‰‹æœºä¸Šé€šå¸¸åŒæ—¶è¿è¡Œç€å¤šä¸ªåº”ç”¨ï¼ŒæŸä¸ªåº”ç”¨åœ¨å‰å°æ—¶ï¼Œå…¶å®ƒçš„åº”ç”¨åœ¨åå°ã€‚åœ¨èµ„æºæœ‰é™çš„æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¿è¯è®¾å¤‡å°½å¯èƒ½çš„æµç•…ï¼Œç³»ç»Ÿä¼šä¸ºæ¯ä¸ªåº”ç”¨æ™ºèƒ½åˆ†é… CPU åŠå†…å­˜çš„é˜ˆå€¼ï¼Œä¸€æ—¦åº”ç”¨è¶…è¿‡å¯¹åº”é˜ˆå€¼ï¼Œå°†ä¼šè¢«ç³»ç»Ÿç»ˆæ­¢ã€‚æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­å‘ç”Ÿçš„ OOM(Out Of Memory) ä»¥åŠä¸»çº¿ç¨‹é•¿æ—¶é—´æœªå“åº”è€Œè§¦å‘ç³»ç»Ÿçš„â€œçœ‹é—¨ç‹—â€ï¼Œéƒ½æ˜¯ç”±äºåº”ç”¨è€—å°½äº†ç³»ç»Ÿåˆ†é…çš„èµ„æºè€Œè¢«ç³»ç»Ÿç»ˆæ­¢ã€‚ å»¶å±•é˜…è¯»è§¦å‘â€œçœ‹é—¨ç‹—â€é€šå¸¸ä¼šç”Ÿæˆä¸€ä»½ Crash æ—¥å¿—ï¼Œæ—¥å¿—å†…å®¹ç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼Œç»å…¸çš„ 0x8badf00dException Type: EXC_CRASH (SIGKILL)Exception Codes: 0x0000000000000000, 0x0000000000000000Exception Note: EXC_CORPSE_NOTIFYTermination Reason: Namespace SPRINGBOARD, Code 0x8badf00dTermination Description: SPRINGBOARD, process-launch watchdog transgression: com.xxxx exhausted real (wall clock) time allowance of 20.00 seconds | | ProcessVisibility: Unknown | ProcessState: Running | WatchdogEvent: process-launch | WatchdogVisibility: Foreground | WatchdogCPUStatistics: ( | â€œElapsed total CPU time (seconds): 2.910 (user 2.910, system 0.000), 7% CPUâ€, | â€œElapsed application CPU time (seconds): 0.000, 0% CPUâ€ | )Triggered by Thread: 0å¦‚æœå¯¹ç³»ç»Ÿ Crash æ—¥å¿—æ„Ÿå…´è¶£ï¼Œå¯ä»¥çœ‹çœ‹æˆ‘å»å¹´å†™çš„è¿™ç¯‡æ–‡ç«  WWDC 2018ï¼šç†è§£å´©æºƒä»¥åŠå´©æºƒæ—¥å¿— å¤§éƒ¨åˆ† OOM çš„æƒ…å†µä¸‹ä¸€èˆ¬ä¼šç”Ÿæˆä¸€ä»½ JetsamEvent å¼€å¤´çš„æ—¥å¿—æ–‡ä»¶ï¼Œå¯åœ¨è®¾å¤‡çš„ è®¾ç½®-&gt;éšç§-&gt;åˆ†æ ä¸­æŸ¥çœ‹åˆ°ï¼Œé‡Œé¢çš„å†…å®¹ä¼šæœ‰å´©æºƒç°åœºçš„ä¸€äº›è¿›ç¨‹ä¿¡æ¯ä»¥åŠå†…å­˜åˆ†é…æƒ…å†µã€‚æ›´å¤šå…³äº JetsamEvent çš„ä»‹ç»ï¼Œå¯ä»¥æŸ¥çœ‹è¿™ç¯‡æ–‡ç«  iOSå†…å­˜abort(Jetsam) åŸç†æ¢ç©¶ã€‚ éšç§ ç”±äºåº”ç”¨åœ¨æ‰§è¡Œåå°ä»»åŠ¡æ—¶ï¼Œç”¨æˆ·æ˜¯æ— æ„Ÿçš„ï¼Œä½†æ˜¯ç”¨æˆ·å¯¹äºè‡ªå·±çš„éšç§ä¿¡æ¯æ˜¯æ•æ„Ÿçš„ï¼Œæ‰€ä»¥åœ¨ç›¸å…³ API çš„è®¾è®¡æ—¶ä¼šå‘ŠçŸ¥ç”¨æˆ·ï¼Œå“ªäº›æ•°æ®ä¼šè¢«ä½¿ç”¨ã€‚ä»ä»Šå¹´çš„ WWDC çš„åŠ¨ä½œæ¥çœ‹ï¼Œè‹¹æœå¯¹ç”¨æˆ·çš„éšç§è¶Šæ¥è¶Šé‡è§†ï¼Œè¿™ç‚¹éå¸¸å€¼å¾—ç§°èµï¼Œæ¯”å¦‚ä»Šå¹´æ¨å‡ºçš„ Sign In With Appleã€åœ°ç†ä½ç½®æƒé™çš„å˜æ›´ã€åå°åœ°ç†ä½ç½®è®¿é—®çš„å¼¹çª—ç­‰ã€‚å½“ç„¶ï¼Œè¿™ä¸æ˜¯å¼€å§‹ä¹Ÿä¸æ˜¯ç»“æŸï¼Œä¸ºè‹¹æœçˆ¸çˆ¸ç‚¹èµğŸ‘ã€‚ æœ€ä½³å®è·µäº†è§£äº†åå°ä»»åŠ¡ç›¸å…³ API çš„è®¾è®¡åˆè¡·ï¼Œæ˜¯æ—¶å€™æ¥çœ‹çœ‹å¦‚ä½•å®è·µæ‰èƒ½ä¿è¯æµç•…çš„ç”¨æˆ·ä½“éªŒä»¥åŠå»¶é•¿ç”µæ± å¯¿å‘½ã€‚ æƒ³è±¡ä¸€ä¸‹ä¸€ä¸ªç±»ä¼¼å¾®ä¿¡çš„å³æ—¶é€šè®¯è½¯ä»¶æ‹¥æœ‰çš„ä¸€äº›åŠŸèƒ½ï¼šå³æ—¶æ¶ˆæ¯ã€å‹¿æ‰°æ¨¡å¼ã€VoIPã€å†å²è®°å½•ä¸‹è½½ç­‰ï¼Œå¯¹äºè¿™äº›åŠŸèƒ½ï¼Œç»“åˆç³»ç»Ÿæä¾›çš„å„ç§åå°ä»»åŠ¡åº”ç”¨åœºæ™¯ï¼Œè¯¥ä»¥ä½•ç§å§¿åŠ¿ä½¿ç”¨è¿™äº› API å‘¢ï¼Ÿä¸”å¾€ä¸‹çœ‹~ å³æ—¶æ¶ˆæ¯å³æ—¶æ¶ˆæ¯è‚¯å®šéœ€è¦ç¡®ä¿æ—¶æ•ˆæ€§ï¼Œå°½å¯èƒ½å¿«çš„è§¦è¾¾å¯¹æ–¹æ‰èƒ½ä¿è¯è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒã€‚ä½†æ˜¯æŸäº›æƒ…å†µä¸‹ï¼ˆæ¯”å¦‚è¾ƒå·®ç½‘ç»œç¯å¢ƒï¼‰ï¼Œä¸ä¸€å®šèƒ½é©¬ä¸Šå°†æ¶ˆæ¯å‘é€åˆ°å¯¹æ–¹ï¼Œæ­¤æ—¶ç”¨æˆ·å¯èƒ½åˆ‡å›åˆ°æ¡Œé¢æˆ–è€…å…¶å®ƒåº”ç”¨ï¼Œé‚£ä¹ˆå¦‚ä½•æ‰èƒ½ä¿è¯å‘é€æ¶ˆæ¯è¿™ä¸ªæ“ä½œå®Œæˆå‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ä½¿ç”¨ Background Task Completion ç›¸å…³ APIã€‚ 123456789101112131415161718192021222324252627// Guarding Important Tasks While App is Still in the Foregroundfunc send(_ message: Message) &#123; let sendOperation = SendOperation(message: message) var identifier: UIBackgroundTaskIdentifier! // 1 identifier = UIApplication.shared.beginBackgroundTask(expirationHandler: &#123; // 2 sendOperation.cancel() postUserNotification("Message not sent, please resend") // Background task will be ended in the operation's completion block below &#125;) sendOperation.completionBlock = &#123; // 3 UIApplication.shared.endBackgroundTask(identifier) &#125; operationQueue.addOperation(sendOperation) &#125;``` è®©æˆ‘ä»¬ä¾æ¬¡çœ‹çœ‹ä¸Šé¢æ ‡æ³¨çš„æ­¥éª¤ï¼š1. åº”ç”¨åœ¨å‰å°æ—¶é€šè¿‡å¯¹åº” API åˆ›å»ºä¸€ä¸ªåå°ä»»åŠ¡ï¼Œæ­¤æ—¶å³ä½¿ app è¿›å…¥åå°ï¼Œä¹Ÿä¼šè·å¾—ä¸€å®šçš„æ—¶é—´æ¥å¤„ç†æ¶ˆæ¯å‘é€ã€‚2. åœ¨ç³»ç»Ÿç»™å‡ºçš„æ—¶é—´å†…è¿˜æ²¡æœ‰å¤„ç†å®Œï¼Œåº”ç”¨å³å°†è¢«æŒ‚èµ·ï¼Œåˆ™å–æ¶ˆå‘é€ï¼ŒåŒæ—¶æœ¬åœ° push é€šçŸ¥ç”¨æˆ·ã€‚3. å¦‚æœå‘é€æˆåŠŸï¼Œåˆ™é€šçŸ¥ç³»ç»Ÿè¯¥ä»»åŠ¡å·²ç»“æŸï¼Œä»¥æ­¤é™ä½å¯¹ç”µé‡çš„æ¶ˆè€—ã€‚&gt; å¦‚æœæ˜¯ `Extension`ï¼Œå¯ä»¥ä½¿ç”¨ `ProcessInfo.performExpiringActivity(withReason:using:)`ã€‚ç›¸ä¿¡è¿™ç§æ–¹å¼å¤§å®¶æˆ–å¤šæˆ–å°‘éƒ½ç”¨è¿‡ï¼Œæœ‰äº›åº”ç”¨ç”šè‡³ç”¨è¿™ä¸ªæ¥å£å»åšæ‰€è°“çš„â€œä¿æ´»â€ã€‚ä½†æ˜¯è¿™é‡Œè¦æé†’å¤§å®¶æ³¨æ„ä¸€ä¸ªç‚¹ï¼ˆè¯´å¤šäº†éƒ½æ˜¯æ³ªï¼‰ï¼Œ**å°±æ˜¯ task çš„ begin å’Œ end çš„è°ƒç”¨è¦å¯¹åº”**ï¼Œä½ ä¼šè¸©åˆ°æˆ‘è¸©è¿‡çš„å‘ï¼šæ²¡æœ‰æˆå¯¹è°ƒç”¨çš„ `task` ä¼šè§¦å‘ `0x8badf00d` çœ‹é—¨ç‹—ã€‚ä½†æ˜¯è¿™é‡Œçš„ `Crash` å †æ ˆå’Œä¸Šé¢è¯´çš„çš„ä¸»çº¿ç¨‹å¡å¤ªä¹…è€Œè¢«å¼ºæ€çš„å †æ ˆæ˜¯ä¸ä¸€æ ·çš„ï¼Œå…·ä½“å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« çš„åˆ†æï¼š[**iOS App åå°ä»»åŠ¡çš„å‘**](http://mrpeak.cn/blog/ios-background-task/)ã€‚### ç”µè¯æœ‰äº›æ—¶å€™ä¼šè§‰å¾—æ‰“å­—éº»çƒ¦è€Œç›´æ¥æ‰“ç”µè¯ï¼Œç³»ç»ŸåŒæ ·ä¹Ÿæä¾›äº†å¯¹åº”çš„ APIâ€”â€”â€”â€”VoIP é€šçŸ¥ã€‚å®ƒæ˜¯ä¸€ç§ç‰¹æ®Šçš„é€šçŸ¥ç±»å‹ï¼Œå¯ä»¥å”¤èµ·åº”ç”¨ï¼Œæé†’ç”¨æˆ·æœ‰ç”µè¯å‘¼å…¥ï¼Œä»£ç å®ç°èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•```Swiftfunc registerForVoIPPushes() &#123; self.voipRegistry = PKPushRegistry(queue: nil) self.voipRegistry.delegate = self self.voipRegistry.desiredPushTypes = [.voIP]&#125; åŒæ—¶å¿…é¡»åœ¨ didReceiveIncomingPush å›è°ƒä¸­ä½¿ç”¨ CallKit æ¥å¤„ç† VoIP push é€šçŸ¥ï¼Œå¦åˆ™ç³»ç»Ÿä¼šâ€œæ€â€æ‰åº”ç”¨ï¼Œå¹¶ä¸”ç³»ç»Ÿå¯èƒ½åœ¨æ”¶åˆ° VoIP é€šçŸ¥æ—¶ä¸å†å”¤èµ·åº”ç”¨ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 123let provider = CXProvider(configuration: providerConfiguration) func pushRegistry(_ registry: PKPushRegistry, didReceiveIncomingPushWith payload: PKPushPayload, for type: PKPushType, completion: @escaping () -&gt; Void) &#123; if type == .voIP &#123; if let handle = payload.dictionaryPayload["handle"] as? String &#123; let callUpdate = CXCallUpdate() callUpdate.remoteHandle = CXHandle(type: .phoneNumber, value: handle) let callUUID = UUID() provider.reportNewIncomingCall(with: callUUID, update: callUpdate) &#123; _ in completion() &#125; establishConnection(for: callUUID) &#125; &#125; &#125; åŒæ—¶ä»¥ä¸‹å‡ ç‚¹ä¹Ÿå¯ä»¥å…³æ³¨ä¸€ä¸‹ï¼š payload ä¸­å¡«å……å°½å¯èƒ½å¤šçš„ä¿¡æ¯ï¼Œä»¥ä¾¿å±•ç¤ºæ›´åŠ å®Œå–„çš„ UIï¼ˆå½“ç„¶ä¸èƒ½è¶…è¿‡å…¶é™åˆ¶ï¼‰ã€‚ å› ä¸ºç”µè¯çš„å®æ—¶æ€§å¾ˆé«˜ï¼Œpayload ä¸­çš„ apns-expiration çš„å€¼å°½å¯èƒ½å°æˆ–è€…ä¸º0ï¼Œä»¥ä¾¿é€šçŸ¥èƒ½ç«‹å³è§¦å‘ã€‚ å¦‚æœä¸æƒ³è¦ç±»ä¼¼ç³»ç»Ÿç”µè¯çš„å…¨å± UIï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ ‡å‡†çš„æ¨é€ API æ¥è§¦å‘ banner æ ·å¼ã€‚ å¦‚æœæƒ³è¦è‡ªå®šä¹‰ push å†…å®¹ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ Notification Service Extensionï¼Œæ¯”å¦‚æƒ³è¦åšä¸€äº›åŠ å¯†æ“ä½œã€‚ ç”±äºç¬”è€…æ²¡æœ‰å®é™…ä½¿ç”¨è¿‡ VoIP ç›¸å…³æŠ€æœ¯ï¼Œæ‰€ä»¥è¿™é‡Œæ¨èå¤§å®¶çœ‹çœ‹è‹¹æœçš„å®˜æ–¹æ–‡æ¡£ VoIP æœ€ä½³å®è·µ ä»¥åŠé—²é±¼æŠ€æœ¯å›¢é˜Ÿå†™çš„è¿™ç¯‡æ–‡ç« iOS VoIPç”µè¯ï¼šCallKitä¸PushKitçš„åº”ç”¨ å‹¿æ‰°æ¨¡å¼èŠå®Œ VoIPï¼Œæˆ‘ä»¬ç´§æ¥ç€çœ‹çœ‹å‹¿æ‰°æ¨¡å¼çš„æœ€ä½³å®è·µã€‚å¾®ä¿¡ä¸­é€šå¸¸èŠå¤©åˆ—è¡¨é‡Œèººç€å‡ åä¸ªç”šè‡³ä¸Šç™¾ä¸ªä¼šè¯ï¼Œæœ‰äº›æ´»è·ƒçš„ç¾¤å¯èƒ½ä¸€å¤©æœ‰ä¸Šåƒæ¡ä¿¡æ¯ï¼Œå¦‚æœä¸€ç›´æ”¶åˆ° pushï¼Œè‚¯å®šä¼šä¸èƒœå…¶çƒ¦ã€‚æ‰€ä»¥ä¸€èˆ¬éƒ½ä¼šå¯¹è¿™ä¸ªç¾¤å¼€å¯æ¶ˆæ¯å…æ‰“æ‰°æ¨¡å¼ï¼Œä½†æ˜¯åˆä¸æƒ³é”™è¿‡é‡è¦ä¿¡æ¯ï¼ˆæ¯”å¦‚è¢«åˆ«äºº@ï¼‰ã€‚é‚£ä¹ˆè¿™ç§å‹¿æ‰°æ¨¡å¼ï¼Œåœ¨åå°æ¨¡å¼ä¸‹è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿä½¿ç”¨é™é»˜æ¨é€ï¼~ é™é»˜æ¨é€å¯ä»¥åœ¨ç”¨æˆ·æ— æ„ŸçŸ¥çš„æƒ…å†µä¸‹ï¼Œå°†æ•°æ®æ¨é€åˆ°è®¾å¤‡ä¸Šã€‚åªéœ€è¦å°† push payload é‡Œçš„ content-available çš„å€¼è®¾ç½®ä¸º 1ï¼ŒåŒæ—¶ payload ä¸­ä¸è¦åŒ…å« alertã€soundã€badge å­—æ®µï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š ç¤ºä¾‹æ‘˜æŠ„è‡ª Creating the Remote Notification Payload Listing 7-1 1234567&#123; "aps" : &#123; "content-available" : 1 &#125;, "acme1" : "bar", "acme2" : 42&#125; å½“æ”¶åˆ°é™é»˜æ¨é€åï¼Œç³»ç»Ÿå‡ºäºå¯¹ç”µæ± å¯¿å‘½å’Œæ€§èƒ½çš„ä¿è¯ï¼Œä¼šæ™ºèƒ½åœ°åœ¨åå°å”¤èµ·åº”ç”¨å»ä¸‹è½½ç›¸å…³å†…å®¹ã€‚ ä¸‹å›¾è¿˜æ˜¯ä»¥æ¶ˆæ¯å…æ‰“æ‰°ä¸ºä¾‹ï¼Œç”¨æˆ·åœ¨å‰å°å¯¹æŸä¸ªä¼šè¯å¼€å¯äº†æ¶ˆæ¯å…æ‰“æ‰°ï¼Œç„¶åå›åˆ°åå°ï¼Œä¸€æ®µæ—¶é—´åè¯¥ä¼šè¯æœ‰æ–°çš„å†…å®¹ï¼Œä½†æ˜¯ç”¨æˆ·å¼€äº†å‹¿æ‰°æ¨¡å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦â€œå·å·åœ°â€æ›´æ–°ä¼šè¯å†…å®¹ï¼Œä½†æ˜¯ç”¨æˆ·å´æ— æ„ŸçŸ¥ã€‚è¿™é‡Œâ€œå·å·åœ°â€å°±æ˜¯ç³»ç»Ÿåœ¨æ”¶åˆ°é™é»˜æ¨é€æ—¶ï¼Œä¼šåœ¨åˆé€‚çš„æ—¶æœºåœ¨åå°å”¤èµ·åº”ç”¨å»åŠ è½½è¯¥ä¼šè¯çš„æ–°å†…å®¹ï¼ˆè¯¥åå°ä»»åŠ¡å¯ä»¥æŒç»­30ç§’ï¼‰ã€‚ç­‰ç”¨æˆ·å›åˆ°å‰å°ï¼Œä¼šå‘ç°å…æ‰“æ‰°çš„ä¼šè¯é‡Œçš„å†…å®¹ä¹Ÿæœ‰äº†æ›´æ–°ï¼Œæå¤§æé«˜äº†ç”¨æˆ·ä½“éªŒã€‚ å…³äºé™é»˜æ¨é€çš„å…¶å®ƒå‡ ç‚¹ tipsï¼š å¿…é¡»å°† apns-priority è®¾ç½®ä¸º 5ï¼Œå¦åˆ™ç³»ç»Ÿä¸ä¼šå”¤èµ·åº”ç”¨ã€‚ watchOS åº”ç”¨å¿…é¡»ï¼ˆå…¶å®ƒå¹³å°åˆ™å¼ºçƒˆæ¨èï¼‰å°† apns-push-type è®¾ç½®ä¸º backgroundã€‚ ä»¥ä¸Šæ¶‰åŠåˆ° payload é‡Œçš„ç›¸å…³å­—æ®µçš„è®¾ç½®ï¼Œå…¶å®æ˜¯åœ¨å‘ APNs æœåŠ¡å™¨å‘èµ·è¯·æ±‚æ—¶ï¼Œè¯·æ±‚ä½“é‡Œçš„ç›¸å…³å­—æ®µï¼Œæ›´å¤šå†…å®¹å¯å‚è€ƒSending Notification Requests to APNså…³äºæœ€åä¸€ç‚¹éœ€è¦ç¨å¾®åæ§½ä¸€ä¸‹ï¼Œè¿™é›† Session Keynote ä¸Šæ˜¯è¯´ watchOS å¿…é¡»è®¾ç½®ï¼Œå…¶å®ƒå¹³å°å¼ºçƒˆæ¨èè®¾ç½®ã€‚ä½†æ˜¯å®˜æ–¹æ–‡æ¡£å´è¯´ä» iOS13 å’Œ watchOS6 èµ·ï¼Œè¿™ä¸ª key å¿…é¡»è®¾ç½®ï¼Œå»ºè®®è¿˜æ˜¯ä»¥æ–‡æ¡£ä¸ºå‡†ã€‚ å…³äºæ¨é€æµ‹è¯•ï¼Œæ¨èä¸€ä¸‹è¿™ä¸ªå·¥å…· Knuff å†å²è®°å½•ä¸‹è½½å½“æˆ‘ä»¬åœ¨æ–°è®¾å¤‡ä¸Šç™»å½•æ—¶ï¼Œä¼šåŒæ­¥å†å²èŠå¤©åˆ—è¡¨ï¼Œå¯¹äºä¸€äº›æ¯”è¾ƒä¹…è¿œçš„ä¼šè¯è®°å½•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åå°ä¸‹è½½ä»»åŠ¡ï¼ˆBackground URL Sessionï¼‰å°†å…¶å»¶è¿Ÿä¸‹è½½ã€‚å…¶å®ä¸ä»…ä»…æ˜¯ä¼šè¯åˆ—è¡¨å¯ä»¥å»¶è¿Ÿæ”¾åˆ°åå°ä»»åŠ¡å»åŒæ­¥ï¼Œå…¶ä»–çš„ä¸€äº›ä»»åŠ¡ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ¯”å¦‚æ•°æ®ç»Ÿè®¡ã€ç…§ç‰‡å¤‡ä»½ç­‰ã€‚ä¸è¿‡æ˜¯å¦æ”¾åœ¨åå°ä»»åŠ¡å»æ‰§è¡Œï¼Œè¿˜æ˜¯éœ€è¦ç»“åˆæ—¶æ•ˆæ€§ä»¥åŠæ€§èƒ½ç¨³å®šæ€§æ¥å†³å®šã€‚ åå°ä¸‹è½½ä»»åŠ¡ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 123456789// é…ç½®ä»»åŠ¡let config = URLSessionConfiguration.background(withIdentifier: "com.app.attachments") let session = URLSession(configuration: config, delegate: ..., delegateQueue: ...) // è®¾ç½®è¿™ä¸ªå€¼ä¸º trueï¼Œå‘Šè¯‰ç³»ç»Ÿåœ¨åˆé€‚çš„æ—¶æœºè§¦å‘ç›¸åº”ä»»åŠ¡æ¥ä¿è¯è‰¯å¥½çš„æ€§èƒ½// å¦‚æœä»»åŠ¡æ¯”è¾ƒè€—æ—¶ï¼Œå»ºè®®å°†è¿™ä¸ªå€¼è®¾ä¸º trueconfig.discretionary = true// è®¾ç½®è¶…æ—¶æ—¶é—´ config.timeoutIntervalForResource = 24 * 60 * 60 config.timeoutIntervalForRequest = 60 // åˆ›å»ºè¯·æ±‚ var request = URLRequest(url: url) request.addValue("...", forHTTPHeaderField: "...") let task = session.downloadTask(with: request)// è®¾ç½®æœ€æ—©è§¦å‘æ—¶é—´task.earliestBeginDate = Date(timeIntervalSinceNow: 2 * 60 * 60) // è®¾ç½®æœŸæœ›çš„å‘é€å’Œæ¥æ”¶çš„æ•°æ®åŒ…å¤§å° task.countOfBytesClientExpectsToSend = 160 task.countOfBytesClientExpectsToReceive = 4096 task.resume() æ›´å¤šä¿¡æ¯å¯ä»¥æŸ¥çœ‹Downloading Files in the Backgroundã€‚è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœåœ¨åå°ä»»åŠ¡ä¸‹è½½è¿‡ç¨‹ä¸­åº”ç”¨è¢«ç³»ç»Ÿç»ˆæ­¢ï¼Œå†æ¬¡å¯åŠ¨æ—¶ï¼Œä½¿ç”¨ç›¸åŒ identifier åˆ›å»ºçš„ session ç³»ç»Ÿå°†ä¼šä»ä¸Šä¸€æ¬¡ç»ˆæ­¢çš„åœ°æ–¹ç»§ç»­ä¸‹è½½å¯¹åº”å†…å®¹ã€‚ä½†æ˜¯å¦‚æœç”¨æˆ·æ‰‹åŠ¨é€šè¿‡å¤šä»»åŠ¡å°†åº”ç”¨ç»ˆæ­¢çš„è¯ï¼Œç³»ç»Ÿä¼šå–æ¶ˆæ‰€æœ‰åå°ä¸‹è½½ä»»åŠ¡ï¼ŒåŒæ—¶ç³»ç»Ÿä¹Ÿä¸ä¼šè‡ªåŠ¨åœ¨åå°å”¤èµ·åº”ç”¨ã€‚ é€šè¿‡ä¸Šé¢çš„å››ç§åœºæ™¯åˆ†æï¼Œç³»ç»Ÿåˆ†åˆ«ä¸ºæˆ‘ä»¬æä¾›äº†ä¸åŒåœºæ™¯ä¸‹è¯¥ä½¿ç”¨çš„ APIï¼Œä»¥åŠå¯¹åº”çš„æœ€ä½³å®è·µã€‚å½“ç„¶è¿˜æœ‰ä¸€äº›åœºæ™¯ä¸Šé¢ä¾‹å­å¹¶æ²¡æœ‰æ¶‰åŠï¼Œæ¯”å¦‚ Background Fetchã€Background Processingã€‚æŸäº›ç‰¹å®šçš„åå°ä»»åŠ¡éœ€è¦åœ¨ Xcode çš„ Signing &amp; Capabilitiesï¼ˆXcode 10 ä¸º Capabilitiesï¼‰ä¸­å‹¾é€‰æ‰èƒ½ç”Ÿæ•ˆï¼Œå…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ è€Œæˆ‘ä»¬ä¸Šé¢æåˆ°çš„ VoIP ç”µè¯å’Œé™é»˜æ¨é€éœ€è¦å°† Voice over IP å’Œ Remote notifications é€‰é¡¹å‹¾èµ·æ¥ã€‚ å…¨æ–°åå°ä»»åŠ¡æ¡†æ¶ä»¥ä¸Šåœºæ™¯éƒ½æœ‰å¯¹åº”çš„ API å¯ç”¨ï¼Œä½†æ˜¯å¯¹äºå…¶å®ƒåœºæ™¯å‘¢ï¼Ÿæ¯”å¦‚æ•°æ®åŒæ­¥ã€ç…§ç‰‡å¤‡ä»½ã€æ•°æ®åº“æ¸…ç†ç­‰ï¼Œæœ‰æ²¡æœ‰æ›´ä¾¿æ·çš„æ–¹å¼å‘¢ï¼Ÿå½“ç„¶ï¼Œä¸”çœ‹ iOS13 æ¨å‡ºçš„å…¨æ–°æ¡†æ¶ BackgroundTasks.framework~ å¦‚æœ¬æ–‡é¢˜å›¾é‚£æ ·ï¼ŒBackgroundTasks.framework æ˜¯ä¸€ä¸ªå…¨æ–°çš„åå°ä»»åŠ¡è°ƒåº¦æ¡†æ¶ï¼ŒåŒæ—¶å¯¹iOSã€iPadOSã€watchOSã€tvOS ä»¥åŠ Mac ä¸Šçš„ iPad åº”ç”¨éƒ½æ”¯æŒã€‚åŒæ · iOS13 æ–°å¢äº†ä¸€ç§åå°æ¨¡å¼ Background processingï¼ŒåŒæ—¶å¯¹ç°æœ‰çš„åå°åˆ·æ–°ç›¸å…³ API è¿›è¡Œäº†æ”¹å–„ã€‚ è¿›åˆ°è¿™ä¸ªæ¡†æ¶çš„ç±» APIï¼Œä¼šå‘ç°è¿™ä¸ªæ¡†æ¶ååˆ†ç®€æ´ï¼Œä¸¤ç§åå°ä»»åŠ¡åˆ†åˆ«å¯¹åº”çš„ç±»ä¸º BGProcessingTask å’Œ BGAppRefreshTaskï¼Œè¿™ä¸¤ä¸ªç±»éƒ½æ˜¯ç»§æ‰¿è‡ªä¸€ä¸ªæŠ½è±¡ç±» BGTaskï¼Œç„¶åå†é…åˆå¯¹åº”çš„BGTaskRequest ä»¥åŠ BGTaskSchedulerï¼Œå°±å¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†åå°ä»»åŠ¡çš„éœ€æ±‚ã€‚ ç›¸å…³ API ä¸€è§ˆï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445// task@available(iOS 13.0, *)open class BGTask : NSObject &#123; open var identifier: String &#123; get &#125; open var expirationHandler: (() -&gt; Void)? open func setTaskCompleted(success: Bool)&#125;@available(iOS 13.0, *)open class BGProcessingTask : BGTask &#123;&#125;@available(iOS 13.0, *)open class BGAppRefreshTask : BGTask &#123;&#125;// request@available(iOS 13.0, *)open class BGTaskRequest : NSObject, NSCopying &#123; open var identifier: String &#123; get &#125; open var earliestBeginDate: Date?&#125;@available(iOS 13.0, *)open class BGAppRefreshTaskRequest : BGTaskRequest &#123; public init(identifier: String)&#125;@available(iOS 13.0, *)open class BGProcessingTaskRequest : BGTaskRequest &#123; public init(identifier: String) open var requiresNetworkConnectivity: Bool open var requiresExternalPower: Bool&#125;// scheduler@available(iOS 13.0, *)open class BGTaskScheduler : NSObject &#123; open class var shared: BGTaskScheduler &#123; get &#125; open func register(forTaskWithIdentifier identifier: String, using queue: DispatchQueue?, launchHandler: @escaping (BGTask) -&gt; Void) -&gt; Bool open func submit(_ taskRequest: BGTaskRequest) throws open func cancel(taskRequestWithIdentifier identifier: String) open func cancelAllTaskRequests() open func getPendingTaskRequests(completionHandler: @escaping ([BGTaskRequest]) -&gt; Void)&#125; BGProcessingTaské¦–å…ˆæ¥çœ‹çœ‹ä»Šå¹´æ–°æä¾›çš„åå°æ¨¡å¼â€”â€”â€”â€”Background Processing Taskã€‚ è¿™ç§åå°æ¨¡å¼ä¼šç»™åº”ç”¨å‡ åˆ†é’Ÿçš„æ—¶é—´æ¥å¤„ç†ç›¸å…³ä»»åŠ¡ï¼Œç›¸æ¯”ä¹‹å‰çš„å‡ åç§’æœ‰äº†æ¯”è¾ƒå¤§çš„æå‡ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å°†ä¸€äº›å¯å»¶è¿Ÿåˆ°åå°æ‰§è¡Œçš„ä»»åŠ¡æ”¾åˆ°è¿™ç§æ¨¡å¼ä¸‹æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥å°†ä¸€äº› Core ML çš„è®­ç»ƒæ”¾åˆ°è¿™ç§æ¨¡å¼ä¸‹æ‰§è¡Œã€‚ æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œæ–°æ¡†æ¶å…è®¸æˆ‘ä»¬å…³æ‰ CPU çš„æ£€æµ‹ï¼Œå› ä¸ºä¹‹å‰ç³»ç»Ÿå‡ºäºå¯¹ç”µæ± å¯¿å‘½çš„è€ƒè™‘ï¼Œä¼šå°†åå° CPU å ç”¨è¾ƒé«˜çš„åº”ç”¨â€œæ€æ­»â€ï¼Œæ‰€ä»¥æ–°æ¡†æ¶çš„è¿™ä¸ªç‰¹æ€§å¯¹äºé‚£äº› CPU å ç”¨è¾ƒé«˜çš„åå°ä»»åŠ¡å¯ä»¥è¯´æ˜¯åŠæ—¶é›¨äº†ï¼Œè€Œè¦åšåˆ°è¿™ä¸ªï¼Œä»…ä»…åªéœ€è¦è®¾ç½® bgProcessingTaskRequest.requiresExternalPower = true å³å¯ã€‚ åŒæ—¶æˆ‘ä»¬åªè¦éœ€åº”ç”¨åœ¨å‰å°æ—¶æäº¤äº†å¯¹åº”è¯·æ±‚ï¼Œç³»ç»Ÿå°±ä¼šåœ¨é€‚å½“çš„æ—¶æœºè§¦å‘ç›¸åº”çš„ä»»åŠ¡ã€‚ BGAppRefreshTaskäº†è§£å®Œ BGProcessingTaskï¼Œæˆ‘ä»¬ç»§ç»­çœ‹ä¸€çœ‹ BGAppRefreshTaskã€‚ è™½ç„¶æ˜¯æ–° APIï¼Œä½†æ˜¯è§„åˆ™å’Œä¹‹å‰çš„ Background Fetchä¸€æ ·ï¼šæœ‰30ç§’çš„æ‰§è¡Œæ—¶é—´ã€è®©åº”ç”¨å†…å®¹ä¿æŒæœ€æ–°ã€‚ ä¼šæ ¹æ®ç”¨æˆ·ä½¿ç”¨åº”ç”¨çš„é¢‘æ¬¡å’Œæ—¶é—´æ®µï¼Œæ¥å†³å®šä½•æ—¶è§¦å‘åå°åˆ·æ–°ä»»åŠ¡ã€‚æ¯”å¦‚ç”¨æˆ·ç»å¸¸åœ¨æ—©ä¸Š 8 ç‚¹å’Œæ™šä¸Š 10 ç‚¹ä¼šæ‰“å¼€åº”ç”¨ï¼Œç³»ç»Ÿåˆ™ä¼šåœ¨è¿™ä¸¤ä¸ªæ—¶é—´ç‚¹ä¹‹å‰è§¦å‘åˆ·æ–°ä»»åŠ¡ï¼Œä»¥ä¿è¯ç”¨æˆ·æ€»æ˜¯çœ‹åˆ°æœ€æ–°çš„å†…å®¹ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€å¦‚æœåº”ç”¨ä½¿ç”¨çš„é¢‘æ¬¡è¾ƒä½ï¼Œç³»ç»Ÿè§¦å‘çš„åˆ·æ–°ä»»åŠ¡çš„é¢‘æ¬¡ä¹Ÿå°±éšä¹‹å˜ä½ã€‚åŒæ—¶ä¸‹é¢ä¸¤ä¸ª API è¢«åºŸå¼ƒäº†ï¼Œè™½ç„¶åœ¨iOSã€iPadOSã€tvOS ä»»èƒ½ä½¿ç”¨ï¼Œä½†æ˜¯åœ¨ Mac ä¸Šå°†æ— æ³•ä½¿ç”¨ï¼Œæ‰€ä»¥å°½å¿«åˆ‡åˆ°æ–°çš„ API å§~ 123- (void)setMinimumBackgroundFetchInterval:(NSTimeInterval)minimumBackgroundFetchInterval API_DEPRECATED("Use a BGAppRefreshTask in the BackgroundTasks framework instead", ios(7.0, 13.0), tvos(11.0, 13.0));- (void)application:(UIApplication *)application performFetchWithCompletionHandler:(void (^)(UIBackgroundFetchResult result))completionHandler API_DEPRECATED("Use a BGAppRefreshTask in the BackgroundTasks framework instead", ios(7.0, 13.0), tvos(11.0, 13.0)); åœ¨æˆ‘ä»¬æäº¤äº†ç›¸åº”åå°ä»»åŠ¡åï¼Œç³»ç»Ÿä¼šæ ¹æ®ä¸€äº›æ¡ä»¶å’Œè§„åˆ™ï¼ˆæ¯”å¦‚ç”µé‡ã€åº”ç”¨ä½¿ç”¨é¢‘æ¬¡ã€ç½‘ç»œç­‰ï¼‰æ¥é€‚æ—¶åœ°è§¦å‘å¯¹åº”ä»»åŠ¡ã€‚æˆ‘ä»¬å’Œç³»ç»Ÿäº¤äº’ï¼Œä¸»è¦æ˜¯é€šè¿‡ BGTaskScheduler è¿™ä¸ªç±»ã€‚ å¦‚å›¾æ‰€ç¤ºï¼Œå½“åº”ç”¨æˆ–è€… Extension åœ¨å‰å°é€šè¿‡ BGTaskScheduler å‘ç³»ç»Ÿæäº¤åå°ä»»åŠ¡è¯·æ±‚ï¼ˆBGRequestï¼‰åï¼ˆå›¾ä¸­ 1ã€2 æ‰€ç¤ºï¼‰ï¼Œç³»ç»Ÿåœ¨æ¡ä»¶æ»¡è¶³çš„æƒ…å†µä¸‹ä¼šåœ¨åå°å”¤èµ·åº”ç”¨ï¼Œç„¶åå°†å¯¹åº”çš„åå°ä»»åŠ¡ï¼ˆBBGTaskï¼‰ä¼ ç»™åº”ç”¨ï¼ˆä¸Šå›¾æ­¥éª¤ 3 æ‰€ç¤ºï¼‰ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç³»ç»Ÿåå°å”¤èµ·åº”ç”¨åï¼Œå¯èƒ½åŒæ—¶å°†å¤šä¸ªåå°ä»»åŠ¡ä¼ ç»™åº”ç”¨ï¼Œç³»ç»Ÿä¼šç»™è¿™äº›ä»»åŠ¡ä¸€å®šçš„æ—¶é—´å»æ‰§è¡Œï¼Œä½†è¿™é‡Œåˆ†é…çš„æ—¶é—´ä¸æ˜¯é’ˆå¯¹æ¯ä¸ªä»»åŠ¡ï¼Œè€Œæ˜¯é’ˆå¯¹æ¯æ¬¡åå°å”¤èµ·ï¼Œæ‰€ä»¥å¿…é¡»ä¿è¯åœ¨æœ‰é™æ—¶é—´å†…èƒ½å¤ŸåŒæ—¶å¤„ç†æ‰€æœ‰ä»»åŠ¡ã€‚è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼ŒExtension æäº¤çš„ä»»åŠ¡è¯·æ±‚ï¼Œä¹Ÿä¼šè¢«åˆ†å‘åˆ°å®¿ä¸»åº”ç”¨ï¼Œå› ä¸ºç³»ç»Ÿåªä¼šå”¤èµ·å®¿ä¸»åº”ç”¨è€Œä¸æ˜¯ Extensionã€‚ Demo Timeé€šè¿‡ä¸Šé¢æˆ‘ä»¬å¯¹æ–°çš„æ¡†æ¶æœ‰äº†ä¸€ä¸ªå®è§‚ä¸Šçš„äº†è§£ï¼Œè‹¹æœçˆ¸çˆ¸ä¹Ÿååˆ†è´´å¿ƒçš„ä¸ºè¿™é›† Session æä¾›äº† Demoã€‚è¿™é‡Œå°±ä¸å†è¯¦ç»†å±•å¼€ï¼ŒåªæŒ‡å‡ºå€¼å¾—æ³¨æ„çš„åœ°æ–¹ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è‡ªè¡Œä¸‹è½½ Demo æ„Ÿå—ä¸€ä¸‹ã€‚ æƒ³è¦æ–°æ¡†æ¶å¯¹åº”çš„ç‰¹æ€§ï¼Œå¿…é¡»å‹¾é€‰å¯¹åº”çš„åå°æ¨¡å¼ï¼Œ BGProcessingTask å¯¹åº” Background processingï¼ŒBGAppRefreshTask å¯¹åº” Background fetchã€‚Xcode11 çš„å¼€å¯æ­¥éª¤å¦‚å›¾æ‰€ç¤ºã€‚ ä»£ç ä¸­ç”¨åˆ°çš„ä»»åŠ¡æ ‡è¯†ç¬¦å¿…é¡»å’Œ Info.plist ä¸­çš„ä¸€è‡´ï¼Œå¦åˆ™ä»»åŠ¡ä¸ç”Ÿæ•ˆï¼Œå¦‚å›¾æ‰€ç¤ºã€‚Info.plist ä¸­å¯¹åº”çš„ key ä¸º Permitted background task scheduler identifiersï¼ŒåŒæ—¶æ ‡è¯†ç¬¦è¦ç¡®ä¿å…¨å±€å”¯ä¸€ï¼Œæ¨èä½¿ç”¨ååŸŸåçš„æ–¹å¼ã€‚ å¦‚æœä»»åŠ¡ä¼šå ç”¨è¾ƒé«˜ CPUï¼Œå¼ºçƒˆæ¨èå°† requiresExternalPower è®¾ç½®ä¸º trueã€‚ ä»»åŠ¡è¯·æ±‚æäº¤åï¼Œä»»æ„ä½ç½®è®¾ç½®æ–­ç‚¹æˆ–è€…æš‚åœåº”ç”¨è¿›åˆ°æ–­ç‚¹æ¨¡å¼ï¼Œè¾“å…¥ä»¥ä¸‹ä¸¤æ¡æŒ‡ä»¤æ¥æ¨¡æ‹Ÿè§¦å‘ä»»åŠ¡ä»¥åŠæå‰ç»ˆæ­¢ä»»åŠ¡ï¼Œè¾“å…¥å®Œæˆåï¼Œç‚¹å‡»ç»§ç»­ï¼Œä¼šå‘ç°ä»»åŠ¡è¢«æ­£å¸¸è§¦å‘æˆ–ç»ˆæ­¢ã€‚ä»…çœŸæœºæœ‰æ•ˆã€‚ 12345// æ¨¡æ‹Ÿè§¦å‘ä»»åŠ¡ï¼ŒTASK_IDENTIFIER æ›¿æ¢ä¸ºæƒ³è¦æµ‹è¯•çš„ä»»åŠ¡å¯¹åº”çš„æ ‡è¯†e -l objc -- (void)[[BGTaskScheduler sharedScheduler] _simulateLaunchForTaskWithIdentifier:@"TASK_IDENTIFIER"]// æ¨¡æ‹Ÿç»ˆæ­¢ä»»åŠ¡ï¼ŒTASK_IDENTIFIER æ›¿æ¢ä¸ºæƒ³è¦æµ‹è¯•çš„ä»»åŠ¡å¯¹åº”çš„æ ‡è¯† e -l objc -- (void)[[BGTaskScheduler sharedScheduler] _simulateExpirationForTaskWithIdentifier:@"TASK_IDENTIFIER"] ä¸è¦æŠŠä»»åŠ¡çš„æœ€æ—©å¼€å§‹æ—¥æœŸ(earliestBeginDate)è®¾çš„å¤ªå¤§ï¼Œæ¨èåœ¨ä¸€å‘¨å†…ã€‚ ç¡®ä¿æ–‡ä»¶åœ¨é”å±ä¸‹å¯è®¿é—®ï¼Œæœ€å¥½å°†æ–‡ä»¶è®¿é—®ç­‰çº§è®¾ç½®æˆ FileProtectionType.completeUntilFirstUserAuthenticationï¼Œå½“ç„¶è¿™ä¹Ÿæ˜¯ iOS7 ä¹‹åç³»ç»Ÿçš„é»˜è®¤è¡Œä¸ºï¼Œè®¾å¤‡é‡å¯åˆ°ç”¨æˆ·é¦–æ¬¡è§£é”çš„è¿™æ®µæ—¶é—´ï¼Œåå°ä»»åŠ¡ä¸ä¼šè¢«è§¦å‘ã€‚ æ”¯æŒåˆ†å±çš„åº”ç”¨éœ€è¦åœ¨åˆé€‚çš„æ—¶æœºè°ƒç”¨ UIApplication.requestSceneSessionRefresh(_:) æ¥å‘Šè¯‰ç³»ç»Ÿæ¥æ›´æ–°å¤šä»»åŠ¡çª—å£ä¸‹çš„åº”ç”¨æˆªå›¾ã€‚ ä¸è¦åœ¨ä¸»çº¿ç¨‹ä¸Šæäº¤ä»»åŠ¡è¯·æ±‚ï¼Œå°½é‡æ”¾åˆ°åå°çº¿ç¨‹ï¼Œé¿å…é˜»å¡ UI åˆ°æ­¤æ•´ä¸ªæ–°æ¡†æ¶ä»¥åŠä¸€äº›æœ€ä½³å®è·µéƒ½å·²ç»ä»‹ç»å®Œæ¯•ï¼Œå„ä½æ˜¯ä¸æ˜¯è¿«ä¸åŠå¾…æƒ³åŠ¨æ‰‹è¯•è¯•ï¼Ÿå¿ƒåŠ¨ä¸å¦‚è¡ŒåŠ¨ï¼Œèµ¶ç´§åŠ¨æ‰‹è¯•è¯•å§ã€‚Enjoy~ ä¸ªäººæƒ³åˆ°çš„ä¸€äº›æ–°æ¡†æ¶å¯èƒ½é€‚ç”¨çš„ç‚¹ï¼ˆKeynote ä¸Šæåˆ°çš„æœºå™¨å­¦ä¹ çš„æ¨¡å‹è®­ç»ƒä¹‹ç±»çš„å°±ä¸å†è¯´äº†ï¼‰ ä½¿ç”¨ BGAppRefreshTask æå‰æ‹‰å–åº”ç”¨é¦–å±éœ€è¦çš„å†…å®¹ï¼Œå‡å°‘ç”¨æˆ·å¯åŠ¨åçš„ç­‰å¾…æ—¶é—´ï¼ˆä¹‹å‰çš„ background fetch ä¹Ÿèƒ½å®ç°ï¼‰ æ•°æ®åŒæ­¥ï¼Œå°¤å…¶æ˜¯å¤§æ–‡ä»¶ï¼Œåƒè°·æ­Œç›¸å†Œã€å„ç§äº‘ç›˜ä¹‹ç±»çš„è½¯ä»¶ æ—¥å¿—ä¸ŠæŠ¥ï¼Œä¸€äº›ä¸éœ€è¦é‚£ä¹ˆå®æ—¶çš„æ—¥å¿—ï¼Œå¯ä»¥è€ƒè™‘æ”¾åˆ°åå°ä»»åŠ¡ PS: æœŸå¾…è°·æ­Œç›¸å†Œèƒ½é€‚é…ä¸€æ³¢ï¼Œé¿å…åŒæ­¥æ—¶ä¸€ç›´å¾—ä¿æŒåº”ç”¨åœ¨å‰å°ğŸ˜‚]]></content>
      <categories>
        <category>æ¡†æ¶å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>åŸåˆ›</tag>
        <tag>WWDC</tag>
        <tag>åå°ä»»åŠ¡</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[WWDC 2018ï¼šä½¿ç”¨æ—¥å¿—æ¡†æ¶æµ‹é‡æ€§èƒ½]]></title>
    <url>%2F2019%2F02%2F22%2FWWDC-2018-Signpost%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡æ˜¯ WWDC 2018 Session 405 çš„è§‚åæ„Ÿï¼ŒåŸè§†é¢‘å’Œ pdf å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°ã€‚é¦–å‘äºå°ä¸“æ ã€‚ ä¼—æ‰€å‘¨çŸ¥ï¼Œåº”ç”¨äº¤äº’çš„æµç•…åº¦å†³å®šäº†ç”¨æˆ·å¯¹è¿™æ¬¾ç”¨æˆ·çš„å–œçˆ±åº¦ï¼Œæ‰€ä»¥å¯¹äºæ¯ä¸ª iOS å·¥ç¨‹å¸ˆè€Œè¨€ï¼Œåº”ç”¨çš„æµç•…ç¨‹åº¦æ˜¯éå¸¸é‡è¦çš„ã€‚è€Œè¿™é‡Œæ‰€è¯´çš„æµç•…åº¦åœ¨å·¥ç¨‹å¸ˆå±‚é¢æ¥ç†è§£å°±æ˜¯åº”ç”¨çš„æ€§èƒ½æ˜¯å¦å¤„äºä¸€ä¸ªæ¯”è¾ƒä¼˜çš„çŠ¶æ€ã€‚é‚£æˆ‘ä»¬åœ¨å‘ç°é¡µé¢å¡é¡¿æ—¶ï¼Œå¦‚ä½•å»æ£€æµ‹å¡é¡¿æ˜¯å“ªä¸€æ®µä»£ç å¼•èµ·çš„å‘¢ï¼Ÿç›®å‰ä¸šç•Œçš„å¡é¡¿æ£€æµ‹å·²ç»éå¸¸å¤šäº†ï¼Œæ¯”å¦‚ Instrument çš„ Time Profileï¼Œå„ç§åŸºäº runloop çš„å¡é¡¿ç‡æ£€æµ‹å¼€æºåº“ã€‚ä½†æ˜¯ä»Šå¤©ä¸»è¦æ¥è¯´ä¸€è¯´ iOS12 è‹¹æœä¸ºæˆ‘ä»¬å¸¦æ¥çš„ä¸€ä¸ªæ–°çš„æ£€æµ‹æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯åŸºäº OSLog çš„ä¸€å¥—æ–° APIã€‚ å¥½äº†ï¼Œé¢˜å¤–è¯è®²å®Œï¼Œæˆ‘ä»¬æ­£å¼è¿›å…¥æ­£é¢˜ã€‚è¯¥ Seesion ä¸»è¦æœ‰ä¸‹é¢å‡ éƒ¨åˆ†ç»„æˆï¼š é›†æˆ signposts å¼‚æ­¥å¹¶è¡Œæ“ä½œ æ·»åŠ åŸæ•°æ® æ§åˆ¶ signposts çš„å¯ç”¨å’Œç¦ç”¨ ä½¿ç”¨ Instruments åˆ†æ é¦–å…ˆå…ˆç®€å•å›é¡¾ä¸€ä¸‹ OSLogï¼Œè‹¹æœåœ¨2016å¹´æ¨å‡ºè¿™ä¸ªç°ä»£åŒ–çš„æ—¥å¿—è®°å½•æ¡†æ¶ï¼Œç”¨æ¥è·å–ç³»ç»Ÿè°ƒè¯•ä¿¡æ¯ï¼Œè¿™ä¸ªæ¡†æ¶ä¸»è¦æ˜¯ä¸ºæ•ˆç‡è€Œç”Ÿã€‚å¯ä»¥çœ‹ä¸€ä¸ªç®€å•å®ä¾‹ 12let logHandle = OSLog(subsystem: "com.example.widget", category: "Setup")os_log(.info, log: logHandle, "Hello, %&#123;public&#125;s!", world) PS: æ›´å¤šå†…å®¹å¯ä»¥å‚çœ‹ WWDC 2016 Session 721 Unified Logging and Activity Tracing è¿™é‡Œè¦ä»‹ç»çš„ Signpost å¯¹ OSLog è¿›è¡Œäº†ä¸€äº›æ‰©å±•ï¼Œæ–°å¢äº†ä¸€äº›ç”¨äºè¡¡é‡æ€§èƒ½çš„ APIã€‚é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åœ¨ä»£ç ä¸­é›†æˆ Signpostã€‚ é›†æˆ Signpostä½¿ç”¨ signpost è®¡ç®—è€—æ—¶æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªåº”ç”¨ï¼ŒåŒ…å«äº†ä¸€ç»„å›¾ç‰‡çš„ feed æµï¼Œæ»‘åŠ¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šå»åŠ è½½ feed æµçš„å°é¢ï¼Œé¡µé¢å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æˆ‘ä»¬æƒ³è¦è·å–æ¯å¼ å°é¢çš„åŠ è½½è€—æ—¶ï¼Œå¦‚æœä½¿ç”¨ Signpost ç›¸å…³ API æˆ‘ä»¬éœ€è¦å¦‚ä½•åšå‘¢ï¼Ÿä½¿ç”¨ Signpost æˆ‘ä»¬å¯ä»¥æ ‡è®°æ¯ä¸ªä»»åŠ¡çš„å¼€å§‹å’Œç»“æŸï¼Œç„¶åå°†ä»–ä»¬å…³è”èµ·æ¥ï¼Œè°ƒç”¨çš„ç›¸å…³ API ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦åšä¸€ä¸ªç®€å•çš„æ‰“ç‚¹ï¼Œé€šè¿‡ä¸¤ä¸ªå…³è”çš„æ‰“ç‚¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®°å½•è¿™ä¸ªä»»åŠ¡çš„å…·ä½“è€—æ—¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ ä¼ªä»£ç å¦‚ä¸‹ 123456789101112// å¼•å…¥ os æ¡†æ¶import os.signpost// ä½¿ç”¨è‡ªå®šä¹‰æ ‡è¯†å’Œåˆ†ç±»åˆ›å»ºä¸€ä¸ª logï¼Œsubsystem å»ºè®®ä½¿ç”¨ bundle idï¼Œcategory ä¸»è¦ç”¨äºå¯¹ç›¸å…³è”çš„æ“ä½œè¿›è¡Œåˆ†ç±»let refreshLog = OSLog(subsystem: "com.example.your-app", category: "RefreshOperations")for element in panel.elements &#123; // ä»»åŠ¡å¼€å§‹å‰æ‰“ç‚¹ os_signpost(.begin, log: refreshLog, name: "Fetch Asset") fetchAsset(for: element) // ä»»åŠ¡ç»“æŸæ‰“ç‚¹ï¼Œæ³¨æ„ log å’Œ name è¦å’Œå¼€å§‹å‰çš„åŒ¹é…ï¼Œè¿™æ ·æ‰ä¼šè‡ªåŠ¨å…³è” os_signpost(.end, log: refreshLog, name: "Fetch Asset")&#125; å¦‚æœæƒ³è¦ç»Ÿè®¡æ‰€æœ‰ä»»åŠ¡çš„è€—æ—¶ï¼Œä¹Ÿéå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨ for å¾ªç¯å‰ååŸ‹ç‚¹å³å¯ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ name çš„å€¼ï¼Œå¦‚ä¸Šæ‰€è¿°å› ä¸ºæƒ³è¦è®¡ç®—çš„æ‰€æœ‰ä»»åŠ¡çš„è€—æ—¶ï¼Œæ‰€ä»¥æ–°èµ·äº†ä¸€ä¸ªå€¼ï¼Œæ¥è¿›è¡Œå…³è”ã€‚ä»£ç å¦‚ä¸‹ 12345678let refreshLog = OSLog(subsystem: "com.example.your-app", category: "RefreshOperations")os_signpost(.begin, log: refreshLog, name: "Refresh Panel")for element in panel.elements &#123; os_signpost(.begin, log: refreshLog, name: "Fetch Asset") fetchAsset(for: element) os_signpost(.end, log: refreshLog, name: "Fetch Asset")&#125;os_signpost(.end, log: refreshLog, name: "Refresh Panel") æ•´ä¸ªæ—¶é—´è½´çœ‹èµ·æ¥å¦‚ä¸‹å›¾æ‰€ç¤º å¼‚æ­¥ä»»åŠ¡è€—æ—¶çš„è®¡ç®—å¦‚æœæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯ä¸€æ­¥æ­¥å¾ªåºæ¸è¿›çš„ï¼Œä¸Šé¢çš„æ–¹å¼æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯å®é™…åº”ç”¨åœºæ™¯ä¸­ï¼Œå¤§éƒ¨åˆ†ä»»åŠ¡æ˜¯å¼‚æ­¥åŒæ—¶è¿›è¡Œçš„ã€‚å› æ­¤ä¸Šé¢çš„ name å”¯ä¸€æ ‡è¯†åœ¨å¼‚æ­¥å¹¶è¡Œçš„åœºæ™¯ä¸‹ï¼Œä¸å†èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œå› ä¸ºå„ä»»åŠ¡çš„èµ·å§‹æ—¶é—´æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ç»“æŸæ—¶é—´è‚¯å®šä¸ä¸€æ ·ï¼Œå¦‚æœéƒ½ç”¨ç›¸åŒçš„ name æ¥åšå”¯ä¸€æ ‡è¯†ï¼Œæ—¶é—´è½´è‚¯å®šä¼šå­˜åœ¨é‡å çš„æƒ…å†µï¼Œå› æ­¤æ— æ³•åŒºåˆ†å„ä¸ªä»»åŠ¡çš„è€—æ—¶æ—¶é—´ã€‚ å› æ­¤ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ª Signpost çš„ APIï¼Œå«åš signpost IDã€‚é€šè¿‡ signpost IDï¼Œå¯ä»¥åŒºåˆ†åŒç§ç±»å‹æ“ä½œä¸­çš„ä¸åŒä»»åŠ¡ã€‚æ‰€ä»¥å³ä½¿ä¸¤ä¸ªä»»åŠ¡æ—¶é—´è½´æœ‰é‡å ï¼Œä½†æ˜¯ç”±äº signpost ID çš„å­˜åœ¨ï¼Œç³»ç»Ÿå°±å¯ä»¥åŒºåˆ†å‡ºè¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„æ—¶é—´é—´éš”ï¼Œæ‰€ä»¥åªè¦ .begin å’Œ .end æ‰“ç‚¹æ—¶ä¼ å…¥çš„ ID ä¸€è‡´ï¼Œç³»ç»Ÿå°±ä¼šæŠŠäºŒè€…è‡ªåŠ¨å…³è”èµ·æ¥ï¼Œè®¡ç®—è€—æ—¶ã€‚ä»£ç å¦‚ä¸‹ï¼š 12345678910111213let refreshLog = OSLog(subsystem: "com.example.your-app", category: "RefreshOperations")let spidForRefresh = OSSignpostID(log: refreshLog)os_signpost(.begin, log: refreshLog, name: "Refresh Panel", signpostID: spidForRefresh)for element in panel.elements &#123; let spid = OSSignpostID(log: refreshLog, object: element) os_signpost(.begin, log: refreshLog, name: "Fetch Asset", signpostID: spid) fetchAssetAsync(for: element) &#123; os_signpost(.end, log: refreshLog, name: "Fetch Asset", signpostID: spid) &#125;&#125;notifyWhenDone &#123; os_signpost(.end, log: refreshLog, name: "Refresh Panel", signpostID: spidForRefresh)&#125; signpost ID å¯ä»¥é€šè¿‡ OSSignpostID æ„å»ºå‡½æ•°ä¼ å…¥ä¸€ä¸ª log handlerï¼Œä»¥åŠä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼ˆå¯é€‰ï¼‰ã€‚åé¢çš„ object å‚æ•°éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºåªè¦ä¼ å…¥çš„ object æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆç”Ÿæˆçš„ ID ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼ˆå½“ç„¶å‰ææ˜¯ log handler ä¹Ÿè¦ä¸€è‡´ï¼‰ã€‚ ä»ä¸Šé¢ç¤ºä¾‹æˆ‘ä»¬å¯ä»¥å¾—çŸ¥ï¼Œåªè¦ .begin å’Œ .end çš„å…¶å®ƒå‚æ•°æ˜¯ä¸€è‡´çš„ï¼Œç³»ç»Ÿå°±ä¼šè‡ªåŠ¨å°†å…¶åŒ¹é…ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹å»è¿›è¡Œâ€œæ‰“ç‚¹â€ã€‚ æ‰€ä»¥æ•´ä¸ª API æ€»ç»“ä¸€ä¸‹ï¼Œå¤§æ¦‚æ˜¯ä¸‹é¢è¿™æ ·ä¸€ä¸ªå±‚çº§ã€‚ å‚æ•° ç¤ºä¾‹ å«ä¹‰ Log category â€œRefreshOperationsâ€ ç›¸å…³æ“ä½œ Signpost name â€œFetch Assetâ€ æƒ³è¦è®¡ç®—çš„æŸç±»æ“ä½œ Signpost ID spid åŒä¸€ç±»æ“ä½œä¸‹çš„æŸä¸ªä»»åŠ¡ æ·»åŠ è‡ªå®šä¹‰ Metadataçœ‹å®Œä¸Šé¢éƒ¨åˆ†ï¼Œä½ å¯èƒ½ä¼šæœ‰ä¸ªç–‘é—®ï¼šæ˜¯å¦å¯ä»¥åœ¨ signpost ä¸­æºå¸¦ä¸€äº›é¢å¤–ä¿¡æ¯å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚os_signpost å‡½æ•°ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€äº›å¯é€‰å‚æ•°ï¼Œç”¨äºä¼ é€’ä¸Šä¸‹æ–‡ã€‚ä¼ å…¥çš„å‚æ•°å¾—æ˜¯ os_log æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä¼ å…¥ä¸åŒç±»å‹çš„å‚æ•°ä»¥åŠåŠ¨æ€å­—ç¬¦ä¸²ï¼Œæœ€ç»ˆè¿™äº›å­—ç¬¦ä¸²éƒ½ä¼šæ˜¾ç¤ºåœ¨ Instrument ä¸­ã€‚ æ·»åŠ ç‹¬ç«‹äº‹ä»¶é™¤äº†ä¸Šé¢æåˆ°çš„è‡ªå®šä¹‰å…ƒæ•°æ®ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜æƒ³åœ¨ .begin å’Œ .end ä¹‹é—´è®°å½•ä¸€äº›ç‰¹å®šçš„â€œç‚¹â€ï¼Œå› æ­¤è‹¹æœç»™äº†æˆ‘ä»¬ä¸€ç§æ–°çš„ç±»å‹ï¼ŒOSSignpostType.eventã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥è®°å½•ä¸€äº›è¿‡ç¨‹ä¸­çš„ç‰¹å®šç‚¹ï¼Œæ¯”å¦‚ä¸Šé¢æåˆ°çš„å›¾ç‰‡åŠ è½½çš„æŸä¸ªç‰¹å®šè¿›åº¦ï¼Œæˆ–è€…è®°å½•åŠ è½½è¿‡ç¨‹ä¸­çš„ç”¨æˆ·ç‚¹å‡»è¡Œä¸ºç­‰ç­‰ã€‚ 12os_signpost(.event, log: log, name: "Fetch Asset", "Fetched first chunk, size %u", size)os_signpost(.event, log: log, name: "Swipe", "For action 0x%x", actionCode) Signpost ç¦ç”¨åŠå¯ç”¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒSignpost æ˜¯å¯ç”¨çš„ï¼Œä½†æ˜¯æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³å¼€å¯å®ƒï¼Œæ¯”å¦‚ Release æ¨¡å¼ä¸‹åŒ…æˆ–è€…æäº¤åˆ° Appstore çš„åŒ…ã€‚è‹¹æœå·¥ç¨‹å¸ˆä¸€å†å¼ºè°ƒ Signpost æœ¬èº«éå¸¸è½»é‡ï¼ŒåŒæ—¶åœ¨å®ƒè¢«è§¦å‘çš„æ—¶å€™ä¹Ÿåšäº†å¾ˆå¤šä¼˜åŒ–ï¼ŒåŒæ—¶åœ¨ç¼–è¯‘å™¨å±‚é¢ä¹Ÿåšäº†ä¸€äº›ä¼˜åŒ–æ¥ç¡®ä¿å®ƒä½œç”¨äºè¿è¡Œæ—¶ä¹‹å‰ï¼ŒæŠŠå¾ˆå¤šå·¥ä½œæ¨è¿Ÿåˆ° Instrument çš„å¤„ç†æ—¶æœŸï¼Œæ‰€ä»¥å½“å®ƒè¢«è§¦å‘æ—¶å‡ ä¹ä¸ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºã€‚æ‰€ä»¥ä¸ºäº†å¯ä»¥æ ¹æ®æ¡ä»¶æ¥å¯/ç¦ç”¨ Signpostï¼Œç³»ç»Ÿæä¾›äº†ä¸€ä¸ªé»˜è®¤çš„ OSLog.disabled çš„ log handlerï¼Œä½¿ç”¨æ­¤ log handler åˆ›å»ºçš„ Signpostï¼Œéƒ½ä¼šè¢«ç¦ç”¨ï¼Œæ‰€ä»¥åªéœ€å‡ è¡Œä»£ç å°±å¯ä»¥æå®šæ˜¯å¦éœ€è¦å¼€å¯ Signpost çš„éœ€æ±‚ï¼Œäº¦å³åªéœ€è¦æ ¹æ®æ¡ä»¶ä¿®æ”¹ log handler åˆå§‹åŒ–æ–¹å¼å³å¯ã€‚ 123456let refreshLog: OSLogif ProcessInfo.processInfo.environment.keys.contains("SIGNPOSTS_FOR_REFRESH") &#123; refreshLog = OSLog(subsystem: "com.example.your-app", category: "RefreshOperations")&#125; else &#123; refreshLog = .disabled&#125; å½“ç„¶ï¼Œå¦‚æœæœ‰ä¸€äº› Signpost ä»£ç å¦‚æœæ¯”è¾ƒè€—æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡åˆ¤æ–­å½“å‰ log handler æ˜¯å¦è¢«ç¦ç”¨æ¥è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ 12345// å¦‚æœè·å– info æ¯”è¾ƒè€—æ—¶ï¼Œé‚£å¯ä»¥å…ˆè¿›è¡Œä¸€æ¬¡åˆ¤æ–­if refreshLog.signpostsEnabled &#123; let information = copyDescription() os_signpost(..., information)&#125; ä»¥ä¸Šç¤ºä¾‹ä»£ç éƒ½æ˜¯ç”¨çš„ Swiftï¼Œä½†æ˜¯åœ¨ C ä»£ç ä¸­ï¼Œå®ƒä»¬ä¹Ÿæ˜¯å¯ä»¥ç”¨çš„ã€‚å¯¹åº”å…³ç³»å¦‚ä¸‹å›¾ï¼Œå¦‚æœéœ€è¦äº†è§£æ›´å¤šï¼Œå¯ä»¥è¿›åˆ°å¯¹åº”çš„å¤´æ–‡ä»¶ï¼ŒæŸ¥çœ‹å…¶ä½¿ç”¨æ–¹å¼å’Œç›¸å…³è¯´æ˜ã€‚ ä¸ Instruments é…åˆä½¿ç”¨è¿™ä¸€ç« èŠ‚ï¼Œè‹¹æœå·¥ç¨‹å¸ˆä»¥ä¸€ä¸ªæœ¬åœ°å¾’æ­¥æ—…è¡Œçš„åº”ç”¨ï¼ˆå‚ç…§ä¸Šé¢æˆªå›¾ï¼‰ä½œä¸ºç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Signpost è¿›è¡ŒåŸ‹ç‚¹ï¼Œç„¶åé€šè¿‡ Instrument è·å–åŸ‹ç‚¹æ•°æ®ï¼Œè¿›è€Œæ¥è¿›è¡Œå¯¹åŸ‹ç‚¹çš„è€—æ—¶åˆ†æè®¡ç®—ã€‚ æŸ¥çœ‹ Signpost æ•°æ®æˆ‘ä»¬å¯ä»¥ Instruments(10) æ¥è®°å½•ã€æŸ¥çœ‹å’Œåˆ†ææˆ‘ä»¬åœ¨ä¸Šé¢è¯´çš„æ‰€æœ‰çš„åŸ‹ç‚¹ã€‚ä¸‹é¢æ˜¯ Demo çš„ä¸€äº›ç›¸å…³èƒŒæ™¯ï¼š é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸ºäº†æ€§èƒ½ä¼˜åŒ–ï¼Œä¼šæŠŠä¸€äº›è€—æ—¶ä»»åŠ¡æ”¾åˆ°å¼‚æ­¥çº¿ç¨‹ï¼Œç­‰ä»»åŠ¡å®Œæˆåå†å›åˆ°ä¸»çº¿ç¨‹ï¼Œè¿™æ ·å°±å¾ˆéš¾å¯¹å…¶è¿›è¡Œæ—¶é—´çš„æµ‹é‡åˆ†æã€‚å½“ç”¨æˆ·æ»‘åŠ¨çš„æ—¶å€™ï¼Œå°±ä¼šåŒæ—¶è§¦å‘å¤šä¸ªå›¾ç‰‡ä¸‹è½½ä»»åŠ¡ã€‚å¦‚æœç”¨æˆ·æ»‘åŠ¨éå¸¸è¿…é€Ÿï¼Œé‚£ä¹ˆå¾ˆå¤šå›¾ç‰‡åœ¨ cell è¢«é‡ç”¨æ—¶å¯èƒ½è¿˜æ²¡æœ‰ä¸‹è½½å®Œæˆï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦å–æ¶ˆè¿™äº›ä¸‹è½½ä»»åŠ¡ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰å–æ¶ˆçš„è¯ï¼Œå°±ä¼šå¹³ç™½å¤šå‡ºå‡ ä¸ªæˆ‘ä»¬å¹¶ä¸æƒ³è¦çš„ä¸‹è½½ä»»åŠ¡ã€‚ cell æœ‰ä¸€ä¸ª startImageDownload æ–¹æ³•ç”¨æ¥ä¸‹è½½å›¾ç‰‡ï¼Œä»£ç å¦‚ä¸‹æ¯ä¸ªä¸‹è½½ä»»åŠ¡å¼€å§‹æ—¶ï¼Œä¼šæ ¹æ®å›¾ç‰‡åç§°åˆ›å»º downloaderï¼Œç„¶åæ ¹æ® downloader åˆ›å»ºä¸€ä¸ª SignpostID ç”¨æ¥ä½œä¸ºè¿™ä¸ªä¸‹è½½ä»»åŠ¡çš„ Signpost æ•°æ®å”¯ä¸€æ ‡è¯†ï¼Œç„¶åé€šè¿‡å°†å›¾ç‰‡åç§°ä¼ å…¥åˆ°å…ƒæ•°æ®ä¸­ã€‚ ç„¶åå›¾ç‰‡ä¸‹è½½å®Œæˆçš„å›è°ƒå¦‚ä¸‹åŒæ ·ç›´æ¥é€šè¿‡ downloader åˆ›å»ºä¸€ä¸ª SignpostIDï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ .begin å’Œ .end èƒ½å¤ŸåŒ¹é…ã€‚æ³¨æ„åˆ°è¿™é‡Œä¼ å…¥çš„ metadata &quot;Finished with size %{xcode:size-in-bytes}llu&quot;ï¼Œè¿™é‡Œçš„ xcode:size-in-bytes å‘Šè¯‰ Xcode å’Œ Instrument è¿™ä¸ªå‚æ•°åœ¨åˆ†æå’Œå±•ç¤ºæ—¶è¦å½“åš bytes æ¥å¤„ç†ã€‚å®ƒä»¬è¢«ç§°ä¸ºå·¥ç¨‹ç±»å‹ï¼ˆengineering typesï¼‰ï¼Œå¯ä»¥åœ¨Instruments Developer HelpæŸ¥çœ‹æ›´å¤šç›¸å…³ä¿¡æ¯ã€‚ åœ¨ cell è¢«é‡ç”¨æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è®°å½•å›¾ç‰‡ä¸‹è½½çš„ cancel æ“ä½œï¼Œä»£ç å¦‚ä¸‹å¤„ç†ç±»ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚ é€šè¿‡ Xcode-&gt;Product-&gt;Profile(æˆ–è€…å¿«æ·é”® cmd+I) æ¥å¯åŠ¨ Instrumentã€‚ç„¶åé€‰å–ä¸€ä¸ªç©ºç™½ï¼ˆBlankï¼‰é…ç½®ï¼Œè¿›è¡Œä¸‹é¢æ“ä½œ å³ä¸Šè§’ + æŒ‰é’®ï¼Œç„¶åæœç´¢ os_signpostï¼Œç„¶åé€‰ä¸­å°†å…¶æ‹–å…¥åˆ°å·¦è¾¹æ ï¼Œç„¶åç‚¹å‡» Record å³å¯ã€‚ ä¸€é¡¿æ»‘åŠ¨ä¹‹åï¼Œåœæ­¢å½•åˆ¶ï¼ˆRecordï¼‰ï¼Œç„¶åæŸ¥çœ‹é¡¶éƒ¨é¢æ¿ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å„ä¸ªå›¾ç‰‡åŠ è½½çš„è€—æ—¶ï¼Œä»¥åŠæˆ‘ä»¬åœ¨åŸ‹ç‚¹æ—¶ä¼ å…¥çš„å…ƒæ•°æ®ã€‚åŒæ—¶åç»­æ—¶é—´çš„ä¸€äº› signpost æ•°æ®å¦‚ä¸‹ä»è¿™å¼ å›¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŒæ—¶ä¸‹è½½æ•°ä¸è¶…è¿‡5ä¸ªï¼Œè¿™æ ·è¯æ˜æˆ‘ä»¬çš„ cancel æ–¹æ³•ç”Ÿæ•ˆäº†ã€‚ä¸ºäº†è¯æ˜è¿™ä¸€ç‚¹ï¼Œæ”¾å¤§å¾—åˆ°ä¸‹å›¾å¯ä»¥çœ‹åˆ°æ»‘åŠ¨è¿‡ç¨‹ä¸­ç¡®å®äº§ç”Ÿäº†å¾ˆå¤š metadata æ˜¯ cancel çš„ signpost æ•°æ®ã€‚ å¦‚æœæˆ‘ä»¬æƒ³è¦çœ‹å›¾ç‰‡ä¸‹è½½è€—æ—¶ï¼Œæˆ‘ä»¬èƒ½å¯ä»¥çœ‹åº•éƒ¨æ•°æ®æ Instrument ä¼šæŒ‰ç…§ SignpostID è¿›è¡Œæ±‡æ€»ï¼Œç„¶åç»™å‡ºå„é¡¹æ•°æ®ï¼Œæ¯”å¦‚ä¸ªæ•°ã€æœ€å¤§å€¼ã€æœ€å°å€¼ã€æ ‡å‡†å·®ã€å¹³å‡å€¼ã€‚åŒä¸€ä¸ª SignpostID åˆåˆ†ä¸º Finished å’Œ Cancelã€‚è¿˜è®°å¾—ä¸Šé¢æåˆ° size-in-bytes ä¹ˆï¼Ÿè¿™é‡Œæ¯ä¸€ä¸ª Finished åé¢éƒ½è·Ÿäº†ä¸€ä¸ªè¿™å¼ å›¾ç‰‡çš„å­—èŠ‚æ•°ã€‚å¦‚æœæƒ³ç”¨ metadata æ•°æ®è¿›è¡Œåˆ†æï¼Œæˆ‘ä»¬å¯ä»¥åˆ‡åˆ°ä¸‹å›¾æ‰€ç¤ºçš„åˆ†ç±»ã€‚ Instrument æ ¹æ® log handler çš„ subsystemã€categoryã€format stringã€arguments å„ä¸ªå‚æ•°è¿›è¡Œäº†ä¸€ä¸ªåˆ†å±‚ã€‚å› ä¸ºæˆ‘ä»¬åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œæ‰€ä»¥è¿™é‡Œåªå±•ç¤ºäº† arg0ã€‚ç„¶åä¼šæ ¹æ® size-in-bytes ç±»å‹ï¼Œç®—å‡ºæ€»åŠ è½½å¤§å°ä»¥åŠæœ€å¤§å€¼ã€æœ€å°å€¼ã€æ ‡å‡†å·®ã€å¹³å‡å€¼ï¼Œæ‰€ä»¥é€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿåˆ†æä¸€äº›å…ƒæ•°æ®ä¼ å…¥çš„æ•°æ®ã€‚ å‰é¢æåˆ°ä¸ºäº†ä¿è¯ OSLog çš„è½»é‡æ€§ï¼Œå¤§éƒ¨åˆ†å·¥ä½œè¢«æ¨è¿Ÿåˆ° Instrument æ¥å¤„ç†ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬åœ¨å½•åˆ¶çš„æ—¶å€™é‡‡ç”¨å³æ—¶æ¨¡å¼(é»˜è®¤)ï¼Œæ•°æ®ç›´æ¥äº¤ç”± Instrument å¤„ç†ï¼Œå®ƒå°±ä¼šå®æ—¶å±•ç¤ºå’Œè®°å½•ç›¸å…³æ•°æ®ã€‚å½“æˆ‘ä»¬è§¦å‘çš„ signpost è¶³å¤Ÿå¤šæ—¶ï¼Œé‚£ä¹ˆæ•´ä¸ªæµç¨‹ä¼šå˜æ…¢ï¼Œç”šè‡³ä½ çš„ App å’Œç”µè„‘éƒ½å°†å˜å¾—å¡é¡¿ã€‚æ‰€ä»¥ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œåœ¨æ¯æ¬¡å½•åˆ¶å‰ï¼Œæœ€å¥½å…ˆæ›´æ”¹å®ƒçš„å½•åˆ¶æ¨¡å¼ã€‚æ“ä½œæ–¹å¼å°±æ˜¯é•¿æŒ‰å½•åˆ¶æŒ‰é’®ï¼Œç„¶åé€‰æ‹©å½•åˆ¶é€‰é¡¹ï¼ˆRecording Optionsï¼‰ï¼Œç„¶ååœ¨å¼¹å‡ºçš„é¢æ¿è¿›è¡Œç±»ä¼¼ä¸‹å›¾çš„æ“ä½œï¼Œå°†é»˜è®¤çš„å³ä½¿æ¨¡å¼ï¼ˆImmediate Modeï¼‰æ›´æ”¹ä¸ºä½ æƒ³è¦çš„æ¨¡å¼ï¼Œç¤ºä¾‹ä¸­é€‰çš„æ˜¯æœ€å5ç§’ã€‚ å…´è¶£ç‚¹å¦‚æœæˆ‘ä»¬åªæƒ³ç®€å•è®°å½•ä¸€äº›ç‚¹å‡»äº‹ä»¶ï¼Œä½†æ˜¯åˆä¸æƒ³è®©è¿™äº›ç‚¹å‡»äº‹ä»¶æ·¹æ²¡åœ¨ä¸Šé¢çš„å¤§é‡ signpost æ•°æ®ä¸­ï¼Œä¹Ÿä¸æƒ³æ¯æ¬¡éƒ½åˆ›å»ºç©ºç™½é…ç½®ï¼Œç„¶åè‡ªè¡Œæ·»åŠ  os_signpost é…ç½®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å…´è¶£ç‚¹(Points Of Interest)çš„æ–¹å¼ã€‚å…·ä½“å¦‚ä½•æ“ä½œçš„å‘¢ï¼Ÿå…¶å®å’Œå…¶å®ƒçš„ signpost ç±»ä¼¼ï¼Œä¸è¿‡åˆ›å»º log handler æ—¶ï¼Œcategory å‚æ•°è¦ä¼ å…¥ .pointsOfInterestï¼Œè¿™æ˜¯ä¸€ç§ä¼šè¢« Instrument è‡ªåŠ¨è¯†åˆ«çš„ç‰¹æ®Šåˆ†ç±»ã€‚åˆ›å»ºå’Œä½¿ç”¨ä»£ç ç¤ºä¾‹å¦‚ä¸‹å›¾ è¿è¡Œ Instrumentï¼Œç„¶åé€‰æ‹© Time Profile é…ç½®ï¼Œè¯¥é…ç½®ä¼šè‡ªå¸¦å…´è¶£ç‚¹ä¸€æ çš„æ•°æ®ã€‚ è‡ªå®šä¹‰ Instrumenté€šè¿‡ Demo æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è‡ªå®šä¹‰ Instrument æ¥å¿«é€Ÿç›´æ¥åœ°è¿›è¡Œè®°å½•å’Œåˆ†æï¼Œå±•ç¤ºé¢æ¿åŸºæœ¬ç±»ä¼¼ä¸Šé¢çš„æ•°æ®æŸ¥çœ‹ã€‚è‡³äºå¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰ Instrumentï¼Œå¯ä»¥æŸ¥çœ‹ Session 410 Creating Custom Instruments æ¥äº†è§£æ›´å¤šã€‚ æ€»ç»“é€šè¿‡ä½¿ç”¨ signpostï¼Œæˆ‘ä»¬å¯ä»¥è½»æ˜“åœ°è®°å½•æ—¶é—´æ®µï¼Œæ•è·æ„Ÿå…´è¶£çš„å…ƒæ•°æ®ï¼Œç„¶åé€šè¿‡ Instruments æ¥æŸ¥çœ‹å’Œåˆ†æ signpost æ•°æ®ï¼ŒæŸ¥çœ‹æ—¶é—´èŠ±åœ¨å“ªäº›åœ°æ–¹ï¼Œæ›´æ¸…æ¥šçš„äº†è§£åˆ°ç¨‹åºçš„è¡Œä¸ºã€‚]]></content>
      <categories>
        <category>åŸåˆ›</category>
      </categories>
      <tags>
        <tag>WWDC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[WWDC 2018ï¼šç†è§£å´©æºƒä»¥åŠå´©æºƒæ—¥å¿—]]></title>
    <url>%2F2019%2F02%2F22%2FUnderstanding-Crash%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡é¦–å‘äºæ˜é‡‘ã€‚ äººéåœ£è´¤ï¼Œå­°èƒ½æ— è¿‡ã€‚æ¯ä¸ªäººåœ¨å†™ä»£ç çš„æ—¶å€™ï¼Œæˆ–å¤šæˆ–å°‘éƒ½ä¼šçŠ¯é”™ï¼Œé‚£ä¹ˆå¦‚ä½•è°ƒè¯•ã€æ‰¾å‡ºé—®é¢˜æ‰€åœ¨å‘¢ï¼Ÿè®©æˆ‘ä»¬è·Ÿéšè‹¹æœå·¥ç¨‹å¸ˆä¸€èµ·äº†è§£ä¸€ä¸‹å´©æºƒæ˜¯å¦‚ä½•äº§ç”Ÿä»¥åŠå¦‚ä½•è§£å†³å®ƒä»¬çš„å§ã€‚ 1. åŸºç¡€çŸ¥è¯†å´©æºƒæ˜¯ä»€ä¹ˆï¼Ÿå´©æºƒæ˜¯å½“åº”ç”¨æƒ³è¦åšæŸä»¶äº‹çš„æ—¶å€™ï¼Œè¢«æ„å¤–ç»ˆæ­¢ã€‚ 1.1 å´©æºƒä¸ºä»€ä¹ˆä¼šå‘ç”Ÿä¸»è¦æ˜¯ä»¥ä¸‹å‡ æ–¹é¢åŸå›  CPU æ— æ³•æ‰§è¡Œçš„ä»£ç ã€‚ è¢«æ“ä½œç³»ç»Ÿâ€œå¼ºæ€â€ï¼Œç³»ç»Ÿä¸ºäº†ç”¨æˆ·ä½“éªŒï¼Œä¼šå¼ºåˆ¶ç»ˆæ­¢æ‰é‚£äº›å¡é¡¿æ—¶é—´è¿‡é•¿æˆ–è€…å†…å­˜æ¶ˆè€—è¿‡é«˜çš„åº”ç”¨ã€‚ ç¼–ç¨‹è¯­è¨€ä¸ºäº†é˜²æ­¢é”™è¯¯å‘ç”Ÿè€Œè§¦å‘çš„å´©æºƒï¼Œå¦‚ NSArray æˆ–è€… Swift.Array è¶Šç•Œ å¼€å‘è€…ä¸ºäº†é˜²æ­¢é”™è¯¯å‘ç”Ÿè€Œè§¦å‘çš„å´©æºƒï¼Œæ¯”å¦‚ä¸€äº›éç©ºåˆ¤æ–­çš„æ–­è¨€ 1.2 å´©æºƒé•¿ä»€ä¹ˆæ ·å­1.2.1 è°ƒè¯•å™¨é‡Œå½“æˆ‘ä»¬è¿æ¥ç€ Xcode è¿›è¡Œè°ƒè¯•çš„æ—¶å€™ï¼Œé‡åˆ°å´©æºƒï¼Œå¤§æ¦‚é•¿è¿™ä¸ªæ ·å­ã€‚ å½“è¿ç€è°ƒè¯•å™¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ‹¿åˆ°å´©æºƒç°åœºçš„ä¸€äº›è°ƒç”¨æ ˆä»¥åŠå¯¹åº”çš„æ–¹æ³•ï¼Œå½“æ²¡æœ‰è¿ç€è°ƒè¯•å™¨çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šå°†å´©æºƒæ—¥å¿—å­˜å‚¨åˆ°ç£ç›˜å½“ä¸­ã€‚ 1.2.2 å´©æºƒæ—¥å¿—é‡Œé€šå¸¸æƒ…å†µä¸‹ï¼Œrelease æ¨¡å¼çš„åº”ç”¨çš„å´©æºƒæ—¥å¿—æ˜¯æ²¡æœ‰ç¬¦å·åŒ–çš„ï¼Œæ—¥å¿—å†…è®°å½•çš„éƒ½æ˜¯åœ°å€ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ Xcode æ¥å°†å´©æºƒæ—¥å¿—è¿›è¡Œç¬¦å·åŒ–ï¼Œè§£æå‡ºå¯¹åº”æ–‡ä»¶åã€æ–¹æ³•åä»¥åŠå¯¹åº”å´©æºƒåœ¨ç¬¬å‡ è¡Œã€‚ 1.3 è·å–å´©æºƒæ—¥å¿—è·å–å´©æºƒæ—¥å¿—çš„æ–¹å¼å¾ˆå¤šï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹å¦‚ä½•é€šè¿‡ Xcode Organizer æ¥è·å–ä» TestFlight æˆ–App Store ä¸‹è½½çš„åº”ç”¨çš„å´©æºƒæ—¥å¿—ã€‚ 1.3.1 Organizer Windowå…ˆæ¥çœ‹ä¸€ä¸‹ä¸‹é¢è¿™å¼ å›¾ï¼š ä¸‹é¢æ•°å­— 1~6 åˆ†åˆ«ä»£è¡¨å›¾ä¸­æ ‡æ³¨çš„ 1~6 1.å¯ä»¥çœ‹åˆ°æ‰€æœ‰å¹³å°å‘å¸ƒåœ¨ App Store æˆ–è€… TestFlight ä¸Šçš„åº”ç”¨ã€‚ 2.å´©æºƒæ—¥å¿—åˆ—è¡¨ï¼Œå¯ä»¥çœ‹åˆ°å¯¹åº”å½±å“çš„è®¾å¤‡æ•°ä»¥åŠå¯¹åº”çš„å¹³å°ã€æ‰©å±•ï¼ˆextensionï¼‰ï¼Œå¦‚å›¾ä¸­è“è‰²æ¡†æ ‡æ³¨çš„ä½ç½®ã€‚ 3.å´©æºƒæ‰€åœ¨è°ƒç”¨æ ˆåŠå´©æºƒä½ç½®çš„é«˜äº®ã€‚ 4.åœ¨å¯¹åº”å·¥ç¨‹ä¸­æ‰“å¼€å´©æºƒæ‰€åœ¨çš„æ–‡ä»¶ï¼Œå¹¶è·³è½¬åˆ°æŒ‡å®šä½ç½®ï¼Œæ–¹ä¾¿è¿½è¸ªé—®é¢˜ã€‚ 5.æœ€è¿‘æ•°æ®åˆ†æï¼ŒåŒ…å«ç³»ç»Ÿå’Œæœºå‹ä¸¤ä¸ªç»´åº¦ã€‚ 6.åœ¨å´©æºƒæ•°è¾ƒå¤šæ—¶ï¼Œæ”¯æŒç¿»é¡µã€‚ PSï¼šä¸Šé¢6ä¸ªåªæ˜¯ç®€å•ä»‹ç»äº†ä¸€ä¸‹ä¸»é¢˜éƒ¨åˆ†ï¼Œå‰©ä½™çš„å¯ä»¥è‡ªè¡Œæ¢ç´¢ä½¿ç”¨ã€‚æ¯”å¦‚æœç´¢ã€å¯¹å•ä¸ªæ—¥å¿—åšä¸€äº›ç¬”è®°ã€ä»¥åŠå°†å·²ä¿®å¤çš„å´©æºƒæ ‡è®°ä¸ºå·²è§£å†³ç­‰ç­‰ã€‚ é‚£ä¹ˆå¦‚ä½•æ‰èƒ½åœ¨ Organizer ä¸­è·å–å¯¹åº”çš„å´©æºƒæ—¥å¿—å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦åšåˆ°ä¸‹é¢å‡ æ­¥ åœ¨ Xcode ä¸­ç™»å½•å·²ä»˜è´¹çš„å¼€å‘è€…å¸å·ã€‚ ä¸Šä¼ åº”ç”¨åˆ° App Store æˆ– TestFlight æ—¶ï¼Œä¸€å¹¶ä¸Šä¼ ç¬¦å·æ–‡ä»¶ã€‚ æ‰“å¼€ Xcode Organizer çª—å£ï¼Œé€‰ä¸­ Crashes tab(å¿«æ·é”®:Cmd+Shift+6)ã€‚ 1.3.2 Devices Window è¿æ¥ä¸Šè®¾å¤‡ï¼Œæ‰“å¼€ Xcodeï¼Œä½¿ç”¨å¿«æ·é”® Cmd+Shift+2 æ¥æ‰“å¼€ Devices Windowï¼Œé€‰ä¸­å¯¹åº”è®¾å¤‡ï¼Œç„¶åé€‰æ‹© View Device Logsï¼Œå³å¯æŸ¥çœ‹å½“å‰è®¾å¤‡ç£ç›˜ä¸Šçš„æ‰€æœ‰å´©æºƒæ–‡ä»¶ï¼Œæ‰¾åˆ°åº”ç”¨å¯¹åº”çš„æ—¥å¿—å³å¯å±•å¼€åˆ†æã€‚ æœ‰äº›æ—¶å€™ï¼Œè·å–åˆ°çš„å´©æºƒæ—¥å¿—å¹¶æ²¡æœ‰ç¬¦å·åŒ–ã€‚è¿™ä¸ªæ—¶å€™éœ€è¦è‡ªå·±åšä¸€äº›é¢å¤–æ“ä½œï¼Œè¿™é‡Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰åœ¨çŸ¥è¯†å°é›†åˆ†äº«è¿‡çš„ä¸€ä¸ªå° tipâ€”â€”iOSå¿«é€Ÿè§£æå´©æºƒæ—¥å¿—ã€‚ 1.3.3 å…¶å®ƒé€”å¾„ Xcode çš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆå¾—åˆ°çš„æ˜¯å·²ç¬¦å·åŒ–çš„æ—¥å¿—ï¼‰ Mac è‡ªå¸¦çš„ Console åº”ç”¨ï¼Œè·å– Mac æˆ–è€…æ¨¡æ‹Ÿå™¨çš„å´©æºƒæ—¥å¿— iOSè®¾å¤‡å¯é€šè¿‡è¿™ç§æ“ä½œè·å–ï¼Œæ‰“å¼€ã€è®¾ç½®ã€‘-&gt;ã€éšç§ã€‘-&gt;ã€åˆ†æã€‘-&gt;ã€åˆ†ææ•°æ®ã€‘æ‹¿åˆ°å¯¹åº”çš„æœªç¬¦å·åŒ–çš„å´©æºƒæ—¥å¿—ï¼Œç„¶åé€šè¿‡ç³»ç»Ÿè‡ªå¸¦çš„åˆ†äº«å³å¯ä¼ è¾“åˆ°å¯¹åº”çš„è®¾å¤‡ä¸Šè¿›è¡Œåˆ†æã€‚ 1.4 ç¬¦å·åŒ–æœ€ä½³å®è·µ ä¸Šä¼ åº”ç”¨çš„ç¬¦å·æ–‡ä»¶ï¼Œä»¥ä¾¿è‹¹æœåå°å¯ä»¥ç›´æ¥ç¬¦å·åŒ–å´©æºƒæ—¥å¿—ï¼Œæœ€ç»ˆå¾—ä»¥åœ¨ Xcode Organizer çš„ Crashestab ä¸­å‘ˆç°ã€‚ ä¿ç•™åº”ç”¨å½’æ¡£æ–‡ä»¶ï¼Œä»¥ä¾¿åšæœ¬åœ°ç¬¦å·åŒ–ï¼Œåªè¦æœ‰å½’æ¡£æ–‡ä»¶åœ¨ï¼ŒXcode ä¼šè‡ªåŠ¨è¿›è¡Œç¬¦å·åŒ–ã€‚ åœ¨ Xcode Organizer çš„ Archivetab ä¸ºå·²å¼€å¯ bitcode çš„åº”ç”¨ä¸‹è½½ dSYM æ–‡ä»¶ã€‚ 2. åˆ†æå¥”æºƒæ—¥å¿—2.1 å´©æºƒæ—¥å¿—çš„ç»„æˆ å´©æºƒæ‘˜è¦ï¼Œä¸»è¦è®°å½•ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œæ¯”å¦‚æœºå‹ã€ç³»ç»Ÿç‰ˆæœ¬ã€å´©æºƒæ—¶é—´ç­‰ å´©æºƒåŸå›  å´©æºƒä¿¡æ¯ï¼ˆè¿™ä¸€éƒ¨åˆ†åœ¨çœŸæœºä¸Šå¤„äºéšç§åŸå› ï¼Œä¸€èˆ¬éƒ½æ˜¯ä¸å¯è§çš„ï¼Œåœ¨æ¨¡æ‹Ÿå™¨å’Œ MacOS ä¸Šå¯è§ï¼‰ å´©æºƒçº¿ç¨‹çš„è°ƒç”¨æ ˆ å´©æºƒå‘ç”Ÿæ—¶ï¼Œå…¶å®ƒçº¿ç¨‹çš„è°ƒç”¨æ ˆ å¯„å­˜å™¨çŠ¶æ€ å·²åŠ è½½çš„å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ 2.2 å¦‚ä½•åˆ†æé¦–å…ˆä»å´©æºƒåŸå› ä¸­çš„å´©æºƒç±»å‹å¼€å§‹ å¦‚ä¸Šå›¾çš„å´©æºƒç±»å‹ä¸º EXC_BAD_INSTRUCTIONï¼Œå®ƒä»£è¡¨ CPU å°è¯•åœ¨æ‰§è¡Œä¸€æ®µä¸å­˜åœ¨æˆ–æ— æ•ˆçš„ä»£ç ï¼Œè€Œå¯¼è‡´è¿›è¡Œè¢«â€œæ€æ­»â€ã€‚ ç„¶åæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å´©æºƒçº¿ç¨‹çš„è°ƒç”¨æ ˆçš„å‰å‡ è¡Œï¼Œç»“åˆå´©æºƒä¿¡æ¯ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰è¿›ä¸€æ­¥åˆ†æã€‚æ‰¾åˆ°å´©æºƒæ ˆä¸­ç¬¬ä¸€å¤„äºŒè¿›åˆ¶åä¸ºåº”ç”¨åç§°æ‰€åœ¨é‚£ä¸€è¡Œï¼Œè¿›åˆ°å¯¹åº”æ–‡ä»¶å¯¹åº”çš„ä»£ç è¡Œæ•°è¿›è¡ŒæŸ¥çœ‹ï¼ˆå¦‚ä¸Šå›¾ä¸­æ ‡çº¢çš„é‚£ä¸€è¡Œï¼‰ï¼Œç„¶åè¿›ä¸€æ­¥åˆ†æã€‚ä¸Šå›¾ä¸­çš„å´©æºƒå¯ä»¥å¾ˆæ˜æ˜¾çœ‹å‡ºå…¶åŸå› æ˜¯å¯¹ nil è¿›è¡Œäº†å¼ºåˆ¶è§£åŒ…ã€‚ 2.3 æ–­è¨€å’Œå…ˆå†³æ¡ä»¶å¯¼è‡´çš„å´©æºƒæ–­è¨€å’Œå…ˆå†³æ¡ä»¶çš„æ„ä¹‰åœ¨äºå½“é”™è¯¯å‘ç”Ÿæ—¶ï¼Œå¼ºåˆ¶ç»ˆæ­¢å½“å‰è¿›ç¨‹ã€‚ ä¸Šè¿°æåˆ°çš„å¯¹ nil å¼ºåˆ¶è§£åŒ…å¯¼è‡´çš„å´©æºƒæ˜¯æ–­è¨€å’Œå…ˆå†³æ¡ä»¶ä¸­çš„ä¸€ç§ã€‚è€Œå®ƒä»¬è¿˜åŒ…å«ä¸‹é¢å‡ ç§æƒ…å†µï¼š æ•°æ®è¶Šç•Œè®¿é—® ç®—æœ¯æº¢å‡º æœªæ•è·çš„å¼‚å¸¸ ä»£ç ä¸­çš„è‡ªå®šä¹‰æ–­è¨€ 2.4 æ“ä½œç³»ç»Ÿâ€œæ€æ­»â€åº”ç”¨å¯¼è‡´çš„å´©æºƒæŸäº›æƒ…å†µä¸‹ï¼Œç³»ç»Ÿå¤„äºä¿æŠ¤ç›®çš„ï¼Œä¼šå°†ä¸€äº›å¼‚å¸¸çš„åº”ç”¨â€œæ€æ­»â€ã€‚ä»¥ä¸‹å‡ ç§åœºæ™¯å¯èƒ½è§¦å‘ç³»ç»Ÿå°†åº”ç”¨â€œæ€æ­»â€ï¼š çœ‹é—¨ç‹—äº‹ä»¶ï¼Œä¸»çº¿ç¨‹é•¿æ—¶é—´æ— å“åº” è®¾å¤‡è¿‡åº¦å‘çƒ« å†…å­˜æ¶ˆè€—æ®†å°½ éæ³•çš„åº”ç”¨ç­¾å ä»¥ä¸Šå‡ ç§åœºæ™¯å¯¼è‡´çš„å´©æºƒï¼Œå…¶å´©æºƒæ—¥å¿—å¯ä»¥åœ¨ä¸Šé¢æåˆ°çš„ Device Window ä¸­æŸ¥çœ‹ï¼ŒOrganizer Window å¹¶ä¸ä¸€å®šèƒ½å¤Ÿæ”¶é›†åˆ°è¿™äº›æ—¥å¿—ã€‚æ›´å¤šç»†èŠ‚å¯ä»¥å‚è€ƒè‹¹æœçš„è¿™ä¸ªæŠ€æœ¯è®²åº§ Understanding and Analyzing Application Crash Reportsã€‚ å…ˆæ¥çœ‹ä¸€ä¸ªå…³äºçœ‹é—¨ç‹—çš„ä¾‹å­ã€‚ ä¸Šé¢çš„å´©æºƒç±»å‹ä¸º EXC_CRASH (SIGKILL)ï¼ŒSIGKILL ä¸€èˆ¬ä»£è¡¨çš„æ˜¯ç³»ç»Ÿç»ˆæ­¢äº†è¿›ç¨‹çš„è¿è¡Œï¼Œè¿™ç§ä¿¡å·æ— æ³•è¢«åº”ç”¨æ•è·ï¼Œè¿›è€Œä¹Ÿå°±æ— æ³•å¤„ç†ã€‚ç»ˆæ­¢åŸå› ä¸º Namespace SPRINGBOARD, Code 0x8badf00dï¼Œå¦‚æœä½ æœ‰æŸ¥çœ‹ä¸Šé¢æåˆ°çš„å…³äºå´©æºƒæ—¥å¿—çš„è®²åº§ï¼Œä½ åº”è¯¥ä¼šçŸ¥é“ Code 0x8badf00d ä»£è¡¨ä»€ä¹ˆã€‚ä»ç»ˆæ­¢æè¿°ä¸­æ¥çœ‹ï¼Œæ˜¯ç”±äºå¯åŠ¨æ—¶é•¿è¶…è¿‡äº† 19.97 ç§’ã€‚ è¿™æ¬¡æ€»ç®—çŸ¥é“ä¸ºä»€ä¹ˆçœ‹é—¨ç‹—å¯¹åº”çš„ code æ˜¯ 0x8badf00d äº†ï¼Œä»è¿™æ¬¡è‹¹æœå·¥ç¨‹å¸ˆçš„å‘éŸ³ä¸Šæ¥çœ‹ï¼Œè¿™ä¸ª code çš„å‘éŸ³åŒ ate bad foodã€‚ 2.4.1 å¦‚ä½•é¿å…å¯åŠ¨è¶…æ—¶åº”ç”¨å®¡æ ¸è¢«æ‹’çš„æ¯”è¾ƒå¸¸è§çš„åŸå› å°±åŒ…å«å¯åŠ¨è¶…æ—¶è¿™ä¸€é¡¹ã€‚é‚£ä¹ˆå¦‚ä½•æ¥é¿å…è¿™ç§æƒ…å†µå‘ç”Ÿå‘¢ï¼Ÿè‹¹æœå·¥ç¨‹å¸ˆç»™äº†æˆ‘ä»¬è¿™äº›å»ºè®®ï¼š åœ¨çœŸæœºä¸Šæµ‹è¯•ï¼Œå› ä¸ºçœ‹é—¨ç‹—åœ¨æ¨¡æ‹Ÿå™¨ä»¥åŠè°ƒè¯•é˜¶æ®µæ˜¯è¢«ç¦ç”¨çš„ åœ¨ä½æ€§èƒ½è®¾å¤‡ä¸Šæµ‹è¯•ï¼Œé«˜æ€§èƒ½è®¾å¤‡å“åº”è‚¯å®šä¼šå¿«ï¼Œæ— æ³•ä½“ç°å‡ºçœŸå®æ•ˆæœ 2.4.2 å¦‚ä½•é¿å…å†…å­˜é—®é¢˜å¸¸è§çš„å†…å­˜é”™è¯¯åŒ…å«ï¼šè¿‡åº¦é‡Šæ”¾ã€é‡æŒ‡é’ˆï¼ˆè®¿é—®å·²é‡Šæ”¾å¯¹è±¡ï¼‰ã€å†…å­˜è®¿é—®è¶Šç•Œï¼ˆæ¯”å¦‚ C æ•°ç»„ï¼‰ã€‚æˆ‘ä»¬è¿˜æ˜¯é€šè¿‡ä¸€ä¸ªæ—¥å¿—æ¥åˆ†æä¸€ä¸‹å…·ä½“é—®é¢˜ã€‚ ç”±ä¸Šå›¾ä¸­æ ‡æ³¨çš„1ï¼Œæˆ‘ä»¬çŸ¥é“å´©æºƒç±»å‹ä¸º EXC_BAD_ACCESS(SIGSEGV)ï¼Œè¿™ç§ç±»å‹å´©æºƒä¸»è¦æ˜¯æœ‰ä¸¤ç§æƒ…å†µå¯¼è‡´ï¼š å¯¹åªè¯»çš„å†…å­˜åœ°å€è¿›è¡Œå†™æ“ä½œ è®¿é—®ä¸å­˜åœ¨çš„å†…å­˜åœ°å€ é€šè¿‡å´©æºƒæ ˆä¸­çš„objc_releaseã€object_dispose ç­‰ï¼Œæˆ‘ä»¬æ›´åŠ ç¡®å®šè¿™æ˜¯ç”±äºå†…å­˜é—®é¢˜å¯¼è‡´çš„å´©æºƒã€‚æˆ‘ä»¬é€šè¿‡è¿™å‡ ä¸ªçº¿ç´¢å¯ä»¥çŸ¥é“ï¼ŒLoginViewController å®ä¾‹åœ¨è°ƒç”¨ deinit æ–¹æ³•é”€æ¯ç›¸å…³å±æ€§çš„æ—¶å€™ï¼Œå‘ç”Ÿäº†å†…å­˜é—®é¢˜ï¼Œè¿›è€Œå¯¼è‡´å´©æºƒçš„äº§ç”Ÿã€‚ æˆ‘ä»¬å›åˆ°æ—¥å¿—çš„ç¬¬ä¸€éƒ¨åˆ†ä¸­çš„Exception Codesï¼Œè‹¹æœçš„å·¥ç¨‹å¸ˆè¯´å¯ä»¥æ ¹æ®ç»éªŒä»¥åŠæ—¥å¿—ä¸­çš„ç›¸å…³ä¿¡æ¯å¾—å‡ºç»“è®ºï¼Œå¯¹åº”çš„ BAD_ADDRESS ä¸º 0x7fdd5e70700ã€‚åŸå› æ˜¯ 0x7fdd5e70700 åˆšå¥½åœ¨æ—¥å¿—ä¸­çš„è¿™ä¸€æ®µ MALLOC_TINY 00007fdd5e400000-00007fdd5e800000 åœ°å€èŒƒå›´å†…ã€‚ ä¸€äº›å…³äºå†…å­˜åŠé‡Šæ”¾çš„åŸºç¡€ Objective-C å¯¹è±¡ä»¥åŠä¸€äº› Swift å¯¹è±¡çš„å†…å­˜å¸ƒå±€å¦‚å›¾ï¼Œå½“ä¸€ä¸ªå¯¹è±¡æœ‰æ•ˆï¼ˆæœªé‡Šæ”¾ï¼‰æ—¶ä»¥ isa å¼€å§‹ï¼Œisa æŒ‡å‘å®ƒæ‰€å±çš„ç±»ã€‚objc_release ä¸»è¦æ˜¯è¯»å–å¯¹è±¡çš„ isa æŒ‡é’ˆï¼Œç„¶åå°† isa æŒ‡é’ˆè§£é™¤å¯¹ Class çš„å¼•ç”¨ã€‚ æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸€åˆ‡éƒ½èƒ½ç…§å¸¸å·¥ä½œã€‚å¦‚æœå¯¹è±¡å·²ç»è¢«é‡Šæ”¾ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿfree å‡½æ•°è°ƒç”¨åï¼Œä¼šå°†å¯¹è±¡åˆ é™¤ï¼Œå¹¶ä¸”å°†å…¶æ’å…¥åˆ°åŒ…å«äº†å…¶å®ƒå·²é‡Šæ”¾å¯¹è±¡ç»„æˆçš„é“¾è¡¨ä¸­ï¼ŒåŒæ—¶å°†ä¹‹å‰ isa åŒºåŸŸæŒ‡å‘é“¾è¡¨ä¸­ä¸‹ä¸€ä¸ªå·²é‡Šæ”¾å¯¹è±¡ã€‚ å½“ä¹‹å‰çš„ isa å†…å­˜åŒºåŸŸè¢«å†™å…¥æˆ rotated free list æŒ‡é’ˆæ—¶ï¼Œæ„å‘³ç€è®¿é—®è¿™ä¸ªåœ°å€è¿”å›çš„å°†æ˜¯ä¸€ä¸ªæ— æ•ˆçš„å†…å­˜åœ°å€ï¼Œè¿›è€Œå¯¼è‡´å´©æºƒã€‚æ‰€ä»¥å½“ objc_release å»è§£é™¤ isa å¼•ç”¨æ—¶ï¼Œè®¿é—®åˆ°çš„æ˜¯ rotated free listï¼Œæ‰€ä»¥å´©æºƒå°±å‘ç”Ÿäº†ã€‚ æ‰€ä»¥å¯ä»¥åˆ†æå‡ºï¼Œè‚¯å®šæ˜¯åœ¨é‡Šæ”¾æŸä¸ªå±æ€§æ—¶ï¼Œè¯¥å±æ€§å·²ç»è¢«é‡Šæ”¾ã€‚æˆ‘ä»¬èƒ½çŸ¥é“å…·ä½“æ˜¯å“ªä¸ªå±æ€§å¯¼è‡´çš„ä¹ˆï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚ ç›®å‰ä»å´©æºƒçš„é‚£ä¸€è¡Œæ¥çœ‹ï¼Œ__ivar_destroyer æ˜¯ç¼–è¯‘å™¨å¸®æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆçš„å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— ä»çŸ¥æ™“å…·ä½“æ˜¯å“ªä¸€è¡Œå¯¼è‡´çš„é—®é¢˜ã€‚æˆ‘ä»¬åªçŸ¥é“è¿™ä¸ªç±»æœ‰å¦‚å›¾ä¸‰ä¸ªå±æ€§ï¼š ä½†æ˜¯ä» @objc LoginViewController.__ivar_destroyer + 42 å¯ä»¥è·å–åˆ°ä¸€äº›ä¿¡æ¯ï¼Œ+42 ä»£è¡¨ç€æ±‡ç¼–é‡Œé¢çš„è¯¥å‡½æ•°çš„åç§»é‡ã€‚æˆ‘ä»¬å¯ä»¥å¯¹ __ivar_destroyer å‡½æ•°è¿›è¡Œåæ±‡ç¼–ï¼Œç„¶åçœ‹åç§»é‡ä¸º42å¯¹åº”è·å–çš„æ˜¯å“ªä¸ªå±æ€§ï¼Œåœ¨ Xcode ä¸­å¯ä»¥ä½¿ç”¨ lldb è°ƒè¯•ã€‚ æ–­ç‚¹ååˆ†åˆ«è¾“å…¥ä¸Šå›¾ä¸­é»„è‰²å­—çš„å‘½ä»¤ï¼Œåˆ†åˆ«ä¸º command script import lldb.macosx.crashlogï¼Œcrashlog /Users/.../RideSharingApp-2018-05-24-1.crashï¼Œåé¢çš„è·¯å¾„éœ€è¦æ›¿æ¢æˆä½ çš„å´©æºƒæ—¥å¿—è·¯å¾„ã€‚Xcode ä¼šè‡ªåŠ¨æ£€ç´¢äºŒè¿›åˆ¶æ–‡ä»¶ä»¥åŠå¯¹åº”çš„ dSYM æ–‡ä»¶ï¼Œç„¶åç¬¦å·åŒ–æ˜¾ç¤ºåœ¨ lldb æ§åˆ¶å°ä¸­ã€‚ç„¶åæˆ‘ä»¬æ‰¾åˆ°å´©æºƒå¤„çš„åœ°å€ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå³å¯å¾—åˆ°å¯¹åº”çš„åæ±‡ç¼–ä»£ç ï¼š æˆ‘ä»¬ä¸éœ€è¦ç†è§£æ¯ä¸€è¡Œæ±‡ç¼–çš„æ„æ€ï¼Œæ¯è¡Œåé¢çš„æ³¨é‡Šå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç†è§£ï¼Œæ ¹æ®æ³¨é‡Šå¯ä»¥çŸ¥é“ 1ã€2ã€3 å¤„ä»£ç åˆ†åˆ«ä»£è¡¨ç€ userNameã€databaseã€views çš„é‡Šæ”¾ã€‚å›åˆ°ä¸Šé¢æåˆ°çš„ +42ï¼Œæˆ‘ä»¬æ‰¾åˆ°ç¬¬3å¤„çš„ç¬¬ä¸€è¡Œï¼Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ±‡ç¼–çš„åç§»åœ°å€æ˜¯è¿”å›åœ°å€ï¼Œæ‰€ä»¥è°ƒç”¨ objc_release æ˜¯åœ¨ä¸Šä¸€è¡Œã€‚æ‰€ä»¥å¯ä»¥åˆ¤æ–­å‡ºæ˜¯åœ¨é‡Šæ”¾ database æ—¶å‡ºç°äº†é—®é¢˜ã€‚è™½ç„¶æˆ‘ä»¬ç›®å‰è¿˜ä¸çŸ¥é“å…·ä½“é—®é¢˜æ‰€åœ¨ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡è¿™äº›ä¿¡æ¯ç¼©å°æŸ¥æ‰¾é—®é¢˜çš„èŒƒå›´ï¼Œå¯ä»¥æŸ¥æ‰¾ä½¿ç”¨åˆ° database çš„åœ°æ–¹ï¼Œæ¥æ‰¾åˆ°çœŸæ­£çš„é—®é¢˜æ‰€åœ¨ã€‚ 2.4.2 æ—¥å¿—åˆ†ææ€»ç»“ ç†è§£å´©æºƒæ—¥å¿—äº§ç”Ÿçš„åŸå›  æ£€æŸ¥å´©æºƒæ ˆä¿¡æ¯ ä½¿ç”¨åæ±‡ç¼–å¸®æˆ‘ä»¬æ‰¾åˆ°æ›´å¤šçº¿ç´¢æ¥åˆ†æ bad address é—®é¢˜ 2.4.3 å¸¸è§å†…å­˜é”™è¯¯ objc_msgSend æˆ–è€… retain/release å´©æºƒ æ— æ³•è¯†åˆ«çš„æ–¹æ³•å¼‚å¸¸ abort() inside malloc/free 2.5 æ—¥å¿—åˆ†æå»ºè®® ä¸è¦åªå…³æ³¨å´©æºƒå‘ç”Ÿçš„é‚£ä¸€è¡Œä»£ç ï¼Œå¤šæŸ¥çœ‹ä¸€ä¸‹å’Œå´©æºƒç›¸å…³çš„ä»£ç ï¼Œæ¯”å¦‚ä¸Šé¢é‚£ä¸ªå´©æºƒä»£ç å¹¶ä¸æ˜¯çœŸæ­£å¯¼è‡´ bug å‡ºç°çš„åŸå›  æŸ¥çœ‹æ‰€æœ‰è°ƒç”¨æ ˆï¼Œä¸è¦åªå…³æ³¨å´©æºƒæ‰€åœ¨çº¿ç¨‹çš„è°ƒç”¨æ ˆï¼Œéå´©æºƒçº¿ç¨‹è°ƒç”¨æ ˆå¯ä»¥å¸®åŠ©æˆ‘ä»¬æŸ¥çœ‹å´©æºƒæ—¶åº”ç”¨æ‰€å¤„çŠ¶æ€ å¤šæŸ¥çœ‹ä¸€äº›å´©æºƒæ—¥å¿—ï¼Œæœ‰äº›æ—¶å€™å¾ˆå¤šå´©æºƒæ—¥å¿—éƒ½æ˜¯å´©æºƒåœ¨åŒä¸€ä¸ªåœ°æ–¹ï¼Œä½†æ˜¯æŸäº›å´©æºƒæ—¥å¿—ä¼šåŒ…å«æ›´å¤šçš„ä¿¡æ¯ ä½¿ç”¨ Xcode æä¾›çš„å·¥å…·æ¥å¤ç°å†…å­˜é—®é¢˜ï¼Œæ¯”å¦‚ Address Sanitizer æˆ–è€… Zombies 3. å¤šçº¿ç¨‹é—®é¢˜3.1 å´©æºƒæ—¥å¿—ä¸­å¤šçº¿ç¨‹é—®é¢˜çš„ä¸€äº›â€œç—‡çŠ¶â€ æœ€éš¾å¤ç°å’Œè¯Šæ–­çš„ä¸€ç±» bug å¤šçº¿ç¨‹é—®é¢˜é€šå¸¸ä¼šå¼•èµ·å†…å­˜ç«äº‰ å¤šä¸ªçº¿ç¨‹æ‰§è¡Œç€ç›¸ä¼¼ä»£ç  åŒä¸€ä¸ª bug å¯èƒ½ä¼šæœ‰ä¸åŒçš„å´©æºƒæ—¥å¿— 3.2 ä½¿ç”¨ Thread Sanitizer æ£€æµ‹å¤šçº¿ç¨‹é—®é¢˜å¤šçº¿ç¨‹é—®é¢˜å³ä½¿æˆ‘ä»¬æ‹¿åˆ°æ—¥å¿—å¤§æ¦‚ç‡æƒ…å†µä¸‹ä¹Ÿæ— æ³•åˆ†æé—®é¢˜æ‰€åœ¨ï¼Œå³ä½¿è¿ç€ Xcode è°ƒè¯•ä¹Ÿä¸ä¸€å®šèƒ½å¤Ÿç¨³å®šå¤ç°ï¼Œå³ä½¿è¿æ°”å¥½èƒ½å¤ç°ä¹Ÿå¯èƒ½åˆ†æä¸å‡ºå…·ä½“é—®é¢˜ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å€ŸåŠ© Xcode æä¾›çš„å·¥å…·æ¥å¸®æˆ‘ä»¬åˆ†æï¼Œè¿™ä¸ªå·¥å…·å°±æ˜¯ Thread Sanitizerã€‚é€šè¿‡å¿«æ·é”® Cmd+shift+,ï¼Œç„¶åé€‰åˆ™ Diagnostics tabï¼Œå‹¾é€‰ Thread Sanitizer å³å¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º å¯ç¨³å®šå¤ç°å¤šçº¿ç¨‹ bug åœ¨æ¨¡æ‹Ÿå™¨ä¸‹ä¹Ÿå¯è¿›è¡Œ åªæŸ¥æ‰¾å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»£ç çš„é—®é¢˜ 3.3 å®ç”¨å»ºè®®åœ¨åˆ›å»º GCD Queueã€(NS)OperationQueueã€(NS)Thread æ—¶ï¼Œä½¿ç”¨è‡ªå®šä¹‰åç§°ï¼Œæ–¹ä¾¿åç»­è°ƒè¯•ä»¥åŠå´©æºƒæ—¥å¿—å†…æŸ¥çœ‹ã€‚ let queue = DispatchQueue(label: "com.example.myapp.networking") let operationQueue = OperationQueue() operationQueue.name = "Networking OperationQueue" let thread = Thread(...) thread.name = "Networking Thread" 3.4 é¢å¤–å»ºè®® ä½¿ç”¨çœŸæœºæµ‹è¯• å°è¯•å¤ç°ï¼Œä»ç”¨æˆ·å¤„æ‹¿åˆ°å´©æºƒæ—¥å¿—åæ ¹æ®è°ƒç”¨æ ˆå°è¯•å»å¤ç°é—®é¢˜ ä½¿ç”¨å·¥å…·æ¥æŸ¥æ‰¾éš¾ä»¥å¤ç°çš„ bugï¼Œä¸‹é¢ä¸¤ä¸ªå·¥å…·çš„æ›´å¤šä½¿ç”¨æ–¹å¼å¯ä»¥å‚è€ƒ WWDC 2016 Session 412 Thread Sanitizer and Static Analysis ä½¿ç”¨ Address Sanitizer æ¥æŸ¥çœ‹å†…å­˜é—®é¢˜ ä½¿ç”¨ Thread Sanitizer æ¥æŸ¥çœ‹å¤šçº¿ç¨‹é—®é¢˜]]></content>
      <categories>
        <category>åŸåˆ›</category>
      </categories>
      <tags>
        <tag>WWDC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ—¶å…‰çš„æ²³å¦‚æµ·æµ]]></title>
    <url>%2F2019%2F02%2F03%2F2018-Summary%2F</url>
    <content type="text"><![CDATA[è€è§„çŸ©ï¼Œè¿™æ¬¡åˆæ˜¯2018å¹´çš„æœ€åä¸€å¤©ï¼Œæ˜¯æ—¶å€™æ›´æ–°ä¸€ä¸‹å¹´ç»ˆæ€»ç»“äº†ï¼Œæ°´ä¸€ä¸‹ï¼Œçº¯å½“ä¸€ä¸ªè®°å½•~ å·¥ä½œä»Šå¹´å·¥ä½œä¸Šçš„å˜åŠ¨è¿˜æ˜¯è›®å¤§çš„ï¼Œä»å¹´åˆçš„ç›´æ’­ SDK æ‹†åˆ†å®Œæˆä¹‹åçš„äº¤ä»˜ï¼Œåˆ°4æœˆä»½çš„æ—¶å€™å»åˆ°ç¾æ‹åŒ—äº¬åˆ†éƒ¨ï¼Œå†åˆ°12æœˆåº•çš„ç¦»èŒï¼Œç»“æŸäº†åœ¨ç¾å›¾å°†è¿‘5å¹´çš„æ—¶å…‰ï¼Œæ„Ÿè°¢åœ¨ç¾å›¾å¾…çš„è¿™å‡ å¹´ï¼Œè‡ªå·±ä»ä¸€ä¸ªæ— ä»ä¸‹æ‰‹çš„èœé¸Ÿæ…¢æ…¢å˜æˆä¸€ä¸ªå¾—å¿ƒåº”æ‰‹çš„è€èœé¸Ÿã€‚ç”±äºè‡ªèº«åŸå› ï¼ˆè€å©†åœ¨å¹¿å·ï¼Œåé¢ç”Ÿæ´»éƒ¨åˆ†ä¹Ÿæœ‰æåˆ°ï¼‰ï¼Œåœ¨å¹´åº•çš„æ—¶å€™è£¸è¾ï¼Œç„¶åå»åˆ°å¹¿å·ï¼Œå¼€å¯ä¸€æ®µæ‰¾å·¥ä½œä¹‹æ—…ï¼Œå¸Œæœ›å¹´åæœ‰å¥½æ¶ˆæ¯ğŸ˜ƒã€‚ è¿™ä¸€å¹´æ¥ä¸»è¦æ˜¯åœ¨åŒ—äº¬ï¼Œè‡ªå·±çš„è§’è‰²ä¹Ÿå‘ç”Ÿäº†ä¸€äº›å˜åŒ–ï¼Œç¨å¾®äº†è§£äº†ä¸€ç‚¹ç‚¹çš„â€œç®¡ç†â€çš„çš®æ¯›ï¼Œä¹Ÿæ„Ÿè°¢è¿™ä¸ªæœºä¼šï¼Œè®©è‡ªå·±åœ¨éæŠ€æœ¯å±‚é¢ä¸Šä¹Ÿæœ‰ä¸€å®šçš„æ”¶è·ã€‚åˆ°åŒ—äº¬åä¸»è¦æ˜¯è´Ÿè´£ç¾æ‹ iOS ç¤¾åŒºçš„ç›¸å…³å¼€å‘ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯æ—¥å¸¸è¿­ä»£ï¼Œä¹å–„å¯é™ˆã€‚æ¯”è¾ƒæœ‰æˆå°±æ„Ÿçš„ä¸¤ä»¶äº‹ï¼š æ€»ç®—å®ç°äº†ä¸€å¥—åŸºäº YYModel å’Œ IGListKit çš„æ–¹æ¡ˆæ¥æ›¿ä»£ç°æœ‰ç¾æ‹åŸºäº ResetKit(CoreData) çš„æ–¹æ¡ˆï¼Œæœ€ç»ˆåœ¨æ–° App (VCUS)ä¸­å®è·µä¸Šçº¿ï¼Œä¸çŸ¥é“æœ€ç»ˆä¼šä¸ä¼šåœ¨ç¾æ‹ä¸­ä¸Šçº¿ã€‚åé¢ä¹Ÿä¼šæ›´æ–°ä¸€ä¸ªç³»åˆ—ï¼Œåå­—å¤§æ¦‚å«åšã€ŠCoreData ä»å…¥é—¨åˆ°æ”¾å¼ƒã€‹ï¼Œåº”è¯¥ä¸ä¼šæ–­æ›´ï¼Œå¯ä»¥æœŸå¾…ä¸€ä¸‹~ ä¼˜åŒ– Feed æ»šåŠ¨ï¼Œæ»šåŠ¨è¿‡ç¨‹ä¸­åªåŠ è½½æœ€ç»ˆåœä¸‹çš„åŒºåŸŸçš„ cellï¼Œå¹¶ä¸”å°†å…¶è§£è€¦æˆé€šç”¨é€»è¾‘ï¼Œæ— æ˜æ˜¾ä¾µå…¥ã€‚ ç”Ÿæ´» ç”Ÿæ´»åº”è¯¥ä»å¾®ä¿¡çš„å…â€œå•â€æƒŠå–œå¼€å§‹ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯é¢„å…†ï¼Œå»å¹´å¹´åº•çš„æ—¶å€™å¾®ä¿¡æ”¯ä»˜åœ¨æƒ…äººèŠ‚é‚£å¤©ï¼Œè¢«å…å•äº†ã€‚ç„¶ååœ¨è¿™ä¸€å¹´ï¼Œè‡ªå·±çœŸçš„è„±å•äº†ï¼Œé¡ºä¾¿è¿˜ç»“äº†å©šï¼Œæ„Ÿæ©ã€‚ 4æœˆä»½çš„æ—¶å€™ç¡®å®šäº†è¦å»åŒ—äº¬ï¼Œç¢°å·§å¤§å­¦å¥½å“¥ä»¬ç ”ç©¶ç”Ÿæ¯•ä¸šè¦å»åŒ—äº¬çˆ±å¥‡è‰ºï¼Œæ‰€ä»¥ä¸€èµ·å’Œä»–çš„ä¸¤ä¸ªç ”ç©¶ç”ŸåŒå­¦åˆç§Ÿäº†ï¼Œä½åœ¨åŒ—äº”ç¯ä¸Šï¼Œ4ä¸ªäººå¤§æ¦‚æ¯ä¸ªæœˆ1.2wçš„æˆ¿ç§Ÿï¼ˆå¯æ€•ğŸ˜‚ï¼‰ã€‚å¾—äºå¤§å­¦è€å“¥çš„ä¸€é¦–å¥½å¨è‰ºï¼Œå‡ ä¹æ¯ä¸ªå‘¨æœ«éƒ½ä¼šå¼€è¤ï¼Œè‡ªå·±ä¸‹å¨ï¼Œä¹Ÿå¶å°”å‘¨æœ«ä¸€èµ·å‡ºå»å¥èº«ï¼Œæ‰“çƒã€‚ ä¸­é—´æ¸…æ˜æ”¾å‡å›äº†ä¸€è¶Ÿå®¶ï¼Œç„¶ååœ¨è€å®¶è´·æ¬¾ä¹°äº†ä¸€å¥—æˆ¿ï¼Œä¹Ÿè·»èº«æ³±æ³±æˆ¿å¥´å¤§å†›ã€‚ã€‚ã€‚ 12æœˆåº•ç¦»èŒæ¥åˆ°è€å©†åœ¨çš„åŸå¸‚â€“å¹¿å·ï¼Œç›´æ¥ä»å†¬å¤©è¿›å…¥å¤å¤©ï¼Œèˆ’æœã€‚ç”±äºè£¸è¾ï¼Œæ²¡æœ‰å·¥ä½œï¼Œæ‰€ä»¥æ¯å¤©é™¤äº†æ¥è€å©†ä¸Šä¸‹ç­ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯æå‡å¨è‰ºå’Œå‡†å¤‡é¢è¯•ï¼Œä»¥åŠä¸Šé¢æåˆ°çš„é‚£ä¸ªç³»åˆ—åšå®¢çš„æ’°å†™ã€‚ æ—…æ¸¸åœ¨åŒ—äº¬å…¶å®æ¯”è¾ƒå°‘å‡ºå»ï¼Œä¹Ÿå°±åˆšæ¥çš„æ—¶å€™å»äº†ä¸€ä¸‹å—é”£é¼“å··ä»¥åŠåæµ·é…’å§ä¸€æ¡è¡—ï¼Œå–äº†æ¯é…’æ„Ÿå—äº†ä¸€ä¸‹ã€‚å†å°±æ˜¯å›¢å»ºä¸€èµ·è‡ªé©¾å»äº†å†…è’™å¤ä¹Œå…°å¸ƒç»Ÿå¤§è‰åŸï¼ŒæŒºç¾çš„ï¼Œå°¤å…¶æ˜¯æ—¥è½æ—¶å€™åœ¨ä¸€æœ›æ— é™…çš„è‰åŸé©¬è·¯ä¸Šå¼€è½¦ï¼ŒçœŸçš„å¤ªæ£’äº†ã€‚ 8æœˆä»½çš„æ—¶å€™å’Œè€å©†å»äº†é•¿åŸã€å¤©å®‰é—¨ã€åœ†æ˜å›­ï¼Œæœ¬æ‰“ç®—å»æ•…å®«ï¼Œåªå¯æƒœæ—¶é—´å¤ªèµ¶ï¼Œè¿‡å»çš„æ—¶å€™å·²ç»å…³é—¨äº†ï¼Œåé¢è‡ªå·±å’ŒåŒäº‹å»äº†ä¸€æ¬¡ğŸ˜‚ã€‚å›½åº†å’Œä¸­ç§‹é‚£æ®µæ—¶é—´ï¼Œä¼‘äº†ä¸€æ³¢å©šå‡ï¼ˆç®—ä¸Šä¸­ç§‹å›½åº†ï¼Œ22å¤©é•¿å‡ï¼‰ï¼Œå¸¦è€å©†å’Œå®¶äººä¸€èµ·è‡ªé©¾å»äº†æ¡‚æ—ï¼Œåªå¾…äº†ä¸¤å¤©ï¼Œåç»­æœ‰æœºä¼šå†å»ã€‚11æœˆåº•çš„æ—¶å€™å’Œè€å©†å»äº†ä¸€è¶Ÿæˆéƒ½å’Œé‡åº†ï¼Œæˆéƒ½ä¸»è¦æ˜¯æ˜¥ç†™è·¯å’Œå®½çª„å··å­é‚£è¾¹æ‰“å¡ï¼Œç„¶ååƒäº†ä¸€äº›å·å¤§ç¥æ¨èçš„æˆéƒ½åå°åƒã€‚æ™šä¸Šåƒèœ€å¤§ä¾ ç«é”…ï¼Œæ’é˜Ÿæ’äº†3ä¸ªå¤šå°æ—¶ï¼ˆå°´å°¬ï¼‰ï¼Œè¾›è‹¦å·å¤§ç¥ä¸‹ç­è·‘è¿™ä¹ˆè¿œæ¥è¯·æˆ‘åƒç«é”…ã€‚æœ¬æ¥æƒ³æŒ‰å·å¤§ç¥çš„å»ºè®®è‡ªé©¾å»å››å§‘å¨˜å±±ï¼Œä½†æ˜¯ç”±äºè‡ªå·±è‡ªé©¾ç»éªŒå°‘ï¼Œè€Œä¸”å·è¥¿è·¯çº¿éƒ½éå¸¸é™©ï¼Œè€Œä¸”å¯èƒ½ä¼´éšé«˜åŸååº”ï¼Œæ‰€ä»¥é€€è€Œæ±‚å…¶æ¬¡ï¼Œå»äº†æ¯•æ£šæ²Ÿï¼Œäº‹åä¹Ÿè¯æ˜ç¡®å®æœ‰é«˜åï¼Œå¹¸å¥½æ²¡è‡ªé©¾ã€‚æ¯•æ£šæ²Ÿï¼Œ5æ˜Ÿæ¨èï¼Œä¸€â€œå›¾â€ä»¥è”½ä¹‹ã€‚ ç„¶åç”±äºè£¸è¾ï¼Œè‡ªå·±ä¹‹å‰æ²¡ä¹°ç”µè„‘ï¼Œæ‰€ä»¥éœ€è¦ä¹°ä¸€å° MBPï¼Œåˆšå¥½å°æ½˜è¯´ä»–çš„å·¥ç‰Œä¹° MBP å¯ä»¥9.4æŠ˜ï¼Œæ‰€ä»¥å…ƒæ—¦åå»äº†ä¸€è¶Ÿé¦™æ¸¯ï¼Œä¹°äº†å° MBPã€‚ è¿™é‡Œéœ€è¦åæ§½ä¸€ä¸‹ï¼Œç”±äºTimeMachine æ¢å¤ä¸€ç›´å¤±è´¥ï¼Œç„¶åæˆ‘å°±æ ¼ç›˜é‡è£…ï¼Œç»“æœå› ä¸ºå®¶é‡Œç½‘ç»œé—®é¢˜ï¼Œä¸€ç›´è¿æ¥ä¸ä¸Šè‹¹æœçš„æœåŠ¡å™¨ï¼Œæ‰€ä»¥ç³»ç»Ÿå®‰è£…æ–‡ä»¶ä¸€ç›´æ— æ³•ä¸‹è½½ï¼Œç„¶åé¢„çº¦å¤©æ‰å§ï¼Œå®¢æœè¯´å¸®æˆ‘é¢„çº¦äº†å½“å¤©æ™šä¸Š7.30çš„ï¼Œç„¶åè¿˜è¯´å¦‚æœä½ æå‰å»çš„è¯å¯ä»¥å…ˆå»å‘¨å›´çš„æˆæƒåº—è®©ä»–ä»¬å¸®å¿™å®‰è£…æ–°ç³»ç»Ÿã€‚ç»“æœå¤§è€è¿œè·‘åˆ°å¤©æ²³åŒºï¼ŒçœŸæ˜¯è¢«æ°”æ­»ï¼Œè·‘åˆ°å…¶ä¸­ä¸€å®¶å®¢æœæ¨èçš„æˆæƒåº—ï¼Œæˆ‘è¿˜æ²¡è¯´å®Œæƒ…å†µï¼Œé‚£ä½åº—å‘˜å°±è¯´è£…ç³»ç»Ÿè¦æ”¶è´¹300ï¼ˆï¼Ÿï¼Ÿï¼Ÿï¼‰ï¼Œç„¶åå°±æƒ³ç€åœ¨å‘¨è¾¹åƒä¸ªé¥­ï¼Œç„¶åç­‰åˆ°7.30å†å»è®©å¤©æ‰è£…ï¼Œç»“æœå»äº†ä¹‹åï¼Œå¤©æ‰è¯´æˆ‘æ²¡æœ‰é¢„çº¦ã€‚å‘µå‘µï¼Œæˆ‘å»å¹´ä¹°äº†ä¸ªç™»å±±åŒ…ï¼Œè¶…è€ç£¨ã€‚ç¬¬ä¸€æ¬¡é¢„çº¦å¤©æ‰å§ï¼Œå°±é‡åˆ°è¿™ç§å®¢æœï¼Ÿï¼Ÿï¼Ÿåé¢è‡ªå·±å›å»å€’è…¾åŠå¤©ï¼Œæœ€åç”¨æ‰‹æœºçƒ­ç‚¹æ€»ç®—ä¸‹è½½å¥½äº†å®‰è£…é•œåƒï¼ŒğŸŒ¶ğŸ”ğŸğŸ’Š æ¸¸æˆè¿™ä¸€å¹´ï¼Œæ‰‹æ¸¸å æ¯”90%ï¼ŒåŸºæœ¬ä¸Šé›†ä¸­åœ¨åƒé¸¡å’Œå†œè¯ã€‚åˆšåˆ°åŒ—äº¬çš„æ—¶å€™ï¼Œä¸»è¦æ˜¯å’ŒåŒå­¦æ‰“ç‹è€…ï¼Œä»–æ˜¯ç‹è€…æ®µä½ï¼Œç„¶åç»å¸¸ç”¨å°å·å¸¦æˆ‘ï¼Œåæ­£æˆ‘è´Ÿè´£å‘å°±å®Œäº‹äº†ã€‚ç”±äºå½“æ—¶å’Œè€å©†å¼‚åœ°ï¼Œæ¯å¤©éƒ½ä¼šè§†é¢‘ï¼Œæ‰€ä»¥å½“æ—¶ä¸ºäº†é¿å…æ— èŠï¼Œå°±æŠŠå¥¹ä¹Ÿæ‹‰å…¥å‘ï¼Œå’Œæˆ‘ä¸€èµ·ç©åƒé¸¡ã€‚è‹±é›„è”ç›Ÿç©çš„æ¬¡æ•°å±ˆæŒ‡å¯æ•°ï¼Œä¸»è¦æ˜¯ä¸æƒ³å»ç½‘å§ï¼Œè‡ªå·±ç”±äºæ¢ç”µè„‘ï¼Œæ²¡æœ‰è£…åŒç³»ç»Ÿï¼ŒIG å¤ºå† ååŒå­¦ä¸€ç›´çº¦ï¼Œæ‰€ä»¥å°±è£…äº†åŒç³»ç»Ÿï¼Œå¶å°”å‘¨æœ«ç©ä¸€ä¸‹åˆï¼Œåæ­£æˆ‘ä¹Ÿæ˜¯è´Ÿè´£å‘ï¼Œæœ‰äºº carry å°±è¡Œã€‚ å±•æœ›è¿™ä¸€å¹´ä¸ç®¡æ˜¯ç”Ÿæ´»è¿˜æ˜¯å·¥ä½œï¼Œéƒ½å˜åŒ–è›®å¤§çš„ã€‚ä»å•èº«å˜æˆä¸¤ä¸ªäººä¸€èµ·ç”Ÿæ´»ï¼Œä»æœåæ™šä¸ƒå˜æˆå¤±ä¸šåœ¨å®¶åšâ€œå®¶åº­ç…®å¤«â€ï¼Œç”¨æµ©æ–‡å’Œå°æ½˜çš„è¯æ¥è¯´å°±æ˜¯â€œè½¯é¥­ç¡¬åƒâ€ã€‚æ€»å¾—æ¥è¯´2018ç®—æ˜¯æ¯”è¾ƒæƒŠå–œçš„ä¸€å¹´ï¼Œæ„Ÿæ©~ 2019å¹´ï¼ˆå†œå†ï¼Œå˜¿å˜¿ï¼‰ä¹Ÿå³å°†æ¥ä¸´ï¼Œå¸Œæœ›è‡ªå·±åœ¨å·¥ä½œå’Œç”Ÿæ´»ä¸­éƒ½èƒ½ç¨³æ­¥å‰è¿›ï¼Œè®¢å‡ ä¸ªå°ç›®æ ‡ï¼š å¤šä¸€äº›äº§å‡ºï¼ˆå¼€æºé¡¹ç›®å’Œåšå®¢ï¼‰ å­¦ä¼š JS ä»¥åŠ Pythonï¼Œæœ€å¥½èƒ½ç”¨åœ¨å®é™…åº”ç”¨ä¸­ åˆ· leetcodeï¼Œé‡æ–°å­¦ä¸€ä¸‹æ•°æ®ç»“æ„ä¸ªç®—æ³• æŠŠä¹‹å‰ä¹°çš„çº¸è´¨ä¹¦å’Œç”µå­ä¹¦çœ‹å®Œ ä¹°è½¦ å¸¦è€å©†åƒéå¹¿å·çš„ç±³å…¶æ—åº—]]></content>
      <categories>
        <category>æ‰¯æ·¡é›†</category>
      </categories>
      <tags>
        <tag>æ‚è°ˆ</tag>
        <tag>åŸåˆ›</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ Travis CI å®ç° Hexo åšå®¢è‡ªåŠ¨éƒ¨ç½²]]></title>
    <url>%2F2018%2F10%2F28%2FBlog-Automation%2F</url>
    <content type="text"><![CDATA[ç°åœ¨ä½¿ç”¨çš„åšå®¢ç³»ç»Ÿæ˜¯ Hexo+GitHub Pagesï¼Œæ¯æ¬¡å‘å¸ƒæ–°çš„æ–‡ç« æ—¶æµç¨‹ç”šæ˜¯ç¹çï¼Œæ˜¯å¦æœ‰å¥½çš„æ–¹å¼æ¥æé«˜æ•ˆç‡ï¼Œä¸“æ³¨äºã€å†™ã€‘è¿™ä»¶äº‹ä¸Šå‘¢ï¼Ÿ ä¹‹å‰ä» Jeklly è½¬åˆ° Hexoï¼Œå‘ç° Hexo æ¯”è¾ƒç¬¦åˆæˆ‘çš„ä¹ æƒ¯ï¼Œä½†æ˜¯æ¯æ¬¡å†™ä¸€ç¯‡æ–°æ–‡ç« è¦å‘å¸ƒï¼Œæµç¨‹æœ‰ç‚¹éº»çƒ¦ï¼Œå…·ä½“æˆ‘ä»¬å¯ä»¥æ¥çœ‹çœ‹ã€‚åœ¨æµç¨‹ä»‹ç»å‰ï¼Œå…ˆè¯´ä¸€ä¸‹æˆ‘çš„å†™ä½œç¯å¢ƒã€‚ Markdown ç¼–è¾‘å™¨ï¼šMWebåšå®¢ç³»ç»Ÿï¼šHexo è‡³äºå¦‚ä½•æ­å»ºåŸºäº Hexo + GitHub Pagesï¼Œè¿™é‡Œå°±ä¸è¯´äº†ï¼Œç½‘ä¸Šæ•™ç¨‹ä¸€å¤§å †ï¼Œè€Œ MWeb çš„ä¸€äº›åŸºæœ¬ä½¿ç”¨ä»¥åŠè¿›é˜¶ä½¿ç”¨ï¼Œåœ¨å…¶å®˜ç½‘ä¸Šä½œè€…å·²ç»ç»™äº†å……åˆ†çš„ä»‹ç»ï¼Œè¿™é‡Œä¹Ÿä¸å†èµ˜è¿°ï¼Œåœ¨æˆ‘ä»¬åªå…³å¿ƒå¦‚ä½•ä¼˜åŒ–ç°æœ‰æµç¨‹ã€‚å¥½äº†ï¼ŒåºŸè¯è¯´å®Œæˆ‘ä»¬çœ‹ä¸‹ç°æœ‰æµç¨‹ï¼Œä»¥åŠæˆ‘ä»¬æœŸæœ›çš„æµç¨‹ã€‚ ç°æœ‰æµç¨‹ ç”¨ hexo n &quot;some title&quot; ç”Ÿæˆä¸€ä¸ª markdown æ–‡ä»¶ MWeb å†™æ–‡ç« ï¼Œå¯èƒ½è¿˜è¦æ’å…¥å›¾ç‰‡ ä¸Šä¼ å›¾ç‰‡åˆ°å›¾åºŠï¼Œæ›¿æ¢ markdown ä¸­çš„æœ¬åœ°å›¾ç‰‡è·¯å¾„ä¸ºå›¾åºŠé“¾æ¥ hexo gã€hexo s ç¡®è®¤æ— è¯¯åï¼Œhexo d è¿™é‡Œè¦æ¨èä¸€æ³¢ MWebï¼Œä»–å¯ä»¥çœŸæ­£è®©ä½ ä¸“æ³¨äºå†™ä½œï¼Œå¦‚æœéœ€è¦æ’å…¥å›¾ç‰‡ï¼Œåªéœ€è¦æˆªå›¾åç²˜è´´ï¼Œæˆ–å¤åˆ¶åç²˜è´´ï¼Œæˆ–ç›´æ¥æŠŠå›¾ç‰‡æ‹–åˆ°ç¼–è¾‘çª—å£ä¸­å³å¯ã€‚å¾—ç›Šäº MWeb å¤–éƒ¨æ–‡æ¡£çš„æ¦‚å¿µï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠ Hexo çš„ source æ–‡ä»¶åŠ æ·»åŠ åˆ° MWeb å½“ä¸­ï¼Œç„¶åè¿›è¡Œç®€å•çš„é…ç½®å³å¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º ç°æœ‰æµç¨‹æœ‰å“ªäº›éº»çƒ¦çš„åœ°æ–¹å‘¢ï¼Ÿéœ€è¦æœ¬åœ°å®‰è£… Hexoï¼Œæ¯æ¬¡æ¢ç”µè„‘éƒ½è¦é‡æ–°å®‰è£…ï¼Œæœ‰æ—¶å€™å› ä¸ºå›½å†…è¿™å°¿æ€§ï¼ŒHexo æ ¹æœ¬å°±å®‰è£…ä¸ä¸‹æ¥ï¼Œä¹Ÿæ˜¯å¾ˆæ— å¥ˆã€‚ç„¶åæ¯æ¬¡è¿˜å¾— hexo g/s/dï¼Œè®©å†™ä½œæ¬²å¤§å¤§é™ä½ã€‚ æœŸæœ›çš„æµç¨‹ ç›´æ¥ä½¿ç”¨ MWeb ç”Ÿæˆ md æ–‡ä»¶ å›¾ç‰‡åŠ æ°´å° å†™å®Œä¹‹åï¼Œæ¨é€åˆ° GitHubï¼Œè‡ªåŠ¨ç”Ÿæˆåšå®¢ åŠ¨æ‰‹å®ç°ç¬¬ä¸€ä¸ªå°±ä¸å¤šè¯´äº†ï¼Œç›´æ¥è¯´ä¸‹å›¾ç‰‡åŠ æ°´å°ã€‚ å›¾ç‰‡åŠ æ°´å°ä¸Šé¢è¯´åˆ° MWeb ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨ä¸Šä¼ æ–‡ç« å¼•ç”¨çš„å›¾ç‰‡åˆ°å›¾åºŠï¼Œå‰ææ˜¯æˆ‘ä»¬é…ç½®äº†å›¾åºŠã€‚æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ä¸ƒç‰›ä½œä¸ºå›¾åºŠã€‚å…ˆæ¥çœ‹ä¸‹æˆ‘çš„ä¸ƒç‰›ç›¸å…³é…ç½®ä»¥åŠ MWeb ä¸­å…³äºä¸ƒç‰›çš„é…ç½®ã€‚ ç”±äºä¸ƒç‰›æµ‹è¯•åŸŸåå·²ç»æ— æ³•å†ä½¿ç”¨ï¼Œæ‰€ä»¥å¿…é¡»è¦ç»‘å®šä¸€ä¸ªåŸŸåï¼Œè€Œä¸”è¯¥åŸŸåéœ€è¦å¤‡æ¡ˆè¿‡ã€‚ å…³äºä¸Šé¢çš„ç¬¬äº”ç‚¹ï¼Œå›¾ç‰‡å¤„ç†æ ·å¼çš„åˆ«åï¼Œä¸ƒç‰›ä¸Šæˆ‘é…ç½®çš„æ˜¯ wmï¼Œæ ·å¼åˆ†å‰²çº¿æˆ‘è®¾ç½®çš„æ˜¯ !ï¼Œæ‰€ä»¥ MWeb é‡Œé¢æˆ‘å¡«çš„æ˜¯ !wmï¼Œä½ åªéœ€è¦æŒ‰ç…§ä½ è‡ªå·±çš„æ ·å¼å»å¼„å³å¯ã€‚æœ€å MWeb ç»™çš„é“¾æ¥ç±»ä¼¼ http://sub.your.domain/xxxx.jpg!wm è¿™æ ·çš„ã€‚ å…¶ä¸­å¦‚ä½•ç»‘å®šåŸŸåï¼Œä¸ƒç‰›ä¸Šéƒ½æœ‰å¯¹åº”çš„å¼€å‘æ–‡æ¡£ï¼Œå¯¹ç€å¼„å°±è¡Œã€‚ åˆ°è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å®ç°äº†å›¾ç‰‡åŠ æ°´å°ï¼Œå½“ç„¶è¿™æ˜¯ä¸ƒç‰›æä¾›çš„åœ¨çº¿æœåŠ¡ã€‚è¿™é‡Œå…³é”®ç‚¹æ˜¯ï¼Œä½ éœ€è¦ä¸€ä¸ªå¤‡æ¡ˆè¿‡çš„åŸŸåã€‚ è‡ªåŠ¨ç”Ÿæˆåšå®¢ä¸€ç¯‡æ–‡ç« å†™å®Œåæˆ‘ä»¬å°±éœ€è¦æŠŠå®ƒå‘å¸ƒåˆ°åšå®¢ä¸Šï¼Œè¿™é‡Œä¸å†é‡‡å– hexo g/s/d çš„æ–¹å¼ï¼Œè€Œæ˜¯ä½¿ç”¨ Travis CI æ¥å¸®æˆ‘ä»¬åšè‡ªåŠ¨éƒ¨ç½²ï¼Œæˆ‘ä»¬åªéœ€è¦å…³å¿ƒæ–‡ç« çš„æ¨é€ï¼Œè€Œä¸å…³å¿ƒåšå®¢çš„ç”Ÿæˆï¼Œç”Ÿæˆç›´æ¥äº¤ç»™ Travis CIã€‚ ç›¸ä¿¡ä½ å·²ç»æœ‰äº†åä¸º xxx.github.io çš„ repoï¼Œç„¶ååšå®¢åº”è¯¥æ˜¯æ”¾åœ¨ master åˆ†æ”¯ä¸Šçš„ã€‚æŠŠè¿œç«¯ repo æ‹‰åˆ°æœ¬åœ°ï¼Œç„¶åæ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œåˆ†æ”¯åéšæ„ï¼Œå‡è®¾ä¸º hexoï¼Œåˆ é™¤æ‰€æœ‰å†…å®¹ï¼Œç„¶åæŠŠ Hexo ç”Ÿæˆçš„æ•´ä¸ªæ–‡ä»¶å¤¹å†…å®¹ç§»åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼ŒåŒ…æ‹¬ theme æ–‡ä»¶å¤¹ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœå­æ–‡ä»¶å¤¹ä¸­åŒ…å« .git æ–‡ä»¶ï¼Œä½ éœ€è¦åˆ é™¤ï¼Œæˆ–è€…ä½¿ç”¨ submodule çš„å½¢å¼ï¼Œæˆ‘è¿™é‡Œé‡‡ç”¨çš„æ˜¯åˆ é™¤çš„æ–¹å¼ã€‚ ç”Ÿæˆ Personal access tokens æŒ‰ç…§å›¾ä¸­æ­¥éª¤ç”Ÿæˆ Tokenï¼Œè¿™ä¸€æ­¥åœ¨åé¢è¦ç”¨åˆ°ï¼Œç”Ÿæˆä¹‹åæœ€å¥½å¤åˆ¶ä¸€ä¸‹ï¼Œä»¥å…å…³æ‰é¡µé¢åï¼Œå°±çœ‹ä¸åˆ°åªèƒ½é‡æ–°ç”Ÿæˆäº†ã€‚ Travis CI é…ç½®é¦–å…ˆæˆ‘ä»¬ç”¨ GitHub ç™»å½•ä¸Š Travis CIï¼Œç„¶åæ‰¾åˆ°ä½ æƒ³è¦å¼€å¯çš„ Repoï¼Œç„¶åå°†å…¶å¼€å…³æ‰“å¼€ï¼Œåšå¦‚ä¸‹å›¾é…ç½®å³å¯ã€‚ ç´§æ¥ç€æˆ‘ä»¬åœ¨ç”µè„‘ä¸Šéœ€è¦ä½¿ç”¨å‘½ä»¤ sudo gem install travis å®‰è£… travisï¼Œç„¶ååœ¨ hexo æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ª .travis.ymlã€‚ä¸‹é¢æ˜¯æˆ‘çš„æ•´ä¸ªå®‰è£…è®°å½•æ­¥éª¤åŠæ—¥å¿—ï¼Œå…³é”®ç‚¹æˆ‘éƒ½åŠ äº†æ³¨é‡Šï¼š ğŸ‘ˆç‚¹å‡»å®‰è£…æ­¥éª¤æ—¥å¿—123456789101112131415161718192021# å½“å‰åœ¨ hexo æ ¹ç›®å½•ä¸‹ï¼Œä¸” .travis.yml æ–‡ä»¶å·²åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºå¥½äº†$ sudo gem install travis Password:Fetching: backports-3.11.4.gem (100%)Successfully installed backports-3.11.4Fetching: addressable-2.4.0.gem (100%)Successfully installed addressable-2.4.0... # ä¸­é—´ä¸€å †æ—¥å¿—çœç•¥äº†$ travis login # ä½¿ç”¨ GitHub ç™»å½•ï¼Œä¸‹é¢æ˜¯æ—¥å¿—ä¸ç”¨ç®¡ We need your GitHub login to identify you.This information will not be sent to Travis CI, only to api.github.com.The password will not be displayed.Try running with --github-token or --auto if you don't want to enter your password anyway.Username: wang9262 # è¾“å…¥ GitHub ç”¨æˆ·åPassword for wang9262: ************** # è¾“å…¥ GitHub å¯†ç Successfully logged in as wang9262!travis encrypt ENVName=yourtoken --add # ENVName å¯ä»¥æ¢æˆä»»æ„å­—ç¬¦ä¸²ï¼Œyourtoken æ¢æˆä¸Šé¢ç”Ÿæˆçš„ tokenï¼Œæ¯”å¦‚æˆ‘çš„æ˜¯ BlogToken=12345 ä»¥ä¸Šæ“ä½œæ‰§è¡Œå®Œï¼Œæ‰“å¼€ .travis.ymlï¼Œä¼šå‘ç°å·²ç»ç”Ÿæˆäº†ä¸€äº›ç±»ä¼¼ä¸‹é¢ä»£ç  123env: global: - secure: wrewrewrwebJ+XFbrUGTM0kIr..... ç„¶å .travis.yml å…·ä½“å†…å®¹ï¼Œå¯ä»¥å‚è€ƒæˆ‘è¿™ä¸ªåˆ†æ”¯ä¸Šçš„å†…å®¹å³å¯ã€‚å…¶ä¸­ä¸Šé¢é‚£ä¸ªè„šæœ¬éœ€è¦è¯´æ˜çš„æ˜¯ä¸ºäº†ç»™æ¯æ¬¡ commit æ—¶æ·»åŠ è®°å½•ç”¨çš„ï¼ŒåŒæ—¶ä¸ºäº†é˜²æ­¢ä¹‹å‰çš„è®°å½•è¢«è¦†ç›–ï¼Œéœ€è¦å…ˆå°†è¿œç«¯çš„ .git æ‹·è´åˆ°æœ¬åœ°ï¼Œç„¶åå†è¿›è¡Œ commitï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ‰€æœ‰å†å²è®°å½•éƒ½åœ¨ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿæ˜¯æ”¾åœ¨æ ¹ç›®å½•ä¸‹çš„ã€‚ æˆ‘ç”¨çš„å‘½ä»¤è¡Œæ–¹å¼ï¼Œå¦‚æœç”¨çš„ä¸æ˜¯å‘½ä»¤è¡Œæ–¹å¼ï¼Œå¯ä»¥å‚è€ƒç½‘ä¸Šçš„ï¼Œåœ¨ç½‘é¡µä¸Šè®¾ç½®ç¯å¢ƒå˜é‡ï¼ŒæŠŠ Token å¡«å…¥åˆ°ç½‘é¡µä¸Šï¼Œä¹Ÿå°±æ˜¯ä¸Šå›¾ä¸­çš„2ã€3ä¸¤ä¸ªæ ‡è®°ç‚¹ï¼Œ2å¡«å…¥ç¯å¢ƒå˜é‡åï¼Œ3å¤„å¡«å…¥ Tokenï¼Œä¹Ÿå¯ä»¥æ–°å¢å…¶å®ƒç¯å¢ƒå˜é‡ã€‚ æœ€åç°åœ¨æ¯æ¬¡æœ‰æ–°æ–‡ç« å‘å¸ƒï¼Œåªéœ€è¦æœ¬åœ°å†™å¥½åï¼ŒæŠŠ markdown æ–‡ä»¶æ¨åˆ°è¿œç«¯çš„ hexo åˆ†æ”¯å³å¯ï¼Œä¸éœ€è¦é¢å¤–æ“ä½œï¼Œè¿™æ ·å¯ä»¥ä¾¿æ·åœ°åœ¨å¤šå°ç”µè„‘ä¸Šå‘å¸ƒå†…å®¹ï¼Œä¸å¿…ä¸ºç¯å¢ƒé…ç½®è€Œæ‹…å¿ƒã€‚å½“ç„¶è¿™ç¯‡æ–‡ç« ä¹Ÿæ˜¯é€šè¿‡è¿™ç§æ–¹å¼å‘å¸ƒçš„ï¼Œæ•ˆæœè¿˜è¡Œå§ã€‚ æ¥ä¸‹æ¥çš„è®¡åˆ’å°±æ˜¯æŠŠæ–‡ç« é¡¶éƒ¨çš„ä¸€äº› hexo ç”¨åˆ°çš„å…ƒä¿¡æ¯é€šè¿‡è„šæœ¬è‡ªåŠ¨ç”Ÿæˆè€Œä¸éœ€è¦æ‰‹åŠ¨å»æ·»åŠ ã€‚ å¦‚æœä½ æ ¹æ®ä¸Šé¢æ­¥éª¤ï¼Œæ²¡æœ‰è¾¾åˆ°æƒ³è¦çš„æ•ˆæœï¼Œå¯ä»¥åœ¨ä¸‹æ–¹ç•™è¨€ï¼Œä¸€èµ·äº¤æµæ²Ÿé€šã€‚å½“ç„¶å¦‚æœä½ æœ‰æ›´é«˜æ•ˆçš„æ–¹å¼ï¼Œä¹Ÿæ¬¢è¿åˆ†äº«ä¸€ä¸‹~]]></content>
      <categories>
        <category>å¤‡å¿˜è®°å½•</category>
      </categories>
      <tags>
        <tag>åŸåˆ›</tag>
        <tag>ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[GMTC ä¹‹æ—…]]></title>
    <url>%2F2018%2F10%2F28%2FSome-thoughts-On-GMTC-2018%2F</url>
    <content type="text"><![CDATA[ä¸Šå‘¨å‡‘å·§æœ‰æœºä¼šæ‹¿åˆ° GMTC çš„ç¥¨ï¼Œç„¶åå»ç°åœºä½“éªŒäº†ä¸€ä¸‹ã€‚è¿™é‡Œä¸»è¦è®°å½•ç¬¬ä¸€æ¬¡å‚åŠ è¿™ç§çº¿ä¸‹å¤§ä¼šçš„ä¸€äº›æ„Ÿå—ã€‚ å¤§ä¼šåœ¨ 6.21~6.22 è¿›è¡Œï¼Œç”±äºæ—¶é—´é—®é¢˜ï¼Œæˆ‘åªå»äº†ä¸¤ä¸ªè‡ªå·±æ„Ÿå…´è¶£çš„ä¸“é¢˜ï¼šæ€§èƒ½ä¼˜åŒ–ä¸“åœºä»¥åŠ iOS æ–°æŠ€æœ¯ä¸“åœºã€‚æ€§èƒ½ä¼˜åŒ–ä¸“åœºåœ¨21å·ä¸‹åˆè¿›è¡Œï¼Œå½“å¤©æ—©ä¸Š Flutter Release Preview 1 æ”¾å‡ºï¼Œæ›´å¤šå…³äº Flutter çš„æ–‡ç« ï¼Œå¯ä»¥åœ¨æˆ‘ä»¬å…¬ä¼—å·çŸ¥è¯†å°é›†ä¸Šè·å–ã€‚ æ€§èƒ½ä¼˜åŒ–ä¸“åœºå½“å¤©ä¸‹åˆæå‰ä¸€å°æ—¶ä»å…¬å¸å‡ºå‘ï¼Œ1ï¼š30 åˆ°ç°åœºæ—¶ï¼Œä¼šåœºå·²ç»æ»¡åº§ï¼Œåªèƒ½ååœ°ä¸‹ï¼Œç¬¬äºŒåœºä¸€äº›äººèµ°äº†ä¹‹åæ‰ç©ºå‡ºä¸€äº›åº§ä½ã€‚ ç¬¬ä¸€åœºæ˜¯ LinkedIn iOS å·¥ç¨‹å¸ˆå¸¦æ¥çš„ã€ŠLinkedIn ç§»åŠ¨åº”ç”¨çš„æ€§èƒ½ä¼˜åŒ–å®è·µã€‹ï¼Œåˆ†äº«äº†é¢†è‹±çš„ä¸€äº›æ€§èƒ½ä¼˜åŒ–å®è·µã€‚éšç€åº”ç”¨ä½“é‡ï¼ˆåŠŸèƒ½ï¼‰å˜å¾—è¶Šæ¥è¶Šåºå¤§ï¼Œæœ€åˆçš„åº”ç”¨æ¶æ„ä¼šå˜å¾—è¶Šæ¥è¶Šæ’‘ä¸ä½ï¼Œæ‰€ä»¥éœ€è¦é€‚æ—¶è°ƒæ•´åˆç†çš„åº”ç”¨æ¶æ„ã€‚é¢†è‹±ä½¿ç”¨ç»„ä»¶åŒ–å’Œæ ‡å‡†åŒ–æ¥æé«˜ä»£ç å¤ç”¨ç‡ä»¥åŠé¡¹ç›®å¤æ‚åº¦ï¼Œè¿›è€Œå‡å°‘äº†çº¿ä¸Šçš„å´©æºƒç‡å’Œæ€§èƒ½é—®é¢˜ã€‚å»ºç«‹å®Œå–„çš„æ€§èƒ½ç›‘æ§ä½“ç³»å¯¹çº¿ä¸Šç”¨æˆ·çš„æ€§èƒ½æ•°æ®è¿›è¡Œåˆ†æï¼Œå‘ç°é—®é¢˜å¹¶è§£å†³é—®é¢˜ï¼ŒåŒæ—¶ä½¿ç”¨ AB å®éªŒæ¥å¿«é€ŸéªŒè¯æ•ˆæœã€‚æœ€åä½œè€…é€šè¿‡ä¸€ä¸ªå®é™…æ¡ˆä¾‹æ¥é˜è¿°ï¼Œä»¥ä¸Šå‡ ç‚¹æ˜¯å¦‚ä½•åœ¨é¡¹ç›®ä¸­è½åœ°å®è·µçš„ã€‚é€šè¿‡çº¿ä¸Šç›‘æ§å‘ç°é¡µé¢åŠ è½½æ¯”è¾ƒæ…¢ï¼Œä¸»è¦åŸå› æœ‰ï¼šç½‘ç»œè¯·æ±‚å¤šã€æ•°æ®é‡å¤§ã€é¡µé¢æ¸²æŸ“æ…¢ï¼Œå¯¹è¿™ä¸‰ä¸ªåˆ†åˆ«é‡‡å–å¯¹åº”æªæ–½æ¥è§£å†³ï¼šç½‘ç»œä¼˜åŒ–ï¼Œä½¿ç”¨ http/2ã€æ•°æ®ç®€åŒ–ï¼ˆæœåŠ¡ç«¯ç²¾ç®€è¿”å›å­—æ®µï¼‰ã€å¸ƒå±€ä¼˜åŒ–ï¼ˆé¢†è‹±å¼€æºåº“ LayoutKitï¼Œå°†å¸ƒå±€è®¡ç®—æ”¾åˆ°åå°çº¿ç¨‹ï¼‰ã€‚ å…¶å®å¤§éƒ¨åˆ†åº”ç”¨éƒ½å¯èƒ½å­˜åœ¨ä¸Šè¿°é—®é¢˜ï¼Œä»ç½‘ç»œå‘èµ·åˆ°é¡µé¢å®Œæ•´æ¸²æŸ“å±•ç¤ºï¼Œé‡Œé¢å¾ˆå¤šçš„å…³é”®èŠ‚ç‚¹éƒ½å¯èƒ½å¯¼è‡´é¡µé¢åŠ è½½è¿‡æ…¢ã€‚å¯¹äºæ•°æ®ç®€åŒ–è¿™ä¸€å—ï¼Œä½œè€…æœ‰æåˆ°ä»–ä»¬å†…éƒ¨æœ‰ä¸€ä¸ª Frontend Deco å¹³å°ï¼Œå®¢æˆ·ç«¯å¯ä»¥æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©éœ€è¦æœåŠ¡ç«¯è¿”å›çš„å­—æ®µï¼Œç„¶åç”Ÿæˆä¸€ä¸ª recipe_idï¼Œè¯·æ±‚æ—¶å¸¦ä¸Šè¿™ä¸ªå‚æ•°ï¼Œåˆ™åªä¼šè¿”å›å¯¹åº”çš„æ•°æ®ï¼Œè¿›è€Œå®ç°æ•°æ®ç²¾ç®€ã€‚ è¿™é‡Œæœ‰ä¸€ç‚¹å¾ˆç–‘é—®ï¼Œç†è®ºä¸Šæ€§èƒ½ä¼˜åŒ–æ˜¯è‚¯å®šèƒ½æ”¹å–„ç”¨æˆ·ä½“éªŒçš„ï¼Œè¿™é‡Œå¯¹æ€§èƒ½ä¼˜åŒ–åš AB å®éªŒæ˜¯ä¸æ˜¯æœ‰ç‚¹å¤šæ­¤ä¸€ä¸¾ï¼Ÿ åˆ†äº«è€…çš„å›ç­”ï¼š å‰©ä¸‹çš„ 3 åœºä¸»è¦æ˜¯å‰ç«¯å’Œå®‰å“ä¸Šçš„æ€§èƒ½ä¼˜åŒ–ï¼Œç”±äºè‡ªå·±å¯¹äºå®‰å“å’Œå‰ç«¯æŠ€æœ¯ä¸€æ— æ‰€çŸ¥ï¼Œæ‰€ä»¥åªæ˜¯å¤§æ¦‚å¬äº†ä¸€ä¸‹ã€‚å°è±¡æ¯”è¾ƒæ·±çš„æ˜¯é˜¿é‡Œçš„ç›‘æ§ä½“ç³»ï¼Œè¿˜åŸç”¨æˆ·â€œäº‹å‘ç°åœºâ€ï¼Œå¤§è‡´åŸç†å°±æ˜¯è®°å½•é¦–å±æ—¶çš„æ‰€æœ‰æ•°æ®ï¼Œç”¨æˆ·æ“ä½œå¯¼è‡´çš„å¢é‡æ•°æ®é¡µå®æ—¶è®°å½•ï¼Œè¿›è€Œå®ç°ç”¨æˆ·æ“ä½œç°åœºçš„è¿˜åŸã€‚çˆ±å¥‡è‰ºçš„â€œæè‡´â€æ€§èƒ½ä¼˜åŒ–ï¼Œå¯¹äºåŠŸè€—çš„æµ‹é‡ï¼Œä½¿ç”¨ PowerMonitor æ¥æ£€æµ‹åˆ†æï¼ŒåŒæ—¶ä½¿ç”¨ AI æ¥åšè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚åŒæ—¶å¼€æºäº† LiteAppï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªè¡Œåœ¨ GitHub ä¸Šæœç´¢ã€‚ iOS æ–°æŠ€æœ¯ä¸“åœºè¿™ä¸€åœºåœ¨22å·æ—©ä¸Š9ç‚¹åŠå¼€å§‹ï¼Œ9ç‚¹åˆ°è¾¾ä¼šåœºï¼Œäººæ²¡æœ‰æ˜¨å¤©é‚£ä¹ˆå¤šï¼Œç©ºä½å¾ˆå¤šã€‚è¿™ä¸ªä¸“é¢˜å‡ºå“äººæ˜¯å˜€å˜€å‡ºè¡Œçš„æˆ´é“­è€å¸ˆã€‚è¿™ä¸ªä¸“åœºæœ‰ä¸‰ä¸ªä¸»é¢˜ï¼Œè®²å¸ˆåˆ†åˆ«æ¥è‡ª Instagramã€ç¾å›¢ã€ç¾ç”²å¸®ã€‚ æ¥è‡ª Instagram çš„å·¥ç¨‹å¸ˆä¸»è¦åˆ†äº«äº†å¤æ‚åˆ—è¡¨çš„è§£å†³æ–¹æ¡ˆã€å¯¹ç…§å®éªŒã€ä»¥åŠåŠ å¿«ç¼–è¯‘é€Ÿåº¦ã€‚å¤æ‚åˆ—è¡¨ä½¿ç”¨ä»–ä»¬è‡ªå·±å¼€æºçš„ IGListKit ä»¥åŠ MVVM æ¶æ„æ¥å®ç°ä»£ç å¤ç”¨ï¼Œå„è‡ªä¸šåŠ¡å›¢é˜Ÿä»£ç é›†ä¸­åœ¨ SectionController æ¥è¾¾åˆ°è§£è€¦ï¼Œå„ä¸ªä¸šåŠ¡å›¢é˜Ÿåªéœ€ä¸“æ³¨äºè‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ã€‚åŒæ · Instagram ä¹Ÿé€šè¿‡ AB å®éªŒæ¥æŠ‰æ‹©å‡ºä¸€äº›è¾ƒå¥½çš„äº§å“éœ€æ±‚ï¼ŒåŒæ—¶é€šè¿‡ AB å®éªŒæ¥ä¿æŒäº§å“çš„å¿«é€Ÿè¿­ä»£ã€‚åŒæ—¶éšç€ AB å®éªŒçš„å¢å¤šï¼Œéš¾å…ä¼šé‡åˆ°ä¸€äº›äº’æ–¥å®éªŒæˆ–è€…äº’ç›¸å½±å“çš„å®éªŒï¼Œæ‰€ä»¥åœ¨è®¾è®¡ä¸€äº›å®éªŒæ—¶ï¼Œä¹Ÿéœ€è¦å°½é‡é¿å…è¿™ç§æƒ…å†µã€‚å¯¹äºå¯èƒ½äº’ç›¸å¹²æ‰°çš„å®éªŒï¼Œä½œè€…ä¸¾äº†ä¸€ä¸ªä¾‹å­ä»¥åŠå¯èƒ½çš„å‡ ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæ€è·¯ä¹Ÿæ˜¯å¾ˆä¸å¤šçš„ï¼Œå…·ä½“å†…å®¹å¤§å®¶å¯ä»¥å»å®˜ç½‘ä¸Šæ‰¾åˆ°å¯¹åº”çš„ PPT é“¾æ¥ï¼Œä¸‹è½½æŸ¥çœ‹ã€‚æœ€åä¸€ä¸ªåˆ†äº«ç‚¹ï¼Œä¹Ÿæ˜¯ç›®å‰å¤§éƒ¨åˆ† iOS å¼€å‘è€…çš„æ§½ç‚¹ï¼Œå°±æ˜¯ Xcode çš„ç¼–è¯‘é€Ÿåº¦ã€‚éšç€å·¥ç¨‹åŠä»£ç é‡çš„å¢å¤§ï¼Œç¼–è¯‘é€Ÿåº¦ä¹Ÿéšä¹‹å˜æ…¢ï¼Œä»åŸæ¥çš„åå‡ ç§’åˆ°å‡ åˆ†é’Ÿåˆ°åŠå°æ—¶ï¼ˆçœŸæ­£çš„â€œå¸¦è–ªç¼–è¯‘â€ï¼‰ï¼Œç¼–è¯‘æ—¶çš„å¿ƒæƒ…ä¹Ÿä¾æ¬¡æ”¹å˜ï¼šğŸ˜€-&gt;ğŸ™‚-&gt;ğŸ˜°-&gt;ğŸ˜¡-&gt;ğŸ’€ã€‚Facebook å†…éƒ¨ä½¿ç”¨ Buck+Focus æ¥åŠ å¿«ç¼–è¯‘é€Ÿåº¦ï¼ŒBuck ç›®å‰å·²å¼€æºï¼Œæ®ä½œè€…è¯´ï¼Œä½¿ç”¨ Buck+Focus åï¼Œç¼–è¯‘é€Ÿåº¦åˆèƒ½åˆ°åå‡ ç§’ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å°è¯•ä¸€ä¸‹ã€‚ æ¥è‡ªç¾å›¢çš„è‡§æˆå¨è€å¸ˆåˆ†äº«äº†ä»–ä»¬å³å°†å¼€æºçš„é¢å‘å¯¹è±¡çš„å“åº”å¼æ¶æ„ï¼šEasyReact ä»¥åŠ EasyMVVMï¼Œç›¸ä¿¡ç”¨è¿‡ ReactiveCocoa çš„åŒå­¦éƒ½å¾ˆæ¸…æ¥šï¼Œæ¯æ¬¡è°ƒè¯•æ—¶ï¼Œè°ƒç”¨æ ˆéå¸¸æ·±ï¼Œè€Œä¸”ä¸­é—´çš„è°ƒç”¨æ ˆå†…å®¹å‡ ä¹æ²¡å•¥ç”¨å¤„ï¼Œè°ƒè¯•èµ·æ¥æ¯”è¾ƒè´¹åŠ²ï¼Œä½œè€…è¡¨ç¤º EasyReact ç›¸å¯¹äº ReactiveCocoaï¼ŒåŒæ ·çš„5æ¬¡å˜æ¢æ“ä½œï¼Œå‰è€…è°ƒç”¨æ ˆåªæœ‰10å±‚ï¼Œè€Œ ReactiveCocoa æœ‰50å±‚ã€‚å…³äºå…¶å®ƒçš„å¯¹æ¯”ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ä½œè€…æ”¾å‡ºçš„ benchmark å¯¹æ¯”å›¾ æœ€åç¾ç”²å¸®çš„é›é’åˆ†äº«äº†ä»–çš„è§£å†³å¼‚æ„åˆ—è¡¨çš„å¼€æºåº“ Flixã€‚ä¸»è¦æ˜¯é€šè¿‡å‡ ä¸ªå®ä¾‹æ¥ä¸€æ­¥æ­¥ç»™å‡º Flix çš„è®¾è®¡ç†å¿µï¼Œä»¥åŠä¸€äº›ä½¿ç”¨åœºæ™¯ï¼Œä¼šä¸Šä»£ç æ¶‰åŠçš„è¾ƒå¤šï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªè¡Œå» GitHub ä¸Šç¿»é˜…å¯¹åº”æºç ã€‚ æ„Ÿå—AB å®éªŒä½œä¸ºä¸€ç§å¿«é€ŸéªŒè¯æƒ³æ³•çš„å·¥å…·ï¼Œç›®å‰å›½å†…å¤–å¤§å…¬å¸åº”è¯¥éƒ½æœ‰åœ¨ä½¿ç”¨ï¼Œç›¸å¯¹äºä¼ ç»Ÿçš„ç‰ˆæœ¬è¿­ä»£ï¼ŒAB å®éªŒå¯ä»¥è¾ƒå¥½çš„ç¼©å°è¿­ä»£å‘¨æœŸï¼Œåœ¨ä»¥æ•°æ®ç»“æœä¸ºå¯¼å‘çš„æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½å¿«é€Ÿå¾—å‡ºç»“è®ºï¼Œä¸éœ€è¦åšè¿‡å¤šäº‰è¾©ã€‚ä½†åŒæ—¶å®ƒä¹Ÿå¸¦æ¥äº†ä¸€äº›æŒ‘æˆ˜ï¼Œæ¯”å¦‚ AB å®éªŒçš„è®¾è®¡ï¼Œä»¥åŠå¯¹å®éªŒç»“æœçš„åˆ†æç­‰ã€‚ æ€§èƒ½ä¼˜åŒ–ä½œä¸ºæ¯ä¸ªå¼€å‘è€…éƒ½åº”è¯¥æŒæ¡çš„æŠ€èƒ½ï¼Œå¼€å‘è¿‡ç¨‹ä¸­éœ€è¦å¤šè€ƒè™‘æ€§èƒ½ä¸Šçš„é—®é¢˜ï¼Œä¸èƒ½ä¸€å‘³è¿½æ±‚éœ€æ±‚å®Œæˆé€Ÿåº¦ï¼Œè¿˜è¦å…¼é¡¾è´¨é‡ã€‚ æ•´ä¸ªä¸¤åœºä¸“é¢˜å¬ä¸‹æ¥ï¼Œæ„Ÿå—æœ€æ·±çš„å°±æ˜¯å‡ ä¹æ¯ä¸ªå°ä¸»é¢˜éƒ½åœ¨åˆ†äº«è‡ªå·±çš„å¼€æºæ¡†æ¶ï¼Œä¸€æ–¹é¢å¯ä»¥æé«˜è‡ªå·±å…¬å¸çš„å½±å“åŠ›ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¯ä»¥å¸å¼•åˆ°æ›´å¤šäººã€‚ PSï¼šä»¥ä¸Šæ‰€æœ‰åœºæ¬¡çš„ PPT å‡å¯åœ¨è¿™é‡Œä¸‹è½½åˆ°]]></content>
      <categories>
        <category>æ‰¯æ·¡é›†</category>
      </categories>
      <tags>
        <tag>æ‚è°ˆ</tag>
        <tag>åŸåˆ›</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ›¿æ¢ç³»ç»ŸéŸ³é‡æç¤ºçš„å®ç°å’Œé‡åˆ°çš„å‘]]></title>
    <url>%2F2018%2F06%2F03%2FReplace-System-Volume-View%2F</url>
    <content type="text"><![CDATA[ç›¸ä¿¡å¹³æ—¶å¤§å®¶åœ¨ç”¨ iPhone çœ‹è§†é¢‘è°ƒèŠ‚éŸ³é‡æ—¶ï¼Œæ€»ä¼šè¢«ç³»ç»Ÿçš„éŸ³é‡æç¤ºæ‰€æ‰“æ‰°ï¼Œå› ä¸ºå®ƒä¼šé®ä½ä¸€éƒ¨åˆ†å†…å®¹ã€‚æ‰€ä»¥å¾ˆå¤šè§†é¢‘åº”ç”¨éƒ½ä½¿ç”¨è‡ªå®šä¹‰éŸ³é‡è§†å›¾çš„æ–¹å¼æ¥æ›¿ä»£ç³»ç»Ÿçš„éŸ³é‡æç¤ºã€‚ æ¯”å¦‚ä¸‹é¢ä¸‰å¼ æˆªå›¾ï¼Œåˆ†åˆ«æ¥è‡ª Instagramã€å“”å“©å“”å“©ã€å³åˆ» åŸç†è¿™é‡Œä¸»è¦è®°å½•ä¸€ä¸‹åœ¨é¡¹ç›®ä¸­å¦‚ä½•æ›¿æ¢ç³»ç»ŸéŸ³é‡æç¤ºè§†å›¾çš„è¿‡ç¨‹ã€‚é€šè¿‡ Google å’Œ stackoverflowï¼Œå¯ä»¥æŸ¥åˆ°ï¼Œå¦‚æœè¦è‡ªå®šä¹‰éŸ³é‡æç¤ºï¼Œéœ€è¦åšåˆ°ä»¥ä¸‹å‡ æ­¥ï¼š æ¿€æ´» AudioSession åˆ›å»ºä¸€ä¸ª MPVolumeViewï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°å½“å‰å¯è§çš„è§†å›¾å±‚çº§å½“ä¸­ï¼ŒåŒæ—¶å°†å…¶ frame è®¾ç½®åˆ°ä¸å¯è§åŒºåŸŸ ç›‘å¬éŸ³é‡æŒ‰é’®è§¦å‘äº‹ä»¶ï¼Œæ”¹å˜éŸ³é‡æç¤º å®ç°ç„¶åä¸ºäº†è°ƒç”¨ç»Ÿä¸€ä¸”éŸ³é‡è§†å›¾å±‚çº§æ°¸è¿œåœ¨æœ€ä¸Šæ–¹ï¼ˆå³ä¸è¢« Alert ç­‰æŒ¡ä½ï¼‰ï¼Œé¦–å…ˆæƒ³åˆ°ä½¿ç”¨ä¸€ä¸ª UIWindowï¼Œç„¶åè‡ªå®šä¹‰è§†å›¾å’Œç³»ç»Ÿçš„è§†å›¾åŠ åˆ°è¿™ä¸ªè§†å›¾å±‚çº§ä¸Šï¼Œåˆå§‹åŒ–æ—¶ frame ä¸º CGRectZeroï¼Œhidden å±æ€§ä¸º NOï¼ˆæ³¨æ„è¿™é‡Œå¿…é¡»ä¸º NOï¼Œä¸ç„¶ç³»ç»ŸéŸ³é‡æç¤ºä»ä¼šå‡ºç°ï¼Œä¸Šé¢è¯´åˆ°çš„ç¬¬2ç‚¹ï¼‰ï¼›è¦æ˜¾ç¤ºæ—¶è®¾ç½®å…¶ frame è®¾ç½®æˆ mainScreen çš„ boundsï¼Œç„¶åå±•ç¤ºå³å¯ã€‚ ç”±äºè‡ªå·±åˆ›å»ºçš„ UIWindow çš„ hidden å±æ€§é»˜è®¤æ˜¯ YESï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨å°†å…¶è®¾æˆ NOã€‚éŸ³é‡æŒ‰é’®æ¯è§¦å‘ä¸€æ¬¡ï¼Œå˜åŒ–é‡éƒ½æ˜¯ 6.25%ï¼Œè¿ç»­æŒ‰16æ¬¡ï¼Œå³å¯è°ƒèŠ‚è‡³æœ€å¤§æˆ–æœ€å° ä¸Šè¿°çš„ç¬¬3æ­¥æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥åšåˆ°ï¼Œå„æœ‰ä¼˜åŠ£ï¼Œä¸‹é¢æ¥åšä¸€ä¸ªç®€å•ä»‹ç»ã€‚ KVOé€šè¿‡ KVO ç›‘å¬ [AVAudioSession sharedInstance] çš„ outputVolume å±æ€§ï¼Œç„¶åæ¥æ˜¾ç¤ºè‡ªå®šä¹‰çš„ UI æ§ä»¶ã€‚è¿™ç§æ–¹å¼æœ‰ä¸€ä¸ªä¸å¥½çš„åœ°æ–¹å°±æ˜¯ï¼Œåœ¨éŸ³é‡è°ƒèŠ‚è‡³æœ€å¤§/æœ€å°æ—¶ï¼Œè¿™ä¸ªæ—¶å€™å†è°ƒå¤§/è°ƒå°éŸ³é‡ï¼Œç”±äº outputVolume çš„å€¼ä¸å˜ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘ KVOï¼Œä¹Ÿå°±æ— æ³•å±•ç¤ºè‡ªå®šä¹‰éŸ³é‡è§†å›¾ã€‚ä»£ç å¤§æ¦‚é•¿ä¸‹é¢è¿™æ · 123456789101112131415161718192021222324252627- (void)dealloc &#123; [[AVAudioSession sharedInstance] removeObserver:self forKeyPath:NSStringFromSelector(@selector(outputVolume))];&#125;- (void)addObserver &#123; [[AVAudioSession sharedInstance] addObserver:self forKeyPath:NSStringFromSelector(@selector(outputVolume)) options:NSKeyValueObservingOptionNew context:nil];&#125;- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary&lt;NSKeyValueChangeKey,id&gt; *)change context:(void *)context &#123; if ([change isKindOfClass:[NSDictionary class]]) &#123; NSNumber *volumeNum = change[@"new"]; if (volumeNum) &#123; [self volumeDidChange:[volumeNum floatValue]]; &#125; &#125;&#125;- (void)volumeDidChange:(CGFloat)volume &#123; // æ˜¾ç¤ºè‡ªå®šä¹‰éŸ³é‡æç¤º&#125; é€šçŸ¥è¿™ç§æ–¹å¼é€šè¿‡ç›‘å¬ç³»ç»Ÿç§æœ‰ï¼ˆæœªå…¬å¼€çš„ï¼‰é€šçŸ¥ï¼Œåå­—æ˜¯ AVSystemController_SystemVolumeDidChangeNotificationï¼Œè¿™ä¸ªç›‘å¬ä¸ä¼šå—åˆ°æœ€å¤§/æœ€å°éŸ³é‡æ—¶ï¼Œè°ƒå¤§/è°ƒå°éŸ³é‡çš„å½±å“ï¼Œåªè¦éŸ³é‡é”®æŒ‰ä¸‹ï¼Œå§‹ç»ˆéƒ½ä¼šè§¦å‘ã€‚ä½†æ˜¯è¿™ä¸ªé€šçŸ¥ç”±äºæ˜¯ç§æœ‰çš„ï¼Œå¯èƒ½å­˜åœ¨è¢«æ‹’é£é™©ï¼Œè€Œä¸”å°†æ¥ç³»ç»Ÿç‰ˆæœ¬è¯¥é€šçŸ¥åå­—å‘ç”Ÿæ”¹å˜ï¼Œç”±äºæ˜¯ç¡¬ç¼–ç è€Œä¸åƒå…¶å®ƒç³»ç»Ÿé€šçŸ¥ä½¿ç”¨çš„æ˜¯å¸¸é‡ï¼Œä¼šå¯¼è‡´ç›‘å¬ä¸åˆ°çš„é—®é¢˜ã€‚ ä»£ç å¤§æ¦‚é•¿è¿™æ · 1234567891011121314151617181920212223static NSNotificationName const kSystemVolumeDidChangeNotification = @"AVSystemController_SystemVolumeDidChangeNotification";- (void)dealloc &#123; [[NSNotificationCenter defaultCenter] removeObserver:self];&#125;- (void)addObserver &#123; [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(volumeDidChange:) name:kSystemVolumeDidChangeNotification object:nil];&#125;- (void)volumeDidChange:(NSNotification *)notification &#123; NSString *category = notification.userInfo[@"AVSystemController_AudioCategoryNotificationParameter"]; NSString *changeReason = notification.userInfo[@"AVSystemController_AudioVolumeChangeReasonNotificationParameter"]; if (![category isEqualToString:@"Audio/Video"] || ![changeReason isEqualToString:@"ExplicitVolumeChange"]) &#123; return; &#125; CGFloat volume = [[notification userInfo][@"AVSystemController_AudioVolumeNotificationParameter"] floatValue]; // æ˜¾ç¤ºè‡ªå®šä¹‰éŸ³é‡æç¤º&#125; ä»¥ä¸Šä¸¤ç§æ–¹å¼å„è‡ªä¼˜åŠ£åŠ¿éƒ½å·²ç»åˆ—å‡ºæ¥äº†ï¼Œä¸Šé¢è¯´åˆ°çš„ä¸‰ä¸ªåº”ç”¨ï¼ŒInstagram ä½¿ç”¨çš„æ˜¯é€šçŸ¥çš„æ–¹å¼ï¼Œå³åˆ»å’Œå“”å“©å“”å“©éƒ½æ˜¯ç”¨ KVO çš„æ–¹å¼ã€‚å…·ä½“è¦é€‰é‚£ç§æ–¹å¼ï¼Œå°±çœ‹å…·ä½“éœ€æ±‚äº†ï¼Œå¦‚æœåœ¨æœ€å¤§æˆ–æœ€å°æ—¶ï¼Œè°ƒèŠ‚éŸ³é‡å¯ä»¥æ¥å—ä¸å±•ç¤ºéŸ³é‡è§†å›¾çš„è¯ï¼Œä¸ªäººæ¨èä½¿ç”¨ KVO çš„å½¢å¼ã€‚ é‡åˆ°çš„é—®é¢˜ä¸Šé¢é˜æ˜äº†åŸç†å’Œå®ç°æ–¹å¼ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ¥å…¥åˆ°é¡¹ç›®ä¸­çœŸæ­£ä½¿ç”¨äº†ï¼Œæ¥å…¥é¡¹ç›®åå‘ç°é—®é¢˜è¿˜ä¸å°‘ã€‚ å‘0x0001ç”±äºæˆ‘ä»¬ä½¿ç”¨äº† window æ¥æ˜¾ç¤ºè‡ªå®šä¹‰éŸ³é‡æç¤ºï¼Œæ‰€ä»¥ window éœ€è¦æå‰åˆ›å»ºå¥½ï¼Œæœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„æ˜¯ UIWindow çš„ hidden é»˜è®¤æ˜¯ YESï¼Œç”±äºä¸Šé¢è¯´åˆ°ç³»ç»Ÿçš„éŸ³é‡è§†å›¾å¿…é¡»åœ¨å¯è§è§†å›¾å±‚çº§å†…ï¼Œæ‰€ä»¥åˆ›å»ºçš„è¿™ä¸ª window å¿…é¡»è¦å¯è§ï¼Œç„¶åå°½é‡ä¸å½±å“äº¤äº’ï¼Œå°†å…¶ userInteractionEnabled ç½®ä¸º NOï¼Œä¸”è¦è®©å…¶ä¸å¯è§æ—¶å±‚çº§æœ€ä½ï¼ŒwindowLevel è®¾ç½®ä¸º UIWindowLevelNormalã€‚ 123456self.window = [[UIWindow alloc] initWithFrame:[UIScreen mainScreen].bounds];self.window.hidden = NO;self.window.windowLevel = UIWindowLevelNormal - 1;self.window.rootViewController = [[UIViewController alloc] init];self.window.backgroundColor = [UIColor clearColor];self.window.userInteractionEnabled = NO; å‘0x0010è¿™æ ·ä¸€åˆ‡çœ‹èµ·æ¥å¾ˆæ­£å¸¸ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯æœ‰ä¸€äº›åœ°æ–¹é€šè¿‡ [[UIApplication sharedApplication].windows firstObject] æ¥è¿›è¡Œä¸€äº›æ“ä½œï¼Œæ¯”å¦‚å±•ç¤º toast æˆ–è€…æ”¶èµ·é”®ç›˜çš„ UIControlï¼Œæ‰€ä»¥ä¼šå¯¼è‡´å…¶ä¸å¯è§æˆ–è€…æ— æ³•å“åº”äº¤äº’ã€‚æ‰€ä»¥ä¸Šé¢ä»£ç æ”¹æˆ 123self.window = [[UIWindow alloc] initWithFrame:CGRectZero];self.window.clipsToBounds = YES;self.window.windowLevel = UIWindowLevelNormal; å—¯ï¼Œè¿è¡Œèµ·æ¥ï¼Œé‚£äº›å¯»æ‰¾ firstObject çš„åœ°æ–¹éƒ½æ­£å¸¸äº†ï¼Œä½†æ˜¯â€¦ç”±äºå­˜åœ¨å¼€å±å¹¿å‘Šï¼Œè€Œä¸”å¼€å±å¹¿å‘Šç”¨çš„ä¹Ÿæ˜¯ windowï¼Œè€Œä¸”ä»–ä¼šåœ¨è‡ªå·±è¦æ˜¾ç¤ºæ—¶ï¼Œè°ƒç”¨ makeKeyAndVisible æ–¹æ³•ï¼Œæ¶ˆå¤±çš„æ—¶å€™ç›´æ¥å°†å…¶ç½®ä¸º nilï¼Œå¯¼è‡´ç³»ç»Ÿä¼šè‡ªå·±å¯»æ‰¾å…¶å®ƒçš„ window å½“åš keyWindowï¼Œè¿™ä¸ªæ—¶å€™ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼šæ‰¾åˆ°æˆ‘ä»¬éŸ³é‡æç¤ºçš„ windowï¼Ÿéš¾é“æ˜¯å› ä¸º [UIApplication sharedApplication].delegate.window å±‚çº§æ˜¯ Normalï¼ŒéŸ³é‡æç¤º window å±‚çº§ä¹Ÿæ˜¯ Normalï¼Œç„¶åä¼šå°†ååŠ å…¥çš„ å±‚çº§ä¸º Normal çš„ window è®¾ç½®ä¸º key windowï¼Ÿæš‚æ—¶è¿˜ä¸æ‡‚ï¼Œæœ‰çŸ¥é“çš„å¤§ç¥éº»çƒ¦æŒ‡ç‚¹ä¸€ä¸‹ã€‚è¿™æ ·çœ‹æ¥ï¼Œè¿™ç§ä¿®æ”¹æ–¹å¼ä¹Ÿä¸å¤ªè¡Œï¼Œä¼šå¯¼è‡´å…¶å®ƒåœ°æ–¹å– keyWindow çš„æ—¶å€™ï¼Œå–é”™æ‰ã€‚ å‘0x0011å—¯ï¼Œé‚£ç´¢æ€§ç›´æ¥ç”¨ [UIApplication sharedApplication].delegate.window è¿™ä¸ªæ¥æ˜¾ç¤ºéŸ³é‡æç¤ºï¼Œæœ€å¤šä¹Ÿå°±å‡ºç° Alert æˆ–é”®ç›˜çš„æ—¶å€™ï¼ŒéŸ³é‡æç¤ºä¼šè¢«é®ç½©æŒ¡ä½ï¼Œæ¦‚ç‡ä¹Ÿæ¯”è¾ƒå°è¿˜å¥½ã€‚äºæ˜¯æ”¹æˆä¸‹é¢ä»£ç  1self.window = [UIApplication sharedApplication].delegate.window; ä½†æ˜¯è¿™ä¸ªæ—¶å€™ä¼šå‘ç°ï¼ŒiPhoneX ä¸‹éŸ³é‡æç¤ºä¼šè¢«çŠ¶æ€æ æŒ¡ä½ï¼Œwtfï¼ï¼ï¼é‚£ä¹ˆå¥½å§ï¼Œåœ¨éŸ³é‡æ˜¾ç¤ºçš„æ—¶å€™éšè—ä¸€ä¸‹çŠ¶æ€æ ï¼ŒéŸ³é‡æ¶ˆå¤±çš„æ—¶å€™å›å¤ä¸€ä¸‹ä¹‹å‰è®°ä½çš„çŠ¶æ€æ çŠ¶æ€ï¼Œä½†æ˜¯å¦‚æœå­˜åœ¨ä¸¤ä¸ªé¡µé¢çŠ¶æ€æ æ˜¾éšä¸ä¸€è‡´çš„æƒ…å†µï¼Œå°±ä¼šå‡ºç°é—®é¢˜ã€‚åŒæ—¶åœ¨æŸäº› present èµ·æ¥çš„é¡µé¢ï¼ŒéŸ³é‡æç¤ºæ­»æ´»ä¸æ˜¾ç¤ºï¼Œä½†æ˜¯ç”¨ Xcode è‡ªå¸¦è§†å›¾å±‚çº§è°ƒè¯•å·¥å…·çœ‹ï¼ŒéŸ³é‡æç¤ºè§†å›¾çš„ frameã€alphaã€hidden å±æ€§éƒ½æ˜¯æ­£å¸¸çš„ï¼Œä½†å°±æ˜¯æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ã€‚åé¢å°†æç¤ºè§†å›¾ layer çš„ zPosition æé«˜ä¹‹åï¼Œå°±å¯ä»¥æ˜¾ç¤ºå‡ºæ¥äº†ï¼ŒçœŸçš„å¾ˆç¥å¥‡ã€‚ ä¸€æ­¥æ­¥ä¸‹æ¥ï¼Œå¡«å®Œä¸€ä¸ªå‘ï¼Œåˆæ¥ä¸€ä¸ªï¼Œæ„Ÿè§‰æ˜¯ä¸ªæ— åº•æ´ï¼Œæ°¸è¿œå¡«ä¸æ»¡ã€‚æäº†ä¸€æ™šä¸Šï¼Œä¸€ç­¹è«å±•ã€‚ å®Œç¾å¡«å‘æœ€åçµå…‰ä¸€é—ªï¼Œå¦‚æœè‡ªå®šä¹‰ä¸€ä¸ª Windowï¼Œç»§æ‰¿è‡ª UIWindowï¼Œç„¶åå¤å†™ becomeKeyWindow æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œè®©è‡ªèº«ä¸æˆä¸º keyWindow åŒæ—¶å°† [UIApplication sharedApplication].delegate.window è®¾ç½®ä¸º keyWindowï¼Œå¤§è‡´ä»£ç é•¿è¿™æ ·ï¼š 123456789101112@interface VolumeWindow : UIWindow@end@implementation VolumeWindow- (void)becomeKeyWindow &#123; [self resignKeyWindow]; [[UIApplication sharedApplication].delegate.window makeKeyWindow];&#125;@end å‘0x0100æ‹æ‘„é¡µæ‹æ‘„ä¹‹å‰ç³»ç»ŸéŸ³é‡æç¤ºæ˜¯å¯ä»¥è¢«æ›¿æ¢çš„ï¼Œä½†æ˜¯æ‹æ‘„ä¸€æ®µä¹‹åï¼Œè«åå…¶å¦™éŸ³é‡æŒ‰é’®æŒ‰ä¸‹åè‡ªå®šä¹‰æç¤ºä¸è§äº†ï¼Œå‡ºç°äº†ç³»ç»Ÿçš„é“ƒå£°æç¤ºã€‚ä¸€è„¸æ‡µé€¼ï¼Œåé¢å‘ç°æ˜¯ç”±äºè®¾ç½®äº† AVCaptureSession çš„ usesApplicationAudioSession ä¸º NOï¼Œä¼šå¯¼è‡´åœ¨æ‹æ‘„ä¹‹åä¼šå˜æˆé“ƒå£°ï¼Œè¿™ä¸ªå’Œæ˜¯å¦æ›¿æ¢ç³»ç»ŸéŸ³é‡æç¤ºæ— å…³ã€‚è¿™ä¸ªå±æ€§æ˜¯ç”±äºé¡¹ç›®ä¸­å¾ˆä¹…ä¹‹å‰éœ€è¦å…¼å®¹ iOS6ï¼Œç„¶åä¸€ç›´é—ç•™ç€è¿™ä¸ªå±æ€§è®¾ç½®æ²¡æœ‰åˆ é™¤ã€‚ç”±äº iOS7 ä¹‹åï¼ŒAVCaptureSession å’Œåº”ç”¨ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ª AudioSessionï¼Œæ”¯æŒåŒæ—¶æ’­æ”¾å’Œå½•åˆ¶ä¸”ä¸ä¼šå—åˆ°å½±å“å’Œæ‰“æ–­ï¼Œæ‰€ä»¥ä¸éœ€è¦å†å»è®¾ç½®è¿™ä¸ªå±æ€§ã€‚ å‘0x0101åšäº†ä»¥ä¸Šæ“ä½œï¼Œåœ¨ iPhoneX ä¸‹ï¼Œå½“æ‹‰èµ·æ§åˆ¶ä¸­å¿ƒï¼Œå¹¶ä¸Šä¸‹æ»‘è°ƒæ•´éŸ³é‡åï¼Œå†å›åˆ°åº”ç”¨ï¼Œä¼šå‘ç°è‡ªå®šä¹‰éŸ³é‡è§†å›¾ä¼šå‡ºç°åœ¨çŠ¶æ€æ ä¸‹é¢ï¼ŒçŒœæµ‹è™½ç„¶åœ¨åº”ç”¨å†…è‡ªå®šä¹‰éŸ³é‡è§†å›¾ window å±‚çº§é«˜äºçŠ¶æ€æ  window å±‚çº§ï¼Œä½†æ˜¯ç”±äºçŠ¶æ€æ æ˜¯å…¨å±€çš„ï¼Œåœ¨é‡æ–°è¿›å…¥åˆ°åº”ç”¨æ—¶ä¼šå‡ºç°çŠ¶æ€æ å±‚çº§é«˜äºéŸ³é‡è§†å›¾ã€‚æ‰€ä»¥å°±ç´¢æ€§ä»…åœ¨åº”ç”¨ä¸º active çš„æƒ…å†µä¸‹æ‰å¤„ç† KVOã€‚ æœ€åä¸€ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯åœ¨è¯­éŸ³ç”µè¯ï¼ˆæˆ–è€…å…¶å®ƒä½¿ç”¨ç³»ç»ŸéŸ³é‡çš„åœºæ™¯ä¸‹ï¼‰æ—¶ï¼Œå»è‡ªå·±åº”ç”¨å†…è°ƒèŠ‚éŸ³é‡æ˜¯æ— æ•ˆï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™éŸ³é‡å…¶å®ä»£è¡¨çš„æ˜¯ç³»ç»Ÿåœ¨å ç”¨ï¼Œç³»ç»Ÿä¼˜å…ˆçº§é«˜äºåº”ç”¨ï¼Œæ‰€ä»¥åœ¨è¿™äº›åœºæ™¯ä¸‹ï¼Œå³ä½¿åœ¨åº”ç”¨å†…è°ƒèŠ‚éŸ³é‡ï¼Œä¹Ÿæ— æ³•è§¦å‘å‡ºè‡ªå·±çš„éŸ³é‡è§†å›¾ã€‚ ç„¶åä¸Šé¢æ‰€æœ‰é—®é¢˜éƒ½è¿åˆƒè€Œè§£äº†ã€‚ æœ€åæ¨èä¸€ä¸ªå¼€æºåº“ï¼šVolumeBar]]></content>
      <categories>
        <category>Tips</category>
      </categories>
      <tags>
        <tag>åŸåˆ›</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pod ä¸­èµ„æºå¼•å…¥æ–¹å¼å¯¹æ¯”]]></title>
    <url>%2F2018%2F03%2F17%2FPod-Resource%2F</url>
    <content type="text"><![CDATA[å†™è¿™ç¯‡åšå®¢èµ·å› æ˜¯ç”±äºå‘¨å››åœ¨çŸ¥è¯†å°é›†å‘äº†ä¸€ä¸ª Tipï¼Œè®² Pod é‡Œé¢ä½¿ç”¨äº† .xcassets ä¼šå¯¼è‡´ Xcode 9 æ‰“å‡ºæ¥çš„åŒ…æ²¡æœ‰ icon çš„è§£å†³æ–¹æ¡ˆã€‚ç„¶åå’Œ @Damonwong å±•å¼€äº†ä¸€ä¸‹è®¨è®ºã€‚å½“ç„¶è¿™æ¡ Tip è®²å¾—ä¸å…¨å¯¹ï¼Œè€Œä¸”è¡¨è¾¾å¾—ä¸æ˜¯å¾ˆæ¸…æ™°ï¼Œæ‰€ä»¥è¿™é‡Œä¸“é—¨å¼€ä¸€ç¯‡æ–‡ç« æ¥è®²ä¸€ä¸‹é‚£ä¸ª Tip æƒ³è¦è¡¨è¾¾çš„æ„æ€ï¼Œæœ€åä¹Ÿä¼šé™„ä¸Šå¯¹åº”çš„ Demoã€‚ä¹Ÿå½“åšä¹‹åè¦å†™çš„æ¨¡å—åŒ–ç³»åˆ—çš„æ–‡ç« å¼€ç¯‡å§ã€‚ é¦–å…ˆæˆ‘ä»¬å…ˆæ¥ç»™å‡ºç»“è®ºï¼š podspec é‡Œé¢å†™èµ„æºæ—¶ï¼Œæœ€å¥½ç”¨ s.resource_bundle è€Œä¸æ˜¯ s.resource åªæœ‰ podspec ä½¿ç”¨ resource ä¸”æ˜ç¡®å†™äº† .xcassets çš„æƒ…å†µä¸‹æ‰ä¼šå¯¼è‡´ Xcode 9 æ‰“å‡ºæ¥çš„åŒ…æ²¡æœ‰ icon ç¯å¢ƒé…ç½®ï¼šXcode 9.2 ã€Cocoapods 1.4.0æœ¬æ–‡æ‰€æ¶‰åŠåˆ°çš„èµ„æºä¸»è¦æ˜¯æŒ‡ png æ ¼å¼çš„å›¾ç‰‡ ä¸‹é¢æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹è¿™ä¸¤ç§æ–¹å¼çš„å…·ä½“æƒ…å†µï¼Œä»¥åŠå„è‡ªçš„ä¼˜åŠ£åŠ¿ï¼Œæœ€åé€šè¿‡ä¸€ä¸ª Demo æ¥éªŒè¯æˆ‘ä»¬ä¸Šé¢ç»™çš„ç»“è®ºã€‚ resource å’Œ resource_bundleresourceé€šè¿‡å®˜æ–¹æ–‡æ¡£æè¿° A list of resources that should be copied into the target bundle. è¿™ç§æ–¹å¼ä¼šå¼•ç”¨çš„æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰èµ„æºæ‹·è´åˆ° target çš„ bundle ä¸­å»ï¼Œå¯ä»¥ç®€å•çš„ç†è§£ä¸º .app ç›®å½•ä¸‹æˆ–è€… .app çš„ Assets.car æ–‡ä»¶ä¸­ï¼ˆå¦‚æœæ˜¯ .xcassets çš„èµ„æºï¼‰ã€‚ Tips: æ³¨æ„ä¸€ä¸‹ä¸Šé¢åŠ ç²—çš„éƒ¨åˆ†ã€‚ è¿™é‡ŒæŠ„ä¸€ä¸‹å®˜ç½‘ä¸Šç»™çš„å‡ ä¸ªç¤ºä¾‹å†™æ³• #å•ä¸ªè·¯å¾„spec.resource = â€˜Resources/HockeySDK.bundleâ€™#å¤šä¸ªè·¯å¾„spec.resources = [â€˜Images/*.pngâ€™, â€˜Sounds/*â€˜] resource_bundleè¿˜æ˜¯ä¸€æ ·ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ Cocoapods å®˜æ–¹æ–‡æ¡£ä¸Šçš„æè¿° This attribute allows to define the name and the file of the resource bundles which should be built for the Pod. They are specified as a hash where the keys represent the name of the bundles and the values the file patterns that they should include. è¿™ç§æ–¹å¼å¯ä»¥å°†æŒ‡å®šè·¯å¾„ä¸‹çš„èµ„æºæ‰“åŒ…æ‰“ =&gt; ä¹‹å‰çš„ key å‘½åçš„ bundle ä¸­ï¼Œè¿™ä¸ª bundle æœ€ç»ˆä¼šè¢«æ‹·è´åˆ° target ä¹Ÿå°±æ˜¯ .app æ ¹ç›®å½•ä¸‹ã€‚å¦‚æœæœ‰æŒ‡å®š .xcassets èµ„æºï¼Œä¼šè¢«æ‰“åŒ…åˆ°ä»¥ key å‘½åçš„ bundle é‡Œçš„ Assets.car æ–‡ä»¶ä¸­ã€‚ Tips: æ³¨æ„ä¸€ä¸‹ä¸Šé¢åŠ ç²—çš„éƒ¨åˆ†ã€‚ å®˜æ–¹ç¤ºä¾‹å†™æ³• #å•ä¸ªè·¯å¾„spec.ios.resource_bundle = { â€˜MapBoxâ€™ =&gt; â€˜MapView/Map/Resources/*.pngâ€™ }#å¤šä¸ªè·¯å¾„ï¼Œç”Ÿæˆå¤šä¸ª bundlespec.resource_bundles = { â€˜MapBoxâ€™ =&gt; [â€˜MapView/Map/Resources/*.pngâ€™], â€˜OtherResourcesâ€™ =&gt; [â€˜MapView/Map/OtherResources/*.pngâ€™] } å¯¹æ¯”å…¶å®ä¸Šé¢å®˜ç½‘ä¸Šçš„æè¿°æˆ‘æ•…æ„æ¼é™„äº†åé¢çš„å‡ æ®µè¯ï¼Œæ–‡æ¡£ä¸Šåœ¨ä¸¤ç§æ–¹å¼ä¸‹éƒ½å¼ºçƒˆ(strongly)æ¨èä½¿ç”¨ resource_bundle çš„æ–¹å¼ã€‚ resource ä¸‹çš„æè¿°We strongly recommend library developers to adopt resource bundles as there can be name collisions using the resources attribute. Moreover, resources specified with this attribute are copied directly to the client target and therefore they are not optimised by Xcode. resource_bundle ä¸‹çš„æè¿°We strongly recommend library developers to adopt resource bundles as there can be name collisions using the resources attribute.The names of the bundles should at least include the name of the Pod to minimise the chance of name collisions. ç»¼åˆä¸Šè¿°æ‰€è¯´ï¼Œå°±æ˜¯ä½¿ç”¨ resource_bundle ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç‚¹å¥½å¤„ï¼š é¿å…å‘½åå†²çªï¼ˆbundle å‘½åæ—¶æœ€å¥½åŒ…å« Pod çš„åå­—æ¥å°½å¯èƒ½é¿å…æ‰å‘½åå†²çªï¼‰ Xcode ä¼šå¯¹èµ„æºåšä¼˜åŒ–ï¼Œæ¯”å¦‚ .xcassets é‡Œçš„å›¾ç‰‡å‹ç¼©ã€Slicingã€ä»¥åŠ @2x/@3x å›¾ç‰‡èµ„æºåˆ†ç¦» æˆ‘ä»¬æ¥å¯¹æ¯”ä¸‹ä¸¤ç§æ–¹å¼ä¸‹æœ€ç»ˆæ‰“åŒ…å‡ºæ¥çš„åº”ç”¨ç›®å½•ç»“æ„ï¼š æ–¹å¼ ç”Ÿæˆçš„ .app ç›®å½• å¯ä»¥çœ‹å‡º resource_bundle çš„å½¢å¼ä¼šç”Ÿæˆå¯¹åº”çš„ bundle(ä¸Šå›¾ä¸­çš„ Pod1.bundle)ï¼Œå¹¶ä¸” .xcassets æœ€ç»ˆä¼šè¢«æ‰“åŒ…åˆ°å¯¹åº” bundle ä¸‹çš„ Assets.car æ–‡ä»¶ä¸‹ï¼ˆè¯¥æ–‡ä»¶å¯ç”¨è¿™ä¸ªå·¥å…·æ‰“å¼€ï¼šiOS-Images-Extractorï¼‰ã€‚è€Œ resource çš„å½¢å¼ï¼Œä¼šæŠŠ .xcassets æ‰“åŒ…åˆ°åº”ç”¨æ ¹ç›®å½•ä¸‹çš„ Assets.car ä¸­ã€‚ è€Œè¦è¯»å–å¯¹åº”çš„å›¾ç‰‡æ—¶ï¼Œresource å¯¹åº”çš„ä»£ç é•¿ä¸‹é¢è¿™æ ·ï¼š 123UIImage *image = [UIImage imageNamed:@"your-image-name" inBundle:[NSBundle bundleForClass:[self class]] compatibleWithTraitCollection:nil]; è€Œ resource_bundle å¯¹åº”çš„è¯»å–ä»£ç å¦‚ä¸‹é¢æ‰€ç¤ºï¼š 123456NSBundle *bundle = [NSBundle bundleForClass:[self class]];NSURL *url = [bundle URLForResource:@"your-bundle-name" withExtension:@"bundle"];NSBundle *targetBundle = [NSBundle bundleWithURL:url];UIImage *image = [UIImage imageNamed:@"your-image-name" inBundle:targetBundle compatibleWithTraitCollection:nil]; é€šè¿‡ä»¥ä¸Šä¸¤ä¸ªä»£ç ç‰‡æ®µï¼Œç›¸ä¿¡å„ä½å·²ç»çŸ¥é“ä»£ç ç‰‡æ®µ1ã€2éƒ½å¯èƒ½å­˜åœ¨å›¾ç‰‡å‘½åå†²çªçš„é—®é¢˜ï¼Œä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ç‰‡æ®µ2çš„å†²çªæ¦‚ç‡è¿œå°äºç‰‡æ®µ1çš„ã€‚å› ä¸ºä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¨¡å—å†…çš„å›¾ç‰‡å‘½åè‚¯å®šæ˜¯ä¸ä¼šå†²çªçš„ï¼Œè€Œæ¨¡å—é—´çš„å›¾ç‰‡çš„å‘½åå°±ä¸å¥½è¯´äº†ã€‚å½“ç„¶å¦‚æœå›¢é˜Ÿé‡Œæœ‰æ˜ç¡®çš„å‘½åè§„èŒƒï¼Œç‰‡æ®µ1å’Œç‰‡æ®µ2éƒ½ä¸ä¼šæœ‰é—®é¢˜ã€‚è™½ç„¶ç‰‡æ®µ2ä»£ç è¾ƒç‰‡æ®µ1ç¨å¤æ‚ä¸€äº›ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬å°†å…¶å°è£…æˆä¸€ä¸ª NSBundle çš„åˆ†ç±»ï¼Œå°±å…å»äº†å†—é•¿çš„å†™æ³•ï¼Œå¯¹äº Storyboard/Xib åŒæ ·é€‚ç”¨ã€‚ 1234567891011121314151617181920212223242526272829// å…·ä½“ä»£ç å¯ä»¥åœ¨ Demo ä¸­æ‰¾åˆ°//.h@interface NSBundle (Pod1Bundle)+ (NSBundle *)pod1_bundle;@end//.m// FakeClass ä»…ä½œå ä½ç¬¦ç”¨ï¼Œå³åªä¸ºåˆ†ç±»ä¸­çš„ `bundleForClass:` æ–¹æ³•æœåŠ¡@interface Pod1FakeClass : NSObject@end@implementation Pod1FakeClass@end@implementation NSBundle (Pod1Bundle)+ (NSBundle *)pod1_bundle &#123; NSBundle *bundle = [self bundleForClass:[Pod1FakeClass class]]; NSURL *url = [bundle URLForResource:@"Pod1" withExtension:@"bundle"]; return [self bundleWithURL:url];&#125;@end// ç‰‡æ®µ2å¯ä»¥ç®€å†™ä¸ºï¼šUIImage *image = [UIImage imageNamed:@"your-image-name" inBundle:[NSBundle pod1_bundle] compatibleWithTraitCollection:nil]; Demoç¬¬ä¸€ä¸ª commit å†™å¥½äº†ä¸¤ä¸ª podspecï¼Œä¸€ä¸ªç”¨ resource_bundle(Pod1)ï¼Œä¸€ä¸ªç”¨ resource(Pod2)ï¼Œç„¶åéƒ½å¼•ç”¨ .xassets èµ„æºï¼Œé‡Œé¢éƒ½æœ‰ä¸€ä¸ªåä¸ºPodçš„å›¾ç‰‡ï¼Œä¸»å·¥ç¨‹ä¹Ÿæœ‰ã€‚åŒºåˆ«åœ¨äº Pod ä¸­çš„å›¾ç‰‡é¡¶éƒ¨ä¼šæœ‰è¯¥ Pod åç§°çš„æ°´å°ã€‚ç„¶åé¡µé¢ä¸Šæœ‰3ä¸ª ImageViewï¼Œç›®å‰åªè®¾ç½®äº†ä¸­é—´é‚£ä¸ª ImageView çš„å›¾ç‰‡ä¸ºä¸»å·¥ç¨‹çš„å›¾ç‰‡ã€‚è¿è¡Œèµ·æ¥ï¼Œä¸€åˆ‡è¡¨ç°æ­£å¸¸ï¼Œå±•ç¤ºå‡ºæ¥çš„å›¾ç‰‡ä¹Ÿç¡®å®æ˜¯ä¸»å·¥ç¨‹çš„å›¾ç‰‡ã€‚ ç¬¬äºŒä¸ª commit åœ¨ä¸»å·¥ç¨‹å†…åˆ†åˆ«è¯»å– Pod1 å’Œ Pod2 çš„åä¸º Pod çš„å›¾ç‰‡ï¼Œç„¶ååˆ†åˆ«å¡åˆ°ä¸Šä¸‹ä¸¤ä¸ª ImageView ä¸­ï¼Œè¿è¡Œèµ·æ¥ï¼Œæœ€ä¸‹é¢é‚£ä¸ª ImageView çš„å›¾ç‰‡å˜æˆä¸»å·¥ç¨‹çš„å›¾ç‰‡äº†ï¼Œè€Œæœ€ä¸Šé¢çš„ ImageView çš„å›¾ç‰‡æ˜¯æ­£å¸¸çš„ï¼ï¼ï¼è¿™å°±æ˜¯æˆ‘ä»¬ä¸Šé¢è¯´åˆ°çš„é‚£ä¸ªé—®é¢˜ï¼Œç”±äº Pod2 ä½¿ç”¨ resource çš„æ–¹å¼ï¼Œ.xcassets ä¸­å›¾ç‰‡æ˜¯ç›´æ¥å’Œä¸»å·¥ç¨‹çš„ .xcassets ä¸­å›¾ç‰‡ä¸€æ ·æ˜¯æ‰“åŒ…åˆ° .app æ ¹ç›®å½•ä¸‹çš„ Assets.car ä¸­ï¼Œå‘½åä¸€è‡´ï¼Œå¯¼è‡´è¢«ä¸»å·¥ç¨‹çš„å›¾ç‰‡ç»™è¦†ç›–æ‰äº†ï¼ˆå¯ä»¥ä½¿ç”¨ä¸Šé¢è¯´åˆ°çš„è§£å‹å·¥å…·è§£å‹ï¼ŒæŸ¥çœ‹æ ¹ç›®å½• .car ä¸‹çš„æ–‡ä»¶å†…å®¹ï¼Œåªæœ‰ä¸»å·¥ç¨‹çš„å›¾ç‰‡ï¼‰ã€‚ ç¬¬ä¸‰ä¸ª commit åŠ ruby-shell åˆ†æ”¯ä¸»è¦è§£å†³åº”ç”¨ icon ä¸ºç©ºçš„é—®é¢˜ã€‚å½“æˆ‘ä»¬ Home é”®å›åˆ°æ¡Œé¢æ—¶ï¼Œå›å‘ç° Demo çš„ icon æ˜¯ç©ºçš„ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜¯æœ‰è®¾ç½® icon çš„ã€‚æ‰€ä»¥æˆ‘ä»¬æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ æ–¹æ¡ˆä¸€ï¼šä¸ä½¿ç”¨ .xcassetsæŠŠå›¾ç‰‡æ”¾åˆ° Pod2 ç›®å½•ä¸‹ï¼Œä¸å†æ”¾åˆ° .xcassets é‡Œé¢ï¼Œç„¶å podspec é‡Œçš„å†™æ³•æ”¹æˆï¼š 1s.resources = ['Pod2/**/*.png'] pod install ä¹‹åå†è·‘ä¸€ä¸‹ï¼Œå‘ç° icon å›æ¥äº†ï¼Œä½†æ˜¯å›¾ç‰‡è¿˜æ˜¯è¢«ä¸»å·¥ç¨‹è¦†ç›–äº†ï¼ŒæŸ¥çœ‹ .app æ–‡ä»¶ï¼Œæˆ‘ä»¬å‘ç°æ ¹ç›®å½•ä¸‹å¤šäº†ä¸¤å¼ å›¾ç‰‡ï¼Œä»–ä»¬æ¥è‡ªäº Pod2 ç›®å½•ä¸‹ã€‚ ç›¸åº”çš„æˆ‘ä»¬çš„è¯»å–ä»£ç å°±éœ€è¦æ”¹æˆä¸‹é¢è¿™ç§å½¢å¼ï¼Œè¿˜éœ€è¦åŒºåˆ† @2x å’Œ @3xï¼Œéå¸¸éº»çƒ¦ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™ç¡®å®èƒ½è¯»åˆ°å¯¹åº”çš„å›¾ç‰‡ 12345678// @2x è¯»å–_podImage = [UIImage imageNamed:@&quot;Pod@2x&quot; inBundle:[NSBundle bundleForClass:[self class]] compatibleWithTraitCollection:nil];// @3x_podImage = [UIImage imageNamed:@&quot;Pod@3x&quot; inBundle:[NSBundle bundleForClass:[self class]] compatibleWithTraitCollection:nil]; æ–¹æ¡ˆäºŒï¼šè„šæœ¬åœ¨ podfile ä¸­åŠ å…¥ä¸‹é¢è¿™ä¸€æ®µè„šæœ¬ 12345678post_install do |installer|copy_pods_resources_path = "Pods/Target Support Files/Pods-ResourceDemo_Example/Pods-ResourceDemo_Example-resources.sh"string_to_replace = '--compile "$&#123;BUILT_PRODUCTS_DIR&#125;/$&#123;UNLOCALIZED_RESOURCES_FOLDER_PATH&#125;"'assets_compile_with_app_icon_arguments = '--compile "$&#123;BUILT_PRODUCTS_DIR&#125;/$&#123;UNLOCALIZED_RESOURCES_FOLDER_PATH&#125;" --app-icon "$&#123;ASSETCATALOG_COMPILER_APPICON_NAME&#125;" --output-partial-info-plist "$&#123;BUILD_DIR&#125;/assetcatalog_generated_info.plist"'text = File.read(copy_pods_resources_path)new_contents = text.gsub(string_to_replace, assets_compile_with_app_icon_arguments)File.open(copy_pods_resources_path, "w") &#123;|file| file.puts new_contents &#125;end ç„¶å pod install ä¹‹åï¼Œè¿è¡Œå³å¯ã€‚ ä»¥ä¸Šä¸¤ç§æ–¹å¼æ‰§è¡Œä¹‹å‰æœ€å¥½ clean ä¸€ä¸‹ï¼Œé˜²æ­¢ Xcode ç¼“å­˜ï¼Œå¯¼è‡´ä»¥ä¸Šæ–¹æ³•æ‰§è¡Œåä¹Ÿä¼šå‡ºç° icon æ¶ˆå¤±çš„æƒ…å†µã€‚ æ€»ç»“ç»¼åˆä»¥ä¸Šï¼Œæˆ‘ä»¬å†æ€»ç»“ä¸€ä¸‹ resource_bundle çš„ä¼˜åŠ¿ï¼š ç»å¤§å¤šæ•°(99.999%)æƒ…å†µä¸‹ä¸ä¼šæœ‰èµ„æºå‘½åå†²çªé—®é¢˜ å¦‚æœå›¾ç‰‡èµ„æºæ”¾åˆ° .xcasset é‡Œé¢ Xcode ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨ä¼˜åŒ–ã€å¯ä»¥ä½¿ç”¨ Slicing ç­‰ï¼ˆè¿™é‡Œä¸ä»…ä»…æŒ‡çš„æ˜¯ resource_bundle ä¸‹çš„ xcassetsï¼Œåªä¸è¿‡ s.resource ä¸­å¦‚æœå¼•ç”¨ä¼šå¯¼è‡´ icon æ¶ˆå¤±çš„é—®é¢˜ï¼‰ã€‚ è‡³äºåŠ£åŠ¿ï¼Œæˆ‘è§‰å¾—æ ¹æœ¬å°±æ²¡æœ‰ï¼Œä¸Šé¢é‚£ä¸ªç¡¬ç¼–ç é—®é¢˜ï¼Œå®Œå…¨å¯ä»¥é€šè¿‡æˆ‘è¯´çš„åˆ†ç±»æˆ–è€…ä½ è‡ªå®šä¹‰å®çš„æ–¹å¼æŠŠè¿™ä¸ªç¡¬ç¼–ç é—®é¢˜ Cover æ‰ã€‚ å¦‚æœè®¤ä¸ºæ–‡ç« ä¸­çš„è§‚ç‚¹æˆ–ç»“è®ºæœ‰é—®é¢˜ï¼Œæ¬¢è¿æŒ‡å‡ºï¼Œä¸€èµ·æ²Ÿé€šæ¢è®¨ã€‚ å‚è€ƒé“¾æ¥ App Icons not included in build from Xcode 9å…³äº Pod åº“çš„èµ„æºå¼•ç”¨ resource_bundles or resources]]></content>
      <categories>
        <category>æ¨¡å—åŒ–</category>
      </categories>
      <tags>
        <tag>åŸåˆ›</tag>
        <tag>Xcode</tag>
        <tag>Pod</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[äº¦æ— å²æœˆå¯å›å¤´]]></title>
    <url>%2F2018%2F02%2F16%2F2017-Summary%2F</url>
    <content type="text"><![CDATA[2018 å³å°†æ¥åˆ°(å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆï¼Œæˆ‘è¯´çš„æ˜¯å†œå†å¹´)ï¼Œè¿™ç¯‡æ–‡ç« çº¯å½“ä¸€ç¯‡æ°´æ–‡ï¼Œåšä¸ª2017çš„å¹´ç»ˆæ€»ç»“ã€‚ å·¥ä½œ æ¥ç¾å›¾å·¥ä½œå·²ç»å¿«4å¹´äº†ï¼ˆç®—ä¸Šå®ä¹ çš„è¯ï¼‰ï¼Œä»ä¸€ä¸ª CollectionView éƒ½ä¸ä¼šç”¨çš„äººï¼Œåˆ°ç°åœ¨æ…¢æ…¢å¾—èƒ½å¤Ÿæ¯”è¾ƒè½»æ¾åº”å¯¹ç°åœ¨çš„å·¥ä½œã€‚ å»å¹´å·¥ä½œä¸Šæœ€æœ‰æˆå°±æ„Ÿçš„ä¸¤ä»¶äº‹æƒ…ï¼š åœ¨ä¸šç•Œçš„å‡ ç§æ¨¡å—åŒ–æ–¹å¼ä¸Šç»“åˆç¾æ‹å®é™…æƒ…å†µè¿›è¡Œäº†ç®€å•çš„å®è·µã€‚å¹´åå†™ç¯‡æ–‡ç« åˆ†äº«ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹å’Œæ€è·¯ã€‚ é…åˆæ¶æ„åŒå­¦è®©ç¾æ‹ç›´æ’­å®ç°äº†çœŸæ­£çš„ç§’å¼€ã€‚ è®²çœŸé™Œé™Œç›´æ’­ç§’å¼€çœŸçš„å¾ˆç‰›é€¼ï¼Œç°åœ¨ç¾æ‹ä¹Ÿèƒ½è¾¾åˆ°è¿™ä¸ªæ°´å¹³äº†ï¼ å¹´ä¸­çš„æ—¶å€™ï¼Œä¹°äº†å‡ æœ¬ä¹¦ï¼Œç›®å‰åªçœ‹äº†å…¶ä¸­ä¸‰æœ¬ï¼Œå¹´åå†ç»§ç»­å§ã€‚12æœˆçš„æ—¶å€™ç¾æ‹å¼€å§‹996ï¼Œè¯´çœŸçš„æœ‰ç‚¹ç´¯ï¼Œæ¯å¤©æ™šä¸Š10ç‚¹å¤šåˆ°å®¶ï¼Œæ´—å®Œæ¾¡å·®ä¸å¤šåˆ°ç¡è§‰æ—¶é—´ï¼Œå¸Œæœ›å¹´åä¸è¦å†ç»§ç»­äº†ğŸ˜‚è¿˜æ˜¯æ¯”è¾ƒæ€€å¿µä¹‹å‰æœ‰åŒä¼‘çš„æ—¥å­ã€‚å¯¹äºå­¦ä¹ çš„æ–¹å¼ä¹Ÿå‘ç”Ÿäº†ä¸€ç‚¹å˜åŒ–ï¼Œä»¥å‰æ€»æ˜¯æƒ³ç€è¦å­¦å¾ˆå¤šï¼Œåˆ—äº†å¾ˆå¤šå¾…å­¦ä¹ é¡¹ï¼Œä½†æ˜¯æœ€åéƒ½æ˜¯ä¸äº†äº†ä¹‹ï¼Œç°åœ¨æ…¢æ…¢å¼€å§‹å¾€æŸä¸€ä¸ªæ–¹å‘å»æ·±å…¥äº†è§£ï¼Œå…¶ä»–çš„åšä¸ªåŸºæœ¬äº†è§£å°± okã€‚ ç”Ÿæ´»éšç€æ¯•ä¸šå­£åˆ°æ¥ï¼Œå’Œå…¬å¸çš„ä¸¤ä¸ªå°é²œè‚‰åˆç§Ÿï¼Œå‘¨æœ«å¶å°”è‡ªå·±åšåšé¥­ï¼Œåˆšå¼€å§‹å…´è¶£æ¯”è¾ƒå¤§ï¼Œåé¢ç”±äº996ï¼ŒåŸºæœ¬ä¸Šä¹Ÿå°±æ²¡æ€ä¹ˆç”¨è¿‡å¨æˆ¿äº†ã€‚ä»Šå¹´å¤å¤©åœ¨å°é²œè‚‰ä»¬çš„å¸¦é¢†ä¸‹ï¼Œå­¦ä¼šäº†ä¸€é¡¹æ±‚ç”ŸæŠ€èƒ½â€”-æ¸¸æ³³ã€‚ç°åœ¨è¿˜ä¸ä¼šæ¢æ°”ï¼Œä¸€å£æ°”åªèƒ½æ¸¸10mï¼Œå§¿åŠ¿æ˜¯ç‹—åˆ¨è¯•ã€‚åŸºæœ¬ä¸Šæ¯ä¸ªæœˆè‡³å°‘ä¼šå’Œä»–ä»¬ä¸€èµ·çœ‹ä¸€éƒ¨ç”µå½±ï¼Œçƒ‚ç‰‡é™¤å¤–ã€‚å›½åº†å’Œå°ä¼™ä¼´ä»¬å»äº†ä¸€è¶Ÿå°æ¹¾ï¼Œæœ¬æ¥å»å¹´å°±è®¡åˆ’å¥½çš„ï¼Œä½†æ˜¯åˆå»é€šè¡Œè¯æ—¶é—´æ¥ä¸åŠå‘äº†ç†Šå“¥ï¼Œæ‰€ä»¥åŸè®¡åˆ’å°±æ¨åˆ°äº†ä»Šå¹´ã€‚å°æ¹¾æ—…ç¨‹æ„Ÿè§‰æœ€æœ‰æ„æ€çš„åœ°æ–¹éç»¿å²›è«å±äº†ï¼Œç¯å²›éª‘äº†åŠå¤©æœºè½¦ï¼Œå‚æ™šæ—¶åˆ†ä¸€èµ·å»æ½œæ°´ã€‚ç¬¬ä¸€æ¬¡æ¯”è¾ƒç´§å¼ ï¼Œåˆ°åå‡ ç±³æ°´ä¸‹çš„æ—¶å€™æ„Ÿè§‰ä¸èˆ’æœï¼Œç„¶åæ‰‹è„šé”™ä¹±ï¼Œè¿˜å¥½æ•™ç»ƒåœ¨èº«è¾¹ï¼Œé©¬ä¸Šæµ®äº†ä¸Šæ¥ï¼Œå·®ç‚¹ GGã€‚åé¢å†ä¸‹å»å°±æ¯”è¾ƒé¡ºåˆ©äº†ï¼Œå¦‚æœåé¢æœ‰æœºä¼šï¼Œå€¼å¾—å†å»ä¸€æ¬¡ã€‚ æ¸¸æˆå‘¨æœ«ä¸€èˆ¬ä¼šå’ŒåŒå­¦ç©ä¸€ç©è‹±é›„è”ç›Ÿï¼ŒS7ä¸–ç•Œèµ›å’ŒåŒäº‹ä»¬åœ¨å®¶é‡Œä¸€èµ·æŠ•å±çœ‹æ¯”èµ›ï¼Œåªæ˜¯å¾ˆå¯æƒœé›¶å° SSG çš„ RNG æ²¡æœ‰èµ¢ä¸‹å¯¹ SKT çš„æ¯”èµ›ã€‚å½“ç„¶ EDG æ˜¯è¢«å–·çš„æœ€æƒ¨çš„ï¼Œä¸è¿‡ iBoy è¿™ä¸ªå°æœ‹å‹å¾ˆçš®ï¼ŒS8å¯ä»¥æœŸå¾…ä¸€ä¸‹ã€‚ 996ä¹‹åè‹±é›„è”ç›Ÿå°±ç©çš„æ¯”è¾ƒå°‘äº†ï¼Œä¸€èˆ¬å°±ä¸­åˆçš„æ—¶å€™åƒä¸€åƒé¸¡ã€‚ ä¸è¿‡ä¸ç®¡ç©ä»€ä¹ˆæ¸¸æˆï¼Œéƒ½å¾ˆèœï¼Œè€Œä¸”æœ‰æ—¶å€™ååº”å¾ˆæ…¢ï¼Œå¯èƒ½ä¸æ˜¯ç©æ¸¸æˆçš„æ–™ï¼Œçº¯å±å¨±ä¹ğŸ˜‚ã€‚å“ˆå“ˆå“ˆå“ˆå“ˆï¼Œåªèƒ½ç”¨è¿™ä¸ªæ¥å®‰æ…°è‡ªå·±äº†ï¼Œæ„Ÿè°¢é˜Ÿå‹çš„ä¸æ€ä¹‹æ©ï¼ï¼ï¼ æŠ€èƒ½æŠ€æœ¯æ–¹é¢ åˆè¯†é€†å‘ å‘ç°é€†å‘è¿˜æ˜¯è›®å¥½ç©çš„ï¼Œä½†æ˜¯åŸºç¡€çŸ¥è¯†ä¸å¤Ÿï¼Œè¿˜æ²¡æœ‰æ·±å…¥ç©ä¸‹å»ï¼Œåªæ˜¯åšäº†ä¸ªç®€å•çš„äº†è§£ã€‚æ”¹å–„äº†ä¸€ä¸‹å¹³æ—¶å†™æ­£å‘ä»£ç çš„æ€è·¯ã€‚ RAC å®è·µ ä¹‹å‰ç»„å†…åŒäº‹ä¸€ç›´åœ¨æ¨å¹¿ï¼Œä½†æ˜¯è‡ªå·±æ²¡æœ‰çœŸæ­£å®è·µè¿‡ï¼Œéƒ½æ˜¯åœç•™åœ¨ä»–çš„åˆ†äº«ä¸Šã€‚ä»Šå¹´æ¥æ‰‹ç¾æ‹ç›´æ’­è¿™ä¸€å—ä¹‹åï¼Œæ…¢æ…¢å¼€å§‹ä½¿ç”¨ï¼Œå¾ˆå¤šå€¼å¾—æ³¨æ„çš„åœ°æ–¹ï¼Œä¹Ÿè¸©äº†ä¸€äº›å‘ï¼Œç›®å‰åªæ˜¯ç®—å¯¹ RAC æœ‰ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ï¼Œä»¥åŠåˆæ­¥å®è·µï¼Œåé¢è¿˜éœ€è¦ç»§ç»­å®è·µï¼Œä»¥åŠå®Œæ•´è¯»ä¸€éæºç ã€‚ ç”Ÿæ´»æ–¹é¢ åšèœ ä¸Šé¢è¯´åˆ°åˆç§Ÿåæœ‰è‡ªå·±åšè¿‡ä¸€æ®µæ—¶é—´é¥­ï¼Œæœ‰ç…§ç€é£Ÿè°±åšï¼Œä¹Ÿæœ‰å›å¿†ç€è€çˆ¸åšèœæ—¶å€™çš„ä¸€äº›æ“ä½œå’Œæ­¥éª¤ã€‚ä»éš¾åƒåˆ°æ…¢æ…¢å˜æˆå‹‰å¼ºèƒ½åƒï¼Œåˆ°åé¢æ¯æ¬¡å¤§å®¶éƒ½èƒ½æŠŠèœåƒå…‰ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§è¿›æ­¥äº†å§ã€‚ æ¸¸æ³³ ä¹‹å‰å¯¹æ¸¸æ³³æ˜¯æŠ—æ‹’çš„ï¼Œä¸»è¦æ˜¯ä¸ä¼šæ¸¸ï¼Œè§‰å¾—å»äº†å¾ˆå°´å°¬ï¼Œåé¢çœ‹äº†å‡ é›†è§†é¢‘æ•™ç¨‹ä»¥åŠå®è·µï¼Œå¼€å§‹å­¦ä¼šäº†ä¸€ä¸ç‚¹ï¼Œèƒ½æœ‰ä¸€ç‚¹ç‚¹è·ç¦»äº†ï¼Œä½†è¿˜æ˜¯ä¸ä¼šæ¢æ°”ã€‚ å±•æœ›èººåœ¨åºŠä¸Šï¼Œæ•²ç€è¿™äº›æµæ°´è´¦ï¼Œå¬ç€å¤–é¢é­ç‚®å£°ï¼Œè¿™çœŸçš„æ˜¯ä¸€ç¯‡å†™äº†â€œä¸€å¹´â€çš„æ–‡ç« ã€‚ 2017å·²ç»è¿‡å»ï¼Œå¸Œæœ›2018è‡ªå·±èƒ½å¤Ÿç»§ç»­æˆé•¿ã€‚]]></content>
      <categories>
        <category>æ‰¯æ·¡é›†</category>
      </categories>
      <tags>
        <tag>æ‚è°ˆ</tag>
        <tag>åŸåˆ›</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Modern Objective-C]]></title>
    <url>%2F2017%2F04%2F21%2FModern-Objective-C%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦ä»‹ç»ä¸€äº› Objective-C çš„ä¸€äº›æ–°ç‰¹æ€§ã€‚ ä»ä¸€ä¸ª Bug æ¥è¯´è¯´ Objective-C ä¸­çš„æŒ‡å®šæ„é€ å™¨æŸå¤©æµ‹è¯•åé¦ˆï¼ŒiOS8 ç‚¹å‡»æŒ‰é’®æ—¶å¼¹å‡ºä¸€ä¸ªåˆ—è¡¨è§†å›¾å‡ºç°å¿…ç°å´©æºƒï¼Œçœ‹äº†ä¸‹å´©æºƒæ—¥å¿—ï¼Œæ˜¯é‡æŒ‡é’ˆå¯¼è‡´å¯¼å‡ºä¹±å´©ï¼Œå…·ä½“æ˜¯ [xxx collectionView:numberOfItemsInSection:] unrecognized selector send to instance xxxxxã€‚è¿ä¸Šè®¾å¤‡è°ƒè¯•ï¼Œå‘ç° setupDataSource èµ°äº†ä¸¤æ¬¡ï¼Œç”±äºè°ƒç”¨æ ˆéå¸¸ç±»ä¼¼ï¼Œä¸€å¼€å§‹æ²¡æ³¨æ„å®ƒè°ƒäº†ä¸¤æ¬¡ï¼Œä¸€ç›´æ²¡æ‰¾åˆ°é—®é¢˜æ‰€åœ¨ã€‚åé¢å„ç§æ–­ç‚¹ä¸Šå»ï¼Œå‘ç° setupDataSource æ–¹æ³•è¢«è°ƒç”¨äº†ä¸¤æ¬¡ï¼Œè¿›ä¸€æ­¥ commonInit è¢«è°ƒç”¨äº†ä¸¤æ¬¡ã€‚æœ€åæŸ¥çœ‹åˆå§‹åŒ–ä»£ç ï¼Œæ‰å‘ç°è°ƒç”¨ convenience init method æ—¶ï¼Œæ²¡æœ‰è°ƒ designed init methodï¼Œå¹¶ä¸”è°ƒå®Œä¹‹ååˆå†è°ƒäº†ä¸€æ¬¡ commonInitã€‚å…·ä½“çœ‹ä¸‹ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839@interface PanelView()@property (nonatomic, strong) UICollectionView *collectionView;@end- (instancetype)initWithCoder:(NSCoder *)aDecoder &#123; if (self = [super initWithCoder:aDecoder]) &#123; [self commonInit]; &#125; return self;&#125;- (instancetype)initWithFrame:(CGRect)frame &#123; if (self = [super initWithFrame:frame]) &#123; [self commonInit]; &#125; return self;&#125;- (instancetype)initWithType:(PanelType)type &#123; if (self = [super init]) &#123; [self commonInit]; self.type = type; &#125; return self;&#125;- (void)commonInit &#123; self.colletionView = ... [self addSubview:self.colletionView]; [self setupDataSource];&#125;- (void)setupDataSource &#123; DataSource *dataSource = [[DataSource alloc] initWithCollectionView:self.collectionView]; dataSource.delegate = self; self.collectionView.dataSource = dataSource; self.dataSource = dataSource;&#125;// å¤–é¢ä½¿ç”¨ initWithType: åšäº†åˆå§‹åŒ– ç”±äºè°ƒäº†ä¸¤æ¬¡ commonInitï¼Œå¯¼è‡´åˆ›å»ºäº†ä¸¤ä¸ª collectionView å’Œ dataSourceï¼Œç”±äºç¬¬ä¸€æ¬¡åˆ›å»ºçš„ dataSource æ²¡æœ‰æŒæœ‰è€…ï¼Œè¢«é‡Šæ”¾ä¸º nilï¼Œè€Œç¬¬ä¸€æ¬¡åˆ›å»ºçš„ collectionView è¢«åŠ åˆ°è§†å›¾å±‚çº§å½“ä¸­è¢« self æŒæœ‰ï¼Œæ‰€ä»¥åœ¨ç¬¬ä¸€ä¸ª collectionView åœ¨æ‰§è¡Œè°ƒç”¨æ•°æ®æºæ–¹æ³•æ—¶ï¼ŒdataSource ä¸º nilï¼Œä½†æ˜¯åœ¨ iOS9 ä¹‹å‰ UICollectionView å’Œ UITableView çš„ delegate å’Œ dataSource å±æ€§ç”¨ assign è€Œé weak ä¿®é¥°ï¼Œå¯¼è‡´è¿™ä¸€å—å†…å­˜è¢«æ±¡æŸ“ï¼Œç»§ç»­è°ƒç”¨æ—¶ä¼šå‡ºç°é‡æŒ‡é’ˆå´©æºƒã€‚ å½’æ ¹ç»“åº•ï¼Œå°±æ˜¯åˆå§‹åŒ–çš„å§¿åŠ¿ä¸å¯¹ã€‚ æ­£ç¡®çš„å§¿åŠ¿åº”è¯¥æ˜¯ï¼š å­ç±»æŒ‡å®šæ„é€ å™¨å¿…é¡»è°ƒç”¨çˆ¶ç±»æŒ‡å®šæ„é€ å™¨ ä¾¿æ·æ„é€ å™¨åªèƒ½é€šè¿‡è°ƒç”¨è‡ªèº«æŒ‡å®šæ„é€ å™¨æ¥å®Œæˆåˆå§‹åŒ– æŒ‡å®šæ„é€ å™¨å¿…é¡»è¦ç”¨ NS_DESIGNATED_INITIALIZER æ ‡ç¤º å¯å‚è€ƒä¸‹å›¾ å›¾ç‰‡å‡ºè‡ª ã€ŠThe Swift Programming Language (Swift 3.0.1)ã€‹ Initialization - Syntax for Designated and Convenience Initializers å°èŠ‚ å…³äºæŒ‡å®šæ„é€ å™¨ï¼ŒiOS è‡ªèº«å†…éƒ¨å®ç°ä¹Ÿæœ‰ä¸€ä¸ª bug UITableViewController subclass designated initializer Crashã€How to subclass UITableViewController in Swiftã€‚iOS8 ä¸‹è‡ªå®šä¹‰ä¸€ä¸ª UIViewController ç»§æ‰¿è‡ª UITableViewControllerï¼Œç„¶åè‡ªå®šä¹‰æŒ‡å®šæ„é€ å™¨ï¼Œä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819// æŒ‡å®šæ„é€ å™¨- (instancetype)initWithTitle:(NSString *)title &#123; if (self = [super initWithStyle:UITableViewStyleGrouped]) &#123; //.... &#125; return self;&#125;- (instancetype)initWithNibName:(nullable NSString *)nibNameOrNil bundle:(nullable NSBundle *)nibBundleOrNil &#123; return [self initWithTitle:nil];&#125;- (instancetype)initWithStyle:(UITableViewStyle)style &#123; return [self initWithTitle:nil];&#125;// å¤–é¢è°ƒç”¨ï¼ŒiOS8 ä¸‹è°ƒç”¨æ­¤æ®µä»£ç ï¼Œå¿…å´©// æ‰€ä»¥ iOS8 æœ€å¥½ä¸è¦ç»§æ‰¿è‡ª UITableViewControllerTestViewController *vc = [[TestViewController alloc] initWithTitle:@"Hello"]; å‡ ä¸ªå°é—®é¢˜ Question 1: instancetype å’Œ id ä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ instancetype èƒ½å¤Ÿåšåˆ°ç±»å‹æ£€æµ‹è€Œ id ä¸è¡Œã€‚å‰è€…ä»…å¯åšæ–¹æ³•è¿”å›å€¼ï¼Œä¸èƒ½ä½œä¸ºå‚æ•°ï¼Œè§ç¤ºä¾‹ä»£ç æ¯”å¦‚å¦‚ä¸‹ä»£ç ï¼š 1234567891011121314151617@interface TestObjectA : NSObject+ (id)createObjectA;- (void)methodA;@end@interface TestObjectB : NSObject+ (instancetype)createObjectB;- (void)methodB;@end[[TestObjectA createObjectA] methodB]; // no compile error or warning but crash[[TestObjectB createObjectB] methodA]; // compile error --&gt; No visible @interface for 'TestObjectB' declares the selector 'methodA' å»¶ä¼¸é—®é¢˜ï¼šä¸ºä»€ä¹ˆ(id)initWithXXX: ä¹Ÿå¯ä»¥åšåˆ°ç±»å‹æ£€æµ‹ï¼Ÿ ç±»æ–¹æ³•åªè¦ä»¥ allocã€new å¼€å¤´å°±ä¼šæœ‰å…³è”è¿”å›ç±»å‹ï¼ˆå³ç±»å‹æ£€æµ‹ï¼‰å®ä¾‹æ–¹æ³•åªè¦ä»¥ initã€autoreleaseã€retainã€self å¼€å¤´å°±ä¼šæœ‰å…³è”è¿”å›ç±»å‹Clang Language Extensionsâ€“Objective-C FeaturesNote: ARC ä¸‹å®æµ‹ï¼Œå®ä¾‹æ–¹æ³•åªæœ‰ init å¼€å¤´çš„æ‰æœ‰å…³è”è¿”å›ç±»å‹ã€‚ Question 2: æ–°å»ºä¸€ä¸ªVC æ–‡ä»¶åŒæ—¶å‹¾é€‰ Also create XIB file åï¼Œåˆå§‹åŒ– VC *vc = [[VC alloc] init] å¾—åˆ°çš„æ˜¯å¦å’Œ initWithNibName:bundle: åˆå§‹åŒ–å¾—åˆ°çš„ UI ä¸€è‡´ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ æ˜¯ä¸€è‡´çš„ï¼Œå› ä¸ºæœ€ç»ˆéƒ½ä¼šè°ƒåˆ°æŒ‡å®šæ„é€ å™¨ initWithNibName:bundle:ï¼Œä½†æ­¤æ—¶ nibName ä¸º nilï¼Œå…³äº nibName çš„ç›¸å…³è®¾ç½®æ–‡æ¡£æ˜¯è¿™ä¹ˆè¯´çš„However, if you do not specify a nib name, and do not override the loadView method in your custom subclass, the view controller searches for a nib file using other means. Specifically, it looks for a nib file with an appropriate name (without the .nib extension) and loads that nib file whenever its view is requested. Specifically, it looks (in order) for a nib file with one of the following names:If the view controller class name ends with the word â€˜Controllerâ€™, as in MyViewController, it looks for a nib file whose name matches the class name without the word â€˜Â€ÂœControllerâ€™, as in MyView.nib.It looks for a nib file whose name matches the name of the view controller class. For example, if the class name is MyViewController, it looks for a MyViewController.nib file. ç®€å•æ¥è¯´ï¼Œå¦‚æœæ²¡è®¾ç½®è¯¥å±æ€§ä¹Ÿæ²¡æœ‰å¤å†™ loadView æ–¹æ³•ï¼Œåˆ™ç³»ç»Ÿæœ‰ä¸€å¥—è‡ªå·±çš„å¯»æ‰¾æœºåˆ¶æ¥çœ‹æ˜¯å¦æœ‰å¯¹åº”çš„ xib æ–‡ä»¶ï¼Œå¦‚æœæœ‰ï¼Œåˆ™åŠ è½½ xib æ–‡ä»¶ã€‚ Question 3: å¦‚ä¸‹ä»£ç è¾“å‡ºçš„æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ é€‰è‡ª ç¥ç»ç—…é™¢objc runtimeå…¥é™¢è€ƒè¯• 123456789101112@interface TestSubclass : TestSuperclass@end@implementation TestSubclass- (instancetype)init &#123; self = [super init]; if (self) &#123; NSLog(@"%@", NSStringFromClass([self class])); NSLog(@"%@", NSStringFromClass([super class])); &#125; return self;&#125;@end è¾“å‡ºçš„éƒ½æ˜¯ TestSubclassï¼Œå› ä¸ºä¸¤è€…çš„ receiver éƒ½æ˜¯ selfã€‚å½“æˆ‘ä»¬ç»™ super å‘æ¶ˆæ¯çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯ç»™ self å‘æ¶ˆæ¯ï¼Œåªä¸è¿‡åœ¨æŸ¥æ‰¾æ–¹æ³•åˆ—è¡¨æ—¶ä¼šè‡ªåŠ¨è·³è¿‡å½“å‰ç±»çš„æ–¹æ³•åˆ—è¡¨ï¼Œè€Œä»çˆ¶ç±»æ–¹æ³•åˆ—è¡¨ä¸­å¼€å§‹æŸ¥æ‰¾ã€‚å½’æ ¹ç»“åº•ï¼Œæœ€åäº§ç”Ÿçš„æ¶ˆæ¯æ˜¯ objc_msgSendSuper(self, @selector(init));ã€‚ Question 4: ä¸ºä»€ä¹ˆæˆ‘ä»¬åˆå§‹åŒ–æ–¹æ³•çš„å†™æ³•éƒ½é•¿è¿™æ ·ï¼Ÿ 1234567891011@interface SomeClass : TestSuperClass@end@implementation- (instancetype)init &#123; if (self = [super init]) &#123; &#125; return self;&#125;@endSomeClass *aInstance = [[SomeClass alloc] init]; æˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢ä»£ç æ‹†æˆä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š [SomeClass alloc] è¿”å›ä¸€ä¸ª SomeClass çš„å®ä¾‹ ç´§æ¥ç€ç»™ æ­¥éª¤1 ç”Ÿæˆçš„å®ä¾‹å‘ init æ¶ˆæ¯ï¼Œæ‰€ä»¥ init æ–¹æ³•ä¸­çš„ self ä¸º æ­¥éª¤1 ç”Ÿæˆçš„å®ä¾‹ [super init] å®é™…ä¸Šè°ƒç”¨çš„æ˜¯çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œåœ¨çˆ¶ç±»çš„æ–¹æ³•ä¸­ï¼Œself ä¾ç„¶æ˜¯ æ­¥éª¤1 ç”Ÿæˆçš„å®ä¾‹ï¼Œå¯¹äºè¿™ä¸€ç‚¹çš„ç†è§£å¾ˆé‡è¦ çˆ¶ç±»çš„ init æ–¹æ³•è¦ä¹ˆåšä¸€äº›åŸºæœ¬çš„åˆå§‹åŒ–å·¥ä½œï¼Œè¦ä¹ˆä¿®æ”¹ selfï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ å›åˆ° SomeClass çš„initæ–¹æ³•ä¸­æ¥ï¼Œæ­¤æ—¶å¾—åˆ°çš„è¦ä¹ˆæ˜¯ æ­¥éª¤1 ç”Ÿæˆçš„å®ä¾‹ï¼Œè¦ä¹ˆæ˜¯æ–°ç”Ÿæˆçš„å®ä¾‹ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åŠ  if åˆ¤æ–­çš„åŸå› ã€‚ æ–°å¢å…³é”®å­—åŠç‰¹æ€§Nullabilitynonnull/_Nonnull è¡¨è¾¾çš„æ„æ€æ˜¯ä¸€æ ·çš„ï¼Œnullable/_Nullable åŒç†ï¼Œåªæ˜¯ä¿®é¥°ç¬¦çš„ä½ç½®ä¸åŒ_Nonnull å’Œ _Nullable çš„ä½ç½®å’Œ Cè¯­è¨€çš„ const å…³é”®å­—ä½ç½®ä¸€è‡´ã€‚ 1234567// å†™æ³•1å’Œ2 è¡¨è¾¾çš„æ„æ€å®Œå…¨ä¸€è‡´// å†™æ³•1- (AAPLListItem * _Nullable)itemWithName:(NSString * _Nonnull)name;@property (copy, readonly) NSArray * _Nonnull allItems;// å†™æ³•2- (nullable AAPLListItem *)itemWithName:(nonnull NSString *)name;@property (copy, readonly, nonnull) NSArray *allItems; å‡ ä¸ªç‰¹ä¾‹ï¼š typedef ç±»å‹ç”±äºå¯ä»¥ä»ä¸Šä¸‹æ–‡ä¸­æ¨æ–­å‡ºå®ƒæ˜¯ç©ºï¼ˆnullableï¼‰æˆ–éç©ºï¼ˆnonnullï¼‰ï¼Œæ‰€ä»¥å†…éƒ¨ä¸éœ€è¦å†™ nullable æˆ– nonnullã€‚ å¤æ‚æŒ‡é’ˆå¿…é¡»æ˜¾å¼å£°æ˜å…¶æ˜¯å¦å¯ä¸ºç©ºï¼Œæ¯”å¦‚æŒ‡å®šä¸€ä¸ªæŒ‡å‘éç©ºå¯¹è±¡çš„å¯ç©ºæŒ‡é’ˆå¯å£°æ˜ä¸º _Nullable id * _Nonnull NSError ** ç±»å‹é€šå¸¸ä¸ºä¸€ä¸ªæŒ‡å‘å¯ç©ºå¯¹è±¡çš„å¯ç©ºæŒ‡é’ˆã€‚ ä¸ºäº†é¿å…é‡å¤å†™ nonnullï¼Œæœ‰ä¸€å¯¹å® NS_ASSUME_NONNULL_BEGIN å’Œ NS_ASSUME_NONNULL_ENDï¼Œè¢«è¿™ä¸¤ä¸ªå®åŒ…è£¹çš„ä»£ç ï¼Œé»˜è®¤éƒ½æ˜¯ nonnullï¼Œå¦‚æœå¯ä¸ºç©ºï¼Œåˆ™éœ€æ˜¾å¼å£°æ˜ä¸º nullable æˆ–è€… _Nullableã€‚ null_resettable: å¯è¢«ç½® nilï¼Œä½†æ˜¯è°ƒç”¨ getter æ—¶åˆä¼šé‡æ–°åˆ›å»ºï¼Œå¯å‚è€ƒ UIViewController çš„ view å±æ€§ æˆ–è€… UIView çš„ tintColor å±æ€§ã€‚ æ›´å¤šå…³äº Nullability å¯å‚è€ƒï¼š Nullability and Objective-CDifference between nullable, __nullable and _Nullable in Objective-C __kindofè¯¥å…³é”®å­—çš„å‡ºç°å¯ä»¥å¾ˆå¥½çš„é¿å…åšå¼ºè½¬ï¼Œæ¯”å¦‚ UIViewã€UITableView çš„å¦‚ä¸‹æ–¹æ³•/å±æ€§ 123456789101112// UIView.h@property(nonatomic,readonly,copy) NSArray&lt;__kindof UIView *&gt; *subviews;- (nullable __kindof UIView *)viewWithTag:(NSInteger)tag;...// UITableView.h- (nullable __kindof UITableViewCell *)cellForRowAtIndexPath:(NSIndexPath *)indexPath;@property (nonatomic, readonly) NSArray&lt;__kindof UITableViewCell *&gt; *visibleCells;// æ— è­¦å‘Šï¼Œä¸éœ€è¦åšå¼ºè½¬UIlabel *textLabel = view.subviews.firstObject; CustomCell *cell = self.tableView.visibleCells.lastObject; Genericsä¸ºäº†æ›´å¥½çš„æ¡¥æ¥ Swiftï¼ŒObjective-C æ–°å¢äº†è½»é‡çº§çš„æ³›å‹æ”¯æŒï¼Œä¹‹æ‰€ä»¥æ˜¯è½»é‡çº§æ³›å‹ï¼Œæ˜¯å› ä¸ºå®ƒåªæ˜¯ç¼–è¯‘æ—¶çš„æ³›å‹ã€‚ç›®å‰ Swift ä»…æ”¯æŒ NSArray,ã€NSDictionaryã€NSSet è¿™ 3 ä¸ªç±»çš„æ³›å‹æ¡¥æ¥ï¼Œå…¶å®ƒç±»(å«è‡ªå®šä¹‰)ï¼Œä¸æ”¯æŒã€‚Using Objective-C Lightweight Generics __covariantå­ç±»å¯èµ‹ç»™çˆ¶ç±» __contravariantçˆ¶ç±»å¯èµ‹ç»™å­ç±»ï¼Œç›®å‰æ²¡æœ‰æƒ³åˆ°é€‚ç”¨çš„åœºæ™¯ï¼Œ__kindof å’Œè¿™ä¸ªæœ‰ç‚¹ç±»ä¼¼ï¼Œä½†æ˜¯åˆä¸ä¸€æ ·ï¼Œ__kindof å¯ç›´æ¥ä¿®é¥°å±æ€§ã€‚æ¯”å¦‚ @property (nullable, nonatomic, strong) __kindof NSObject *object; åå˜å’Œé€†å˜çš„å…·ä½“åŒºåˆ«å¯å‚è€ƒï¼Œsunnyxx çš„åšå®¢2015 Objective-C æ–°ç‰¹æ€§ __attributes__ å‘½ä»¤åŸºæœ¬æ¦‚å¿µ__attribute__ å‘½ä»¤æ˜¯ç”¨æ¥ä¿®é¥° C/C++/Objective-C ä¸­çš„ä»£ç ç‰‡æ®µï¼Œè®©å®ƒä»¬æ‹¥æœ‰é¢å¤–çš„å±æ€§ï¼Œè¿›è€Œä½¿ç¼–è¯‘å™¨åšå‡ºå¯¹åº”çš„ä¼˜åŒ–æˆ–è€…ä¸ºä»£ç è°ƒç”¨è€…æä¾›æœ‰ç”¨çš„ä¸Šä¸‹æ–‡ï¼ˆè­¦å‘Šæˆ–æç¤ºï¼‰ã€‚è¿›ä¸€æ­¥æ¥è®²ï¼Œå°±æ˜¯ __attributes__ å‘½ä»¤ä¸ºæˆ‘ä»¬æä¾›äº†é˜…è¯»ä»£ç çš„ä¸Šä¸‹æ–‡ï¼Œä¾¿äºç¼–è¯‘å™¨æå‰åšå‡ºä¼˜åŒ–ï¼Œè¾¾åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœã€‚ ä»€ä¹ˆæ—¶å€™ç”¨Twitter å®˜æ–¹åšå®¢æ˜¯æ¨èï¼Œèƒ½ç”¨ä¸”å¯ä»¥æä¾›é¢å¤–ä¸Šä¸‹æ–‡çš„åœ°æ–¹å°±å°½é‡ç”¨ã€‚è¿™æ ·ä¸ä»…å¯ä»¥è®©ç¼–è¯‘å™¨åšä¼˜åŒ–ï¼ŒåŒæ—¶å¯ä»¥è®©å…¶ä»–é˜…è¯»ä»£ç çš„äººï¼ˆåŒ…æ‹¬ä½ è‡ªå·±ï¼‰å—ç›ŠåŒªæµ…ã€‚å½“ä½ æƒ³ç”¨å´åˆåœ¨çŠ¹è±«è¯¥ä¸è¯¥ç”¨æ—¶ï¼Œå°±ä¸è¦ç”¨äº†ã€‚ æ€ä¹ˆç”¨è™½ç„¶ä¸Šé¢è¯´åˆ°åœ¨èƒ½å¤Ÿä½¿ç”¨çš„åœ°æ–¹å°½é‡ä½¿ç”¨ï¼Œä½†æ˜¯ä¹Ÿä¸èƒ½ä¹±ç”¨ã€æ»¥ç”¨ã€‚å…·ä½“ä¾‹å­å¯ä»¥å‚è€ƒä¸‹é¢æåˆ°çš„ Twitter å®˜æ–¹åšå®¢ã€‚ æœ€å¼€å§‹æ¥è§¦ __attribute__ å‘½ä»¤æ˜¯åœ¨ PSPDFUIKitMainThreadGuard.mï¼Œç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™ä¸ªçš„æ—¶å€™ä¸€è„¸æ‡µé€¼ï¼Œä»…ä»…ä¸€ä¸ª .m æ–‡ä»¶ï¼Œå°±å¯ä»¥èµ·åˆ°æ£€æµ‹æ˜¯å¦åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„ä½œç”¨ï¼Œè€Œä¸”å¯¹é¡¹ç›®æ¯«æ— ä¾µå…¥ã€‚åé¢çœ‹äº†ä¸‹æºä»£ç ï¼Œç„¶åæ¯ä¸ªæ–¹æ³•éƒ½è®¾ç½®äº†ä¸€ä¸ªæ–­ç‚¹ï¼Œç„¶ååœ¨éä¸»çº¿ç¨‹æ“ä½œ UIï¼Œçœ‹æ–­ç‚¹ä½ç½®ã€‚ç»“æœè¿è¡Œåï¼Œå°±èµ°åˆ°äº†ä¸€ä¸ªæ–¹æ³•ï¼š 12345678910111213141516171819202122// This installs a small guard that checks for the most common threading-errors in UIKit.// This won't really slow down performance but still only is compiled in DEBUG versions of PSPDFKit.// @note No private API is used here.__attribute__((constructor)) static void PSPDFUIKitMainThreadGuard(void) &#123; @autoreleasepool &#123; for (NSString *selStr in @[PROPERTY(setNeedsLayout), PROPERTY(setNeedsDisplay), PROPERTY(setNeedsDisplayInRect:)]) &#123; SEL selector = NSSelectorFromString(selStr); SEL newSelector = NSSelectorFromString([NSString stringWithFormat:@"pspdf_%@", selStr]); if ([selStr hasSuffix:@":"]) &#123; PSPDFReplaceMethodWithBlock(UIView.class, selector, newSelector, ^(__unsafe_unretained UIView *_self, CGRect r) &#123; PSPDFAssertIfNotMainThread(); ((void ( *)(id, SEL, CGRect))objc_msgSend)(_self, newSelector, r); &#125;); &#125;else &#123; PSPDFReplaceMethodWithBlock(UIView.class, selector, newSelector, ^(__unsafe_unretained UIView *_self) &#123; PSPDFAssertIfNotMainThread(); ((void ( *)(id, SEL))objc_msgSend)(_self, newSelector); &#125;); &#125; &#125; &#125;&#125; å…·ä½“ä»£ç å°±ä¸åˆ†æäº†ï¼Œå°±æ˜¯ hook äº†ä¸€äº›å¸ƒå±€æ‰ä¼šè°ƒç”¨çš„å‡½æ•°ï¼Œç„¶ååˆ¤æ–­å…¶æ˜¯å¦åœ¨ä¸»çº¿ç¨‹ã€‚æœ€æœ‰æ„æ€çš„æ˜¯å‰é¢çš„ä¿®é¥°ç¬¦__attribute__((constructor))ï¼Œåé¢æŸ¥é˜…èµ„æ–™æ‰çŸ¥é“ï¼Œè¯¥ä¿®é¥°ç¬¦ä¿®é¥°çš„æ–¹æ³•ï¼Œåœ¨ main() å‡½æ•°æ‰§è¡Œå‰ï¼Œ +load æ–¹æ³•æ‰§è¡Œåã€‚ constructor å’Œ +load éƒ½æ˜¯åœ¨ main å‡½æ•°æ‰§è¡Œå‰è°ƒç”¨ï¼Œä½† +load æ¯” constructor æ›´åŠ æ—©ä¸€ä¸¢ä¸¢ï¼Œå› ä¸º dyldï¼ˆåŠ¨æ€é“¾æ¥å™¨ï¼Œç¨‹åºçš„æœ€åˆèµ·ç‚¹ï¼‰åœ¨åŠ è½½ imageï¼ˆå¯ä»¥ç†è§£æˆ Mach-O æ–‡ä»¶ï¼‰æ—¶ä¼šå…ˆé€šçŸ¥ objc runtime å»åŠ è½½å…¶ä¸­æ‰€æœ‰çš„ç±»ï¼Œæ¯åŠ è½½ä¸€ä¸ªç±»æ—¶ï¼Œå®ƒçš„ +load éšä¹‹è°ƒç”¨ï¼Œå…¨éƒ¨åŠ è½½å®Œæˆåï¼Œdyld æ‰ä¼šè°ƒç”¨è¿™ä¸ª image ä¸­æ‰€æœ‰çš„ constructor æ–¹æ³•ã€‚Clang Attributes é»‘é­”æ³•å°è®° __attribute__ æ˜¯ç¼–è¯‘å™¨å‘½ä»¤ï¼Œåé¢ä¼šè·Ÿéšä¸¤ä¸ªæ‹¬å·å¯¹ï¼Œä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢å®çš„æ­§ä¹‰ï¼Œæ–¹ä¾¿å®çš„å±•å¼€ã€‚ 12345678910111213// +(void)load æ‰§è¡Œä¹‹åï¼Œmain() æ‰§è¡Œä¹‹å‰ï¼Œåªå¯¹ C æ–¹æ³•ç”Ÿæ•ˆ// è‹¥æœ‰å¤šä¸ª constructor ä¸”æƒ³æ§åˆ¶ä¼˜å…ˆçº§çš„è¯ï¼Œå¯ä»¥å†™æˆ __attribute__((constructor(101)))// é‡Œé¢çš„æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼Œ1 ~ 100 ä¸ºç³»ç»Ÿä¿ç•™__attribute__((constructor))__attribute__((objc_requires_super)) // å­ç±»å¤å†™æ—¶ï¼Œå¿…é¡»å…ˆè°ƒç”¨çˆ¶ç±»æ–¹æ³•// ---------- // ç”¨äº @interface æˆ– @protocolï¼Œå°†ç±»æˆ–åè®®çš„åå­—åœ¨ç¼–è¯‘æ—¶æŒ‡å®šæˆå¦ä¸€ä¸ª__attribute__((objc_runtime_name("SomeClass")))@interface Some : NSObject@endNSLog(@"%@", NSStringFromClass([Some class])); // "SomeClass" æ›´å¤šçš„ __attribute__ å‘½ä»¤å¯å‚è€ƒï¼š Twitter å®˜æ–¹åšå®¢ï¼šattribute directives in Objective-CNSHipster å…³äº __attribute__ çš„è®¨è®ºï¼š attribute]]></content>
      <categories>
        <category>è¯»ä¹¦ç¬”è®°</category>
      </categories>
      <tags>
        <tag>Objective-C</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Xcode å¸¸ç”¨æ’ä»¶]]></title>
    <url>%2F2016%2F09%2F17%2FUseful-Xcode-Plugins%2F</url>
    <content type="text"><![CDATA[å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚éšç€ Xcode çš„ä¸€æ­¥æ­¥å˜å¾—å¼º(yong)å¤§(zhong)ï¼Œè®¸å¤šåŠŸèƒ½å·²ç»è¢«é›†æˆåˆ° Xcode ä¸­ï¼Œä½†æ˜¯æ—¥å¸¸å¼€å‘è¿˜æ˜¯ä¼šé‡åˆ°å¾ˆå¤šå°é—®é¢˜ï¼Œå½±å“æ•ˆç‡ï¼Œäºæ˜¯ Xcode plugins ä¾¿æ´¾ä¸Šç”¨åœºäº†ã€‚ä¸‹é¢ä»‹ç»ä¸€ä¸‹è‡ªå·±åœ¨å¼€å‘ä¸­å¸¸ç”¨çš„æ’ä»¶ï¼Œæ’åä¸åˆ†å…ˆåï¼Œä»…æŒ‰å­—æ¯æ’åºã€‚ å…³äº Xcode8 ä¸èƒ½ä½¿ç”¨æ’ä»¶çš„é—®é¢˜ï¼Œå¯ä»¥åœ¨æˆ‘ä¸Šä¸€ç¯‡æ–‡ç« è®©ä½ çš„ Xcode8 ç»§ç»­ä½¿ç”¨æ’ä»¶æ‰¾åˆ°è§£å†³æ–¹æ¡ˆã€‚ Alcatraz è¿™ä¸ªå°±ä¸ç”¨å¤šè¯´äº†å§ï¼Œæ‰€æœ‰æ’ä»¶åŒ…ç®¡ç†å™¨ï¼Œå¿«æ·é”® cmd + shift + 9ã€‚ ATPropertyå¹³æ—¶åœ¨å±æ€§å£°æ˜æ—¶ï¼Œæ€»è¦å†™ä¸€å †çš„è¯¸å¦‚ @property (strong, nonatomic) UIWindow *window;ä¹‹ç±»çš„ï¼Œå‰é¢é‚£ä¸€é•¿ä¸²åœ¨å±æ€§ä¸€å¤šæ—¶ï¼Œå†™èµ·æ¥æŒºç´¯çš„ã€‚è¿™ä¸ªæ’ä»¶æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªç—›ç‚¹è€Œå­˜åœ¨ï¼Œå¿«æ·é”®å¦‚ä¸‹ï¼š å¿«æ·é”® ç»“æœ @t @property (nonatomic, strong) @w @property (nonatomic, weak) @y @property (nonatomic, copy) @a @property (nonatomic, assign) readonly åªéœ€åœ¨ @ åæ’å…¥ r å³å¯ï¼Œæ¯”å¦‚ @rtï¼Œå°±æ˜¯ @property (nonatomic, strong, readonly) Auto-Importer åœ¨å†™ä»£ç è¿‡ç¨‹ä¸­ï¼Œæ¯”å¦‚å¤„åœ¨ line500 çš„æ—¶å€™è¦å¼•å…¥ä¸€ä¸ªæ–°çš„ç±»ï¼Œè¿™ä¸ªæ—¶å€™ä¸å¾—ä¸æ»‘åˆ°é¡¶éƒ¨ï¼Œå»å†™ä¸€æ¬¡ #import&quot;xxxx.h&quot;ï¼Œç„¶ååˆæ»‘å›æ¥ç»§ç»­å†™ä»£ç ï¼Œä¸¥é‡å½±å“æ•ˆç‡ã€‚æ­¤æ—¶ä½ éœ€è¦è¿™ä¸ªæ’ä»¶æ¥è§£å†³è¿™ä¸ªè‹¦æ¼ï¼Œéšä¾¿ä¸€ä¸ªåœ°æ–¹ï¼Œä½¿ç”¨å¿«æ·é”® cmd + ctrl + h æ¥å‘¼å‡ºå¼¹çª—ï¼Œåœ¨æœç´¢æ¡†ä¸­è¾“å…¥æƒ³è¦å¯¼å…¥çš„å¤´æ–‡ä»¶å³å¯ï¼Œæ— éœ€åœ¨æ»‘åˆ°æ–‡ä»¶é¡¶éƒ¨ï¼Œå‚è€ƒä¸Šå›¾ã€‚ CATweakerSenseç”¨çš„ä¸æ˜¯å¾ˆå¤šï¼Œä¸»è¦æ˜¯åœ¨åšåŠ¨ç”»æ¯”è¾ƒæœ‰ç”¨ï¼Œæ—¶é—´ç¼“å†²å‡½æ•°ï¼Œå°†æ—¶é—´æ›²çº¿å¯è§†åŒ–ã€‚ ColorSenseRainbowä¸€ç›®äº†ç„¶ï¼Œé¢œè‰²å¯è§†åŒ–ã€‚ DBSmartPanelsæ™ºèƒ½åŒ–çš„åŒºåŸŸéšè—æ’ä»¶ï¼Œåœ¨è¾“å…¥æ—¶è‡ªåŠ¨éšè—åº•éƒ¨ debugã€å³ä¾§ inspector åŒºåŸŸï¼Œå…·ä½“å¯ä»¥è‡ªå®šä¹‰ã€‚ DXXcodeConsoleUnicodePluginæœ‰æ—¶å€™åœ¨è°ƒè¯•æ—¶ï¼ŒæœåŠ¡ç«¯è¿”å›çš„ä¸­æ–‡å­—ç¬¦åœ¨ debug console ä¸­æ€»æ˜¯æ˜¾ç¤ºæˆ unicodeï¼Œè¿™ä¸ªæ’ä»¶å¯ä»¥å°†å…¶è‡ªåŠ¨è½¬æˆä¸­æ–‡å­—ç¬¦ã€‚å…·ä½“å¯åˆ°å…¶ GitHub ä¸»é¡µæŸ¥çœ‹ç”¨æ³•ã€‚ FastStub æ£€æµ‹å¤´æ–‡ä»¶ã€çˆ¶ç±»ã€åè®®ç­‰ä¸­çš„æ–¹æ³•ï¼Œç„¶åè‡ªåŠ¨åœ¨ .m æ–‡ä»¶æ’å…¥ã€‚å¿«æ·é”® cmd + ctrl + k FuzzyAutocompleteå¿«é€Ÿè¡¥å…¨ã€‚ GitDiffæ£€æµ‹æ–‡ä»¶ä¸­çš„ git çŠ¶æ€ã€‚ RRConstraintsPluginå¯¹ç³»ç»Ÿ Auto Layout çš„ä¸€äº›è¡¥å……ã€‚ SCXcodeSwitchExpander switch æ—¶æ ¹æ®æšä¸¾ç±»å‹ï¼Œè‡ªåŠ¨è¡¥å…¨æ‰€æœ‰æšä¸¾ SCXcodeTabSwitcher æ­¤æ’ä»¶ç”¨äºå­˜åœ¨å¤šä¸ª tab æ—¶åœ¨ tab é—´å¿«é€Ÿåˆ‡æ¢ï¼Œç±»ä¼¼ Chromeã€‚å¿«æ·é”® Cmd + 1...9 åˆ‡æ¢ã€‚ VVDocumenter-Xcodeè¿™ä¸ªä¸ç”¨å¤šè¯´äº†å§ã€‚å¿«é€Ÿæ³¨é‡Šï¼Œç°å·²é›†æˆåˆ° Xcode8ã€‚ XAlignå¯¹é½æ’ä»¶ï¼Œå¯è‡ªå®šä¹‰å¯¹é½æ–¹å¼ã€‚ XQuitå®Œå…¨é€€å‡º(cmd + q) Xcode ä¹‹å‰ï¼Œå¼¹å‡ºä¸€ä¸ªç¡®è®¤æ¡†ï¼Œé˜²æ­¢è¯¯æ“ä½œã€‚ XToDoç”¨äºå·¥ç¨‹ä¸­çš„ä¸€äº›æ ‡æ³¨ï¼ŒåŠå¿«é€ŸæŸ¥æ‰¾è¿™äº›æ ‡æ³¨çš„æ’ä»¶ã€‚ XVimVim æ§å¿…å¤‡ã€‚ ä»¥ä¸Šä¾¿æ˜¯ä¸ªäººå¸¸ç”¨çš„ Xcode æ’ä»¶ï¼Œæ¬¢è¿æ¨èã€‚]]></content>
      <categories>
        <category>Tips</category>
      </categories>
      <tags>
        <tag>Xcode</tag>
        <tag>æ’ä»¶</tag>
        <tag>Xcode8</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®©ä½ çš„ Xcode8 ç»§ç»­ä½¿ç”¨æ’ä»¶]]></title>
    <url>%2F2016%2F09%2F10%2FMake-Your-Xcode8-Great-Again%2F</url>
    <content type="text"><![CDATA[éšç€ iOS10 çš„æ­£å¼ç‰ˆå³å°†å‘å¸ƒï¼ŒXcode8 GM ä¹Ÿåœ¨å‘å¸ƒä¼šåæ”¾å‡ºï¼Œæœ¬æ–‡ä¸ä¼šæ¶‰åŠåˆ° Xcode8 æœ‰å“ªäº›æ›´æ–°ï¼Œè€Œæ˜¯è®°å½•äº†å¦‚ä½•è®© Xcode8 ç»§ç»­æ”¯æŒ Pluginã€‚ Update:2017.4.9 Xcode 8.3 ç”Ÿæˆ XcodeGr8 åï¼ŒXVim å³ä½¿ç”¨è„šæœ¬æ›´æ–°ä¹Ÿä¼šå¤±æ•ˆï¼Œéœ€è¦é‡æ–°ç¼–è¯‘ä¸€æ¬¡ã€‚ä¸‹è½½ XVim åˆ°æœ¬åœ°åï¼Œéœ€è¦åˆ é™¤åˆ é™¤å¦‚ä¸‹å‡ ä¸ªæ–‡ä»¶ï¼š IDEPlaygroundEditor+XVim.hIDEPlaygroundEditor+Xvim.måŒæ—¶å±è”½æ‰ XVim/XVimHookManager.m é‡Œé¢å¯¹ä¸Šé¢ä¸¤ä¸ªæ–‡ä»¶çš„å¼•ç”¨å’Œè°ƒç”¨ è¯¦æƒ…å‚è€ƒè¿™ä¸ª issue: Build failure with Xcode 8.3 2016.10.8å¦‚æœä½ çš„ XcodeGr8 æ—¶ä¸æ—¶å°±è½¬èŠèŠ±å¡æ­»ï¼Œå¯ä»¥è¯•ä¸‹è¿™ç§æ–¹å¼ï¼šæ‰“å¼€ç³»ç»Ÿåå¥½è®¾ç½®-&gt;å®‰å…¨æ€§ä¸éšç§-&gt;é€šè®¯å½•-&gt;å°† Xcode å‰é¢çš„å‹¾å»æ‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè§£å†³æ–¹æ¡ˆæ¥è‡ª Xvim çš„è¿™ä¸ª issueã€‚ 2016.9.16çœ‹åˆ° GitHub ä¸Šæœ‰ä¸€ä¸ª repo å¯ä»¥ä¸€å¥å‘½ä»¤å³å¯è§£å†³æœ¬æ–‡æåˆ°çš„æ‰€æœ‰é—®é¢˜ update_xcode_pluginsï¼Œæ²¡æœ‰äº²æµ‹ï¼Œå¦‚æœè§‰å¾—æœ¬æ–‡æ–¹æ³•æ¯”è¾ƒéº»çƒ¦ï¼Œå¯ä»¥ä¸€è¯•ã€‚ æˆ‘ä¸ªäººå¸¸ç”¨çš„ Xcode æ’ä»¶å¯ä»¥å‚è§è¿™ç¯‡æ–‡ç« Xcode å¸¸ç”¨æ’ä»¶ã€‚ ç›¸ä¿¡å„ä½å·²ç»æœ‰å°è¯•è¿‡ Xcode-beta äº†ï¼Œä½†æ˜¯ä¼šå‘ç°ä¹‹å‰æ‰€æœ‰çš„æ’ä»¶éƒ½å¤±æ•ˆäº†ã€‚ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯å’Œä¹‹å‰ä¸€æ · Xcode å‡çº§äº†ï¼Œéœ€è¦æ›´æ–° Xcode info.plsit ä¸­çš„ DVTPlugInCompatibilityUUID,äºæ˜¯è¿è¡Œäº†å¦‚ä¸‹å‘½ä»¤ï¼Œå…·ä½“ä¿®å¤åŸç†å’Œæ–¹æ¡ˆå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  Xcodeå‡çº§åæ’ä»¶å¤±æ•ˆçš„åŸç†ä¸ä¿®å¤åŠæ³•ã€‚ 1find ~/Library/Application\ Support/Developer/Shared/Xcode/Plug-ins -name Info.plist -maxdepth 3 | xargs -I&#123;&#125; defaults write &#123;&#125; DVTPlugInCompatibilityUUIDs -array-add `defaults read /Applications/Xcode-beta.app/Contents/Info.plist DVTPlugInCompatibilityUUID` ç»“æœè¿˜æ˜¯æ— æ•ˆï¼Œå» Github ä¸Šçœ‹ï¼Œæœç„¶ä¸€å †äººé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥çœ‹ä¸‹è¿™ä¸ª issueã€‚ç”±äº Xcode8 æ²¡äº†æ’ä»¶æ”¯æŒï¼Œæˆ‘ç”¨çš„æ—¶å€™å‹‰å¼ºè¿˜èƒ½ä¹ æƒ¯ï¼Œä¸€ä¸ªç”¨ä¹ æƒ¯äº† Xvim çš„åŒäº‹è¡¨ç¤ºä¸èƒ½å¿ï¼Œäºæ˜¯å°±å»åˆ° XVim çœ‹æœ‰æ²¡æœ‰æè¿™ä¸ª issueï¼Œæœç„¶ä¹Ÿæ˜¯æœ‰ä¸€å †äººæåˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…ä¹Ÿç»™å‡ºäº†å¯¹åº”çš„è§£å†³æ–¹æ¡ˆï¼Œæ‘˜å½•æœ€ä¸»è¦çš„ä¸€æ®µå¦‚ä¸‹ï¼š With Xcode 8 and above, youâ€™ll be asked if you want to remove code singature from Xcode. It is required to make the XCode load XVim. So if you are OK just type â€˜yâ€™ to proceed and remove code signature from your Xcode. ä½†æ˜¯æˆ‘å¹¶æ²¡æœ‰æŒ‰ç…§è¿™ç§æ–¹å¼æ¥æ“ä½œï¼Œè€Œæ˜¯ç»“åˆè¿™ä¸ª issue ä¸­çš„è§£å†³æ–¹æ¡ˆï¼Œæ€»ç»“èµ·æ¥æ­¥éª¤å¦‚ä¸‹ï¼š ç¼–è¯‘ MakeXcodeGr8Again å¹¶ä¸”å¯¼å‡ºå…¶ product (å…³äº MakeXcodeGr8Againï¼Œä¸‹æ–‡ä¼šè¯¦ç»†è¯´åˆ°)ã€‚ é€€å‡º Xcode8ï¼ŒåŒæ—¶è¿è¡Œåˆšåˆšå¯¼å‡ºçš„ MakeXcodeGr8Againï¼Œå°† Xcode8 æ‹–å…¥å…¶ä¸­ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´(3~10åˆ†é’Ÿ)ã€‚ ç­‰èŠèŠ±è½¬å®Œåï¼Œåº”ç”¨ç¨‹åºæ–‡ä»¶å¤¹ä¸‹ä¼šç”Ÿæˆä¸€ä¸ª XcodeGr8 çš„åº”ç”¨ï¼Œè¿è¡Œå‘½ä»¤ sudo xcode-select -s /Applications/XcodeGr8.app/Contents/Developer å°† Xcode å¼€å‘è·¯å¾„æŒ‡å‘åˆšç”Ÿæˆçš„ XcodeGr8ã€‚ æ—¢ç„¶ Xcode8 çš„ç­¾åå·²è¢«ç§»é™¤ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç»§ç»­ä½¿ç”¨ä¸Šé¢çš„ä¿®å¤æ’ä»¶å¤±æ•ˆä»£ç ã€‚ä½†æ˜¯ä¸Šé¢çš„è„šæœ¬è¦ç¨å¾®æ”¹ä¸€ä¸‹å°±æ˜¯æŠŠ Xcode.app æ¢æˆ XcodeGr8.app å³å¯ã€‚ä»£ç å¦‚ä¸‹ï¼š 1find ~/Library/Application\ Support/Developer/Shared/Xcode/Plug-ins -name Info.plist -maxdepth 3 | xargs -I&#123;&#125; defaults write &#123;&#125; DVTPlugInCompatibilityUUIDs -array-add `defaults read /Applications/XcodeGr8.app/Contents/Info.plist DVTPlugInCompatibilityUUID` ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹æ­¥éª¤1æåˆ°çš„ MakeXcodeGr8Againï¼Œå…¶ ReadMe ä¹Ÿæœ‰å¯¹åº”çš„ä»‹ç»ã€‚è¿™é‡Œå¤§æ¦‚æ‘˜å½•ä¸€ä¸‹: è‹¹æœä¸ºäº†é¿å…ç±»ä¼¼ Xcode Ghost ğŸ‘» äº‹ä»¶çš„å†æ¬¡å‘ç”Ÿï¼ŒXcode8 ç¦ç”¨äº†æ’ä»¶æœºåˆ¶ï¼Œè€Œå¼€æ”¾äº†å¦ä¸€ç§å½¢å¼ï¼šSource Editor extensionsï¼Œä½†æ˜¯è¿™ç§å½¢å¼å±€é™æ€§å¤ªå¤§ã€‚MakeXcodeGr8Again åªæ˜¯å»é™¤äº†å®ƒçš„ç­¾åï¼Œè¿™æ ·ä½¿å¾— Xcode8 ä¹Ÿå¯ä»¥ç»§ç»­ä½¿ç”¨æ’ä»¶äº†ã€‚ç”±äºç­¾åè¢«ç§»é™¤ï¼Œæ‰€ä»¥å®ƒçš„å®‰å…¨æ€§åˆé‡å› Xcode7 æ—¶ä»£ï¼Œä¹Ÿå°±æ˜¯è¿˜æœ‰å¯èƒ½å—åˆ°ç±»ä¼¼ Xcode Ghost çš„æ”»å‡»ã€‚æ‰€ä»¥ä¸æ¨èç”¨ XcodeGr8 æ¥æäº¤åº”ç”¨åˆ° Appstoreã€‚Use at your own risk. PSï¼šå¯èƒ½é‡åˆ°çš„é—®é¢˜ 1.ç”Ÿæˆäº† XcodeGr8 ä¹‹åï¼Œæ‰“ä¸å¼€ã€‚ è§£å†³æ–¹æ³•ï¼šé‡å¯ã€‚ 2.å¦‚æœä¹‹å‰å¯¹å…¶å®ƒç‰ˆæœ¬çš„ Xcode-beat ä¹Ÿæœ‰ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå†å¯¹ Xcode8 GM ä¹Ÿæ˜¯ç”¨è¯¥æ–¹å¼å¯èƒ½ MakeXcodeGr8Again è¿™ä¸ª APP ä¼šä¸€ç›´é—ªé€€ã€‚ è§£å†³æ–¹æ³•ï¼šå¸è½½ä¹‹å‰ç”Ÿæˆçš„ XcodeGr8ï¼Œå†é‡è¯•ã€‚å¸è½½åè®°å¾—å°†å¼€å‘è·¯å¾„é‡æ–°æŒ‡å›åŸæ¥çš„è·¯å¾„ï¼Œå³ sudo xcode-select -s /Applications/Xcode.app/Contents/Developerã€‚å¦‚æœè¿™ç§æ–¹å¼è¿˜ä¸è¡Œï¼Œå¸è½½æ‰€æœ‰ç‰ˆæœ¬çš„ Xcodeï¼Œç„¶åå†å®‰è£… GM ç‰ˆï¼Œé‡å¤ä¸Šè¿°æ­¥éª¤ã€‚ PPSï¼šå¦‚æœè¦å¸è½½ XcodeGr8ï¼Œè®°å¾—å°†é‡æ–°å¼€å‘è·¯å¾„ç½®å›åˆå§‹çŠ¶æ€ã€‚ æœ€åï¼Œé‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼šä¸è¦ä½¿ç”¨ XcodeGr8 æ‰“åŒ…ä¸Šä¼  Appstoreï¼Œæœ€å¥½ä½¿ç”¨æœåŠ¡å™¨æ‰“åŒ…ï¼Œä¿è¯æœåŠ¡å™¨ Xcode æ˜¯ Appstore ä¸‹è½½çš„ï¼ï¼ï¼ä¸è¦ä½¿ç”¨ XcodeGr8 æ‰“åŒ…ä¸Šä¼  Appstoreï¼Œæœ€å¥½ä½¿ç”¨æœåŠ¡å™¨æ‰“åŒ…ï¼Œä¿è¯æœåŠ¡å™¨ Xcode æ˜¯ Appstore ä¸‹è½½çš„ï¼ï¼ï¼ä¸è¦ä½¿ç”¨ XcodeGr8 æ‰“åŒ…ä¸Šä¼  Appstoreï¼Œæœ€å¥½ä½¿ç”¨æœåŠ¡å™¨æ‰“åŒ…ï¼Œä¿è¯æœåŠ¡å™¨ Xcode æ˜¯ Appstore ä¸‹è½½çš„ï¼ï¼ï¼]]></content>
      <categories>
        <category>Tips</category>
      </categories>
      <tags>
        <tag>Xcode</tag>
        <tag>æ’ä»¶</tag>
        <tag>Xcode8</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS Animations by Tutorials 2.0 ç¬”è®°]]></title>
    <url>%2F2016%2F08%2F27%2FNote-for-iOS-Animations-by-Tutorials%2F</url>
    <content type="text"><![CDATA[è¿™æœ¬ä¹¦ä¸»è¦åˆ†æˆä¸ƒä¸ªéƒ¨åˆ†ï¼ŒäºŒåä¸ƒä¸ªç« èŠ‚ï¼Œæ¶µç›–äº†ä»åº•å±‚çš„ Core Animation åˆ°ä¸Šå±‚çš„ UIView çš„åŠ¨ç”»å°è£…ï¼ŒAutoLayout åŠ¨ç”»ä»¥åŠ ViewController ä¹‹é—´çš„è½¬åœºåŠ¨ç”»ã€‚æœ€åé€‰æ‹©äº†ä¸¤ä¸ªå¼€æºåŠ¨ç”»åº“ï¼ˆEasy Animationã€popï¼‰è¿›è¡Œå®è·µã€‚æœ¬ç¯‡æ–‡ç« ä¸»è¦æ˜¯åœ¨é˜…è¯»ã€å­¦ä¹ è¿‡ç¨‹ä¸­çš„ä¸€äº›ç¬”è®°ï¼Œç•™ä¸‹è®°å½•ï¼Œæ—¥åå¿˜è®°å¯ä»¥å†æ¥ç¿»çœ‹ã€‚ Section â…  View Animationè¿™éƒ¨åˆ†ä¸»è¦æ˜¯å…³äº UIView çš„åŠ¨ç”»ï¼ŒUIView å±‚æ¬¡çš„åŠ¨ç”»æ˜¯ä¸€äº›ç»è¿‡å°è£…çš„ä¸Šå±‚ APIï¼Œç®€å•ä½†æ˜¯å®ç”¨ã€‚åŸºæœ¬éƒ½æ˜¯æ—¥å¸¸ç”¨åˆ°çš„ï¼Œæ¯”å¦‚ä½ç½®ã€å¤§å°ã€é€æ˜åº¦ã€æ—‹è½¬ã€å…³é”®å¸§åŠ¨ç”»ç­‰ç­‰ï¼Œæ‰€ä»¥æ²¡å•¥å¥½è®°å½•çš„ã€‚ View ä¹‹é—´çš„è¿‡æ¸¡è½¬åœºä¸»è¦æ˜¯ä½¿ç”¨å¦‚ä¸‹ä¸¤ä¸ªæ–¹æ³•: 12345+ (void)transitionWithView:(UIView *)view duration:(NSTimeInterval)duration options:(UIViewAnimationOptions)options animations:(void (^ __nullable)(void))animations completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(4_0);// toView added to fromView.superview, fromView removed from its superview+ (void)transitionFromView:(UIView *)fromView toView:(UIView *)toView duration:(NSTimeInterval)duration options:(UIViewAnimationOptions)options completion:(void (^ __nullable)(BOOL finished))completion NS_AVAILABLE_IOS(4_0); Section â…¡ Auto Layoutè¿™éƒ¨åˆ†ä¸»è¦æ˜¯ Auto Layout çš„ç›¸å…³åŠ¨ç”»ï¼Œé¦–å…ˆåŸºæœ¬ä»‹ç»äº†å®ƒçš„ä½¿ç”¨ï¼Œç„¶åé€šè¿‡åŒä¸€ä¸ª Demo å±‚å±‚é€’è¿›ã€‚æ€»å¾—æ¥è¯´ï¼Œä¸ç®¡æ˜¯æ‰‹å†™è¿˜æ˜¯ IB,å¸ƒå±€è™½ç„¶çœ‹ä¼¼é™æ€çš„ï¼Œä½†æ˜¯å®ƒä¹Ÿæ˜¯èƒ½åšåŠ¨ç”»çš„ã€‚ è¿™ä¸€éƒ¨åˆ†çš„åŠ¨ç”»ï¼Œæ— éå°±æ˜¯æ”¹äº†çº¦æŸï¼Œç„¶åæŠŠ [view layoutIfNeeded] æ”¾åˆ°åŠ¨ç”» block é‡Œé¢ã€‚ä¸è¿‡åœ¨è¿™é‡Œå­¦ä¼šäº†ä¸€æ‹›ï¼Œå°±æ˜¯åœ¨ IB é‡Œé¢å¯ä»¥ä¸ºçº¦æŸè®¾ç½®æ ‡è¯†ï¼ˆidentifierï¼‰æœ‰ç‚¹ç±»ä¼¼äº view çš„ tagã€‚ Section â…¢ Layer Animationè¿™ä¸€éƒ¨åˆ†é€šè¿‡å‡ ä¸ª Demo æ¥ç€é‡ä»‹ç» CALayer åŠå…¶å‡ ä¸ªå¸¸ç”¨çš„å­ç±»ã€CAAnimation åŠå…¶å­ç±»ã€‚å…¶ä¸­ä½¿ç”¨ CAShapeLayerã€CAGradientLayerã€CAReplicatorLayer çš„å®ä¾‹éƒ½æ¯”è¾ƒæœ‰è¶£ã€‚å½“ UIView çš„é‚£ä¸€å¥—åŠ¨ç”» API å·²ç»æ— æ³•æ»¡è¶³éœ€è¦æ—¶ï¼Œè¿™ä¸ªæ—¶å€™åº”è¯¥è½¬å‘æ›´ä¸ºåº•å±‚çš„ Core Animationã€‚UIView çš„é‚£ä¸€å¥—åŠ¨ç”» API å½’æ ¹ç»“åº•ä¹Ÿæ˜¯å¯¹ Core Animation çš„å°è£…ã€‚è¯´ç™½äº†ï¼ŒUIView æ˜¯ CALyaer çš„ delegate.ä¸¤è€…çš„å…·ä½“åŒºåˆ«å¦‚ä¸‹: UIView CALayer æ‹¥æœ‰å¤æ‚çš„è§†å›¾å¸ƒå±€åŠå±‚çº§ç­‰ è¾ƒç®€å•çš„å±‚çº§ç»“æ„ï¼Œæ‰€ä»¥èƒ½å¿«é€Ÿå¸ƒå±€åŠç»˜åˆ¶ å¯äº¤äº’ ä¸å¯äº¤äº’ åˆ©ç”¨ CPU åœ¨ä¸»çº¿ç¨‹åšä¸€äº›è‡ªå®šä¹‰ç»˜åˆ¶åŠå…¶å®ƒé€»è¾‘ é»˜è®¤æ²¡æœ‰è‡ªå®šä¹‰é€»è¾‘ï¼Œç›´æ¥ä½¿ç”¨ GPU ç»˜åˆ¶åŠç¼“å­˜ çµæ´»ã€å®ç”¨ - è¿™é‡Œä½œè€…ç»™å‡ºäº†é€‰æ‹© UIView è¿˜æ˜¯ Core Animation æ¥åšåŠ¨ç”»çš„ä¸€äº›å»ºè®®ï¼š choose view animations any time you can to do the job; you will know when you need more performance or flexibility and have to switch to layer animations instead.Donâ€™t stress yourself about it though, because you can mix and match view and layer animations freely. ç®€å•æ¥è¯´å°±æ˜¯åœ¨ UIView æ»¡è¶³éœ€æ±‚çš„æ—¶å€™å°½é‡ä½¿ç”¨ UIViewï¼Œå½“è¿½æ±‚æ›´å¥½çš„æ€§èƒ½åŠçµæ´»æ€§æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨ Core Animation.å½“ç„¶ï¼Œä¸¤è€…ä¹Ÿå¯ä»¥æ··åˆä½¿ç”¨ã€‚ fillModeè¿™é‡Œå€Ÿç”¨ä¹¦ä¸­çš„å‡ å¼ å›¾æ¥é˜æ˜ä¸€ä¸‹å„ç§æ¨¡å¼ kCAFillModeRemoved é»˜è®¤æ¨¡å¼ï¼šåŠ¨ç”»æ‰§è¡Œå®Œæ¯•åæ¢å¤åŸæ · kCAFillModeBackwards åŠ¨ç”»å¼€å§‹å‰å±•ç¤ºç¬¬ä¸€å¸§ kCAFillModeForwards åŠ¨ç”»ç»“æŸå layer ç»´æŒæœ€åä¸€å¸§çš„çŠ¶æ€ kCAFillModeBoth æ˜¯ä¸Šé¢ä¸¤ç§æ¨¡å¼çš„ç»“åˆï¼ŒåŠ¨ç”»å¼€å§‹å‰ç»´æŒç¬¬ä¸€å¸§ï¼ŒåŠ¨ç”»ç»“æŸåç»´æŒæœ€åä¸€å¸§ Layer å¼¹æ€§åŠ¨ç”»è¿™ä¸€èŠ‚ä»¥é’Ÿæ‘†ä¸¾ä¾‹ï¼Œæ¥è§£é‡Šå¼¹æ€§é˜»å°¼åŠ¨ç”»çš„ç›¸å…³å±æ€§ã€‚ damping é˜»å°¼ï¼Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯è¿™ä¹ˆç¿»è¯‘ï¼Œä¸»è¦æ˜¯ç”±ç©ºæ°”æ‘©æ“¦ã€æœºæ¢°æ‘©æ“¦ä»¥åŠå…¶å®ƒå¤–ç•Œé˜»åŠ›é€ æˆçš„ã€‚ mass æƒ¯æ€§ï¼Ÿç‰©ä½“çš„è´¨é‡è¶Šå¤§ï¼ŒæŒ¯è¡æ—¶é—´è¶Šé•¿ã€‚ stiffness é‡åŠ›åŠ é€Ÿåº¦ï¼ˆGï¼‰ initial velocity åˆå§‹é€Ÿåº¦ï¼Œå¼€å§‹è¿åŠ¨å‰ï¼Œå¤–ç•Œçš„æ¨ï¼ˆæ‹‰åŠ›ï¼‰äº§ç”Ÿçš„é€Ÿåº¦ æŸäº›æƒ…å†µä¸‹ï¼ŒUIView çš„å¼¹æ€§é˜»å°¼åŠ¨ç”»çœ‹èµ·æ¥èƒ¡æ¯”è¾ƒç”Ÿç¡¬ï¼Œå› ä¸ºåœ¨æŒ‡å®šçš„ duration å†…æ— æ³•åœä¸‹æ¥ï¼Œè€Œè¢«ç³»ç»Ÿå¼ºåˆ¶åœä¸‹æ¥ï¼Œæ‰€ä»¥çœ‹èµ·æ¥å¾ˆç”Ÿç¡¬ã€‚å°±å¦‚ä¸‹å›¾ï¼š å¦‚æœ duration ä¸º0.25ï¼Œæ­¤æ—¶æœ¬åº”è¯¥è¿˜æœ‰æŒ¯è¡ï¼Œä½†æ˜¯åŠ¨ç”»æ—¶é—´å·²åˆ°ï¼Œåªèƒ½å¼ºåˆ¶åœæ­¢æŒ¯è¡ï¼Œè¿›è€Œä½¿åŠ¨ç”»çœ‹èµ·æ¥ç•¥å¾®ç”Ÿç¡¬ã€‚æ‰€ä»¥ CASpringAnimation é‡Œé¢æœ‰ä¸€ä¸ªå±æ€§å«åš settlingDuration,è¯¥å±æ€§è¡¨ç¤ºæ‰€æœ‰åŠ¨ç”»å‚æ•°è®¾å®šå¥½ä¹‹åï¼ŒæŒ¯è¡å®Œæˆæ˜¯æ‰€éœ€æ—¶é—´ï¼Œå¦‚æœå°† duration è®¾ç½®æˆè¿™æ ·ï¼Œé‚£ä¹ˆåŠ¨ç”»çœ‹èµ·æ¥å°±ä¼šå¾ˆè‡ªç„¶ã€‚ å‹æƒ…æç¤ºï¼šè¯·åœ¨è®¾ç½®å¥½æ‰€æœ‰å¼¹æ€§æŒ¯è¡å‚æ•°ä¹‹åå†è®¾ç½® duration. Section â…£ 3D Animationsè¿™éƒ¨åˆ†ä¸»è¦é€šè¿‡ä¸€ä¸ªä¾§æ‹‰èœå•çš„ Demo è®²è§£äº† 3D åŠ¨ç”»è¯¥å¦‚ä½•å®ç°ã€‚å…³é”®è¿˜æ˜¯åœ¨äº CATransform3D ä¸­çš„ m34 ä»¥åŠé…åˆæ”¹å˜ anchor point,è¦æƒ³è®©è§†å›¾çœ‹èµ·æ¥å…·æœ‰ 3D é€è§†æ•ˆæœï¼Œå¯ä»¥å°† m34 è®¾ç½®ä¸º -1.0 / [camera distance], åˆ†æ¯ä»£è¡¨ç›¸æœºç¦»è§†å›¾çš„è·ç¦». å…³äºè·ç¦»é€‰å€¼ä¸é€è§†æ•ˆæœçš„æ˜æ˜¾ç¨‹åº¦å¯å‚è§ä¸‹è¡¨ï¼š distance 0.1~500 å¤±çœŸè¾ƒä¸¥é‡ 700~2000 æ•ˆæœæœ€å¥½ï¼Œé€¼çœŸ &gt;2000 å‡ ä¹æ²¡æœ‰é€è§†æ•ˆæœ Section â…¤ Further Types of Animationsè¿™éƒ¨åˆ†ä¸»è¦æ˜¯è®²ä¸€äº›å…¶å®ƒåŠ¨ç”»çš„å»¶ä¼¸ï¼Œæ¯”å¦‚ç²’å­åŠ¨ç”»ã€ImageView çš„å¸§åŠ¨ç”»ã€‚ç²’å­åŠ¨ç”»ä¸»è¦ä½¿ç”¨ CAEmitterLayer æ¥åšï¼Œå…·ä½“ç»†èŠ‚å¯ä»¥å‚è€ƒ CAEmitterLayer çš„ APIã€‚å¸§åŠ¨ç”»ä¸»è¦æ˜¯è®²è§£ UIImageView å…³äºä½¿ç”¨å›¾ç‰‡æ•°ç»„äº§ç”Ÿå¸§åŠ¨ç”»çš„æ•ˆæœï¼ŒåŸºæœ¬å°±æ˜¯æ”¹å˜å…¶ animationDuration æ¥è¾¾åˆ°æ§åˆ¶å¸§ç‡çš„æ•ˆæœã€‚ Section â…¥ View Controller Transitionsè¿™ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯å°†è§†å›¾æ§åˆ¶å™¨ä¹‹é—´è¿‡æ¸¡çš„è½¬åœºæ•ˆæœåŠ¨ç”»ã€‚å…³äºè¿™é‡Œï¼Œä¸å†è¿‡å¤šè®°å½•ï¼Œæ¯•ç«Ÿå…³äº VC ä¹‹é—´çš„è½¬åœºæ•ˆæœ GitHub ä¸Šä¸€æŠ“ä¸€å¤§æŠŠäº†ï¼Œéšä¾¿æ‹¿ä¸€ä¸ªè¯»ä¸€è¯»æºç å³å¯ï¼Œä¸‡å˜ä¸ç¦»å…¶å®—ã€‚ Section â…¦ Third-Party Animation Librariesè¿™éƒ¨åˆ†ä¸»è¦æ˜¯ä¸¤ä¸ªå¼€æºåŠ¨ç”»åº“çš„ä½¿ç”¨ï¼Œæ‰¾ä¸ªæ—¶é—´è¯»ä¸€è¯»æºç ï¼Œå¦å¤–å†å†™ä¸€ç¯‡æ–‡ç« ã€‚]]></content>
      <categories>
        <category>è¯»ä¹¦ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[WebView ä¸ JS çš„äº¤äº’]]></title>
    <url>%2F2015%2F10%2F19%2FCommunication-Between-WebView-and-JS%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦åˆ†æä¸€äº› iOS ä¸­ WebView ä¸ JavaScript äº¤äº’çš„ä¸€äº›æ¡†æ¶ã€‚ UIWebView è°ƒ JS æ–¹æ³•é€šè¿‡è°ƒç”¨å¦‚ä¸‹æ–¹æ³•ï¼š 1- (NSString *)stringByEvaluatingJavaScriptFromString:(NSString *)script; æ¯”å¦‚è·å–ç½‘é¡µ titleï¼Œä¹Ÿå¯ä»¥åŠ¨æ€æ³¨å…¥ JSï¼Œå…ˆå†™ä¸€ä¸ª JS å‡½æ•° 123function showAlert() &#123; alert('show alert'); &#125; ç„¶åä¿å­˜ä¸ºjs æ–‡ä»¶ï¼Œæœ€åè¯»å–è¿™ä¸ªæ–‡ä»¶å¹¶æ³¨å…¥ 123NSString *filePath = [[NSBundle mainBundle] pathForResource:@"test" ofType:@"js"]; NSString *jsString = [[NSString alloc] initWithContentsOfFile:filePath]; [webView stringByEvaluatingJavaScriptFromString:jsString]; JS è°ƒåŸç”Ÿæ–¹æ³•ç›´æ¥è°ƒç”¨æ— æ³•åšåˆ°ï¼Œå¯ä»¥é—´æ¥å®ç°ã€‚ æ–¹æ³•1JS ä¸­è¦ä»ç°åœ¨çš„ç½‘é¡µè·³åˆ°å¦å¤–ä¸€ä¸ªç½‘é¡µçš„æ—¶å€™ï¼Œå°±ä¼šå»ä¿®æ”¹ window.location.href ï¼Œè€Œåœ¨ @protocol UIWebViewDelegate ä¸­æœ‰ä¸€ä¸ªå›è°ƒæ–¹æ³• 1- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType; å¯ä»¥ç›‘å¬åˆ°ç½‘é¡µçš„è·³è½¬ï¼Œæ‰€ä»¥å¯ä»¥åœ¨æ­¤åšæ–‡ç« ã€‚é€šè¿‡æŒ‡å®šwindow.location.href = schemename://nativemethodname:argså°±å¯ä»¥å»é—´æ¥è°ƒç”¨åˆ°åŸç”Ÿå‡½æ•°ã€‚JS ä¸€æ—¦ä¿®æ”¹äº†window.location.hrefï¼ŒUIWebViewå°±ä¼šæ”¶åˆ°ç›¸åº”å›è°ƒï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢è¯´çš„æ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ¤æ–­requestçš„urlæ˜¯å¦ä¸ºè‡ªå®šä¹‰çš„ schemeæ¥å†³å®šæ˜¯å¦è°ƒç”¨åŸç”Ÿå‡½æ•°ã€‚ æ–¹æ³•2åˆ›å»ºiframeï¼Œè®¾ç½®srcï¼Œå¹¶æ’å…¥åˆ°bodyèŠ‚ç‚¹ 123456789function execute(url) &#123; var iframe = document.createElement("IFRAME"); iframe.setAttribute("src", url); document.documentElement.appendChild(iframe); iframe.parentNode.removeChild(iframe); iframe = null;&#125;execute("schemename://nativemethodname:args"); ä¸Šè¿°çš„è¿™ä¸€ä¸²schemename://nativemethodname:argsç”±å®¢æˆ·ç«¯å’Œå‰ç«¯çº¦å®šå¥½å³å¯ã€‚å‰©ä½™çš„äº‹å°±æ˜¯æˆªè·è¿™ä¸ªrequestï¼Œç„¶åè§£æå¾—åˆ°ç›¸åº”çš„å‚æ•°ï¼Œä¼ å…¥è¦è°ƒç”¨çš„åŸç”Ÿå‡½æ•°å³å¯ã€‚åŒæ—¶åœ¨å›è°ƒæ–¹æ³•ä¸­è¦return NOã€‚å¤§è‡´ä»£ç å¦‚ä¸‹ï¼š 1234567891011- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType&#123; NSURL *requestUrl = request.URL; if ([requestUrl.scheme isEqualToString:@"schemename"]) &#123; NSArray *components = [requestUrl.absoluteString componentsSeparatedByString:@":"]; NSString *resultJSONString = [components[2] stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding]; [self customMethod:resultJsonString]; return NO; &#125; return YES;&#125; WebViewJavaScriptBridge å®ç°åŸç†å¤§è‡´åŸç†ä¸ä¸Šé¢è¯´çš„ä¸€è‡´ã€‚åªä¸è¿‡WebViewJavaScriptBridgeè¿›è¡Œäº†æ›´å®Œå–„çš„å°è£…ï¼Œä½¿å¾— JSä¸Nativeä¹‹é—´çš„é€šä¿¡å˜å¾—æ›´ä¸ºç®€ä¾¿ã€‚ ä¸€å¼€å§‹æ³¨å…¥WebViewJavaScriptBridge.js,è¯¥æ–‡ä»¶ä¸­çš„JSæ–¹æ³•ä¸»è¦åšäº†ä»¥ä¸‹å‡ ä»¶äº‹ åˆ›å»ºäº†ä¸€ä¸ªç”¨äºå‘é€æ¶ˆæ¯çš„iFrame(é€šè¿‡åˆ›å»ºä¸€ä¸ªéšè—çš„ifrmaeï¼Œå¹¶è®¾ç½®å®ƒçš„URL æ¥å‘å‡ºä¸€ä¸ªè¯·æ±‚ï¼Œä»è€Œè§¦å‘UIWebViewçš„shouldStartLoadWithRequestå›è°ƒåè®®) åˆ›å»ºäº†ä¸€ä¸ªæ ¸å¿ƒå¯¹è±¡WebViewJavaScriptBridgeï¼Œå¹¶ç»™å®ƒå®šä¹‰äº†å‡ ä¸ªæ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å¤§éƒ¨åˆ†æ˜¯å…¬å¼€çš„APIæ–¹æ³• åˆ›å»ºäº†ä¸€ä¸ªäº‹ä»¶ï¼šWebViewJavaScriptBridgeReadyï¼Œå¹¶dispatchã€‚## nativeå°†æ–¹æ³•åã€å‚æ•°ã€å›è°ƒçš„idæ”¾åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ä¼ ç»™jsã€‚jsæ ¹æ®æ–¹æ³•åå­—è°ƒç”¨ç›¸åº”æ–¹æ³•ï¼Œä¹‹åå°†è¿”å›æ•°æ®å’ŒresponseIdæ‹¼è£…ï¼Œæœ€åé€šè¿‡src é‡å®šå‘åˆ°UIWebview çš„delegateã€‚nativeå¾—åˆ°æ•°æ®åæ ¹æ®responseIdè°ƒç”¨äº‹å…ˆè£…å…¥_responseCallbacksçš„blockï¼ŒåŠ¨æ€è¯»å–è°ƒç”¨ï¼Œä»è€Œå®Œæˆäº¤äº’ã€‚ æµç¨‹ï¼ˆNativeç«¯ï¼‰Public Interface12345678910+ (instancetype)bridgeForWebView:(WVJB_WEBVIEW_TYPE*)webView handler:(WVJBHandler)handler;+ (instancetype)bridgeForWebView:(WVJB_WEBVIEW_TYPE*)webView webViewDelegate:(WVJB_WEBVIEW_DELEGATE_TYPE*)webViewDelegate handler:(WVJBHandler)handler;+ (instancetype)bridgeForWebView:(WVJB_WEBVIEW_TYPE*)webView webViewDelegate:(WVJB_WEBVIEW_DELEGATE_TYPE*)webViewDelegate handler:(WVJBHandler)handler resourceBundle:(NSBundle*)bundle;+ (void)enableLogging;- (void)send:(id)message;- (void)send:(id)message responseCallback:(WVJBResponseCallback)responseCallback;- (void)registerHandler:(NSString*)handlerName handler:(WVJBHandler)handler;- (void)callHandler:(NSString*)handlerName;- (void)callHandler:(NSString*)handlerName data:(id)data;- (void)callHandler:(NSString*)handlerName data:(id)data responseCallback:(WVJBResponseCallback)responseCallback; åˆå§‹åŒ–ä¸€ä¸ª bridgeåˆå§‹åŒ–çš„å·¥ä½œä¸»è¦å¦‚ä¸‹ï¼š è®¾ç½®é»˜è®¤çš„æ¶ˆæ¯å¤„ç† block â€”â€”â€”â€” messageHandler åˆå§‹åŒ–ç”¨æ¥ä¿å­˜æ¶ˆæ¯å¤„ç† block çš„å­—å…¸ â€”â€”â€”â€” messageHandlers åˆå§‹åŒ–æ¶ˆæ¯é˜Ÿåˆ—æ•°ç»„ â€”â€”â€”â€” startupMessageQueue åˆå§‹åŒ–å“åº”å›è°ƒ â€”â€”â€”â€” responseCallbacks ä»¥åŠåˆå§‹åŒ–å…¨å±€å”¯ä¸€æ ‡è¯† â€”â€”â€”â€” uniqueId å½“åœ¨å¤–éƒ¨è°ƒç”¨ 1- (void)registerHandler:(NSString *)handlerName handler:(WVJBHandler)handler; æ–¹æ³•æ—¶ï¼Œä¼šå°† handler ä¿å­˜åˆ°ä¸Šé¢åˆå§‹åŒ–å¥½çš„ messageHandlers å½“ä¸­ï¼Œkeyä¸ºä¸Šè¿°æ–¹æ³•ä¸­çš„ handlerNameï¼Œvalue ä¸ºä¸Šè¿°æ–¹æ³•çš„ handlerã€‚ 1- (void)sendData:(id)data responseCallback:(WVJBResponseCallback)responseCallback handlerName:(NSString*)handlerName; å‘é€æ¶ˆæ¯æ—¶ï¼Œä¼šå°†æ¶ˆæ¯åŠ å…¥åˆ°æ¶ˆæ¯é˜Ÿåˆ—æ•°ç»„ï¼ŒåŠ åˆ°æ•°ç»„å½“ä¸­çš„object ä¸ºå­—å…¸å‹ï¼Œå­—å…¸æœ‰ä¸‰ä¸ª keyï¼Œåˆ†åˆ«ä¸º dataï¼ŒcallbackIdï¼Œ handlerNameï¼Œåˆ†åˆ«å¯¹åº”ä¸Šè¿°æ–¹æ³•çš„ä¸‰ä¸ªå‚æ•°ã€‚å…¥é˜Ÿæ—¶ï¼Œå¦‚æœå½“å‰æ¶ˆæ¯é˜Ÿåˆ—å­˜åœ¨ï¼Œåˆ™å°†è¯¥æ¶ˆæ¯å…¥é˜Ÿï¼Œå¦åˆ™ç«‹å³åˆ†å‘è¯¥æ¶ˆæ¯ã€‚ ç½‘é¡µåŠ è½½è¿‡ç¨‹1- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType; åŠ è½½è¯·æ±‚æˆ– html æ—¶ï¼Œåœ¨ shouldStartLoadWithRequest å›è°ƒä¸­ä¼šå…ˆåˆ¤æ–­è¯·æ±‚æ˜¯å¦å¸¦è‡ªå®šä¹‰åè®®ã€‚å¦‚æœå¸¦æœ‰è‡ªå®šä¹‰åè®®ï¼Œä¼šè°ƒç”¨æ³¨å…¥çš„ js ä¸­ WebViewJavaScriptBridge çš„_fetchQueue æ–¹æ³•æ¥è·å–å½“å‰æ¶ˆæ¯ï¼Œç„¶ååˆ†å‘è¯¥æ¶ˆæ¯ã€‚ä¸»è¦æ˜¯åœ¨åˆ†å‘æ¶ˆæ¯è¿™ä¸€å—ï¼Œæ‹¿åˆ°æ¶ˆæ¯ json ç„¶ååºåˆ—åŒ–ï¼Œå¦‚æœè¿™ä¸ªæ¶ˆæ¯æ˜¯é˜Ÿåˆ—(æ•°ç»„)æ‰è¿›è¡Œå¤„ç†ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ä¸­ä¹Ÿæ˜¯ä¸€ç³»åˆ—å­—å…¸å‹å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡å¯èƒ½æœ‰è¿™ä¹ˆå‡ ä¸ªkeyï¼šresponseIdï¼ŒresponseDataï¼ŒcallbackIdï¼ŒhandlerNameï¼Œdataã€‚ç„¶åå¯¹æ¶ˆæ¯é˜Ÿåˆ—åšä¸€ä¸ªéå†å¤§è‡´é€»è¾‘å¦‚ä¸‹ï¼š å¦‚æœ responseId å¯¹åº”çš„ value å­˜åœ¨ï¼Œé‚£ä¹ˆå°±åˆ° responseCallbacks å­—å…¸ä¸­å»å¯»æ‰¾å¯¹åº”çš„ WVJBResponseCallback å‹å›è°ƒ blockï¼Œç„¶åæ‰§è¡Œï¼Œblock å‚æ•°ä¸º responseData å¯¹åº”çš„ valueã€‚ç„¶åæŠŠè¿™ä¸ª block ä» responseCallbacks å­—å…¸ä¸­ç§»é™¤ã€‚ å¦‚æœ responseId å¯¹åº”çš„ value ä¸å­˜åœ¨ï¼Œå†çœ‹ callbackId å¯¹åº”çš„ value æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™è®¾ç½®å›è°ƒ responseCallbackï¼Œè¿™ä¸ª responseCallback ä¸»è¦æ˜¯åˆ›å»ºä¸€ä¸ªæ¶ˆæ¯ï¼Œç„¶åæ˜¯æ¶ˆæ¯å…¥é˜Ÿï¼Œè¿™ä¸ªæ¶ˆæ¯å­—å…¸ä¸º @{ @&quot;responseId&quot;:callbackId, @&quot;responseData&quot;:responseData }ï¼›åä¹‹ responseCallback ä¸­ä»€ä¹ˆä¹Ÿä¸æ‰§è¡Œï¼›æœ€ååˆ¤æ–­ handlerName å¯¹åº”çš„ value æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™å– messageHandlers ä¸­å¯¹åº”çš„å›è°ƒ handlerï¼Œä¸å­˜åœ¨å°±æ˜¯ç”¨é»˜è®¤çš„ handlerï¼Œæœ€åæ‰§è¡Œè¿™ä¸ª WVJBHandler å‹çš„ handlerï¼Œå‚æ•°ä¸º data å¯¹åº”çš„ value ä»¥åŠ responseCallbackã€‚ æ–‡å­—æœ‰ç‚¹å¤šï¼Œå‚è€ƒä¸‹ä¸‹é¢è¿™ä¸ªæµç¨‹å›¾ï¼š 1- (void)webViewDidFinishLoad:(UIWebView *)webView; åŠ è½½ç»“æŸçš„å›è°ƒä¸­åˆ¤æ–­ js æ˜¯å¦åˆå§‹åŒ–äº† WebViewJavaScriptBridgeå®ä¾‹ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±æ³¨å…¥æœ¬åœ°çš„ jsã€‚ç„¶åæ£€æµ‹åˆ° bridge è°ƒç”¨è‡ªå®šä¹‰ scheme åä¼šåˆ†å‘æ•´ä¸ªæ¶ˆæ¯é˜Ÿåˆ—å³ startupMessageQueueï¼Œéå†æ¶ˆæ¯é˜Ÿåˆ—ç„¶åå–å‡ºæ¯ä¸€ä¸ªæ¶ˆæ¯å¯¹è±¡(NSDictionary) ç„¶åå°†å…¶åºåˆ—åŒ–æˆ JSONï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ JS çš„ WebViewJavaScriptBridge._handleMessageFromObjC æ–¹æ³•ï¼Œå‚æ•°å°±æ˜¯åºåˆ—åŒ–åçš„ JSON æ•°æ®ã€‚åˆ†å‘å®Œæˆåï¼Œå°† startupMessageQueue é˜Ÿåˆ—ç½®ä¸º nilã€‚ è‡³æ­¤ OC ç«¯çš„æ•´ä¸ªæµç¨‹å®Œæ¯•ã€‚ JS ç«¯æµç¨‹JS ç«¯æµç¨‹å’Œ OC ç«¯æµç¨‹å¤§è‡´æ˜¯ä¸€æ ·çš„ Public Interface123456function init(messageHandler)function send(data, responseCallback)function registerHandler(handlerName, handler)function callHandler(handlerName, data, responseCallback)function _fetchQueue()function _handleMessageFromObjC(messageJSON) åˆå§‹åŒ–ç±»ä¼¼ OC ä¸­çš„åˆå§‹åŒ– æ³¨å…¥ä¸€ä¸ªé»˜è®¤çš„ messageHandler åˆå§‹åŒ–ä¸€ä¸ªæ¶ˆæ¯æ¥æ”¶é˜Ÿåˆ—ï¼Œç„¶åè°ƒç”¨å†…éƒ¨æ–¹æ³• _dispatchMessageFromObjC æ¥åˆ†å‘æ¶ˆæ¯,åŒæ—¶å°†æ¶ˆæ¯æ¥æ”¶é˜Ÿåˆ—ç½®ç©º å‘é€æ¶ˆæ¯è°ƒç”¨å†…éƒ¨ function _doSend(message, responseCallback) å‡½æ•°ï¼Œè¯¥å‡½æ•°é€šè¿‡åˆ¤æ–­ responseCallback å›è°ƒæ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™å°†è¿™ä¸ªå›è°ƒå­˜å…¥åˆ° responseCallbacks å­—å…¸ä¸­ï¼Œå…¶ key æ˜¯å…¨å±€å”¯ä¸€çš„ï¼ŒåŒæ—¶å°†è¿™ä¸ª key å­˜å…¥åˆ° message è¿™ä¸ªå­—å…¸å‚æ•°ä¸­ï¼Œå…¶ key å’Œ value ä¸€è‡´ï¼ŒåŠ message[â€˜keyâ€™] = keyã€‚æ¥ç€æŠŠè¿™ä¸ª message å‚æ•°å…¥é˜Ÿå³åŠ åˆ° sendMessageQueue æ•°ç»„ä¸­ã€‚ç„¶åé‡å®šå‘ frame çš„ srcï¼Œè¿™æ · OC ç«¯å°±å¯ä»¥åœ¨ä»£ç†å›è°ƒæ–¹æ³•ä¸­å»æ‹¦æˆªè¿™ä¸ª src å¯¹åº”çš„ requestã€‚ æ¶ˆæ¯å¤„ç†æœºåˆ¶å¦‚æœæ¶ˆæ¯æ¥å—é˜Ÿåˆ—å­˜åœ¨åˆ™å°†æ¶ˆæ¯ JSON å…¥é˜Ÿå³æ·»åŠ åˆ° receiveMessageQueue æ•°ç»„ä¸­ã€‚åä¹‹ï¼Œè°ƒç”¨å†…éƒ¨æ¶ˆæ¯åˆ†å‘æ–¹æ³• 1function _dispatchMessageFromObjC(messageJSON) åˆ†å‘æœºåˆ¶ç±»ä¼¼ OC ç«¯çš„é‚£å¼ æµç¨‹å›¾ï¼Œåœ¨æ­¤ä¸åšè¯¦è¿°ã€‚ æ³¨å†ŒåŠè°ƒç”¨ handler æ³¨å†Œï¼šåœ¨ messageHandlers è¿™ä¸ªå­—å…¸æ·»åŠ å¯¹åº”çš„ key å’Œ valueã€‚key ä¸º nameï¼Œvalue ä¸º handler è°ƒç”¨ï¼šç±»ä¼¼å‘é€æ¶ˆæ¯ï¼Œmessage å‚æ•°ä¸º { handlerName:handlerName, data:data } è·å–æ¶ˆæ¯é˜Ÿåˆ—(ä¾› OC ç«¯è°ƒç”¨)è¿™é‡Œä¼šå°†æ¶ˆæ¯å‘é€æ•°ç»„è¿›è¡Œ JSON è½¬åŒ–ï¼Œè½¬æ¢åæ¸…ç©ºæ¶ˆæ¯é˜Ÿåˆ—ï¼Œç„¶åè¿”å›ç»™ OC ç«¯ã€‚ å†…éƒ¨æ³¨å…¥çš„ JSä¸Šé¢è¯´çš„æ‰€æœ‰éƒ½åœ¨å†…éƒ¨æ³¨å…¥çš„ JS(WebViewJavaScriptBridge.js.txt) ä¸­å®Œæˆ,è¯¥ JS åšçš„äº‹æƒ…åœ¨ä¸Šè¿°çš„å®ç°åŸç†ä¸­ä¹Ÿæœ‰æåˆ°ï¼Œè¿™é‡Œä¸å†å±•å¼€ã€‚ å¤–éƒ¨ html æˆ– js éœ€è¦å¤„ç†çš„äº‹å¯å‚è€ƒä¸‹ä¾‹çš„å†™æ³•ï¼š 1234document.addEventListener('WebViewJavascriptBridgeReady', function(event) &#123; var bridge = event.bridge // Start using the bridge&#125;, false) å¯å°†ä¸Šè¿°ä»£ç å°è£…åˆ°ä¸€ä¸ª JS å‡½æ•°ä¸­ï¼Œç„¶ååœ¨å‡½æ•°ä¸­è¿›è¡Œå…¶å®ƒä¸€ç³»åˆ—æ“ä½œï¼Œå¦‚initï¼Œsend ç­‰å…·ä½“å‚è§ Demoã€‚ JavaScriptCore(iOS7 &amp; OS X 10.9 later)ä¸»è¦çš„ç±»: JSVirtualMachineï¼šéå¸¸è½»é‡ï¼Œå¯åˆå§‹åŒ–å¤šä¸ª VM æ¥æ”¯æŒ JS ä¸­çš„å¤šçº¿ç¨‹ JSContextï¼šç»™ JS æä¾›è¿è¡Œä¸Šä¸‹æ–‡ç¯å¢ƒä»¥åŠä¸€ç³»åˆ—å€¼æ“ä½œ(é€šè¿‡ä¸‹æ ‡æ¥è·å–ï¼Œç±»ä¼¼ NSdictionaryï¼Œå³context[@â€objectKeyâ€])ï¼Œä¸€ä¸ª VM ä¸­å¯æœ‰å¤šä¸ª context JSValueï¼šæ•°æ®æ¡¥æ¢ JSManagedValueï¼šç”¨äºè§£å†³ retain cycle OC è°ƒç”¨ JSJSContext å¯è°ƒç”¨ evaluateScript: æ–¹æ³•æ¥æ‰§è¡ŒæŸä¸ªè„šæœ¬å¦‚ä¸‹ï¼š 12345[context evaluateScript:@â€var square = function(x) &#123;return x*x;&#125;â€]; JSValue *squareFunction = context[@â€squareâ€]; NSLog(@â€%@â€, squareFunction); // function (x) &#123;return x*x;&#125;JSValue *aSquared = [squareFunction callWithArguments:@[context[@â€aâ€]]]; NSLog(@â€a^2: %@â€, aSquared); //a^2: 25JSValue *nineSquared = [squareFunction callWithArguments:@[@9]]; NSLog(@â€9^2: %@â€, nineSquared); //81 JS è°ƒç”¨ OCä¸¤ç§æ–¹å¼ï¼š Block JSExport åè®® Block1234567891011context[@"factorial"] = ^(int x) &#123; int factorial = 1; for (; x &gt; 1; x--) &#123; factorial *= x; &#125; return factorial; &#125;;[context evaluateScript:@"var fiveFactorial = factorial(5);"];JSValue *fiveFactorial = context[@"fiveFactorial"];// 5! = 120NSLog(@"5! = %@", fiveFactorial); å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š ä¸è¦åœ¨ block ä¸­æŒæœ‰ JSValueï¼Œè€Œæ˜¯åº”è¯¥å°†JSValue ä½œä¸ºå‚æ•°æ¥ä¼ é€’ ä¸è¦åœ¨ block ä¸­æŒæœ‰ JSContextï¼Œå¯é€šè¿‡ [JSContext currentContext]æ¥è·å–å½“å‰ context 1234JSContext *context = [[JSContext alloc] init]; context[@"callback"] = ^&#123; //é”™è¯¯ç¤ºä¾‹ JSValue *object = [JSValue valueWithNewObjectInContext:context]; //æ­£ç¡®çš„å§¿åŠ¿ JSValue *object = [JSValue valueWithNewObjectInContext: [JSContext currentContext]]; object[@"x"] = 2; object[@"y"] = 3; return object; &#125;; JSExport åè®®å¦‚æœæ²¡æœ‰è¿™ä¸ªåè®®ï¼ŒOC ç«¯çš„ä¿®æ”¹ä¼šåŒæ­¥åˆ° JS ç«¯ï¼Œä½†æ˜¯ JS ç«¯çš„ä¿®æ”¹å¯¹ JS å’Œ OC å‡æ— å½±å“ã€‚è§ä¸‹ä¾‹ 12345678910111213141516171819202122232425262728//TestModel.m- (NSString *)description&#123; NSString *str = [@"TestModel With testString:" stringByAppendingString:self.testString]; return [str stringByAppendingString:[NSString stringWithFormat:@" and numberStr:%@",self.numberStr]];&#125;// viewDidLoadTestModel *model = [[TestModel alloc] init];model.testString = @"test string";model.numberStr = @"123";JSContext *context = [[JSContext alloc] initWithVirtualMachine:[[JSVirtualMachine alloc] init]];context[@"model"] = model;JSValue *modelValue = context[@"model"];// model: TestModel With testString:test string and numberStr:123NSLog(@"model: %@",model);// model JSValue: TestModel With testString:test string and numberStr:123NSLog(@"model JSValue: %@",modelValue);model.numberStr = @"456";// model: TestModel With testString:test string and numberStr:456NSLog(@"model: %@",model);// model JSValue: TestModel With testString:test string and numberStr:456NSLog(@"model JSValue: %@",modelValue);[context evaluateScript:@"model.testString = \"anotoher test\";model.numberStr = \"789\""];// model: TestModel With testString:test string and numberStr:456NSLog(@"model: %@",model);// model JSValue: TestModel With testString:test string and numberStr:456NSLog(@"model JSValue: %@",modelValue); å¦‚æœæƒ³è¦ä¸Šè¿° JS ä¿®æ”¹èµ·ä½œç”¨,åˆ™éœ€è¦å®ç° JSExport åè®®ã€‚é€šè¿‡å®ç°è¯¥åè®®æ¥æš´éœ²è‡ªå®šä¹‰ç±»ç»™ JSï¼Œè¿™æ · JS ä¼šä¸ºè¿™ä¸ªç±»åˆ›å»ºä¸€ä¸ª wrapper objectï¼Œè¿™æ ·çœ‹èµ·æ¥å°±åƒ OC å’Œ JS åœ¨äº’ç›¸ä¼ å€¼ä¸€æ ·ã€‚è¿™æ ·ï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥åœ¨ JS å’Œ OC é—´å…±äº«ï¼Œä»»ä½•ä¸€ç«¯çš„æ›´æ”¹éƒ½å°†åŒæ­¥åˆ°å¦å¤–ä¸€ç«¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒJS åªèƒ½ä¿®æ”¹æš´éœ²åœ¨åè®®ä¸­çš„å±æ€§æˆ–è°ƒç”¨åè®®ä¸­çš„æ–¹æ³•ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344// .h@protocol TestModelDelegate &lt;JSExport&gt;@property (nonatomic, copy) NSString *testString;- (void)modelTest;@end@interface TestModel : NSObject &lt;TestModelDelegate&gt;@property (nonatomic, copy) NSString *testString;@property (nonatomic, copy) NSString *numberStr;@end// .m- (NSString *)description&#123; NSString *str = [@"TestModel With testString:" stringByAppendingString:self.testString]; return [str stringByAppendingString:[NSString stringWithFormat:@" and numberStr:%@",self.numberStr]];&#125;- (void)modelTest&#123; NSLog(@"modelTest!!!");&#125;- (void)test&#123; NSLog(@"Test!!!");&#125;// viewDidLoad[context evaluateScript:@"model.testString = \"anotoher test\";model.numberStr = \"567\""];// model: TestModel With testString:anotoher test and numberStr:123NSLog(@"model: %@",model);// model JSValue: TestModel With testString:anotoher test and numberStr:123NSLog(@"model JSValue: %@",modelValue);// modelTest!!![context evaluateScript:@"model.modelTest()"];JSValue *unknowValue = [context evaluateScript:@"model.test()"];// unknowValue :undefinedNSLog(@"unknowValue :%@",unknowValue); ä¸Šä¾‹ä¸­çš„ numberStr ä¹‹æ‰€ä»¥è¿˜æ˜¯ä¿æŒä¸º 123 æ˜¯å› ä¸ºï¼Œè¿™ä¸ªå±æ€§ä¸åœ¨åè®®ä¸­ï¼ŒJS å¯¹å…¶ä¿®æ”¹ä¸èµ·ä½œç”¨ï¼ŒåŒæ ·å¦‚æœ JS ä¸­è°ƒç”¨ model ä¸åœ¨åè®®ä¸­çš„æ–¹æ³•ï¼Œä¹Ÿä¸èµ·ä½œç”¨ï¼Œå¦‚æœç”¨ JSValue å»æ¥æ”¶è¿™ä¸ªå€¼ï¼Œå…¶å€¼ä¸º undefinedã€‚æ²¡æœ‰ä»»ä½•å“åº”ï¼Œå¦‚æœç”¨ä¸€ä¸ª JSValue å»æ¥æ”¶ä¸Šé¢ä»£ç çš„å€¼ï¼Œå¾—åˆ°çš„æ˜¯ undifine å¯¹è±¡å¯¹åº”å…³ç³» Objective-C type JavaScript type nil undefined NSNull null NSString string NSNumber number, boolean NSDictionary Object object NSArray Array object NSDate Date object NSBlock Function object id Wrapper object Class Constructor object UIWebView ä¸ JavaScriptCore çš„äº¤äº’UIWebview ä¹Ÿæœ‰ä¸€ä¸ª JSContext å®ä¾‹ï¼Œä½†æ˜¯æ²¡æœ‰æš´éœ²åœ¨ API ä¸­ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ KVC æˆ–è€…åœ¨ NSObject åˆ†ç±»å»æ‹¿åˆ°è¿™ä¸ªå®ä¾‹ï¼Œç„¶åæ¥è¿›è¡Œè‡ªå®šä¹‰çš„ä¸€äº›æ“ä½œã€‚å…³äº NSObject åˆ†ç±»å®ç°å¯ä»¥å‚è€ƒè¿™é‡Œã€‚ä½†æ˜¯è¿™ä¸¤ç§æ–¹æ³•éƒ½æœ‰å¯èƒ½è¢«æ‹’ã€‚ å…¶å®WebView ä¸ JS çš„äº¤äº’å’Œä¸Šè¿°çš„ TestModel ä¸ JS äº¤äº’åŒºåˆ«ä¸å¤§ã€‚åªä¸è¿‡ä¸Šä¾‹éƒ½æ˜¯è‡ªå·±åˆ›å»ºçš„ contextï¼Œè€Œåœ¨webView ä¸­åˆ™æ˜¯æˆ‘ä»¬é€šè¿‡ KVC æ¥æ‹¿åˆ°è¿™ä¸ª context è€Œä¸æ˜¯è‡ªå·±åˆ›å»ºã€‚æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š 12345678910111213141516&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;script&gt; function test() &#123; objcObject.testDemo(); alert(objcObject); &#125; &lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;JavaScriptCore Demo&lt;/h1&gt; &lt;button type="button" onclick="test()"&gt;æµ‹è¯•&lt;/button&gt; &lt;/body&gt;&lt;/html&gt; ä¸Šè¿° html ç®€å•åˆ›å»ºäº†ä¸€ä¸ª buttonï¼Œç„¶åç»‘å®šä¸€ä¸ªäº‹ä»¶ã€‚æ¥ä¸‹æ¥çœ‹çœ‹ ViewController é‡Œé¢åšäº†ä»€ä¹ˆã€‚ 1234567891011121314151617181920212223242526272829// .h@protocol TestJSDelegate &lt;JSExport&gt;- (void)testDemo;@end@interface WebViewController : UIViewController &lt;TestJSDelegate,UIWebViewDelegate&gt;@end// .m- (void)viewDidLoad&#123; [super viewDidLoad]; NSURL *path = [[NSBundle mainBundle] URLForResource:@"test" withExtension:@"html"]; NSString *html = [NSString stringWithContentsOfURL:path encoding:NSUTF8StringEncoding error:nil]; [self.webView loadHTMLString:html baseURL:nil];&#125;- (void)webViewDidFinishLoad:(UIWebView *)webView&#123; JSContext *context = [webView valueForKeyPath:@"documentView.webView.mainFrame.javaScriptContext"]; context[@"objcObject"] = self;&#125;- (void)testDemo&#123; NSLog(@"test!!!");&#125; è¿è¡Œæ•ˆæœ: å¦‚æœåè®®æ–¹æ³•ä¸­æœ‰å¤šä¸ªå‚æ•°è¯¥æ€ä¹ˆè°ƒç”¨å‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ 12345// ObjC ä¸­çš„æŸä¸ªåè®®æ–¹æ³•- (void)testWithName:(NSString *)name age:(NSNumber *)age&#123; NSLog(@"name:%@,age:%@",name,age);&#125; 12// åœ¨ä¸Šè¿° html çš„ js ä¸­æ·»åŠ ä¸€è¡Œä»£ç objcObject.testWithNameAge("Tracy",20); é‚£ä¹ˆåœ¨æŒ‰é’®ç‚¹å‡»åï¼Œåè®®æ–¹æ³•å°†ä¼šè¢«æ‰§è¡Œï¼Œç„¶åæ‰“å°å‡º name:Tracy,age:20ã€‚ å†…å­˜ç®¡ç†OC ä¸­æ˜¯ç”¨çš„æ˜¯ ARCï¼ŒJavaScriptCore ä¸­ç”¨çš„æ˜¯åƒåœ¾å›æ”¶æœºåˆ¶ï¼ˆgarbage collectionï¼‰,JavaScriptCore ä¸­æ‰€æœ‰å¼•ç”¨éƒ½ä¸ºå¼ºå¼•ç”¨ã€‚åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼ŒJavaScriptCore èƒ½åšåˆ°åœ¨è¿™ä¸¤ç§å†…å­˜ç®¡ç†æœºåˆ¶ä¹‹é—´æ— ç¼åˆ‡æ¢ï¼Œä½†æ˜¯åœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¸‹éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š åœ¨ OC å¯¹è±¡ä¸­å­˜å‚¨ JavaScript å€¼ åœ¨ OC å¯¹è±¡ä¸­æ·»åŠ  JavaScript åŸŸ å¦‚ä¸‹ä¾‹å°±ä¼šé€ æˆå¾ªç¯å¼•ç”¨ï¼š 12// ClickHandler æ„é€ å™¨ï¼Œbutton ä¸º OC å¯¹è±¡ï¼Œcallback æ˜¯æŒ‰é’®ç‚¹å‡»äº‹ä»¶å›è°ƒfunction ClickHandler(button, callback) &#123; this.button = button; this.button.onClickHandler = this; this.handleEvent = callback; &#125;; 1@implementation MyButton - (void)setOnClickHandler:(JSValue *)handler &#123; _onClickHandler = handler; // Retain cycle &#125; @end ä¸Šä¾‹ä¸­ ClickHandler å¯¹ button è¿›è¡Œäº†å¼ºå¼•ç”¨ï¼Œè€Œ MyButton ä¸­åˆå¯¹ _onClickHandler è¿™ä¸ª JSValue è¿›è¡Œäº†å¼ºå¼•ç”¨ï¼Œæœ€ç»ˆå¯¼è‡´å¾ªç¯å¼•ç”¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¦‚æœå°† _onClickHandler è®¾ç½®ä¸º weakï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ”¶ä¸åˆ°ç‚¹å‡»äº‹ä»¶å›è°ƒã€‚ ä¸¾ä¸ªæ —å­ï¼Œåœ¨æŸä¸ªæ–¹æ³•ä¸­æœ‰ä¸€ä¸ªä¸´æ—¶çš„ OC å¯¹è±¡ï¼Œç„¶åé€šè¿‡ JSContext è¢« JS ä¸­çš„å˜é‡å¼•ç”¨ï¼Œä½†æ˜¯è¯¥ OC æ–¹æ³•è°ƒç”¨ç»“æŸåï¼Œè¿™ä¸ªä¸´æ—¶å¯¹è±¡å°†è¢«é‡Šæ”¾ï¼Œå› æ­¤ JS ä¼šé€ æˆé”™è¯¯è®¿é—®ã€‚ åŒæ ·çš„ï¼Œå¦‚æœç”¨ JSContext åˆ›å»ºäº†å¯¹è±¡ï¼Œç„¶ååœ¨ OC ä¸­ç”¨ JSValue å»æ¥æ”¶ï¼Œå³ä½¿æŠŠ JSValue å˜é‡åœ¨ OC ä¸­è¢« retainï¼Œä½†å¯èƒ½å› ä¸º JS ä¸­å› ä¸ºå˜é‡æ²¡æœ‰äº†å¼•ç”¨è€Œè¢«é‡Šæ”¾å†…å­˜ï¼Œé‚£ä¹ˆå¯¹åº”çš„JSValueä¹Ÿæ²¡æœ‰ç”¨äº†ã€‚ æ‰€ä»¥è‹¹æœå¼•å…¥äº†å¦ä¸€ä¸ªç±»æ¥è§£å†³è¿™ç§å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚ 123@implementation MyButton - (void)setOnClickHandler:(JSValue *)handler &#123; //æ­£ç¡®çš„å§¿åŠ¿ _onClickHandler = [JSManagedValue managedValueWithValue:handler]; [_context.virtualMachine addManagedReference:_onClickHandler withOwner:self] &#125; @end addManagedReferenceåšçš„äº‹æƒ…ä¸»è¦å¦‚ä¸‹ï¼šå®ƒåˆ›å»ºäº†ä¸€ä¸ª garbage collected referenceï¼Œè¿™ç§å¼•ç”¨æ—¢ä¸æ˜¯å¼ºå¼•ç”¨ä¹Ÿä¸æ˜¯å¼±å¼•ç”¨ã€‚ JSManagedValue æœ¬èº«æ˜¯ä¸€ä¸ªå¯¹ JavaScript Value çš„å¼±å¼•ç”¨ï¼Œè€Œ JSValue æ˜¯å¼ºå¼•ç”¨ã€‚addManagedReference å°† JSManagedValue è½¬æ¢ä¸º garbage collected referenceã€‚å¦‚æœ JS åœ¨åƒåœ¾å›æ”¶è¿‡ç¨‹ä¸­èƒ½å¤Ÿæ‰¾åˆ° managed reference çš„æ‰€æœ‰è€…ï¼Œé‚£ä¹ˆè¿™ä¸ªå¼•ç”¨å°†ä¸ä¼šè¢«é‡Šæ”¾ï¼Œå¦åˆ™å°†è¢«é‡Šæ”¾ã€‚JSManagedValue éœ€è¦è°ƒç”¨å…¶addManagedReference:withOwner: æ–¹æ³•æŠŠå®ƒæ·»åŠ åˆ°JSVirtualMachine ä¸­ï¼Œç¡®ä¿ä½¿ç”¨è¿‡ç¨‹ä¸­ JSValue ä¸ä¼šè¢«é‡Šæ”¾ã€‚ å¤šçº¿ç¨‹å¦‚å‰é¢æ‰€è¯´ï¼Œæ¯ä¸€ä¸ª JSVirtualMachine éƒ½å¯ä»¥æœ‰å¤šä¸ª JScontextï¼Œåœ¨æ¯ä¸ªè¿›ç¨‹ä¸­åˆå¯ä»¥æœ‰å¤šä¸ª JSVirtualMachineã€‚JSValue å¯ä»¥åœ¨åŒä¸€ä¸ª JSVirtualMachine ä¸­çš„ä¸åŒ JSContext ä¹‹é—´ä¼ é€’ï¼Œä½†æ˜¯ä¸èƒ½è·¨ JSVirtualMachine æ¥ä¼ é€’ã€‚å› ä¸ºæ¯ä¸ª JSVirtualMachine éƒ½æœ‰è‡ªå·±çš„å†…å­˜å †ä»¥åŠåƒåœ¾å›æ”¶å™¨ï¼Œå¦‚æœ JSValue è·¨ JSVirtualMachine ä¼ é€’ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶å™¨å°†ä¸çŸ¥å¦‚ä½•å¤„ç†æ¥è‡ªä¸åŒå†…å­˜å †çš„ JSvalueã€‚ JavaScriptCore çš„ API æ˜¯çº¿ç¨‹å®‰å…¨çš„ åŒæ­¥é”ç²’åº¦ï¼šJSVirtualMachineï¼Œå³æˆ‘ä»¬å¯ä»¥åœ¨ JSVirtualMachine ä¸åŒçº¿ç¨‹ä¸­è°ƒç”¨ JSï¼Œä½†æ˜¯å¦‚æœæœ‰çº¿ç¨‹æ­£åœ¨æ‰§è¡Œ JSï¼Œé‚£ä¹ˆå…¶å®ƒçº¿ç¨‹å°†ä¸èƒ½æ‰§è¡Œ JS æ“ä½œã€‚æ‰€ä»¥è¦æƒ³è¿›è¡Œå¹¶å‘æ“ä½œï¼Œé‚£ä¹ˆéœ€è¦ä¸ºæ¯ä¸ªæ“ä½œåˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ JSVirtualMachine æ¥å®ç°å¹¶å‘ã€‚ WKWebView (iOS8 and later)æ–°ç‰¹æ€§ åœ¨æ€§èƒ½ã€ç¨³å®šæ€§ã€åŠŸèƒ½æ–¹é¢æœ‰å¾ˆå¤§æå‡ï¼ˆæœ€ç›´è§‚çš„ä½“ç°å°±æ˜¯åŠ è½½ç½‘é¡µæ˜¯å ç”¨çš„å†…å­˜ï¼‰ï¼› å…è®¸JavaScriptçš„Nitroåº“åŠ è½½å¹¶ä½¿ç”¨ï¼ˆUIWebViewä¸­é™åˆ¶ï¼‰ï¼› æ”¯æŒäº†æ›´å¤šçš„HTML5ç‰¹æ€§ä»¥åŠ native å’Œ web çš„é«˜æ•ˆäº¤äº’ï¼› é«˜è¾¾60fpsçš„æ»šåŠ¨åˆ·æ–°ç‡ä»¥åŠå†…ç½®æ‰‹åŠ¿ï¼› å°†UIWebViewDelegateä¸UIWebViewé‡æ„æˆäº†14ç±»ä¸3ä¸ªåè®® WebKit ä¸ºéçº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥è¦ç¡®ä¿è¯¥ framework çš„æ‰€æœ‰æ–¹æ³•åœ¨ä¸»çº¿ç¨‹ä¸Šè°ƒç”¨ã€‚ æ›´å¤šå†…å®¹è¯·å‚è€ƒNshipsterã€‚ æ€»ç»“æ€»å¾—æ¥è¯´ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥å®ç°äºŒè€…çš„äº¤äº’ï¼ŒJavaScriptBridge ç›¸å¯¹è€Œè¨€å¤æ‚ä¸€äº›ï¼Œä½†æ˜¯å®‰å…¨ä¸”ä¸éœ€è¦åšç‰ˆæœ¬é€‚é…ï¼ŒAPP ä¸Šæ¶ä¸ä¼šè¢«æ‹’ï¼Œä½†æ˜¯ JavaScriptCore æ›´åŠ ç®€æ´ï¼Œä¸éœ€è¦å†™ç¹ççš„ä»£ç ï¼Œä½†æ˜¯æœ‰è¢«æ‹’çš„é£é™©ï¼ŒåŒæ—¶è¿™ä¸ªæ¡†æ¶æ˜¯åœ¨ iOS7 ä¹‹åæ‰æœ‰ï¼Œæ‰€ä»¥å¦‚æœè¦é€‚é… iOS6çš„è¯è¿˜æ˜¯é€‰æ‹© JavaScriptBridgeã€‚ æœ¬æ–‡ Demo]]></content>
      <categories>
        <category>æ¡†æ¶å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>åŸåˆ›</tag>
        <tag>WebView</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•åˆ›å»ºä¸€ä¸ªç¿»ä¹¦åŠ¨ç”»(Part2)[è¯‘]]]></title>
    <url>%2F2015%2F09%2F01%2FHow-to-Create-an-iOS-Book-Open-Animation-part-two-translation%2F</url>
    <content type="text"><![CDATA[æ¬¢è¿å›åˆ° iOS ç¿»ä¹¦åŠ¨ç”»æ•™ç¨‹ç³»åˆ—ï¼åœ¨è¯¥ç³»åˆ—çš„ç¬¬ä¸€éƒ¨åˆ†(è¯‘æ–‡)ï¼Œä½ å·²ç»çŸ¥é“å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰çš„ layout ä»¥åŠå¦‚ä½•åœ¨ app ä¸­ä½¿ç”¨é˜´å½±æ•ˆæœæ¥åˆ›å»ºæ™¯æ·±å’Œæ¨¡æ‹Ÿç°å®ã€‚åœ¨è¿™ç¯‡æ•™ç¨‹ä¸­ï¼Œä½ å°†å­¦åˆ°å¦‚ä½•åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„è½¬åœºä»¥åŠå¦‚ä½•ä½¿ç”¨ pinch æ‰‹åŠ¿æ¥æ‰“å¼€ä¹¦æœ¬ã€‚ 2019.11.21 updateæœ¬æ–‡ä¸­å›¾ç‰‡å’Œèµ„æºç›¸å…³é“¾æ¥å¯èƒ½å·²å¤±æ•ˆï¼Œå¦‚éœ€æŸ¥é˜…ï¼Œè¯·æŸ¥çœ‹åŸæ–‡æ„Ÿè°¢Attila HegedÃ¼såˆ›å»ºäº†è¿™ä¸ªæ£’æ£’å“’ç¤ºä¾‹å·¥ç¨‹ã€‚ åŸæ–‡ï¼šHow to Create an iOS Book Open Animation: Part 2 å¼€å§‹è¿™ç¯‡æ•™ç¨‹åŸºäºç¬¬ä¸€éƒ¨åˆ†ã€‚å¦‚æœä½ ä¸äº†è§£ç¬¬ä¸€éƒ¨åˆ†æˆ–è€…æƒ³é‡æ–°å¼€å§‹ï¼Œå¯ä»¥ä¸‹è½½ä¸Šä¸€æ•™ç¨‹çš„å®Œæ•´ä»£ç ã€‚ åœ¨ Xcode ä¸­æ‰“å¼€å·¥ç¨‹ã€‚ç°åœ¨ä½ å¯ä»¥é€‰æ‹©ä¸€æœ¬ä¹¦ï¼Œç„¶åä¹¦æœ¬ä»å³æ»‘å‡º(å³ push)ï¼Œè¿™æ˜¯ UINavigationController çš„é»˜è®¤è½¬åœºè¡Œä¸ºã€‚ä½†æ˜¯åœ¨è¿™ç‰‡æ•™ç¨‹ç»“æŸçš„æ—¶å€™ï¼Œè‡ªå®šä¹‰è½¬åœºçœ‹èµ·æ¥åƒè¿™æ ·ï¼š è‡ªå®šä¹‰è½¬åœºå°†åœ¨ä¹¦æœ¬æ‰“å¼€å’Œåˆä¸Šçš„çŠ¶æ€è½¬æ¢ä¸­è¿›è¡Œä¸æ»‘çš„åŠ¨ç”»è¿‡æ¸¡ï¼Œè¿™ç§æ–¹å¼éå¸¸è‡ªç„¶ï¼Œæ·±å¾—æˆ‘å¿ƒã€‚æ¥å§ï¼Œéªšå¹´ï¼Œå¼€æ’¸ï¼ åˆ›å»ºè‡ªå®šä¹‰å¯¼èˆªæ§åˆ¶å™¨æƒ³è¦å®ç°è‡ªå®šä¹‰è½¬åœºå¿…é¡»åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„å¯¼èˆªæ§åˆ¶å™¨ç„¶åå®ç° UINavigationControllerDelegate åè®®ã€‚å³é”® App åˆ†ç»„åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª UINavigationController åä¸º CustomNavigationController çš„ç±»ã€‚è¯­è¨€è®¾ç½®ä¸º Swiftã€‚ æ‰“å¼€CustomNavigationController.swiftï¼Œç”¨ä¸‹é¢ä»£ç æ›¿æ¢å…¶å†…å®¹ï¼š 1234567891011121314151617181920212223import UIKit class CustomNavigationController: UINavigationController, UINavigationControllerDelegate &#123; override func viewDidLoad() &#123; super.viewDidLoad() //1 delegate = self &#125; //2 func navigationController(navigationController: UINavigationController, animationControllerForOperation operation: UINavigationControllerOperation, fromViewController fromVC: UIViewController, toViewController toVC: UIViewController) -&gt; UIViewControllerAnimatedTransitioning? &#123; if operation == .Push &#123; return nil &#125; if operation == .Pop &#123; return nil &#125; return nil &#125;&#125; ä¸Šé¢ä»£ç ä¸»è¦åšäº†ä¸¤ä»¶äº‹ï¼š 1.åœ¨ viewDidLoad æ–¹æ³•ä¸­å°†ä»£ç†è®¾ç½®ä¸ºè‡ªèº« 2.navigationController(_:animationControllerForOperation:fromViewController:toViewController:) æ–¹æ³•æ˜¯åè®®æ–¹æ³•ä¸­çš„ä¸€ä¸ªã€‚è¿™ä¸ªæ–¹æ³•åœ¨æ¯æ¬¡ push æˆ–è€… pop çš„æ—¶å€™è¢«è°ƒç”¨ï¼Œä½ å¯ä»¥åœ¨æ­¤è¿”å›å¯¹åº”çš„è½¬åœºç±»å‹åŠ¨ç”»ã€‚ç°åœ¨è¿™ä¸ªæ–¹æ³•è¿”å› nil ä½¿å¾—å…¶ä½¿ç”¨é»˜è®¤çš„æ ‡å‡†è½¬åœºã€‚é©¬ä¸Šä½ å°±ä¼šç”¨ä½ è‡ªå®šä¹‰çš„è½¬åœºç±»æ¥æ›¿æ¢å®ƒã€‚ æ—¢ç„¶å¯¼èˆªæ§åˆ¶å™¨å·²ç»å‡†å¤‡å°±ç»ªï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬å¼€å§‹æ¥æ›¿æ¢ storyboard ä¸­é»˜è®¤çš„å¯¼èˆªæ§åˆ¶å™¨ è®¾ç½®å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è¿è¡Œä¸€ä¸‹ï¼Œç¡®ä¿èƒ½æ­£å¸¸è¿è¡Œï¼Œä¸€åˆ‡æ­£å¸¸ï¼Œå› ä¸ºä½ åœ¨ä»£ç†æ–¹æ³•ä¸­è¿”å› nilï¼Œå¯¼è‡´æ§åˆ¶å™¨ä½¿ç”¨é»˜è®¤è½¬åœºè¡Œä¸ºã€‚ åˆ›å»ºè‡ªå®šä¹‰è½¬åœºç»ˆäºæ¥åˆ°é‡å¤´æˆç¯èŠ‚â€”â€”â€”â€”æ’¸ä¸€ä¸ªè‡ªå®šä¹‰è½¬åœºï¼åœ¨è‡ªå®šä¹‰è½¬åœºç±»ä¸­ï¼Œå¿…é¡»éµå¾ª UIViewControllerAnimatedTransitioning åè®®ï¼Œç‰¹åˆ«æ˜¯éœ€è¦å®ç°ä¸‹é¢å‡ ä¸ªæ–¹æ³•ï¼š transitionDurationï¼šå¿…é¡»å®ç°ã€‚è¿”å›è½¬åœºåŠ¨ç”»æ—¶é—´ï¼Œä»¥åŠåŒæ­¥äº¤äº’è½¬åœºåŠ¨ç”» animateTransitionï¼šå¿…é¡»å®ç°ã€‚æä¾›è½¬åœºè¿‡ç¨‹ä¸­çš„æºæ§åˆ¶å™¨å’Œç›®çš„æ§åˆ¶å™¨ã€‚è‡ªå®šä¹‰è½¬åœºçš„å·¥ä½œé‡å¿ƒä¸»è¦æ˜¯åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å®Œæˆ animationEndedï¼šå¯é€‰å®ç°ã€‚åœ¨è½¬åœºç»“æŸæ—¶è°ƒç”¨ã€‚å¯ä»¥åœ¨è¯¥æ–¹æ³•ä¸­è¿˜åŸä¹‹å‰çš„è®¾ç½® è®¾ç½®ä½ çš„è½¬åœºå³é”® App åˆ†ç»„æ–°å»ºä¸€ä¸ªç»§æ‰¿è‡ª NSObject åä¸º BookOpeningTransition çš„ç±»ï¼Œè®¾ç½®è¯­è¨€ä¸º Swiftã€‚ æ‰“å¼€å®ƒï¼Œç„¶åç”¨ä¸‹é¢ä»£ç æ¥æ›¿æ¢å…¶æ‰€æœ‰å†…å®¹ï¼š 1234567891011121314151617181920import UIKit //1class BookOpeningTransition: NSObject, UIViewControllerAnimatedTransitioning &#123; // MARK: Stored properties var transforms = [UICollectionViewCell: CATransform3D]() //2 var toViewBackgroundColor: UIColor? //3 var isPush = true //4 //5 // MARK: UIViewControllerAnimatedTransitioning func transitionDuration(transitionContext: UIViewControllerContextTransitioning) -&gt; NSTimeInterval &#123; return 1 &#125; func animateTransition(transitionContext: UIViewControllerContextTransitioning) &#123; &#125;&#125; æ¯ä¸ªæ•°å­—æ ‡å·æ³¨é‡Šçš„è§£é‡Šï¼š 1.BookOpeningTransition å®ç°äº† UIViewControllerAnimatedTransitioning åè®® 2.å­—å…¸ transforms å­˜å‚¨äº†é”®ä¸º UICollectionViewCell å€¼ä¸º CATransform3Dç±»å‹çš„é”®å€¼å¯¹ã€‚å½“ä¹¦æœ¬æ‰“å¼€æ—¶ï¼Œå®ƒå­˜å‚¨äº†æ¯ä¸ª cell çš„ transform 3.å®šä¹‰äº†ç›®çš„æ§åˆ¶å™¨çš„èƒŒæ™¯è‰²ï¼Œä½¿å¾—æ¸å˜çœ‹èµ·æ¥æ›´åŠ æ¸…çˆ½ 4.isPush å†³å®šäº†è½¬åœºä¸º push è¿˜æ˜¯ pop 5.æ·»åŠ äº†åè®®ä¸­å¿…é¡»å®ç°çš„æ–¹æ³•é¿å…ç¼–è¯‘å™¨æŠ¥é”™ã€‚ç´§æ¥ç€å°±æ˜¯è¦å®ç°è¿™äº›æ–¹æ³• ä¸€åˆ‡å˜é‡è®¾ç½®å°±ç»ªï¼Œæ˜¯æ—¶å€™æ¥å®ç°åè®®æ–¹æ³•äº†ã€‚ ç”¨ä¸‹é¢ä»£ç æ¥æ›¿æ¢ transitionDuration(_:) ä¸­çš„å†…å®¹ï¼š 12345if isPush &#123; return 1&#125; else &#123; return 1&#125; è¯¥æ–¹æ³•è¿”å›äº†è½¬åœºåŠ¨ç”»æŒç»­çš„æ—¶é—´ï¼Œè¿™é‡Œ pop å’Œ pushéƒ½è¿”å›1ç§’ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥è½»æ¾æ”¹å˜è½¬åœºåŠ¨ç”»çš„æŒç»­æ—¶é—´ã€‚æ¥ä¸‹æ¥éœ€è¦å®ç°ç¬¬äºŒä¸ªå¿…é¡»æ˜¯é—²çš„æ–¹æ³•â€”â€”animateTransitionï¼Œè¿™ä¸ªæ–¹æ³•è®©ä¸€åˆ‡å˜å¾—çš†æœ‰å¯èƒ½ã€‚ä½ å°†åˆ†ä¸¤éƒ¨åˆ†æ¥å®ç°ï¼š å†™ä¸¤ä¸ªå·¥å…·æ–¹æ³•æ¥åˆ†åˆ«å®ç° push å’Œ pop çš„animateTransitionã€‚ åˆ›å»º push è½¬åœºå›æƒ³ä¸€ä¸‹å®é™…ç”Ÿæ´»ä¸­ï¼Œä½ ç¿»ä¹¦çš„åœºæ™¯ï¼š çœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œä½†æ˜¯ä½ åªéœ€è¦å…³å¿ƒåŠ¨ç”»çš„ä¸¤ç§çŠ¶æ€ï¼Œç„¶åè®© UIView çš„ animateWithDuration æ–¹æ³•æ¥å®ç°ä¸¤ç§çŠ¶æ€ä¹‹é—´çš„è¿‡æ¸¡ï¼š 1.ç¬¬ä¸€é˜¶æ®µï¼šä¹¦è¢«åˆä¸Š 2.ç¬¬äºŒé˜¶æ®µï¼šä¹¦è¢«æ‰“å¼€ åœ¨å®ç° animateTransition(_:) å‰ï¼Œé¦–å…ˆå†™ä¸€ä¸ªå·¥å…·æ–¹æ³•æ¥å¤„ç†ä¸¤ç§çŠ¶æ€ã€‚è¿˜æ˜¯åœ¨ BookOpeningTransition.swift ä¸­ï¼Œåœ¨æœ€åæ·»åŠ ï¼š 123456// MARK: Helper Methodsfunc makePerspectiveTransform() -&gt; CATransform3D &#123; var transform = CATransform3DIdentity transform.m34 = 1.0 / -2000 return transform&#125; è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª transformï¼Œä»¥åŠæ·»åŠ ä¸€ä¸ª z è½´ä¸Šçš„é€è§†ã€‚åé¢åŠ¨ç”»è¿‡ç¨‹ä¸­ä½ å°†ä¼šç”¨åˆ°å®ƒæ¥æ”¹å˜ viewã€‚ ç¬¬ä¸€é˜¶æ®µâ€”â€”ä¹¦æœ¬åˆèµ·æ¥ç€åœ¨ä¸Šè¿°æ–¹æ³•åé¢æ·»åŠ ï¼š 12345678910111213141516171819202122232425func closePageCell(cell : BookPageCell) &#123; // 1 var transform = self.makePerspectiveTransform() // 2 if cell.layer.anchorPoint.x == 0 &#123; // 3 transform = CATransform3DRotate(transform, CGFloat(0), 0, 1, 0) // 4 transform = CATransform3DTranslate(transform, -0.7 * cell.layer.bounds.width / 2, 0, 0) // 5 transform = CATransform3DScale(transform, 0.7, 0.7, 1) &#125; // 6 else &#123; // 7 transform = CATransform3DRotate(transform, CGFloat(-M_PI), 0, 1, 0) // 8 transform = CATransform3DTranslate(transform, 0.7 * cell.layer.bounds.width / 2, 0, 0) // 9 transform = CATransform3DScale(transform, 0.7, 0.7, 1) &#125; //10 cell.layer.transform = transform&#125; æˆ‘ä»¬å¯¹æ¯ä¸€ä¸ªé¡µé¢åšäº†è½¬æ¢ä½¿å…¶ä¸ä¹¦è„Šå¯¹é½ï¼Œç„¶åç¿»é¡µæ—¶å›´ç»•ç€ä¸ªè½´åšæ—‹è½¬æ¥è¾¾åˆ°çœŸå®çš„ç¿»é˜…æ•ˆæœã€‚é¦–å…ˆä½ æƒ³è¦ä¹¦æœ¬æ˜¯åˆä¸ŠçŠ¶æ€ã€‚è¿™ä¸ªæ–¹æ³•ä½¿å¾—æ¯ä¸ªé¡µé¢å¹³é“ºåœ¨å°é¢çš„åº•éƒ¨ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼š 1.ä½¿ç”¨ä¹‹å‰åˆ›å»ºçš„å·¥å…·æ–¹æ³•åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ transform 2.åˆ¤æ–­é¡µé¢æ˜¯å¦åœ¨ä¹¦è„Šå³ä¾§ 3.å¦‚æœæ˜¯å³ä¾§é¡µé¢ï¼Œè®¾å…¶è§’åº¦ä¸º0ï¼Œä½¿å…¶å‘ˆå¹³é“ºçŠ¶æ€ 4.å°†é¡µé¢å±…ä¸­å¹¶ä½äºå°é¢ä¹‹ä¸‹ 5.ä½¿é¡µé¢çš„xï¼Œy å‡ä¹˜ä»¥0.7.å¦‚æœä½ ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦ä¹˜ä»¥0.7ï¼Œå›æƒ³ä¸Šä¸€ç¯‡æ•™ç¨‹ä¸­ä½ æ›¾å°†å°é¢ç¼©å°åˆ°0.7ã€‚ 6.å¦‚æœä¸æ˜¯å³ä¾§é¡µé¢ï¼Œé‚£å°±æ˜¯å·¦ä¾§é¡µé¢ 7.è®¾ç½®å·¦ä¾§é¡µé¢è§’åº¦ä¸º180åº¦ã€‚ 8.ä½¿å…¶ä½äºå°é¢ä¹‹ä¸‹ï¼Œå¹¶å±…ä¸­ 9.åŒ5 10.è®¾ç½® cell çš„ transform ç°åœ¨æ·»åŠ å¦‚ä¸‹ä»£ç åˆ°ä¸Šé¢æ–¹æ³•ä¹‹å‰ï¼š 1234567891011121314151617181920212223func setStartPositionForPush(fromVC: BooksViewController, toVC: BookViewController) &#123; // 1 toViewBackgroundColor = fromVC.collectionView?.backgroundColor toVC.collectionView?.backgroundColor = nil //2 fromVC.selectedCell()?.alpha = 0 //3 for cell in toVC.collectionView!.visibleCells() as! [BookPageCell] &#123; //4 transforms[cell] = cell.layer.transform //5 closePageCell(cell) cell.updateShadowLayer() //6 if let indexPath = toVC.collectionView?.indexPathForCell(cell) &#123; if indexPath.row == 0 &#123; cell.shadowLayer.opacity = 0 &#125; &#125; &#125;&#125; è¯¥æ–¹æ³•è®¾ç½®äº†ç¬¬ä¸€é˜¶æ®µçš„è½¬åœºã€‚å®ƒåŒæ—¶ä½¿ç”¨ä¸¤ä¸ª VC æ¥åšåŠ¨ç”»ï¼š fromVCï¼šå³ä¹¦å• VC toVCï¼šä¹¦é¡µ VC ç›¸å…³è§£é‡Šï¼š 1.å­˜å‚¨ BooksViewController çš„ collectionView çš„èƒŒæ™¯è‰²ï¼Œè®¾ç½® BookViewController ä¸­ collectionView çš„èƒŒæ™¯è‰²ä¸º nil 2.éšè—é€‰ä¸­ä¹¦ç±çš„å°é¢ï¼ŒtoVC å°†ä¼šå¤„ç†å°é¢å›¾ç‰‡çš„å‘ˆç° 3.éå†ä¹¦æœ¬é¡µé¢ 4.ä¿å­˜æ¯ä¸ª cell æ‰“å¼€çŠ¶æ€ä¸‹çš„transform 5.å› ä¸ºä¹¦æœ¬ä¸€å¼€å§‹æ˜¯åˆä¸Šçš„ï¼Œæ‰€ä»¥éœ€è¦åˆä¸Šæ‰€æœ‰é¡µé¢ç„¶åæ›´æ–°é˜´å½±å±‚ 6.æœ€åå¿½ç•¥å°é¢çš„é˜´å½± ç¬¬äºŒé˜¶ç«¯â€”â€”æ‰“å¼€ä¹¦ç±æˆ‘ä»¬å·²ç»å®Œæˆç¬¬ä¸€é˜¶æ®µçš„è¿‡æ¸¡è½¬åœºï¼Œæ˜¯æ—¶å€™æ’¸ä¸€æ’¸ç¬¬äºŒé˜¶æ®µçš„äº†ã€‚ç¬¬äºŒé˜¶æ®µæ˜¯æœ‰é—­åˆåˆ°æ‰“å¼€çš„çŠ¶æ€ã€‚ åœ¨ setStartPositionForPush(_:toVC:)) æ–¹æ³•ä¸‹æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456789101112func setEndPositionForPush(fromVC: BooksViewController, toVC: BookViewController) &#123; //1 for cell in fromVC.collectionView!.visibleCells() as! [BookCoverCell] &#123; cell.alpha = 0 &#125; //2 for cell in toVC.collectionView!.visibleCells() as! [BookPageCell] &#123; cell.layer.transform = transforms[cell]! cell.updateShadowLayer(animated: true) &#125;&#125; åˆ†æä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼š 1.éšè—æ‰€æœ‰ä¹¦çš„å°é¢ï¼Œå› ä¸ºæˆ‘ä»¬å°†å±•ç¤ºé€‰ä¸­ä¹¦ç±çš„é¡µé¢ã€‚ 2.éå†æ‰€æœ‰é¡µé¢ç„¶ååŠ è½½ä¹‹å‰ä¿å­˜çš„æ‰“å¼€çŠ¶æ€ä¸‹çš„ transform å½“ä½ ä» BooksViewController push åˆ° BookViewController ä¹‹åï¼Œè¿˜åŸä¹‹å‰çš„ä¸€äº›è®¾ç½®ã€‚ åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š 1234func cleanupPush(fromVC: BooksViewController, toVC: BookViewController) &#123; // Add background back to pushed view controller toVC.collectionView?.backgroundColor = toViewBackgroundColor&#125; push å®Œæˆåå°† BookViewController çš„èƒŒæ™¯è‰²è®¾ç½®ä¸ºä½ ä¹‹å‰ä¿å­˜çš„èƒŒæ™¯è‰²ï¼Œå°†ä¸‹é¢æ‰€æœ‰ä¸œè¥¿éƒ½éšè—èµ·æ¥ã€‚ å®ç°å¼€ä¹¦è½¬åœºä¸Šé¢æ‰€æœ‰å·¥å…·æ–¹æ³•å·²ç»æ•´è£…å¾…å‘ï¼Œæ¥ç€æˆ‘ä»¬æ¥å®ç° push åŠ¨ç”»ã€‚å°†ä¸‹é¢ä»£ç åŠ åˆ° animateTransition(_:) ä¸­ï¼š 1234567891011121314151617181920212223242526//1let container = transitionContext.containerView()//2if isPush &#123; //3 let fromVC = transitionContext.viewControllerForKey(UITransitionContextFromViewControllerKey) as! BooksViewController let toVC = transitionContext.viewControllerForKey(UITransitionContextToViewControllerKey) as! BookViewController //4 container.addSubview(toVC.view) // Perform transition //5 self.setStartPositionForPush(fromVC, toVC: toVC) UIView.animateWithDuration(self.transitionDuration(transitionContext), delay: 0.0, usingSpringWithDamping: 0.7, initialSpringVelocity: 0.7, options: nil, animations: &#123; //6 self.setEndPositionForPush(fromVC, toVC: toVC) &#125;, completion: &#123; finished in //7 self.cleanupPush(fromVC, toVC: toVC) //8 transitionContext.completeTransition(finished) &#125;)&#125; else &#123; //POP&#125; ä¸‹é¢è§£é‡Šä¸€ä¸‹ä¸Šé¢ä»£ç åšäº†å“ªäº›äº‹ï¼š 1.è·å–å®¹å™¨è§†å›¾ï¼Œå®ƒåœ¨è½¬åœºè¿‡ç¨‹ä¸­å……å½“çˆ¶è§†å›¾è§’è‰²ã€‚ 2.åˆ¤æ–­å½“å‰æ˜¯æ‰§è¡Œ push æ“ä½œ 3.è·å– fromVC å’Œ toVC 4.å°† toVC åŠ å…¥åˆ°å½“å‰å®¹å™¨è§†å›¾ 5.è®¾ç½®é—­åˆçŠ¶æ€ä¸‹ toVC å’Œ fromVC çš„èµ·å§‹ä½ç½® 6.ä»èµ·å§‹ä½ç½®åšåŠ¨ç”»ï¼Œç›´åˆ°ç»ˆç‚¹ä½ç½® 7.è¿˜åŸè®¾ç½® 8.å‘ŠçŸ¥ç³»ç»Ÿè½¬åœºå·²å®Œæˆ åœ¨å¯¼èˆªæ§åˆ¶å™¨ä¸­ä½¿ç”¨ push è½¬åœºä¸Šé¢æˆ‘ä»¬å·²ç»å®ç°äº† push è½¬åœºåŠ¨ç”»ï¼Œæ˜¯æ—¶å€™æ¥ä½¿ç”¨å®ƒäº†ã€‚æ‰“å¼€ BooksViewController.swift å°†ä¸‹é¢å±æ€§æ·»åŠ åˆ°ç±»å£°æ˜ä¹‹åï¼š 1var transition: BookOpeningTransition? è¿™ä¸ªå±æ€§æ˜¯è½¬åœºç±»å®ä¾‹ï¼Œå®ƒå¸®åŠ©ä½ åˆ¤æ–­å½“å‰è½¬åœºæ˜¯ push è¿˜æ˜¯ popã€‚æ·»åŠ å¦‚ä¸‹æ‰©å±•ï¼š 123456789101112extension BooksViewController &#123;func animationControllerForPresentController(vc: UIViewController) -&gt; UIViewControllerAnimatedTransitioning? &#123; // 1 var transition = BookOpeningTransition() // 2 transition.isPush = true // 3 self.transition = transition // 4 return transition &#125;&#125; 1.åˆ›å»ºä¸€ä¸ª transition 2.è®¾ç½® isPush ä¸º true 3&amp;4.ä¿å­˜å½“å‰ transitionï¼Œè¿”å› transition æ¥ç€æ‰“å¼€ CustomNavigationController.swift ç”¨ä¸‹é¢ä»£ç æ›¿æ¢ push çš„ if åˆ¤æ–­ 12345if operation == .Push &#123; if let vc = fromVC as? BooksViewController &#123; return vc.animationControllerForPresentController(toVC) &#125;&#125; è¿™ä¸€æ­¥åˆ¤æ–­åˆ¤æ–­æ˜¯å¦ä» BooksViewController ä¸­ push è¿‡æ¥çš„ï¼Œç„¶åç”¨ä½ åˆ›å»ºçš„ BookOpeningTransition æ¥åšè½¬åœºå±•ç¤ºä½ çš„ BookViewControllerã€‚ è¿è¡Œï¼Œé€‰ä¸­æŸæœ¬ä¹¦ä½ ä¼šçœ‹åˆ°ï¼Œä¹¦æœ¬åœ¨å¼€ã€åˆä¹‹é—´çš„åŠ¨ç”»éå¸¸é¡ºç•…ã€‚ WTFâ€¦è¿™è´§çœ‹èµ·æ¥æ²¡æœ‰åŠ¨ç”»ï¼Ÿï¼ å®ƒç›´æ¥ä»é—­åˆçŠ¶æ€è·³è½¬åˆ°æ‰“å¼€çŠ¶æ€ï¼Œä¸è¦æ…Œï¼Œè¿™æ˜¯å› ä¸ºä½ è¿˜æ²¡æœ‰åŠ è½½é¡µé¢ cellã€‚å¯¼èˆªæ§åˆ¶å™¨ä» BooksViewController è¿‡æ¸¡åˆ° BookViewControllerï¼Œä»–ä»¬ä¸¤ä¸ªéƒ½æ˜¯ç»§æ‰¿è‡ª UICollectionViewControllerã€‚UICollectionViewCell æ²¡æœ‰åœ¨ä¸»çº¿ç¨‹ä¸­åŠ è½½ï¼Œæ‰€ä»¥æ²¡æœ‰åŠ¨ç”»è¿‡ç¨‹ã€‚ä½ éœ€è¦ç»™ collectionView è¶³å¤Ÿçš„æ—¶é—´è®©å®ƒæ¥åŠ è½½æ‰€æœ‰çš„ cellã€‚æ‰“å¼€ BooksViewController.swift ç„¶åä½¿ç”¨ä¸‹é¢ä»£ç æ›¿æ¢ openBook(_:)ï¼š 1234567891011func openBook(book: Book?) &#123; let vc = storyboard?.instantiateViewControllerWithIdentifier("BookViewController") as! BookViewController vc.book = selectedCell()?.book //1 vc.view.snapshotViewAfterScreenUpdates(true) //2 dispatch_async(dispatch_get_main_queue(), &#123; () -&gt; Void in self.navigationController?.pushViewController(vc, animated: true) return &#125;)&#125; ä¸‹é¢è¯´ä¸‹æ˜¯å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼š 1.å½“è½¬åœºè¦å‘ç”Ÿæ—¶å‘Šè¯‰ BookViewController å»æˆªå–å½“å‰è§†å›¾ 2.ç¡®å®šæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­ pushï¼Œæ¥ç»™ cell è¶³å¤Ÿçš„æ—¶é—´è¿›è¡ŒåŠ è½½ è¿è¡Œç¨‹åºï¼Œåº”è¯¥å’Œä¸‹å›¾ç±»ä¼¼ï¼š çœ‹èµ·æ¥æ›´å®Œç¾äº†ã€‚è‡³æ­¤ push çš„è½¬åœºå·²ç»å®Œæˆï¼Œç»§ç»­æ’¸ pop çš„è½¬åœºã€‚ å®ç° Pop è½¬åœºçš„å·¥å…·æ–¹æ³•pop çš„è¿‡ç¨‹å’Œ push è¿‡ç¨‹åˆšå¥½ç›¸åã€‚ç¬¬ä¸€é˜¶æ®µæ˜¯ä¹¦æ‰“å¼€çŠ¶æ€ï¼Œç¬¬äºŒé˜¶æ®µæ˜¯ä¹¦æœ¬é—­åˆçŠ¶æ€ã€‚ æ‰“å¼€ BookOpeningTransition.swift æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456// MARK: Pop methodsfunc setStartPositionForPop(fromVC: BookViewController, toVC: BooksViewController) &#123; // Remove background from the pushed view controller toViewBackgroundColor = fromVC.collectionView?.backgroundColor fromVC.collectionView?.backgroundColor = nil&#125; è¯¥æ–¹æ³•å­˜å‚¨äº† BookViewController çš„èƒŒæ™¯è‰²ç„¶åç§»é™¤äº† BooksViewController ä¸­ collectionView çš„èƒŒæ™¯è‰²ã€‚æˆ‘ä»¬ä¸éœ€è¦è®¾ç½®ä»»ä½•çš„ transformï¼Œå› ä¸ºä¹¦æœ¬å½“å‰çŠ¶æ€å°±æ˜¯æ‰“å¼€çŠ¶æ€ã€‚æ¥ä¸‹æ¥æ·»åŠ å¦‚ä¸‹ä»£ç åˆ°ä¸Šè¿°ä»£ç ä¹‹åï¼š 1234567891011121314func setEndPositionForPop(fromVC: BookViewController, toVC: BooksViewController) &#123; //1 let coverCell = toVC.selectedCell() //2 for cell in toVC.collectionView!.visibleCells() as! [BookCoverCell] &#123; if cell != coverCell &#123; cell.alpha = 1 &#125; &#125; //3 for cell in fromVC.collectionView!.visibleCells() as! [BookPageCell] &#123; closePageCell(cell) &#125;&#125; è¯¥æ–¹æ³•è®¾ç½® pop è½¬åœºçš„æœ€ç»ˆçŠ¶æ€ï¼š 1.è·å–å½“å‰é€‰ä¸­ä¹¦æœ¬çš„å°é¢ 2.åœ¨ä¹¦æœ¬é—­åˆçŠ¶æ€ï¼Œéå† BooksViewController æ‰€æœ‰ä¹¦æœ¬å°é¢ï¼Œç„¶åæ¸æ˜¾ 3.éå† BookViewController ä¸­æ‰€æœ‰çš„ cellï¼Œç„¶åå°†å®ƒä»¬è½¬æ¢æˆé—­åˆæ€ ç„¶ååŠ å…¥ä»¥ä¸‹ä»£ç ï¼š 123456func cleanupPop(fromVC: BookViewController, toVC: BooksViewController) &#123; // Add background back to pushed view controller fromVC.collectionView?.backgroundColor = self.toViewBackgroundColor // Unhide the original book cover toVC.selectedCell()?.alpha = 1&#125; è¯¥æ–¹æ³•åœ¨ pop è½¬åœºç»“æŸååšäº†ä¸€äº›è¿˜åŸå·¥ä½œã€‚ä¸»è¦æ˜¯å°† BooksViewController çš„ collectionView çš„èƒŒæ™¯è‰²è¿˜åŸæˆä¹‹å‰çš„çŠ¶æ€ï¼Œä»¥åŠå±•ç¤ºä¹‹å‰çš„ä¹¦æœ¬å°é¢ã€‚æŠŠä¸‹é¢ä»£ç åŠ åˆ°ä»£ç†æ–¹æ³• animateTransition(_:) ä¸­çš„ å¸¦æœ‰ //POP æ³¨é‡Šçš„ else å¤§æ‹¬å·å†…ã€‚ 123456789101112131415161718//1let fromVC = transitionContext.viewControllerForKey(UITransitionContextFromViewControllerKey) as! BookViewControllerlet toVC = transitionContext.viewControllerForKey(UITransitionContextToViewControllerKey) as! BooksViewController //2container.insertSubview(toVC.view, belowSubview: fromVC.view) //3setStartPositionForPop(fromVC, toVC: toVC)UIView.animateWithDuration(self.transitionDuration(transitionContext), animations: &#123; //4 self.setEndPositionForPop(fromVC, toVC: toVC)&#125;, completion: &#123; finished in //5 self.cleanupPop(fromVC, toVC: toVC) //6 transitionContext.completeTransition(finished)&#125;) ä¸‹é¢è§£é‡Šä¸‹ pop è½¬åœºåŠ¨ç”»çš„å·¥ä½œåŸç†ï¼š 1.è·å–è½¬åœºè¿‡ç¨‹ä¸­çš„æ§åˆ¶å™¨ã€‚fromVC ç°åœ¨å˜æˆäº† BookViewControllerï¼ŒtoVC å˜æˆäº† BooksViewControllerã€‚ 2.åœ¨ containerView ä¸­æŠŠ BooksViewController çš„è§†å›¾æ”¾ç½®åˆ° BookViewController è§†å›¾ä¸‹é¢ã€‚ 3.setStartPositionForPop(_:toVC) æ–¹æ³•å­˜å‚¨äº†èƒŒæ™¯è‰² 4.ç”¨åŠ¨ç”»å½¢å¼å°†ä¹¦æœ¬æœ‰æ‰“å¼€çŠ¶æ€è½¬æ¢åˆ°é—­åˆçŠ¶æ€ 5.åŠ¨ç”»å®Œæˆåˆ™åšè¿˜åŸè®¾ç½®ï¼Œå°†èƒŒæ™¯è‰²è®¾ç½®ä¸ºä¹‹å‰ä¿å­˜çš„ï¼Œç„¶åæ˜¾ç¤ºä¹¦æœ¬å°é¢ 6.é€šçŸ¥è½¬åœºå®Œæˆ åœ¨å¯¼èˆªæ§åˆ¶å™¨ä¸­ä½¿ç”¨ pop è½¬åœºç°åœ¨è®©æˆ‘ä»¬åƒä¹‹å‰æ·»åŠ è‡ªå®šä¹‰ push åŠ¨ç”»é‚£æ ·å°† pop åŠ¨ç”»ä¹ŸåŠ å…¥åˆ°ä»£ç†æ–¹æ³•ä¸­å»ã€‚æ‰“å¼€ BooksViewController.swift ç„¶ååœ¨ animationControllerForPresentController(_:) æ–¹æ³•åæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456func animationControllerForDismissController(vc: UIViewController) -&gt; UIViewControllerAnimatedTransitioning? &#123; var transition = BookOpeningTransition() transition.isPush = false self.transition = transition return transition&#125; è¿™ä¸ªæ–¹æ³•åŒæ ·åˆ›å»ºä¸€ä¸ª BookOpeningTransition å®ä¾‹ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯å…¶ transition è®¾ç½®ä¸º popã€‚æ‰“å¼€ CustomNavigationController.swift ç”¨ä¸‹é¢ä»£ç æ›¿æ¢ä¹‹å‰çš„ if é€»è¾‘ï¼š 12345if operation == .Pop &#123; if let vc = toVC as? BooksViewController &#123; return vc.animationControllerForDismissController(vc) &#125;&#125; å®ƒè¿”å›ä¸€ä¸ª transitionï¼Œç„¶åæ‰§è¡Œ pop åŠ¨ç”»æ¥æŠŠä¹¦åˆä¸Šã€‚è¿è¡Œç¨‹åºï¼Œé€‰ä¸­ä¸€æœ¬ä¹¦ï¼Œçœ‹ä¸‹å®ƒçš„æ‰“å¼€å’Œé—­åˆçŠ¶æ€ï¼Œåº”è¯¥å’Œä¸‹å›¾ç±»ä¼¼ï¼š åˆ›å»ºä¸€ä¸ªå¯äº¤äº’çš„å¯¼èˆªæ§åˆ¶å™¨æ‰“å¼€å’Œå…³é—­è½¬åœºåŠ¨ç”»çœ‹èµ·æ¥éå¸¸å±Œï¼Œä½†æ˜¯ä½ å¯ä»¥åšå¾—æ›´å¥½ã€‚ä½ å¯ä»¥ä½¿ç”¨ pinch æ‰‹åŠ¿æ¥æ§åˆ¶ä¹¦çš„å¼€ã€åˆã€‚é¦–å…ˆæ‰“å¼€ BookOpeningTransition.swift æ·»åŠ å¦‚ä¸‹å±æ€§ï¼š 12// MARK: Interaction Controllervar interactionController: UIPercentDrivenInteractiveTransition? æ¥ç€æ‰“å¼€ CustomNavigationController.swift ç„¶åæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456func navigationController(navigationController: UINavigationController, interactionControllerForAnimationController animationController: UIViewControllerAnimatedTransitioning) -&gt; UIViewControllerInteractiveTransitioning? &#123; if let animationController = animationController as? BookOpeningTransition &#123; return animationController.interactionController &#125; return nil&#125; ä¸Šè¿°æ–¹æ³•è¿”å›ä¸€ä¸ªå¯äº¤äº’çš„åŠ¨ç”»å¯¹è±¡ã€‚å®ƒä½¿å¾—å¯¼èˆªæ§åˆ¶å™¨æ§åˆ¶ç€æ•´ä¸ªåŠ¨ç”»è¿‡ç¨‹ï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥ä½¿ç”¨ pinch æ‰‹åŠ¿æ¥æ§åˆ¶ä¹¦æœ¬çš„å¼€ã€åˆã€‚æ‰“å¼€ BooksViewController.swift åœ¨transition å˜é‡ä¸‹æ·»åŠ å¦‚ä¸‹å±æ€§ï¼š 12345678910//1var interactionController: UIPercentDrivenInteractiveTransition?//2var recognizer: UIGestureRecognizer? &#123; didSet &#123; if let recognizer = recognizer &#123; collectionView?.addGestureRecognizer(recognizer) &#125; &#125;&#125; ä¸‹é¢è§£é‡Šä¸ºä»€ä¹ˆè¦æ·»åŠ è¿™å‡ ä¸ªå˜é‡ï¼š 1.interactionController æ˜¯ä¸€ä¸ª UIPercentDrivenInteractiveTransition å®ä¾‹ï¼Œå®ƒç®¡ç† VC è½¬åœºè¿‡ç¨‹ä¸­è‡ªå®šä¹‰åŠ¨ç”»çš„å‡ºç°å’Œæ¶ˆå¤±ã€‚è¿™ä¸ªå¯äº¤äº’æ§åˆ¶å™¨åŒæ ·ä¾èµ–ä¸€ä¸ª transition animatorã€‚è¿™ä¸ª animator å®ç°äº† UIViewControllerAnimatorTransitioning åè®®ï¼Œä½ åˆšæ‰åˆ›å»ºçš„ BookOpeningTransition å°±æ˜¯å¹²è¿™ä»¶äº‹çš„ã€‚iteractionController å¯ä»¥æ§åˆ¶ push å’Œ pop çš„è¿‡ç¨‹ï¼Œå¦‚æœæƒ³è¦äº†è§£æ›´å¤šç»†èŠ‚å¯ä»¥å‚è€ƒè‹¹æœå®˜æ–¹æ–‡æ¡£ã€‚ 2.recognizer æ˜¯ä¸€ä¸ª UIGestureRecognizer å®ä¾‹ã€‚ä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥æ§åˆ¶ä¹¦æœ¬çš„å¼€ã€åˆã€‚ åœ¨ BooksViewController æ‰©å±•ä¸­çš„ animationControllerForPresentController(_:) æ–¹æ³•ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œå°†å…¶æ”¾åœ¨ transition.isPush = true è¿™ä¸€è¡Œä¹‹åï¼š 1transition.interactionController = interactionController è¿™è¡Œä»£ç è®©è‡ªå®šä¹‰å¯¼èˆªæ§åˆ¶å™¨çŸ¥é“ä½¿ç”¨é‚£ä¸€ä¸ªäº¤äº’æ§åˆ¶å™¨ã€‚åŒæ ·æŠŠä¸Šé¢åœ¨æ·»åŠ åˆ° animationControllerForDismissController(_:) æ–¹æ³•ä¸­ transition.isPush = false ä¹‹åã€‚ç´§æ¥ç€åœ¨ viewDidLoad() ä¸­åŠ å…¥ä¸‹é¢ä¸€è¡Œä»£ç ï¼š 1recognizer = UIPinchGestureRecognizer(target: self, action: "handlePinch:") å®ƒåˆå§‹åŒ–äº†ä¸€ä¸ª UIPinchGestureRecognizer å®ä¾‹ï¼Œè¿™ä¸ª pinch æ‰‹åŠ¿çš„ action æ˜¯ handlePinch(_:)ã€‚ ç°åœ¨æˆ‘ä»¬æ¥å®ç° handlePinch(_:) è¿™ä¸ªæ–¹æ³•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243// MARK: Gesture recognizer actionfunc handlePinch(recognizer: UIPinchGestureRecognizer) &#123; switch recognizer.state &#123; case .Began: //1 interactionController = UIPercentDrivenInteractiveTransition() //2 if recognizer.scale &gt;= 1 &#123; //3 if recognizer.view == collectionView &#123; //4 var book = self.selectedCell()?.book //5 self.openBook(book) &#125; //6 &#125; else &#123; //7 navigationController?.popViewControllerAnimated(true) &#125; case .Changed: //8 if transition!.isPush &#123; //9 var progress = min(max(abs((recognizer.scale - 1)) / 5, 0), 1) //10 interactionController?.updateInteractiveTransition(progress) //11 &#125; else &#123; //12 var progress = min(max(abs((1 - recognizer.scale)), 0), 1) //13 interactionController?.updateInteractiveTransition(progress) &#125; case .Ended: //14 interactionController?.finishInteractiveTransition() //15 interactionController = nil default: break &#125;&#125; å¯¹äº UIPinchGestureRecognizerï¼Œæˆ‘ä»¬å…³å¿ƒä¸‰ç§ä¸åŒçš„çŠ¶æ€ï¼šbeganï¼Œchangedï¼Œendã€‚ beginçŠ¶æ€ 1.åˆå§‹åŒ–ä¸€ä¸ª UIPercentDrivenInteractiveTransition å¯¹è±¡ 2.åˆ¤æ–­ scaleï¼Œ ä¹Ÿå°±æ˜¯ pinch æ‰‹åŠ¿ç§»åŠ¨çš„è·ç¦»ï¼Œçœ‹èµ·æ˜¯å¦å¤§äºç­‰äº1 3.å¦‚æœæ˜¯ï¼Œç¡®ä¿æ‰‹åŠ¿å‘ç”Ÿåœ¨ colletionView å½“ä¸­ 4.è·å–å½“å‰æ‰‹åŠ¿æ‰€ä½œç”¨çš„ä¹¦è„Š 5.æ‰§è¡Œ push è½¬åœºåŠ¨ç”»ï¼Œæ˜¾ç¤ºä¹¦ç±é¡µé¢ 6.å¦‚æœå°äº1 7.æ‰§è¡Œ pop åŠ¨ç”»æ¥å±•ç¤ºä¹¦æœ¬å°é¢ changed çŠ¶æ€ 8.åˆ¤æ–­å½“å‰è½¬åœºæ˜¯å¦ä¸º push 9.å¦‚æœæ­£ push åˆ° BookViewControllerï¼Œè·å–ç”¨æˆ· pinch æ‰‹åŠ¿çš„ç™¾åˆ†æ¯”ã€‚å°† pinch æ‰‹åŠ¿ç¼©å°ä¸ºå…¶åŸå§‹å€¼çš„ 1/5ï¼Œè¿™æ ·ç”¨æˆ·æ›´åŠ å®¹æ˜“æ§åˆ¶è½¬åœºè¿‡ç¨‹ 10.æ ¹æ®ä¹‹å‰è®¡ç®—çš„ç™½å°é—­æ›´æ–° transition å®ŒæˆçŠ¶æ€çš„ç™¾åˆ†æ¯”ã€‚ 11.å¦‚æœå½“å‰è½¬åœºä¸æ˜¯ pushï¼Œé‚£è‚¯å®šæ˜¯ pop 12.å½“ä½¿ç”¨ pinch æ‰‹åŠ¿æ§åˆ¶ä¹¦æœ¬å…³é—­æ—¶ï¼Œç¼©æ”¾æ¯”ä¸€å®šæ˜¯ä»1å˜åˆ°0 13.æœ€åæ›´æ–° transition çš„è¿›åº¦ end çŠ¶æ€ 14.é€šçŸ¥ç³»ç»Ÿç”¨æˆ·è½¬åœºäº¤äº’å·²å®Œæˆ 15.å°†äº¤äº’ controller ç½®ä¸º nil æœ€åï¼Œä½ éœ€è¦å®ç° pinch-to-closed çŠ¶æ€ã€‚å› æ­¤ä½ éœ€è¦å°†æ‰‹åŠ¿ä¼ é€’ç»™ BookViewControllerï¼Œè¿™æ ·ä»–å°±èƒ½è‡ªå‘è¿›è¡Œ popã€‚ 1234567var recognizer: UIGestureRecognizer? &#123; didSet &#123; if let recognizer = recognizer &#123; collectionView?.addGestureRecognizer(recognizer) &#125; &#125;&#125; å½“ä½ åœ¨ BookViewController ä¸­è®¾ç½®å¥½æ‰‹åŠ¿æ—¶ï¼Œå®ƒä¼šé©¬ä¸Šè¢«åŠ åˆ° collectionView ä¸­åŒºï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ç”¨æˆ·åˆä¸Šä¹¦æœ¬çš„æ—¶å€™è¿½è¸ª pinch æ‰‹åŠ¿ã€‚ä¸‹é¢éœ€è¦åœ¨ BooksViewController å’Œ BookViewController ä¹‹é—´è¿›è¡Œæ‰‹åŠ¿çš„ä¼ é€’ã€‚æ‰“å¼€ BookOpeningTransition.swift æ·»åŠ ä¸‹é¢ä¸€è¡Œä»£ç åˆ° cleanUpPush(_:toVC) æ–¹æ³•ä¸­ï¼Œå¹¶ä¸”å°†å®ƒæ”¾åœ¨è®¾ç½®èƒŒæ™¯è‰²ä¹‹åï¼š 12// Pass the gesture recognizertoVC.recognizer = fromVC.recognizer å½“ä» BooksViewController push åˆ° BookViewControlleråï¼Œä½ éœ€è¦å°†æ‰‹åŠ¿å›ä¼ ã€‚åŠ å…¥ä¸‹é¢ä»£ç åˆ° cleanUpPop(_:toVC) æ–¹æ³•ä¸­ï¼ŒåŒæ ·æ˜¯æ”¾åœ¨è®¾ç½®èƒŒæ™¯è‰²ä¹‹åï¼š 12// Pass the gesture recognizertoVC.recognizer = fromVC.recognizer è¿è¡Œç¨‹åºï¼Œé€‰ä¸­ä»»æ„ä¸€æœ¬ä¹¦ç„¶åä½¿ç”¨ pinch æ‰‹åŠ¿æ¥æ§åˆ¶ä¹¦æœ¬çš„å¼€ã€åˆã€‚ ç”¨ pinch æ”¶æ‹¾æ¥æ§åˆ¶ä¹¦æœ¬çš„å¼€åˆæ˜¾å¾—éå¸¸è‡ªç„¶ï¼ŒåŒæ ·å¯ä»¥è®©ç•Œé¢æ›´åŠ ç®€æ´ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦å¯¼èˆªæ ä¸Šçš„è¿”å›æŒ‰é’®ï¼Œæ˜¯æ—¶å€™æ¥æ¸…ç†å®ƒäº†ã€‚ å¦‚ä¸‹å›¾è®¾ç½®å³å¯ï¼š ç»§ç»­è¿è¡Œï¼Œå¯ä»¥çœ‹åˆ°å¯¼èˆªæ ä¸å¤å­˜åœ¨ç”»é¢å˜å¾—æ›´åŠ ç®€æ´ï¼:] ä½•å»ä½•ä»ä½ å¯ä»¥åœ¨æ­¤ä¸‹è½½å®Œæ•´ä»£ç ã€‚åœ¨è¿™ç³»åˆ—æ•™ç¨‹ä¸­ï¼Œä½ å­¦ä¼šäº†å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰å¸ƒå±€ã€è‡ªå®šä¹‰è½¬åœºã€ä½¿ç”¨æ‰‹åŠ¿æ¥æ§åˆ¶è½¬åœºäº¤äº’ã€‚æˆ‘å¸Œæœ›ä½ å–œæ¬¢è¿™ç¯‡æ•™ç¨‹å¹¶ä»ä¸­å—ç›Šï¼Œæˆ‘æƒ³åœ¨æ­¤æ„Ÿè°¢Attila HegedÃ¼såˆ›å»ºäº†è¿™ä¸ªç¢‰å ¡çš„é¡¹ç›®ã€‚å¦‚æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·åœ¨ä¸‹é¢ç•™è¨€æŒ‡å‡ºã€‚]]></content>
      <categories>
        <category>ç¿»è¯‘</category>
      </categories>
      <tags>
        <tag>UICollectionView</tag>
        <tag>ç¿»è¯‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•åˆ›å»ºä¸€ä¸ªç¿»ä¹¦åŠ¨ç”»(Part 1)[è¯‘]]]></title>
    <url>%2F2015%2F08%2F31%2FHow-to-Create-an-iOS-Book-Open-Animation-part-one-translation%2F</url>
    <content type="text"><![CDATA[åœ¨è¿™ä¸ªåˆ†ä¸¤éƒ¨åˆ†çš„æ•™ç¨‹ç³»åˆ—ä¸­ï¼Œä½ å°†å¼€å‘ä¸€ä¸ªæ¼‚äº®çš„ iOS æ‰“å¼€åŠç¿»ä¹¦åŠ¨ç”»ï¼Œç±»ä¼¼äºPaper by FiftyThreeï¼š 2019.11.21 updateæœ¬æ–‡ä¸­å›¾ç‰‡å’Œèµ„æºç›¸å…³é“¾æ¥å¯èƒ½å·²å¤±æ•ˆï¼Œå¦‚éœ€æŸ¥é˜…ï¼Œè¯·æŸ¥çœ‹åŸæ–‡ ç¬¬ä¸€éƒ¨åˆ†ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•è‡ªå®šä¹‰ UICollectionViewLayoutï¼Œç„¶åä½¿ç”¨æ™¯æ·±å’Œé˜´å½±æ¥è®© app çœ‹èµ·æ¥æ›´åŠ çœŸå®ã€‚ ç¬¬äºŒéƒ¨åˆ†(è¯‘æ–‡)ï¼Œä½ å°†å­¦ä¹ åˆ›å»ºè‡ªå®šä¹‰çš„è½¬åœºåŠ¨ç”»ï¼Œç„¶åé›†æˆæ‰‹åŠ¿æ¥åˆ›å»ºè‡ªç„¶ã€ç®€æ´çš„ view ä¹‹é—´çš„è½¬åœºã€‚ åŸæ–‡ï¼šHow to Create an iOS Book Open Animation: Part 1 æœ¬æ•™ç¨‹ä¸»è¦é’ˆå¯¹äºè¿›é˜¶ä¸­çš„å¼€å‘è€…ï¼Œè®²è§£ä¸€äº›è‡ªå®šä¹‰è½¬åœºä»¥åŠè‡ªå®šä¹‰ collectionView Layout ç›¸å…³çš„çŸ¥è¯†ã€‚å¦‚æœä½ ä¹‹å‰æ²¡æœ‰ç”¨è¿‡ collectionViewï¼Œé‚£ä¹ˆå»ºè®®ä½ å…ˆçœ‹çœ‹å…¶ä»–å…³äº collectionView çš„æ•™ç¨‹ã€‚ æ„Ÿè°¢Attila HegedÃ¼såˆ›å»ºäº†è¿™ä¸ªæ£’æ£’å“’ç¤ºä¾‹å·¥ç¨‹ã€‚ å¼€å§‹ä¸‹è½½æ¨¡æ¿ï¼Œè§£å‹ï¼Œåœ¨ Xcode ä¸­æ‰“å¼€ã€‚ä½¿ç”¨æ¨¡æ‹Ÿå™¨è¿è¡Œç¨‹åºï¼Œå°†å¾—åˆ°å¦‚ä¸‹ç”»é¢ï¼š è¿™ä¸ªåº”ç”¨å·²ç»åˆå…·å…¶åŠŸèƒ½ï¼Œä½ å¯ä»¥æ»‘åŠ¨ä¹¦åº“ç„¶åé€‰ä¸­ä½ å–œæ¬¢çš„ä¹¦æ¥ç¿»é˜…ã€‚ä¸Šä¸€æ¬¡ä½ ä¸€é¡µä¸€é¡µç¿»çœ‹ä¹¦ç±æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿåœ¨ç°æœ‰å¯¹ collectionView äº†è§£çš„åŸºç¡€ä¸Šï¼Œä½ å¯ä»¥ç¾åŒ–é¡µé¢è§†å›¾ã€‚ å·¥ç¨‹ç»“æ„ä¸‹é¢æ˜¯å¿«é€Ÿå¯¹åˆå§‹å·¥ç¨‹é‡è¦æ–¹é¢çš„ä¸€ä¸ªç®€è¦æè¿°ï¼šData Model æ–‡ä»¶å¤¹åŒ…å«ä¸‰ä¸ªæ–‡ä»¶ï¼š Books.plistï¼šåŒ…å«æ ·ä¹¦æ•°æ®ã€‚æ¯æœ¬ä¹¦éƒ½å«æœ‰ä¸€ä¸ªå›¾ç‰‡å°é¢ä»¥åŠä¸€ç³»åˆ—çš„ä¹¦é¡µå›¾ç‰‡ BookStore.swiftï¼šå•ä¾‹ï¼Œä¸»è¦å·¥ä½œå°±æ˜¯ä» Books.plist ä¸­åŠ è½½æ•°æ®ç„¶ååˆ›å»º Book å¯¹è±¡ã€‚ Book.swiftï¼šå­˜å‚¨ä¹¦æœ¬ç›¸å…³ä¿¡æ¯çš„ç±» Books æ–‡ä»¶å¤¹åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼š BooksViewController.swiftï¼šUICollectionViewControllerçš„å­ç±»ï¼Œä¸»è¦è´Ÿè´£å±•ç¤ºä¹¦å• BookCoverCell.swiftï¼šå±•ç¤ºæ‰€æœ‰ä¹¦çš„å°é¢ï¼Œåœ¨BooksViewControllerä½¿ç”¨ã€‚ Book æ–‡ä»¶å¤¹åŒ…å«ä¸‹é¢å‡ ä¸ªæ–‡ä»¶ï¼š BookViewController.swiftï¼šä¹Ÿæ˜¯UICollectionViewControllerçš„å­ç±»ï¼Œç”¨æ¥å±•ç¤ºBooksViewControllerä¸­é€‰ä¸­çš„æŸä¸€æœ¬ä¹¦çš„å†…å®¹é¡µé¢ BookPageCell.swiftï¼šç”¨æ¥å±•ç¤ºä¹¦çš„æ‰€æœ‰é¡µé¢ï¼Œåœ¨BookViewControllerä¸­ä½¿ç”¨ã€‚ æœ€åä¸€ä¸ªæ–‡ä»¶å¤¹ Helper ä¸­åŒ…å«ï¼š UIImage+Helpers.swiftï¼šæ˜¯ UIImage çš„ä¸€ä¸ªæ‰©å±•ã€‚é‡Œé¢æœ‰ä¸¤ä¸ªå·¥å…·æ–¹æ³•ï¼Œä¸€ä¸ªç”¨æ¥åœ†è§’åŒ–å›¾ç‰‡ï¼Œå¦ä¸€ä¸ªç”¨æ¥ç¼©æ”¾å›¾ç‰‡åˆ°æŒ‡å®šå¤§å°ã€‚ ä»¥ä¸Šå°±æ˜¯æ•´ä¸ªå·¥ç¨‹çš„ç›®å½•ç»“æ„ã€‚ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹æ’¸ä»£ç å§ï¼ è‡ªå®šä¹‰ Book å¸ƒå±€é¦–å…ˆä½ éœ€è¦ä¸ºBooksViewControllerçš„ collectionViewå¤å†™é»˜è®¤çš„å¸ƒå±€ï¼Œé»˜è®¤å¸ƒå±€æ˜¾ç¤º3ä¸ªå¤§çš„ä¹¦æœ¬å°é¢ï¼Œå®ƒä»¬å‡ ä¹å æ®æ•´ä¸ªå±å¹•ã€‚ä½ éœ€è¦ç¼©å°å®ƒä»¬æ¥è®©å®ƒçœ‹èµ·æ¥æ›´èˆ’æœï¼Œåƒè¿™æ ·ï¼š åœ¨ä½ æ»‘åŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œæœ€æ¥è¿‘å±å¹•ä¸­å¿ƒçš„å°é¢å°†ä¼šå˜å¤§ä¸€äº›æ¥è¡¨ç¤ºå®ƒå½“å‰è¢«é€‰ä¸­ã€‚ç»§ç»­æ»‘åŠ¨ï¼Œå°é¢å°†ä¼šå˜å°ï¼Œè¿™æ„å‘³ç€ä½ å°†å®ƒç§»åˆ°ä¸€è¾¹å³è¿œç¦»å±å¹•ä¸­å¿ƒã€‚åœ¨ App\Books ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º Layout çš„åˆ†ç»„ï¼Œç„¶åå³å‡» Layout æ–‡ä»¶å¤¹é€‰æ‹©æ–°å»ºæ–‡ä»¶ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªUICollectionViewFlowLayoutçš„å­ç±»ï¼Œå–åä¸ºBooksLayoutï¼Œè¯­è¨€ä¸º Swiftã€‚æ¥ä¸‹æ¥ä½ éœ€è¦å‘Šè¯‰BooksViewControllerçš„ collectionView ä½¿ç”¨ä½ æ–°å»ºçš„ Layoutã€‚æ‰“å¼€Main.storyboardï¼Œé€‰ä¸­BooksViewControllerçš„Collection Viewç„¶ååœ¨å³ä¾§çš„Attributes Inspectorå°† layout è®¾ç½®ä¸º Customï¼ŒClass è®¾ç½®ä¸º BooksLayoutï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ‰“å¼€BooksLayout.swiftï¼Œåœ¨BooksLayoutç±»å£°æ˜ä¸Šé¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 12private let PageWidth: CGFloat = 362private let PageHeight: CGFloat = 568 è¿™ä¸¤ä¸ªå¸¸é‡å°†è¢«ç”¨æ¥è®¾ç½® cell çš„ sizeã€‚æ¥ç€æ·»åŠ ä¸‹é¢åˆå§‹åŒ–æ–¹æ³•ï¼š 1234567required init(coder aDecoder: NSCoder) &#123; super.init(coder: aDecoder) scrollDirection = UICollectionViewScrollDirection.Horizontal //1 itemSize = CGSizeMake(PageWidth, PageHeight) //2 minimumInteritemSpacing = 10 //3&#125; ä¸‹é¢æ˜¯å…³äº1ï¼Œ2ï¼Œ3çš„è§£é‡Šï¼š 1.è®¾ç½®æ»‘åŠ¨æ–¹å‘ä¸ºæ°´å¹³ 2.è®¾ç½® cell çš„é¡µé¢å®½åº¦ä¸º362ï¼Œé«˜åº¦ä¸º568 3.è®¾ç½® cell å‡æœ€å°é—´è·ä¸º10 æ¥ä¸‹æ¥ï¼Œåœ¨init(coder:)åé¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456789101112131415override func prepareLayout() &#123; super.prepareLayout() //The rate at which we scroll the collection view. //1 collectionView?.decelerationRate = UIScrollViewDecelerationRateFast //2 collectionView?.contentInset = UIEdgeInsets( top: 0, left: collectionView!.bounds.width / 2 - PageWidth / 2, bottom: 0, right: collectionView!.bounds.width / 2 - PageWidth / 2 )&#125; prepareLayout()è®©ä½ æœ‰æœºä¼šåœ¨è·å–å¸ƒå±€ä¿¡æ¯å‰è¿›è¡Œä¸€ç³»åˆ—è¿ç®—ã€‚ä¸‹é¢æ˜¯å¯¹æ¯ä¸ªæ•°å­—æ³¨é‡Šçš„è§£é‡Šï¼š 1.è®¾ç½®ç”¨æˆ·æ‰‹æŒ‡ç§»å¼€åcollectionView çš„å‡é€Ÿé€Ÿç‡ã€‚é€šè¿‡è®¾ç½®å…¶å€¼ä¸ºUIScrollViewDecelerationRateFastï¼ŒcolletionView å°†ä¼šæ›´å¿«é€Ÿçš„åœæ­¢æ»‘åŠ¨ã€‚ä¹Ÿå¯ä»¥å°è¯•ä»¥ä¸‹Normalæ¥æŸ¥çœ‹ä»¥ä¸‹å¯¹æ¯”ã€‚ 2.è®¾ç½® contentInsetï¼Œè®©ç¬¬ä¸€æœ¬ä¹¦çš„å°é¢ä¸€ç›´å±…ä¸­ã€‚ ç°åœ¨ä½ éœ€è¦ä½æ²¡ä¸€ä¸ª cell å¤„ç†å¸ƒå±€ä¿¡æ¯ã€‚åœ¨prepareLayout()æ–¹æ³•ä¸‹é¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456789101112131415161718override func layoutAttributesForElementsInRect(rect: CGRect) -&gt; [AnyObject]? &#123; //1 var array = super.layoutAttributesForElementsInRect(rect) as! [UICollectionViewLayoutAttributes] //2 for attributes in array &#123; //3 var frame = attributes.frame //4 var distance = abs(collectionView!.contentOffset.x + collectionView!.contentInset.left - frame.origin.x) //5 var scale = 0.7 * min(max(1 - distance / (collectionView!.bounds.width), 0.75), 1) //6 attributes.transform = CGAffineTransformMakeScale(scale, scale) &#125; return array&#125; layoutAttributesForElementsInRect(_:)è¿”å›ä¸€ä¸ªåŒ…å«äº†å¤šä¸ªUICollectionViewLayoutAttributeså¯¹è±¡çš„æ•°ç»„ï¼Œè¿™äº›å¯¹è±¡ä¸ºæ¯ä¸ª cell æä¾›å¸ƒå±€å±æ€§ã€‚ä¸‹é¢æ˜¯å¯¹ä»£ç çš„æ‹†åˆ†ï¼š 1.è°ƒç”¨çˆ¶ç±»çš„layoutAttributesForElementsInRectæ–¹æ³•æ¥è·å–æ¯ä¸ª cell é»˜è®¤çš„å¸ƒå±€å±æ€§ 2.éå†æ•°ç»„ä¸­çš„æ¯ä¸ªå±æ€§ 3.è·å–å½“å‰ cell å¸ƒå±€å±æ€§çš„ frame 4.è®¡ç®—å°é¢ä¸å±å¹•ä¸­å¿ƒçš„è·ç¦» 5.æ ¹æ®4ä¸­çš„è·ç¦»æ¥æ”¹å˜å°é¢çš„ scaleï¼Œä½¿å…¶åœ¨0.75åˆ°1ä¹‹é—´ï¼Œæœ€ååœ¨ä¹˜ä»¥ä¸€ä¸ªç³»æ•°0.7è®©å®ƒçœ‹èµ·æ¥æ›´èˆ’æœ 6.æœ€åè®©å°é¢ä½¿ç”¨è®¾ç½®åçš„ scale ç´§æ¥ç€åœ¨layoutAttributesForElementsInRect(_:)ä¹‹åæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123override func shouldInvalidateLayoutForBoundsChange(newBounds: CGRect) -&gt; Bool &#123; return true&#125; è¿”å› true è¡¨ç¤ºåœ¨æ¯ä¸€æ¬¡ collectionView bounds å‘ç”Ÿæ”¹å˜æ—¶å¼ºåˆ¶è®© layout å»é‡æ–°è®¡å®ƒçš„å¸ƒå±€å±æ€§ã€‚collectionView åœ¨æ»‘åŠ¨è¿‡ç¨‹ä¸­ bounds ä¼šå‘ç”Ÿæ”¹å˜ï¼Œè¿™ä½¿å¾—é‡è®¡ç®— cell çš„å¸ƒå±€å±æ€§å˜å¾—å¾ˆæ–¹ä¾¿ã€‚ è¿è¡Œç¨‹åºï¼Œå°†ä¼šå‘ç°ä¸­é—´çš„å°é¢ä¼šæ¯”å…¶ä»–çš„å¤§ã€‚ æ»‘åŠ¨æ¥æŸ¥çœ‹æ¯ä¸ªå°é¢æ˜¯å¦‚ä½•æ”¾å¤§å’Œç¼©å°çš„ã€‚ä½†æ˜¯å¦‚æœä¹¦ç±å¸é™„åœ¨ç›¸åº”ä½ç½®æ˜¯ä¸æ˜¯æ›´å¥½å‘¢ï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥å®ç°è¿™ä¸ªã€‚ ä¹¦æœ¬å¸é™„targetContentOffsetForProposedContentOffset(_:withScrollingVelocity:)å†³å®šcollectionViewåœåœ¨ä»€ä¹ˆä½ç½®ï¼Œç„¶åè¿”å›ä¸€ä¸ªoffsetæ¥è®¾ç½® collectionView çš„ contentOffsetã€‚å¦‚æœä¸å¤å†™è¿™ä¸ªæ–¹æ³•ï¼Œåˆ™è¿”å›é»˜è®¤çš„ offsetã€‚åœ¨shouldInvalidateLayoutForBoundsChange(_:)åé¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456789101112131415161718192021222324252627override func targetContentOffsetForProposedContentOffset(proposedContentOffset: CGPoint, withScrollingVelocity velocity: CGPoint) -&gt; CGPoint &#123; // Snap cells to centre //1 var newOffset = CGPoint() //2 var layout = collectionView!.collectionViewLayout as! UICollectionViewFlowLayout //3 var width = layout.itemSize.width + layout.minimumLineSpacing //4 var offset = proposedContentOffset.x + collectionView!.contentInset.left //5 if velocity.x &gt; 0 &#123; //ceil returns next biggest number offset = width * ceil(offset / width) &#125; else if velocity.x == 0 &#123; //6 //rounds the argument offset = width * round(offset / width) &#125; else if velocity.x &lt; 0 &#123; //7 //removes decimal part of argument offset = width * floor(offset / width) &#125; //8 newOffset.x = offset - collectionView!.contentInset.left newOffset.y = proposedContentOffset.y //y will always be the same... return newOffset&#125; åœ¨ç”¨æˆ·æ‰‹æŒ‡ç¦»å¼€å±å¹•æ—¶ï¼Œè¯¥æ–¹æ³•å°†ä¼šè®¡ç®—ä¹¦æœ¬å°é¢çš„ offsetã€‚ 1.åˆ›å»ºä¸€ä¸ªåä¸º newOffset çš„ CGPoint 2.è·å–å½“å‰ collectionView çš„ layout 3.è·å– cell çš„å®½åº¦ 4.è®¡ç®—å½“å‰offset 5.å¦‚æœ velocity.x &gt; 0,ç”¨æˆ·æ˜¯åœ¨å‘å³æ»‘ã€‚æŠŠ offset/width ç†è§£æˆä¹¦æœ¬çš„ indexï¼Œæ»‘è‡³å¯¹åº”çš„ index 6.å¦‚æœ velocity.x = 0,ç”¨æˆ·æ»‘åŠ¨è·ç¦»ä¸å¤Ÿï¼Œä¿æŒä¸Šè¡£åƒé€‰ä¸­çš„ä¹¦ä¸å˜ 7.å¦‚æœ velocity.x &lt; 0,ç”¨æˆ·å‘å·¦æ»‘ 8.æ›´æ–° x çš„ offsetï¼Œç„¶åè¿”å›ã€‚ä¿è¯ä¹¦çš„å°é¢å±…ä¸­æ˜¾ç¤º è¿è¡Œç¨‹åºï¼Œæ»‘åŠ¨ä¸€ä¸‹ï¼Œä½ ä¼šå‘ç°æ»‘åŠ¨è¿‡ç¨‹ä¸­ä¹¦æœ¬ï¼Œå¸é™„æ•ˆæœæ›´æ˜æ˜¾äº†ã€‚ä½ éœ€è¦å»ºç«‹ä¸€ç§æœºåˆ¶æ¥ä½¿å¾—ç”¨æˆ·åªèƒ½ç‚¹å‡»å±…ä¸­çš„ä¹¦æœ¬ï¼Œç„¶è€Œç°åœ¨ä¸ç®¡ä¹¦æœ¬åœ¨å“ªï¼Œä½ éƒ½å¯ä»¥ç‚¹å‡»ã€‚æ‰“å¼€BooksViewController.swiftï¼Œå°†ä¸‹é¢ä»£ç åŠ åˆ°// MARK: Helpersæ³¨é‡Šä¸‹æ–¹ï¼š 12345678func selectedCell() -&gt; BookCoverCell? &#123; if let indexPath = collectionView?.indexPathForItemAtPoint(CGPointMake(collectionView!.contentOffset.x + collectionView!.bounds.width / 2, collectionView!.bounds.height / 2)) &#123; if let cell = collectionView?.cellForItemAtIndexPath(indexPath) as? BookCoverCell &#123; return cell &#125; &#125; return nil&#125; è¯¥æ–¹æ³•è¿”å›å±…ä¸­çš„ cellã€‚æ¥ä¸‹æ¥ç”¨ä¸‹é¢ä»£ç æ¥æ›¿æ¢openBook(_:) 123456789func openBook() &#123; let vc = storyboard?.instantiateViewControllerWithIdentifier("BookViewController") as! BookViewController vc.book = selectedCell()?.book // UICollectionView loads it's cells on a background thread, so make sure it's loaded before passing it to the animation handler dispatch_async(dispatch_get_main_queue(), &#123; () -&gt; Void in self.navigationController?.pushViewController(vc, animated: true) return &#125;)&#125; è¯¥æ–¹æ³•ç®€å•ä½¿ç”¨äº†ä¸Šé¢å†™çš„selectedCellæ–¹æ³•æ¥è·å–å½“å‰é€‰ä¸­çš„ä¹¦æœ¬ã€‚ç„¶åç”¨ä¸‹é¢ä»£ç æ›¿æ¢collectionView(_:didSelectItemAtIndexPath:)ï¼š 123override func collectionView(collectionView: UICollectionView, didSelectItemAtIndexPath indexPath: NSIndexPath) &#123; openBook()&#125; è¿™ä¸ªæ–¹æ³•ä½¿å¾—ä½ çš„ç‚¹å‡»æ‰“å¼€çš„ä¹¦æœ¬ä¸€ç›´æ˜¯å±…ä¸­çš„ cell å¯¹åº”çš„ä¹¦æœ¬ï¼Œè€Œä¸æ˜¯ä¹‹å‰ indexPath å¯¹åº”çš„ä¹¦æœ¬ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº† BooksLayoutã€‚æ˜¯æ—¶å€™å±•ç¤ºçœŸæ­£çš„æŠ€æœ¯äº†â€“è®©å±å¹•ä¸Šçš„ä¹¦æœ¬çœ‹èµ·æ¥æ›´è‡ªç„¶çœŸå®ï¼ŒåŒæ—¶æ”¯æŒç¿»é¡µã€‚ ç¿»é¡µå¸ƒå±€ä¸‹å›¾æ˜¯æˆ‘ä»¬è¦è¾¾æˆçš„æœ€ç»ˆæ•ˆæœï¼š ä½¿å…¶çœ‹èµ·æ¥æ›´åƒä¸€æœ¬ä¹¦ï¼:] åœ¨ Book åˆ†ç»„ä¸‹æ–°å»º Layout åˆ†ç»„ï¼Œå³é”®æ–°å»ºä¸€ä¸ªç»§æ‰¿è‡ªUICollectionViewFlowLayoutåä¸ºBookLayoutçš„å­ç±»ï¼Œè¯­è¨€è®¾ç½®ä¸º Swiftã€‚ å’Œä¹‹å‰ä¸€æ ·ï¼ŒbookCollectionView éœ€è¦è®¾ç½®å…¶ Layout ä¸ºåˆšæ‰æ–°å»ºçš„ Layout ç±»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ‰“å¼€ BookLayout.swiftï¼Œåœ¨ BookLayout ç±»å£°æ˜ä¸Šé¢åŠ å…¥å¦‚ä¸‹ä»£ç ï¼š 123private let PageWidth: CGFloat = 362private let PageHeight: CGFloat = 568private var numberOfItems = 0 æˆ‘ä»¬å°†ä½¿ç”¨è¿™äº›å¸¸é‡æ¥è®¾ç½®æ¯ä¸ª cell çš„å¤§å°ï¼ŒåŒæ ·æˆ‘ä»¬éœ€è¦è®°å½•ä¸€æœ¬ä¹¦çš„é¡µæ•°ã€‚æ¥ä¸‹æ¥åœ¨ç±»å£°æ˜ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456override func prepareLayout() &#123; super.prepareLayout() collectionView?.decelerationRate = UIScrollViewDecelerationRateFast numberOfItems = collectionView!.numberOfItemsInSection(0) collectionView?.pagingEnabled = true&#125; å’Œä½ åœ¨BooksLayoutä¸­æ‰€åšçš„ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ï¼š 1.è®¾ç½®å‡é€Ÿé€Ÿç‡ä¸ºUIScrollViewDecelerationRateFastæ¥å¢åŠ å‡é€Ÿé€Ÿç‡ï¼Œè¿›è€Œä½¿å¾— scrollView å¿«é€Ÿåœæ­¢ 2.è·å–å½“å‰ä¹¦æœ¬çš„é¡µæ•° 3.å¯ç”¨ç¿»é¡µï¼›è®©æ¯æ¬¡æ»‘åŠ¨éƒ½æ˜¯ä¸€ä¸ªé¡µé¢çš„è·ç¦» ç»§ç»­åœ¨BookLayout.swiftæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123override func shouldInvalidateLayoutForBoundsChange(newBounds: CGRect) -&gt; Bool &#123; return true&#125; å’Œä¸Šé¢ä¸€æ ·ï¼Œåœ¨ bounds å‘ç”Ÿæ”¹å˜æ—¶ä½¿å¸ƒå±€å¤±æ•ˆï¼Œè¿›è€Œè°ƒç”¨ prepareLayout æ¥è®¡ç®—æ–°çš„å¸ƒå±€ã€‚æ¥ä¸‹æ¥å¤å†™collectionViewContentSize()æ¥è®¾ç½® collecyionView çš„ contentSizeï¼š 123override func collectionViewContentSize() -&gt; CGSize &#123; return CGSizeMake((CGFloat(numberOfItems / 2)) * collectionView!.bounds.width, collectionView!.bounds.height)&#125; è¯¥æ–¹æ³•è¿”å›æ•´ä¸ªå†…å®¹è§†å›¾å¤§å°ï¼Œé«˜åº¦ä¸å˜ï¼Œå®½åº¦éšç€ item åŠä¹¦çš„é¡µæ•°å‘ç”Ÿæ”¹å˜ã€‚ä¹‹æ‰€ä»¥è¦é™¤ä»¥2ï¼Œæ˜¯å› ä¸ºæ¯ä¸€é¡µæœ‰ä¸¤é¢ï¼Œæ¯ä¸€é¢ä¸Šéƒ½æœ‰å†…å®¹ã€‚å’Œä½ åœ¨BooksLayoutä¸­åšçš„ä¸€æ ·ï¼Œéœ€è¦å¤å†™layoutAttributesForElementsInRect(_:)æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­å¯ä»¥æ·»åŠ ä¸ºæ¯ä¸€é¡µæ·»åŠ ç¿»é¡µæ•ˆæœã€‚åœ¨collectionViewContentSize()æ–¹æ³•åé¢æ·»åŠ ä¸‹é¢ä»£ç ï¼š 123456789101112131415161718override func layoutAttributesForElementsInRect(rect: CGRect) -&gt; [AnyObject]? &#123; //1 var array: [UICollectionViewLayoutAttributes] = [] //2 for i in 0 ... max(0, numberOfItems - 1) &#123; //3 var indexPath = NSIndexPath(forItem: i, inSection: 0) //4 var attributes = layoutAttributesForItemAtIndexPath(indexPath) if attributes != nil &#123; //5 array += [attributes] &#125; &#125; //6 return array&#125; å’Œ BooksLayout ä¸åŒçš„æ˜¯ï¼Œå› ä¸ºæ‰€æœ‰ cell éƒ½åœ¨å¯è§åŒºåŸŸä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ layoutAttributesForItemAtIndexPath(_:) æ–¹æ³•ä¸­æ¥è®¡ç®—å¸ƒå±€å±æ€§ã€‚ä¸‹é¢æ˜¯æ¯ä¸€è¡Œçš„è§£é‡Šï¼š 1.åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„æ¥æŒæœ‰æ‰€æœ‰ cell çš„å¸ƒå±€å±æ€§ 2.éå†æ‰€æœ‰ item 3.ä¸ºæ¯ä¸ª item åˆ›å»ºä¸€ä¸ª indexPath 4.è·å– indexPath å¯¹åº”çš„å¸ƒå±€å±æ€§ã€‚ä½ é©¬ä¸Šå°±è¦å¤å†™ layoutAttributesForItemAtIndexPath(_:) æ–¹æ³• 5.å°†å¸ƒå±€å±æ€§æ·»åŠ åˆ°æ•°ç»„å½“ä¸­ 6.è¿”å›æ‰€æœ‰ cell çš„å¸ƒå±€å±æ€§ é¡µé¢çš„å‡ ä½•è¿ç®—åœ¨ä½ å®ç° layoutAttributesForItemAtIndexPath(_:) ä¹‹å‰ï¼ŒèŠ±ç‚¹æ—¶é—´æ¥è€ƒè™‘å¸ƒå±€ï¼Œæƒ³æƒ³å®ƒè¯¥å¦‚ä½•å·¥ä½œï¼Œæˆ‘ä»¬æ˜¯å¦èƒ½å†™ä¸€äº›å·¥å…·æ–¹æ³•æ¥ä½¿å¾—æ‰€æœ‰äº‹æƒ…ç®€å•åŒ–ã€æ¨¡å—åŒ–ã€‚:] ä¸Šå›¾æ˜¾ç¤ºä¹¦é¡µçš„ç¿»åŠ¨æ˜¯ä»¥ä¹¦è„Šä½œä¸ºæ—‹è½¬è½´ã€‚ä¸Šå›¾ä¸­çš„æ¯”ä¾‹ä»-1.0åˆ°1.0å˜åŒ–ã€‚ä¸ºä»€ä¹ˆï¼Ÿæƒ³è±¡ä¸€ä¸‹å°†ä¸€æœ¬ä¹¦æ”¾åœ¨æ¡Œå­ä¸Šï¼Œä¹¦è„Šè¡¨ç¤º0.0ï¼Œå½“ä½ ä»å·¦è‡³å³ç¿»é¡µæ—¶ï¼Œç¿»è½¬æ¯”ç‡ä»-1.0ï¼ˆæœ€å·¦ç«¯ï¼‰å˜åˆ°1.0ï¼ˆæœ€å³ç«¯ï¼‰ã€‚å› æ­¤ï¼Œä½ å¯ä»¥ç”¨å¦‚ä¸‹æ¯”ç‡æ¥è¡¨ç¤ºä½ çš„ç¿»é¡µè¿‡ç¨‹ï¼š 0.5è¡¨ç¤ºé¡µé¢æˆ90åº¦çŠ¶æ€ï¼Œä¸æ¡Œé¢å‚ç›´ +/- 0.5è¡¨ç¤ºä¸æ¡Œé¢æˆ45åº¦ +/- 1.0è¡¨ç¤ºä¸æ¡Œé¢å¹³è¡Œ å› ä¸ºæ—‹è½¬æ˜¯é€†æ—¶é’ˆçš„ï¼Œè§’åº¦ç¬¦å·ä¸æ¯”ç‡ç¬¦å·ç›¸åã€‚ï¼ˆå³æ­£è´Ÿç¬¦å·ç›¸åï¼‰é¦–å…ˆå°†ä¸‹é¢å·¥å…·æ–¹æ³•æ·»åŠ åœ¨ layoutAttributesForElementsInRect(_:) ä¹‹åï¼š 123456789101112//MARK: - Attribute Logic Helpers func getFrame(collectionView: UICollectionView) -&gt; CGRect &#123; var frame = CGRect() frame.origin.x = (collectionView.bounds.width / 2) - (PageWidth / 2) + collectionView.contentOffset.x frame.origin.y = (collectionViewContentSize().height - PageHeight) / 2 frame.size.width = PageWidth frame.size.height = PageHeight return frame&#125; æ ¹æ® collectionView çš„ä¸­å¿ƒä¸ºæ¯ä¸€ä¸ªé¡µé¢è®¡ç®—å…¶ frameã€‚getFrame(_:) æ–¹æ³•ä¼šå°†æ¯ä¸ªé¡µé¢è¾¹ç¼˜ä¸ä¹¦è„Šå¯¹å…¶ã€‚æ”¹å˜çš„å”¯ä¸€å˜é‡æ˜¯collectionViewçš„å†…å®¹åœ¨xæ–¹å‘åç§»ã€‚æ¥ä¸‹æ¥ï¼Œæ·»åŠ å¦‚ä¸‹æ–¹æ³•ï¼š 1234567891011121314151617func getRatio(collectionView: UICollectionView, indexPath: NSIndexPath) -&gt; CGFloat &#123; //1 let page = CGFloat(indexPath.item - indexPath.item % 2) * 0.5 //2 var ratio: CGFloat = -0.5 + page - (collectionView.contentOffset.x / collectionView.bounds.width) //3 if ratio &gt; 0.5 &#123; ratio = 0.5 + 0.1 * (ratio - 0.5) &#125; else if ratio &lt; -0.5 &#123; ratio = -0.5 + 0.1 * (ratio + 0.5) &#125; return ratio&#125; ä¸Šé¢æ–¹æ³•è®¡ç®—é¡µé¢çš„æ¯”ç‡ã€‚ä¸‹é¢æ˜¯å¯¹æ¯ä¸ªæ³¨é‡Šçš„è§£é‡Šï¼š 1.è®¡ç®—é¡µé¢åœ¨ä¹¦æœ¬å½“ä¸­çš„ç¼–å·ï¼Œè®°ä½ä¹¦é¡µæ˜¯åŒé¢çš„ã€‚ä¹˜ä»¥0.5å¯ä»¥å¾—åˆ°ä½ å½“å‰æ‰€åœ¨çš„é¡µé¢ã€‚ 2.æ ¹æ®ä½ ç¿»åŠ¨çš„æƒé‡è®¡ç®—æ¯”ç‡ 3.éœ€è¦å°†æ¯”ç‡èŒƒå›´é™åˆ¶åœ¨-0.5åˆ°0.5ä¹‹é—´ã€‚ä¹˜ä»¥0.1æ˜¯ç”¨æ¥ç»™é¡µé¢ä¹‹é—´æ·»åŠ ä¸€ä¸ªé—´è·ä½¿å¾—å®ƒä»¬çœ‹èµ·æ¥æ˜¯è¢«é®ç›–ä¸€æ ·ã€‚ åœ¨ä½ è®¡ç®—å¥½æ¯”ç‡ä¹‹åï¼Œå°±å¯ä»¥ç”¨å®ƒæ¥è®¡ç®—å½“å‰ç¿»åŠ¨çš„è§’åº¦äº†ã€‚åœ¨ä¸Šé¢ä»£ç åæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 12345678910111213141516171819func getAngle(indexPath: NSIndexPath, ratio: CGFloat) -&gt; CGFloat &#123; // Set rotation var angle: CGFloat = 0 //1 if indexPath.item % 2 == 0 &#123; // The book's spine is on the left of the page angle = (1-ratio) * CGFloat(-M_PI_2) &#125; else &#123; //2 // The book's spine is on the right of the page angle = (1 + ratio) * CGFloat(M_PI_2) &#125; //3 // Make sure the odd and even page don't have the exact same angle angle += CGFloat(indexPath.row % 2) / 1000 //4 return angle&#125; è¿™é‡Œè¿›è¡Œäº†ä¸€äº›æ•°å­¦è®¡ç®—ï¼Œä½†æ˜¯æ‹†å¼€æ¥çœ‹ä¹Ÿä¸æ˜¯å¾ˆéš¾ï¼š 1.åˆ¤æ–­å½“å‰é¡µé¢æ˜¯å¦ä¸ºåŒä¹¦é¢ï¼Œå³åºå·æ˜¯å¦ä¸º2çš„å€æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå¤„åœ¨ä¹¦è„Šçš„å³è¾¹ã€‚å‘å·¦ç¿»åŠ¨æ˜¯é€†æ—¶é’ˆï¼Œåœ¨ä¹¦è„Šå³ä¾§çš„é¡µé¢çš„è§’åº¦æ˜¯è´Ÿçš„ã€‚å›æƒ³ä¸€ä¸‹ä¹‹å‰å®šä¹‰çš„åœ¨-0.5åˆ°0.5å˜åŒ–çš„æ¯”ç‡ã€‚ 2.å¦‚æœå½“å‰é¢æ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆå®ƒå°±åœ¨ä¹¦è„Šçš„å·¦ä¾§ï¼Œå‘å³ç¿»åŠ¨æ˜¯é¡ºæ—¶é’ˆï¼Œæ‰€ä»¥ä¹¦è„Šå·¦ä¾§çš„é¡µé¢è§’åº¦ä¸ºæ­£ã€‚ 3.ä¸ºæ¯ä¸ªé¡µé¢æ·»åŠ ä¸€ä¸ªåç§»è§’åº¦ 4.è¿”å›æ—‹è½¬è§’ ç°åœ¨æˆ‘ä»¬æœ‰äº†æ—‹è½¬è§’ï¼Œæˆ‘ä»¬éœ€è¦è½¬æ¢æ¯ä¸€ä¸ªé¡µé¢ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 12345func makePerspectiveTransform() -&gt; CATransform3D &#123; var transform = CATransform3DIdentity transform.m34 = 1.0 / -2000 return transform&#125; ä¿®æ”¹ transform ä¸­çš„m34æ¥ä¸ºæ¯ä¸ªé¡µé¢å¢åŠ é€è§†ã€‚ç°åœ¨æ˜¯æ—¶å€™åŠ ä¸Šæ—‹è½¬æ•ˆæœäº†ã€‚åŠ å…¥å¦‚ä¸‹ä»£ç ï¼š 123456func getRotation(indexPath: NSIndexPath, ratio: CGFloat) -&gt; CATransform3D &#123; var transform = makePerspectiveTransform() var angle = getAngle(indexPath, ratio: ratio) transform = CATransform3DRotate(transform, angle, 0, 1, 0) return transform&#125; è¯¥æ–¹æ³•ä½¿ç”¨ä¸Šé¢æåˆ°çš„ä¸¤ä¸ªå·¥å…·æ–¹æ³•æ¥è®¡ç®— transform å’Œ angleï¼Œç„¶ååˆ›å»ºäº†ä¸€ä¸ª CATransform3Då¹¶å°†å…¶ä½¿ç”¨åˆ°é¡µé¢çš„ y è½´ä¸Šã€‚ç°åœ¨æ‰€æœ‰å·¥å…·æ–¹æ³•å·²å‡†å¤‡å°±æ˜¯ï¼Œæ˜¯æ—¶å€™ä¸ºæ¯ä¸ª cellæ’¸ä¸€ä¸‹å¸ƒå±€å±æ€§äº†ã€‚åœ¨ layoutAttributesForElementsInRect(_:) åé¢åŠ å…¥ä¸‹é¢ä»£ç ï¼š 123456789101112131415161718192021222324252627282930override func layoutAttributesForItemAtIndexPath(indexPath: NSIndexPath) -&gt; UICollectionViewLayoutAttributes! &#123; //1 var layoutAttributes = UICollectionViewLayoutAttributes(forCellWithIndexPath: indexPath) //2 var frame = getFrame(collectionView!) layoutAttributes.frame = frame //3 var ratio = getRatio(collectionView!, indexPath: indexPath) //4 if ratio &gt; 0 &amp;&amp; indexPath.item % 2 == 1 || ratio &lt; 0 &amp;&amp; indexPath.item % 2 == 0 &#123; // Make sure the cover is always visible if indexPath.row != 0 &#123; return nil &#125; &#125; //5 var rotation = getRotation(indexPath, ratio: min(max(ratio, -1), 1)) layoutAttributes.transform3D = rotation //6 if indexPath.row == 0 &#123; layoutAttributes.zIndex = Int.max &#125; return layoutAttributes&#125; æ¯ä¸ª cell éƒ½ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼š 1.ä¸ºç»™å®šçš„ indexPath åˆ›å»ºä¸€ä¸ª UICollectionViewLayoutAttributes 2.ä½¿ç”¨ getFrame æ–¹æ³•ç»™å¸ƒå±€å±æ€§è®¾ç½® frameï¼Œæ¥ä¿è¯å®ƒä¼šä¸ä¹¦è„Šå¯¹é½ 3.ç”¨ä¹‹å‰çš„ getRatio æ–¹æ³•æ¥è®¾ç½®å¸ƒå±€å±æ€§çš„æ¯”ç‡ 4.åˆ¤æ–­å½“å‰é¡µçš„æ¯”ç‡æ˜¯å¦åœ¨é™åˆ¶èŒƒå›´å†…ï¼Œå¦‚æœä¸åœ¨å°±ä¸å±•ç¤ºè¿™ä¸ª cellã€‚ä¸ºäº†ä¼˜åŒ–ï¼Œé€šå¸¸ä¸æ˜¾ç¤ºèƒŒé¢ï¼Œåªå±•ç¤ºæ­£é¢ã€‚å½“ç„¶å¦‚æœæ˜¯ä¹¦çš„å°é¢åˆ™éœ€è¦ä¸€ç›´å±•ç¤ºã€‚ 5.æ ¹æ®è®¡ç®—å¾—åˆ°æ¯”ç‡æ¥è·å– rotation å’Œ transform 6.åˆ¤æ–­ indexPath æ˜¯å¦ä¸ºç¬¬ä¸€é¡µï¼Œå¦‚æœæ˜¯ç¬¬ä¸€é¡µåˆ™è®¾ç½®å…¶ zIndex è®©å®ƒæ˜¾ç¤ºåœ¨æ‰€æœ‰é¡µé¢ä¹‹ä¸Šï¼Œé¿å…é—ªç°æƒ…å†µå‘ç”Ÿã€‚ è¿è¡Œç¨‹åºï¼Œæ‰“å¼€ä¹¦æœ¬ï¼Œç¿»åŠ¨ä»¥ä¸‹ã€‚ã€‚ã€‚what the f**k!! é¡µé¢çš„é”šç‚¹è²Œä¼¼æ˜¯ center è€Œä¸æ˜¯è¾¹ç¼˜ï¼ å¦‚å›¾æ‰€ç¤ºï¼Œæ¯ä¸ªé¡µé¢é”šç‚¹åæ ‡ä¸ºï¼ˆ0.5,0.5ï¼‰ã€‚ä½ çŸ¥é“æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å—ï¼Ÿ å¾ˆæ˜æ˜¾ï¼Œä½ éœ€è¦æ”¹å˜é”šç‚¹ä½ç½®ï¼Œä½¿å…¶ä½äºè¾¹ç¼˜ã€‚å¦‚æœé¡µé¢åœ¨ä¹¦è„Šçš„å³ä¾§ï¼Œé”šç‚¹åº”è¯¥ä¸º(0,0.5),åä¹‹é”šç‚¹ä¸º(1,0.5)ã€‚ æ‰“å¼€ BookPageCell.swift æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456789101112131415override func applyLayoutAttributes(layoutAttributes: UICollectionViewLayoutAttributes!) &#123; super.applyLayoutAttributes(layoutAttributes) //1 if layoutAttributes.indexPath.item % 2 == 0 &#123; //2 layer.anchorPoint = CGPointMake(0, 0.5) isRightPage = true &#125; else &#123; //3 //4 layer.anchorPoint = CGPointMake(1, 0.5) isRightPage = false &#125; //5 self.updateShadowLayer()&#125; ä¸Šé¢å¤å†™äº† applyLayoutAttributes(_:) æ–¹æ³•ï¼Œå®ƒä½¿ç”¨äº† BookLayout ä¸­çš„å¸ƒå±€å±æ€§ã€‚è¿™çœ‹èµ·æ¥éå¸¸è¨€ç®€æ„èµ…ã€‚ 1.åˆ¤è¯»å½“å‰é¡µé¢æ˜¯å¦ä¸ºåŒæ•°ï¼Œä¹Ÿå°±æ˜¯å½“å‰é¡µé¢åœ¨ä¹¦è„Šå³ä¾§ã€‚ 2.å°†é”šç‚¹è®¾ç½®æˆå·¦è¾¹ç¼˜ï¼Œç„¶åè®¾ç½®isRightPageä¸º trueã€‚è¿™ä¸ªå˜é‡å¯ä»¥å¸®ä½ ç¡®å®šåœ†è§’çš„ä½ç½®ã€‚ 3ã€‚å¦‚æœå½“å‰é¡µé¢ä¸ºå¥‡æ•°ï¼Œé‚£ä¹ˆå®ƒå°±å¤„äºä¹¦è„Šå·¦ä¾§ 4.è®¾ç½®å¥‡æ•°é¡µé¢çš„é”šç‚¹ä¸ºå…¶å³æµ‹è¾¹ç¼˜ï¼Œç„¶åè®¾ç½®isRightPageä¸º false 5.æœ€åæ›´æ–°å½“å‰é¡µçš„é˜´å½± layer è¿è¡Œä¸€ä¸‹ï¼Œç¿»åŠ¨é¡µé¢ï¼Œçœ‹èµ·æ¥æ¯”ä¹‹å‰å¥½å¤šäº†ã€‚ åˆ°æ­¤ä¸ºæ­¢ï¼Œè¯¥æ•™ç¨‹çš„ç¬¬ä¸€éƒ¨åˆ†å·²ç»ç»“æŸã€‚èŠ±ç‚¹æ—¶é—´ä¼‘æ¯ä¸€ä¸‹ï¼Œæƒ³æƒ³è¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸æ˜¯å¾ˆå±Œï¼Ÿï¼ ä½•å»ä½•ä»ä½ å¯ä»¥åœ¨æ­¤ä¸‹è½½ç¬¬ä¸€éƒ¨åˆ†çš„å®Œæ•´ä»£ç ã€‚ä½ ä»é»˜è®¤çš„ layout å¼€å§‹ï¼Œç„¶åå­¦ä¹ äº†å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªæ–°çš„ layout ç„¶ååˆ›å»ºäº†ä¸€ä¸ªæ¯”è¾ƒå±Œçš„æ•ˆæœï¼ç”¨è¿™ä¸ª app çš„äººä¼šè§‰å¾—ä»–ä»¬åƒåœ¨ç¿»å®ä½“ä¹¦ä¸€æ ·ã€‚æ­£æ˜¯è¿™æ ·ä¸€ä¸ªç»†èŠ‚ä½¿å¾—ä¸€ä¸ªæ™®é€šçš„é˜…è¯»ç±»è½¯ä»¶å˜å¾—æ·±å—ç”¨æˆ·æ¬¢è¿ã€‚ç„¶è€Œï¼Œä¸€åˆ‡è¿˜æ²¡æœ‰ç»“æŸã€‚åœ¨ç¬¬äºŒéƒ¨åˆ†ä¸­ä½ å¯ä»¥è®©è¿™ä¸ª app å˜å¾—æ›´å¥½æ›´ç®€æ´ã€‚ä½ æ˜¯å¦ä¹Ÿæœ‰å¾ˆç‚«çš„å¸ƒå±€æƒ³æ³•ï¼Ÿå¦‚æœä½ æœ‰ä»»ä½•ç–‘é—®ã€è¯„è®ºä»¥åŠå¯¹è¿™ç¯‡æ•™ç¨‹çš„å…¶ä»–æƒ³æ³•ï¼Œæ¬¢è¿åœ¨ä¸‹é¢è®¨è®ºã€‚]]></content>
      <categories>
        <category>ç¿»è¯‘</category>
      </categories>
      <tags>
        <tag>UICollectionView</tag>
        <tag>ç¿»è¯‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UICollectionViewè‡ªå®šä¹‰å¸ƒå±€ä¹‹é£ç«è½®[è¯‘]]]></title>
    <url>%2F2015%2F08%2F31%2FA-Spinning-Wheel-Layout%2F</url>
    <content type="text"><![CDATA[ç°åœ¨æœ‰è®¸å¤šæå…·åˆ›é€ åŠ›çš„ç½‘ç«™ï¼Œå‡ å‘¨å‰æˆ‘ç¢°å·§æµè§ˆåˆ°ä¸€ä¸ªåä¸ºForm Follows Functionçš„ç½‘ç«™ï¼Œä¸Šé¢æœ‰å„ç§äº¤äº’åŠ¨ç”»ã€‚å…¶ä¸­æœ€å¸å¼•æˆ‘çš„æ˜¯ç½‘ç«™ä¸Šçš„å¯¼èˆªè½¬è½®ï¼Œè½¬è½®ç”±å„ç§äº¤äº’ä½“éªŒæµ·æŠ¥ç»„æˆã€‚ åŸæ–‡ï¼šUICollectionView Custom Layout Tutorial: A Spinning Wheel æœ¬æ•™ç¨‹å°†è®²è§£å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰çš„ UICollectionViewFlowLayout æ¥å†ç°é‚£ä¸ªå¯¼èˆªé£ç«è½®ã€‚åœ¨å¼€å§‹ä¹‹å‰ï¼Œå¸Œæœ›ä½ æœ‰å¯¹ 2D è½¬æ¢ã€UICollectionView åŠå…¶è‡ªå®šä¹‰å¸ƒå±€çš„åŸºæœ¬çŸ¥è¯†ã€‚å¦‚æœä½ å¯¹è¿™äº›è¿˜ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œæ¨èä½ å…ˆçœ‹çœ‹ä¸‹é¢å‡ ç¯‡æ•™ç¨‹ã€‚ UICollectionView Tutorial Part 1: Getting Started UICollectionView Tutorial Part 2: Reusable Views and Cell Selection Video Series: Collection Views Video Series: Custom Collection View Layouts é€šè¿‡å­¦ä¹ è¯¥æ•™ç¨‹ï¼Œä½ å°†äº†è§£åˆ°ï¼š ä»å¤´å¼€å§‹åˆ›å»ºè‡ªå®šä¹‰collectionViewçš„å¸ƒå±€ï¼Œè€Œä¸æ˜¯ä½¿ç”¨UICollectionViewFlowLayoutä½œä¸ºä½ çš„åŸºç±»ã€‚ view åœ¨å…¶ bounds ä¹‹å¤–ç»•æŸç‚¹æ—‹è½¬ é‚£ä¹ˆç°åœ¨ï¼Œè®©æˆ‘ä»¬å¼€æå§ã€‚ å¼€å§‹é¦–å…ˆä¸‹è½½æ¨¡æ¿ï¼Œåœ¨ Xcode ä¸­æ‰“å¼€ï¼Œè¿è¡Œã€‚ä½ å°†çœ‹åˆ°ä¸€ç³»åˆ— cellï¼Œæ¯ä¸ªä»£è¡¨ä¹¦åŸä¸­çš„ä¸€æœ¬ä¹¦ã€‚ ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å·¥ç¨‹ç›®å½•ç»“æ„ï¼Œæœ‰ä¸€ä¸ª CollectionViewControllerã€ä¸€ä¸ªè‡ªå®šä¹‰ Cellï¼Œcell ä¸­æœ‰ä¸€ä¸ª imageViewã€‚ç„¶å VC è¢«è¿™äº› Cellå¡«å……ã€‚æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯åˆ›å»ºä¸€ä¸ªUICollectionViewLayoutå­ç±»æ¥å°†è¿™äº› Cell æŒ‰ç…§åœ†å¼§æ’åˆ—ã€‚ ç†è®ºçŸ¥è¯†ä¸‹å›¾æ˜¯ä¸€ä¸ªå¸¦æœ‰ cell çš„é£ç«è½®ã€‚é»„è‰²åŒºåŸŸæ˜¯ iPhone çš„å±å¹•ï¼Œè“è‰²åœ†è§’çŸ©å½¢æ˜¯ cellï¼Œçº¢è‰²è™šçº¿æ˜¯ä½ å°†è¦æ”¾ç½® cell çš„åœ†å¼§ã€‚ ä½ éœ€è¦ä¸‰ä¸ªå‚æ•°æ¥åˆ›å»ºè¿™ç§æ’åˆ—ï¼š 1.åœ†å¼§åŠå¾„ï¼ˆradiusï¼‰ 2.æ¯ä¸ª cell ä¹‹é—´çš„è§’åº¦ï¼ˆanglePerItemï¼‰ 3.æ¯ä¸ª cell çš„è§’ä½ç½® ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œå¹¶éæ‰€æœ‰ cell åœ¨å±å¹•å½“ä¸­èƒ½æ­£å¸¸æ˜¾ç¤ºã€‚ å‡è®¾ç¬¬0ä¸ª cell çš„è§’åº¦ä¸º x åº¦ï¼Œé‚£ä¹ˆç¬¬1ä¸ª cell çš„è§’ä½ç½®ä¸º x + anglePerItem,ç¬¬äºŒä¸ªä¸ºx + anglePerItem * 2ï¼Œä»¥æ­¤ç±»æ¨ã€‚ç¬¬ n ä¸ªçš„è§’ä½ç½®çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š 1angle_for_i = x + (i * anglePerItem) ä¸‹å›¾å±•ç¤ºçš„æ˜¯è§’åæ ‡ç³»ã€‚0åº¦ä»£è¡¨ä¸­å¿ƒï¼Œé¡ºæ—¶é’ˆæ–¹å‘ä¸ºæ­£ï¼Œé€†æ—¶é’ˆæ–¹å‘ä¸ºè´Ÿã€‚æ‰€ä»¥0åº¦è§’çš„ cell å°†å¤„åœ¨æ­£ä¸­å¤®ï¼Œå®Œå…¨å‚ç›´çš„æ–¹å‘ã€‚ ç°åœ¨ä½ å¯¹ç†è®ºçŸ¥è¯†æœ‰äº†ä¸€ä¸ªå…¨é¢çš„ç†è§£ï¼Œè®©æˆ‘ä»¬å¼€å§‹æ’¸ä»£ç å§ã€‚ Circular Collection View Layoutæ–°å»ºä¸€ä¸ª swift æ–‡ä»¶ï¼Œå–åCircularCollectionViewLayoutï¼Œç»§æ‰¿è‡ªUICollectionViewLayoutã€‚ ç‚¹å‡»ä¸‹ä¸€æ­¥ã€åˆ›å»ºã€‚è¿™ä¸ªUICollectionViewLayoutçš„å­ç±»å°†åŒ…å«æ‰€æœ‰ä¸ä½ç½®ç›¸å…³çš„ä»£ç ã€‚å› ä¸ºCircularCollectionViewLayoutç»§æ‰¿è‡ªUICollectionViewLayoutè€Œä¸æ˜¯UICollectionViewFlowLayoutï¼Œæ‰€ä»¥ä½ éœ€è¦å¤„ç†æ‰€æœ‰å¸ƒå±€è¿‡ç¨‹è€Œä¸æ˜¯ç®€å•è°ƒç”¨ super ä¸­çš„å®ç°ã€‚ æˆ‘å‘ç° FlowLayout éå¸¸é€‚åˆç½‘æ ¼è§†å›¾è€Œéåœ†å½¢å¸ƒå±€ã€‚åœ¨CircularCollectionViewLayoutä¸­ï¼Œæ–°å»ºä¸¤ä¸ªå±æ€§itemSizeå’Œradiusã€‚ 1234567let itemSize = CGSize(width: 133, height: 173) var radius: CGFloat = 500 &#123; didSet &#123; invalidateLayout() &#125;&#125; å½“åŠå¾„æ”¹å˜æ—¶ä½ éœ€è¦é‡æ–°è®¡ç®—æ‰€æœ‰å€¼ï¼Œæ‰€ä»¥è¦åœ¨ didSet ä¸­è°ƒç”¨invalidateLayout()ã€‚åœ¨ radius å£°æ˜ä¸‹é¢ç´§æ¥ç€anglePerItemçš„å®šä¹‰ï¼š 123var anglePerItem: CGFloat &#123; return atan(itemSize.width / radius)&#125; anglePerItemå¯ä»¥æ˜¯ä½ æƒ³è¦çš„ä»»ä½•å€¼ï¼Œä½†æ˜¯å…¬å¼è¦ç¡®ä¿ cell ä¸è¦è¢«åˆ†æ•£çš„å¤ªå¼€ã€‚ä¸‹ä¸€æ­¥ï¼Œå®ç°collectionViewContentSize()æ¥å£°æ˜ä½ çš„ collectionView çš„å†…å®¹æœ‰å¤šå¤§ï¼š 1234override func collectionViewContentSize() -&gt; CGSize &#123; return CGSize(width: CGFloat(collectionView!.numberOfItemsInSection(0)) * itemSize.width, height: CGRectGetHeight(collectionView!.bounds))&#125; å†…å®¹é«˜åº¦ä¸ collectionView é«˜åº¦ä¸€è‡´ï¼Œä½†æ˜¯å®½åº¦æ˜¯itemSize.width * numberOfItemsã€‚ç°åœ¨æ‰“å¼€Main.storyboardï¼Œé€‰ä¸­è§†å›¾å¤§çº²ä¸­çš„Collection Viewï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º æ‰“å¼€Attributes Inspectorï¼Œå°†å…¶ Layout è®¾ç½®ä¸ºè‡ªå®šä¹‰ï¼Œå°†å…¶ Class è®¾ç½®ä¸ºCircularCollectionViewLayoutã€‚ è¿è¡Œç¨‹åºï¼Œä½ å°†å‘ç°é™¤äº†ä¸€ä¸ªå¯æ»‘åŠ¨åŒºåŸŸå¤–ï¼Œå±å¹•ä¸Šæ²¡æœ‰ä»»ä½•ä¸œè¥¿ã€‚ä½†æ˜¯å®ƒå°±æ˜¯ä½ æƒ³è¦çš„ï¼Œå› ä¸ºè¿™ç¡®ä¿ä½ æ­£ç¡®åœ°å°† collectionView çš„ Layout è®¾ç½®ä¸ºä½ è‡ªå®šä¹‰çš„ Class å³ CircularCollectionViewLayoutã€‚ è‡ªå®šä¹‰å¸ƒå±€å±æ€§é™¤äº†æ–°å»ºä¸€ä¸ªæ–°çš„å¸ƒå±€å­ç±»ï¼Œä½ è¿˜è¦æ–°å»ºä¸€ä¸ªç»§æ‰¿è‡ªUICollectionViewLayoutAttributesçš„ç±»æ¥å­˜å‚¨è§’ä½ç½®ä»¥åŠé”šç‚¹ï¼ˆanchorPointï¼‰ã€‚æŠŠä¸‹é¢ä»£ç åŠ åˆ°CircularCollectionViewLayout.swiftè¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œå°†å…¶æ”¾åœ¨CircularCollectionViewLayoutç±»å£°æ˜ä¸Šé¢ã€‚ 12345678910111213141516171819class CircularCollectionViewLayoutAttributes: UICollectionViewLayoutAttributes &#123; // 1 var anchorPoint = CGPoint(x: 0.5, y: 0.5) var angle: CGFloat = 0 &#123; // 2 didSet &#123; zIndex = Int(angle * 1000000) transform = CGAffineTransformMakeRotation(angle) &#125; &#125; // 3 override func copyWithZone(zone: NSZone) -&gt; AnyObject &#123; let copiedAttributes: CircularCollectionViewLayoutAttributes = super.copyWithZone(zone) as! CircularCollectionViewLayoutAttributes copiedAttributes.anchorPoint = self.anchorPoint copiedAttributes.angle = self.angle return copiedAttributes &#125;&#125; 1.æˆ‘ä»¬éœ€è¦ä¸€ä¸ªé”šç‚¹ï¼Œå› ä¸ºæ—‹è½¬æ˜¯å›´ç»•é”šç‚¹è€Œéä¸­å¿ƒã€‚ 2.å½“è®¾ç½®è§’åº¦ï¼ˆangleï¼‰çš„æ—¶å€™ï¼Œåœ¨å†…éƒ¨è®¾ç½®å…¶ transform æ—‹è½¬ angle å¼§åº¦ã€‚åŒæ—¶æˆ‘ä»¬æƒ³è¦å³è¾¹çš„ cell è¦†ç›–åœ¨å·¦è¾¹çš„ cell ä¸Šï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡è®¾ç½® zIndex æ¥å®ç°ã€‚å› ä¸ºè§’åº¦ç”¨å¼§åº¦è¡¨ç¤ºï¼Œæˆ‘ä»¬å°†å…¶æ‰©å¤§ 1,000,000å€æ¥ç¡®ä¿ç›¸é‚»çš„å€¼ä¸ä¼šè¢«å››èˆäº”å…¥æˆåŒä¸€ä¸ª zIndex å€¼ï¼ŒzIndex æ˜¯ Int å‹çš„ã€‚ 3.å¤å†™copyWithZone()æ¥éµå¾ªNSCopyingåè®®ï¼Œå› ä¸ºåœ¨ collectionView å¸ƒå±€æ—¶ï¼Œå†…éƒ¨ä¼šæ‹·è´å¸ƒå±€å±æ€§ã€‚å¤å†™è¿™ä¸ªæ–¹æ³•æ¥ç¡®ä¿å¤åˆ¶è¿‡ç¨‹ä¸­ï¼ŒanchorPoint å’Œ angleä¸¤ä¸ªå±æ€§ä¹Ÿä¼šè¢«æ‹·è´ã€‚ ä¸‹é¢æˆ‘ä»¬å›åˆ°CircularCollectionViewLayoutä¸­æ¥å®ç° layoutAttributesClass()æ–¹æ³•ã€‚ 123override class func layoutAttributesClass() -&gt; AnyClass &#123; return CircularCollectionViewLayoutAttributes.self&#125; è¿™ä¸€æ­¥æ˜¯ä¸ºäº†å‘ŠçŸ¥ collecttionView ä½ å°†ä½¿ç”¨CircularCollectionViewLayoutAttributesè€Œä¸æ˜¯é»˜è®¤çš„UICollectionViewLayoutAttributesã€‚ä¸ºäº†æŒæœ‰å¸ƒå±€å±æ€§ï¼Œåœ¨æ‰€æœ‰å±æ€§å£°æ˜ä¹‹ååˆ›å»ºä¸€ä¸ªåä¸ºattributesListçš„æ•°ç»„ã€‚ 1var attributesList = [CircularCollectionViewLayoutAttributes]() Preparing the Layoutå½“ collectionView ç¬¬ä¸€æ¬¡å±•ç¤ºåœ¨å±å¹•ä¸Šæ—¶ï¼ŒLayout çš„prepareLayout()æ–¹æ³•å°†è¢«è°ƒç”¨ã€‚åœ¨æ¯æ¬¡å¸ƒå±€ç”Ÿæ•ˆæ—¶è¿™ä¸ªæ–¹æ³•ä¹Ÿä¼šè¢«è°ƒç”¨ã€‚è¿™æ˜¯å¸ƒå±€è¿‡ç¨‹ä¸­æœ€é‡è¦çš„æ–¹æ³•ä¹‹ä¸€ï¼Œå› ä¸ºè¿™æ˜¯åˆ›å»ºå’Œå­˜å‚¨å¸ƒå±€å±æ€§çš„å…¥å£ã€‚åœ¨CircularCollectionViewLayoutæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 1234567891011121314151617override func prepareLayout() &#123; super.prepareLayout() let centerX = collectionView!.contentOffset.x + (CGRectGetWidth(collectionView!.bounds) / 2.0) attributesList = (0..&lt;collectionView!.numberOfItemsInSection(0)).map &#123; (i) -&gt; CircularCollectionViewLayoutAttributes in // 1 let attributes = CircularCollectionViewLayoutAttributes(forCellWithIndexPath: NSIndexPath(forItem: i, inSection: 0)) attributes.size = self.itemSize // 2 attributes.center = CGPoint(x: centerX, y: CGRectGetMidY(self.collectionView!.bounds)) // 3 attributes.angle = self.anglePerItem*CGFloat(i) return attributes &#125;&#125; ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬ä¾¿åˆ©æ¯ä¸€ä¸ª itemï¼Œç„¶åæ‰§è¡Œé—­åŒ…ã€‚ä¸‹é¢æˆ‘ä»¬ä¸€è¡Œè¡Œæ¥è§£é‡Šï¼š 1.ä¸ºæ¯ä¸ª IndexPath åˆ›å»ºä¸€ä¸ªCircularCollectionViewLayoutAttributeså®ä¾‹ï¼Œç„¶åè®¾ç½®å…¶å¤§å°ï¼ˆsizeï¼‰ 2.å°† item æ”¾åœ¨å±å¹•ä¸­é—´ æŒ‰å¼§åº¦æ¥æ—‹è½¬æ¯ä¸ª itemï¼Œæ—‹è½¬é‡ä¸ºanglePerItem * i æ–¹æ³•ä¸­çš„ map æ˜¯ Swift æ ‡å‡†åº“ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œæ•°ç»„ä¸­å­˜å‚¨çš„æ˜¯é—­åŒ…çš„æ‰§è¡Œç»“æœã€‚ä½ å¯ä»¥åœ¨è¿™ç¯‡æ–‡ç« ä¸­äº†è§£æ›´å¤šã€‚ æˆ‘ä»¬è¿˜éœ€è¦å®ç°ä¸‹é¢çš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•è¿”å›åœ¨ç»™å®šçŸ©å½¢åŒºåŸŸä¸­çš„ item å¸ƒå±€å±æ€§ï¼Œä»¥åŠç»™å®šçš„ indexpath çš„ item å¸ƒå±€å±æ€§ã€‚collectionView åœ¨å¸ƒå±€è¿‡ç¨‹ä¸­å°†ä¼šå¤šæ¬¡è°ƒç”¨è¿™äº›æ–¹æ³•ï¼Œåœ¨ç”¨æˆ·æ»‘åŠ¨ collectionView ä¹Ÿä¼šè§¦å‘è¿™äº›æ–¹æ³•ã€‚ä¸ºäº†ä¿è¯å…¶é«˜æ•ˆæ€§ï¼Œæˆ‘ä»¬åœ¨prepareLayout()æ–¹æ³•ä¸­ç¼“å­˜äº†è¿™äº›å¸ƒå±€å±æ€§ã€‚æŠŠä¸‹é¢ä»£ç åŠ åˆ°prepareLayout()ä¸‹é¢ï¼š 12345678override func layoutAttributesForElementsInRect(rect: CGRect) -&gt; [AnyObject]? &#123; return attributesList&#125; override func layoutAttributesForItemAtIndexPath(indexPath: NSIndexPath) -&gt; UICollectionViewLayoutAttributes! &#123; return attributesList[indexPath.row]&#125; ç¬¬ä¸€ä¸ªæ–¹æ³•ç®€å•è¿”å›äº†æ•´ä¸ªå¸ƒå±€å±æ€§æ•°ç»„ï¼Œç¬¬äºŒä¸ªæ–¹æ³•è¿”å›äº†æŒ‡å®šçš„ indexpath å¯¹åº”çš„å¸ƒå±€å±æ€§ã€‚è¿™ä¸ªæ–¹æ³•éå¸¸ OK å› ä¸ºæˆ‘ä»¬çš„ item æ•°ç›®æ¯”è¾ƒå°ï¼Œä½†æ˜¯é€šå¸¸æˆ‘ä»¬ä¼šéå†æ•°ç»„æ¥åˆ¤æ–­å¸ƒå±€å±æ€§çš„ frame æ˜¯å¦ä¸ç»™å®šçš„çŸ©å½¢åŒºåŸŸç›¸äº¤ï¼Œç„¶åè¿”å›ä¸ç»™å®šåŒºåŸŸç›¸äº¤çš„å¸ƒå±€å±æ€§ã€‚è¿™ä½¿å¾— collectionView åœ¨å±å¹•ä¸Šåªç»˜åˆ¶è¿™äº› itemï¼Œæˆ–è€…å°†è¦å‡ºç°åœ¨å±å¹•ä¸Šçš„ itemã€‚ è¿è¡Œï¼Œä½ ä¼šçœ‹åˆ°æ‰€æœ‰ cell å‡ºç°åœ¨å±å¹•ä¸Šï¼Œä½†æ˜¯å®ƒä»¬æ˜¯å›´ç»•è‡ªèº«æ¥æ—‹è½¬è€Œéå¤–éƒ¨çš„æŸä¸ªç‚¹ã€‚è™½ç„¶å®ƒä¸æ˜¯éå¸¸æ€¥éœ€çš„æ•ˆæœï¼Œä½†æ˜¯å¦‚æœèƒ½åšåˆ°ç¡®å®æŒºé…·çš„ï¼Œä½ è§‰å¾—å‘¢ï¼Ÿ ä½ èƒ½çŒœåˆ°ä¸ºä»€ä¹ˆä¼šè¿™æ ·å—ï¼Ÿ æœ‰äººè¯´æ˜¯é”šç‚¹å—ï¼Ÿä½ è¿˜è®°å¾—ä¸Šé¢æˆ‘ä»¬è¯´çš„ cell çš„é”šç‚¹å—ï¼Ÿä½ è¿˜æ²¡æœ‰è®¾ç½®è¿‡å®ƒï¼Œä¸Šé¢çš„æ—‹è½¬æ•ˆæœè¿œæ²¡è¾¾åˆ°æˆ‘ä»¬å¸Œæœ›å¾—åˆ°çš„æ•ˆæœã€‚ é”šç‚¹æ˜¯ CALayer çš„ä¸€ä¸ªå±æ€§ï¼Œæ‰€æœ‰çš„æ—‹è½¬å’Œç¼©æ”¾éƒ½æ˜¯å›´ç»•ç€å®ƒè€Œå‘ç”Ÿçš„ã€‚é”šç‚¹çš„é»˜è®¤å€¼æ˜¯ centerï¼Œå°±åƒä¸Šé¢çš„è¿è¡Œç»“æœé‚£æ ·ã€‚çœŸæ­£çš„é”šç‚¹çš„ x å€¼åº”è¯¥ä¸º0.5ï¼Œy å€¼åº”è¯¥ä¸ºradius + (itemSize.height / 2)ï¼Œå› ä¸ºé”šç‚¹æ˜¯åœ¨å½’ä¸€åŒ–åæ ‡ç³»ä¸­å®šä¹‰çš„ï¼Œæ‰€ä»¥ä½ è¦é™¤ä»¥itemSize.heightã€‚ å›åˆ°prepareLayout()ï¼Œç„¶åå† centerX çš„å®šä¹‰ä¸‹é¢å®šä¹‰anchorPointYï¼š 1let anchorPointY = ((itemSize.height / 2.0) + radius) / itemSize.height åœ¨map(_:)é—­åŒ…ä¸­çš„ return ä¸Šæ–¹æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 1attributes.anchorPoint = CGPoint(x: 0.5, y: anchorPointY) æ¥ç€æ‰“å¼€open CircularCollectionViewCell.swiftï¼Œç„¶åå¤å†™applyLayoutAttributes(_:) ï¼š 123456override func applyLayoutAttributes(layoutAttributes: UICollectionViewLayoutAttributes!) &#123; super.applyLayoutAttributes(layoutAttributes) let circularlayoutAttributes = layoutAttributes as! CircularCollectionViewLayoutAttributes self.layer.anchorPoint = circularlayoutAttributes.anchorPoint self.center.y += (circularlayoutAttributes.anchorPoint.y - 0.5) * CGRectGetHeight(self.bounds)&#125; è¿™é‡Œä½ ç”¨çˆ¶ç±»å®ç°æ¥ä½¿ç”¨é»˜è®¤å±æ€§å¦‚ center å’Œ transform ä½†æ˜¯å› ä¸ºé”šç‚¹ï¼ˆanchorPointï¼‰æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å±æ€§ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ä½¿ç”¨å®ƒï¼ŒåŒæ ·æˆ‘ä»¬ä¹Ÿæ›´æ–°äº† center.y æ¥è¡¥å¿åœ†å½¢å¸ƒå±€ä¸­çš„anchorPoint.yå˜åŒ–ã€‚ è¿è¡Œç¨‹åºï¼Œä½ ä¼šçœ‹åˆ°æ‰€æœ‰çš„ cell æŒ‰ç…§åœ†å½¢æ¥å¸ƒå±€äº†ï¼Œä½†æ˜¯æ»‘åŠ¨çš„è¿‡ç¨‹ä¸­â€¦ç­‰ä¸€ä¸‹ï¼Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿå®ƒä»¬è¢«ç§»å‡ºäº†å±å¹•è€Œä¸æ˜¯æ—‹è½¬ï¼ï¼Ÿ è¿™ä½¿å¾—æ‰¾åˆ°æƒ³è¦çš„ä¹¦å˜å¾—éå¸¸å›°éš¾ã€‚ æ”¹å–„æ»‘åŠ¨æ•ˆæœæœ€å…·æŒ‘æˆ˜æ€§çš„å¸ƒå±€ item ä»»åŠ¡å·²ç»å®Œæˆäº†ï¼Œå¯å–œå¯è´ºï¼:] ç°åœ¨éœ€è¦åšçš„å°±æ˜¯æ”¹å˜è§’åº¦å€¼æ¥å®ç°æ»‘åŠ¨ã€‚ å›åˆ°CircularCollectionViewLayoutï¼Œç„¶ååœ¨åº•éƒ¨æ·»åŠ ä¸‹é¢ä»£ç ï¼š 123override func shouldInvalidateLayoutForBoundsChange(newBounds: CGRect) -&gt; Bool &#123; return true&#125; è¯¥æ–¹æ³•è¿”å› true å‘ŠçŸ¥ collectionView åœ¨æ»‘åŠ¨æ—¶å¸ƒå±€å¤±æ•ˆï¼Œç„¶åå®ƒä¼šè°ƒç”¨prepareLayout()ï¼Œè¿›è€Œä½¿ç”¨æ›´æ–°åçš„è§’ä½ç½®é‡æ–°è®¡ç®— cell çš„å¸ƒå±€ã€‚angleè¢«å®šä¹‰ä¸ºç¬¬0ä¸ª item çš„è§’ä½ç½®ã€‚ä½ å°†è¦é€šè¿‡æŠŠcontentOffset.xè½¬æ¢æˆä¸€ä¸ªåˆé€‚çš„è§’åº¦å€¼æ¥å®ç°æ»‘åŠ¨ã€‚ æ»‘åŠ¨è¿‡ç¨‹ä¸­ï¼ŒcontentOffset.xä» 0 åˆ°collectionViewContentSize().width - CGRectGetWidth(collectionView!.bounds)å˜åŒ–ã€‚å°†contentOffset.xçš„æå€¼å®šä¹‰ä¸ºmaxContentOffsetï¼Œå½“å…¶ä¸º 0 æ—¶ï¼Œè®©ç¬¬ 0 ä¸ªitem å¤„åœ¨ä¸­å¿ƒï¼Œå½“å…¶ä¸ºæå€¼æ—¶ï¼ˆå³maxContentOffsetï¼‰ï¼Œè®©æœ€åä¸€ä¸ª item å¤„åœ¨å±å¹•ä¸­å¿ƒï¼Œè¿™å°±æ„å‘³ç€æœ€åä¸€ä¸ª item çš„è§’ä½ç½®ä¼šå˜ä¸º 0 ã€‚ æƒ³è±¡ä¸€ä¸‹å³è¾¹çš„åœºæ™¯ï¼Œå¦‚æœä½ æ˜¯ç”¨angle_for_last_item = 0æ¥è§£å†³ä¸‹é¢ç­‰å¼ä½ ä¼šå¾—åˆ°ï¼š 123angle_for_last_item = angle_for_zero_item + (totalItems - 1) * anglePerItem0 = angle_for_zero_item + (totalItems - 1) * anglePerItemangle_for_zero_item = -(totalItems - 1) * anglePerItem å®šä¹‰-(totalItems - 1) * anglePerItemä¸ºangleAtExtremeï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12contentOffset.x = 0, angle = 0contentOffset.x = maxContentOffset, angle = angleAtExtreme ç”±ä¸Šé¢ï¼Œä½¿ç”¨ä¸‹é¢çš„å…¬å¼éå¸¸å®¹æ˜“è®¡ç®—ä»»æ„contentOffset.xå¯¹åº”çš„è§’åº¦ï¼š 1angle = -angleAtExtreme * contentOffset.x / maxContentOffset è„‘æµ·ä¸­å›æƒ³ä»¥ä¸‹è¿™äº›ç®—å¼ï¼ŒæŠŠä¸‹é¢ä»£ç æ·»åŠ åˆ° itemSize çš„å£°æ˜ä¸‹ï¼š 12345678var angleAtExtreme: CGFloat &#123; return collectionView!.numberOfItemsInSection(0) &gt; 0 ? -CGFloat(collectionView!.numberOfItemsInSection(0) - 1) * anglePerItem : 0&#125;var angle: CGFloat &#123; return angleAtExtreme * collectionView!.contentOffset.x / (collectionViewContentSize().width - CGRectGetWidth(collectionView!.bounds))&#125; æ¥ä¸‹æ¥ä½¿ç”¨ 1attributes.angle = self.angle + (self.anglePerItem * CGFloat(i)) æ¥æ›¿æ¢prepareLayout()ä¸­çš„ 1attributes.angle = (self.anglePerItem * CGFloat(i)) è¿™ä¸€æ­¥æ·»åŠ ä¸ºæ¯ä¸ª item æ·»åŠ äº†è§’åº¦å€¼ï¼Œè¿™æ · item çš„è§’åº¦å€¼ä¸åœ¨æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œè€Œæ˜¯ä¸€ä¸ªä¸contentOffset.xæœ‰ç€å‡½æ•°å…³ç³»çš„å€¼ã€‚è¿è¡Œç¨‹åºï¼Œåœ¨å±å¹•ä¸Šæ»‘åŠ¨ï¼Œä½ å°†å‘ç°æ‰€æœ‰ item æŒ‰ç…§ä½ æƒ³è¦çš„æ–¹å¼åœ¨æ»‘åŠ¨ã€‚å¹²å¾—æ¼‚äº®ï¼ åŠ åˆ†ç¯èŠ‚:ä¼˜åŒ–ä½ å·²ç»æˆåŠŸçš„é‡ç°äº†é£ç«è½®å¯¼èˆªï¼Œç°åœ¨å¯ä»¥åœ¨æ‹æ‹è‡ªå·±è‚©è†€è¯´ä¸€å¥å¹²å¾—æ¼‚äº®ï¼Œç„¶åæ¶ç€äºŒéƒè…¿äº«å—è¿™ç¾å¥½æ—¶å…‰ã€‚ä½†æ˜¯åœ¨å­˜åœ¨ä¼˜åŒ–ç©ºé—´çš„æƒ…å†µï¼ˆæ»‘åŠ¨ä¸æ»‘èˆ¬æµç•…ï¼‰ä¸‹ä½ ä¸ºä»€ä¹ˆè¦åœä¸‹æ¥å‘¢ï¼Ÿåœ¨prepareLayout()ä¸­ä¸ºæ¯ä¸ª item åˆ›å»ºäº†ä¸€ä¸ªCircularCollectionViewLayoutAttributeså®ä¾‹ï¼Œä½†æ˜¯ä¸æ˜¯æ‰€æœ‰çš„ item éƒ½ä¼šç«‹åˆ»å±•ç¤ºåœ¨å±å¹•ä¸Šã€‚é‚£äº›ç¦»å±çš„ itemï¼Œä½ å¯ä»¥å®Œå…¨è·³è¿‡å¯¹å®ƒä»¬çš„è®¡ç®—ï¼Œä¹Ÿä¸å¿…åˆ›å»ºCircularCollectionViewLayoutAttributeså®ä¾‹ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜æ˜¯ï¼šæˆ‘ä»¬éœ€è¦ç¡®å®šå“ªäº› item æ­£åœ¨å±å¹•ä¸Šæ˜¾ç¤ºï¼Œå“ªäº›æ˜¯ç¦»å±çš„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨ (-Î¸, Î¸)èŒƒå›´ä¹‹å¤–çš„æ‰€æœ‰ item éƒ½æ˜¯ç¦»å±çš„ã€‚ ä¸¾ä¸ªæ —å­ï¼Œä¸ºäº†è®¡ç®—ä¸‰è§’å½¢ ABC ä¸­çš„ Î¸ è§’ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å…¬å¼ï¼š 1tanÎ¸ = (collectionView.width / 2) / (radius + (itemSize.height / 2) - (collectionView.height / 2)) åœ¨prepareLayout()ä¸­çš„anchorPointYä¸‹ä¸€è¡ŒåŠ å…¥å¦‚ä¸‹ä»£ç ï¼š 1234567891011121314151617// 1 let theta = atan2(CGRectGetWidth(collectionView!.bounds) / 2.0, radius + (itemSize.height / 2.0) - (CGRectGetHeight(collectionView!.bounds) / 2.0))// 2var startIndex = 0var endIndex = collectionView!.numberOfItemsInSection(0) - 1 // 3if (angle &lt; -theta) &#123; startIndex = Int(floor((-theta - angle) / anglePerItem))&#125;// 4endIndex = min(endIndex, Int(ceil((theta - angle) / anglePerItem)))// 5if (endIndex &lt; startIndex) &#123; endIndex = 0 startIndex = 0&#125; è¿™ä¸€æ­¥æˆ‘ä»¬åšäº†ä»€ä¹ˆï¼Ÿ 1.ä½¿ç”¨åæ­£åˆ‡å‡½æ•°è®¡ç®—thetaè§’ 2.åˆå§‹åŒ–startIndexåŠendIndex 3.å¦‚æœç¬¬0ä¸ª item çš„è§’ä½ç½®å°äº -thetaï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ç¦»å±çš„ï¼Œå±ä¸Šç¬¬ 1 ä¸ª item çš„ index å°†ä¸º -Î¸ ä¸ angle çš„å·®å€¼å†é™¤ä»¥ anglePerItem 4.åŒæ ·çš„ï¼Œå±å¹•ä¸Šæœ€åä¸€ä¸ª item æ˜¯Î¸ ä¸ angle çš„å·®å€¼å†é™¤ä»¥ anglePerItemï¼Œmin æ˜¯ä¿è¯endIndexä¸ä¼šè¶Šç•Œ 5.æœ€ååšäº†ä¸€ä¸ªå®¹é”™å¤„ç†ï¼Œé˜²æ­¢åœ¨å¿«é€Ÿæ»‘åŠ¨æ—¶æ‰€æœ‰ cell éƒ½ç¦»å±æ—¶å¯¼è‡´ endIndexå°äº startIndexçš„æƒ…å†µ ä¸‹å›¾æŠŠä¸Šé¢çš„è®¡ç®—è¿‡ç¨‹å¯è§†åŒ–ï¼š æ—¢ç„¶æˆ‘ä»¬çŸ¥é“äº†å“ªäº›æ­£åœ¨æ˜¾ç¤ºï¼Œå“ªäº›æ˜¯ç¦»å±çš„ï¼Œæˆ‘ä»¬éœ€è¦æ›´æ–°ç”¨æ¥è®¡ç®—å¸ƒå±€å±æ€§çš„èµ·å§‹å’Œç»“æŸçš„ indexã€‚ä½¿ç”¨ 12attributesList = (startIndex...endIndex).map &#123; (i) -&gt; CircularCollectionViewLayoutAttributes in æ¥æ›¿æ¢prepareLayout()ä¸­çš„ï¼š 12attributesList = (0..&lt;collectionView!.numberOfItemsInSection(0)).map &#123; (i) -&gt; CircularCollectionViewLayoutAttributes in è¿è¡Œç¨‹åºï¼Œä½ ä¼šå‘ç°è§†è§‰ä¸Šæ²¡æœ‰æ˜æ˜¾å˜åŒ–ï¼Œå› ä¸ºæ‰€æœ‰çš„æ”¹å˜ä»…ä»…å½±å“ç¦»å±çš„ itemã€‚æˆ‘ä»¬å¯ä»¥æ‰“å¼€ Xcode å†…ç½®çš„è§†å›¾å±‚çº§æŸ¥çœ‹å™¨ å› ä¸ºåˆ›å»ºäº†æ›´å°‘çš„å˜é‡ï¼Œä½ åº”è¯¥å¯ä»¥çœ‹åˆ°æ€§èƒ½çš„æå‡ã€‚ ä½•å»ä½•ä»ä½ å¯ä»¥åœ¨æ­¤ä¸‹è½½å®Œæ•´ä»£ç ã€‚ æ­å–œï¼Œä½ å·²ç»æˆåŠŸä½¿ç”¨äº†è‡ªå®šä¹‰çš„ Layout æ¥å®ç°ä¸€ä¸ªå¯¼èˆªé£ç«è½®ã€‚åœ¨è¿™ç¯‡æ•™ç¨‹ä¸­ä½ åº”è¯¥å­¦åˆ°ä¸å°‘ä¸œè¥¿ï¼ŒåŒ…æ‹¬å¦‚ä½•æ—‹è½¬ viewã€æ”¹å˜é”šç‚¹ã€ä»å¤´åˆ›å»ºè‡ªå®šä¹‰çš„ Layout ä»¥åŠå¦‚ä½•ä¼˜åŒ–è®©å®ƒå˜å¾—æ›´å¥½ã€‚ä½ å¯ä»¥æ›´æ”¹radiuså’ŒanglePerItemæ¥è¿›ä¸€æ­¥äº†è§£å®ƒä»¬æ˜¯å¦‚ä½•æ¥æ”¹å˜æœ€ç»ˆçš„åœ†å½¢å¸ƒå±€æ’åˆ—çš„ã€‚è¿™ç¯‡æ•™ç¨‹ä¸»è¦æ˜¯æ”¹å˜2D çš„ transformï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨3D transform æ¥åˆ›å»ºæ›´æœ‰è¶£çš„æ•ˆæœã€‚åŒæ ·ä½ ä¹Ÿå¯ä»¥é€šè¿‡å¤å†™argetContentOffsetForProposedContentOffset(_:withScrollingVelocity:)æ–¹æ³•æ¥å®ç°snappingè¡Œä¸ºã€‚æˆ‘ç›¸ä¿¡ä½ å·²ç»å¼€å§‹è·ƒè·ƒæ¬²è¯•äº†å§ï¼Ÿå¦‚æœä½ é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„ä»£ç ï¼š 1234567891011121314151617override func targetContentOffsetForProposedContentOffset(proposedContentOffset: CGPoint, withScrollingVelocity velocity: CGPoint) -&gt; CGPoint &#123; var finalContentOffset = proposedContentOffset let factor = -angleAtExtreme/(collectionViewContentSize().width - CGRectGetWidth(collectionView!.bounds)) let proposedAngle = proposedContentOffset.x*factor let ratio = proposedAngle/anglePerItem var multiplier: CGFloat if (velocity.x &gt; 0) &#123; multiplier = ceil(ratio) &#125; else if (velocity.x &lt; 0) &#123; multiplier = floor(ratio) &#125; else &#123; multiplier = round(ratio) &#125; finalContentOffset.x = multiplier*anglePerItem/factor return finalContentOffset&#125; å¦‚æœä½ æœ‰ä»»ä½•ç–‘é—®ã€è¯„è®ºæˆ–è€…ç‚«æŠ€ï¼Œè¯·åŠ å…¥ä¸‹é¢çš„è®¨è®ºã€‚]]></content>
      <categories>
        <category>ç¿»è¯‘</category>
      </categories>
      <tags>
        <tag>UICollectionView</tag>
        <tag>ç¿»è¯‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[KolodaåŠ¨ç”»ç¬¬äºŒç‰ˆ[è¯‘]]]></title>
    <url>%2F2015%2F08%2F23%2FKoloda-Second-Version%2F</url>
    <content type="text"><![CDATA[ä¸€ä¸ªæœˆå‰ï¼Œæˆ‘ä»¬å‘å¸ƒäº†how we developed Tinder-like Koloda in Swift(å¦‚ä½•åˆ›å»ºä¸€ä¸ªç±»ä¼¼ Tinder çš„äº¤äº’åŠ¨ç”»[è¯‘])ã€‚åœ¨å¼€å‘è€…ä¸è®¾è®¡å¸ˆç¤¾åŒºè¿™ä¸ªåŠ¨ç”»éƒ½å—åˆ°å¼ºçƒˆçš„æ¬¢è¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å†³å®šç»§ç»­æ”¹å–„å®ƒã€‚ åŸæ–‡ï¼šKoloda Tinder-Like Animation Version 2. ä»æˆ‘ä»¬å‘å¸ƒç¬¬ä¸€ä¸ªç®€å•çš„ Koloda åŠ¨ç”»åï¼Œæˆ‘ä»¬çš„è®¾è®¡å¸ˆDmitry GoncharovåšæŒè¦å®ç°ä»–çš„ä¸‹ä¸€ä¸ªæƒ³æ³•ã€‚åŒæ ·ï¼Œæˆ‘ä»¬çš„ iOS å¼€å‘å·¥ç¨‹å¸ˆï¼ŒKoloda åŠ¨ç”»åˆ›å»ºè€…Eugene Andreyevæ‰¿è¯ºè¦è®© frame è®¡ç®—æ›´åŠ è‡ªå®šä¹‰åŒ–æ¥è®©æ›´å¤šå¼€å‘è€…åœ¨æˆ‘ä»¬çš„ Koloda åŠ¨ç”»ä¸Šåˆ¶ä½œä»–ä»¬åˆ«å…·ä¸€æ ¼çš„ç»„ä»¶ã€‚æ‰€ä»¥è¿™æ˜¯ Koloda æ•…äº‹çš„ç¬¬äºŒç« ã€‚è¿™ä¸€æ¬¡æˆ‘ä»¬å°†åŒæ—¶è®¨è®ºè®¾è®¡å’Œå¼€å‘ã€‚åŒæ—¶ä½ ä¹Ÿå¯ä»¥åœ¨Dribbleä»¥åŠGitHubä¸ŠæŸ¥çœ‹è¯¥åŠ¨ç”»ã€‚ æˆ‘ä»¬å¦‚ä½•ç”¨ Pixate åˆ¶ä½œ Koloda åŸå‹ by Dmitry Goncharov æˆ‘è¢« Tinder-like è¿™ä¸ªæ¦‚å¿µæ‰€é¼“èˆï¼Œå†³å®šè¯¦ç»†é˜è¿°æŠŠ Koloda è½¬å˜ä¸ºä¸åŒå¯»å¸¸åŠ¨ç”»çš„æœ€åŸå§‹çš„æƒ³æ³•ã€‚å¯å–œçš„æ˜¯ï¼Œå‡ ä¸ªå°æ—¶åæˆ‘æœ‰äº†ä¸€ä¸ªæ–°çš„æƒ³æ³•ã€‚æˆ‘çš„æƒ³æ³•æ˜¯å»é™¤åº•éƒ¨å±‚çº§ï¼Œä»èƒŒæ™¯ä¸­æ¥åŠ è½½ä¸‹ä¸€ä¸ªå¡ç‰‡ã€‚æˆ‘åœ¨ PS ä¸­è®¾è®¡äº†ä¸€ä¸ªå®ç‰©æ¨¡å‹ï¼Œç„¶ååœ¨Pixateä¸­åˆ¶ä½œäº†åŸå‹ã€‚Pixate æ˜¯ä¸€ä¸ªç±»ä¼¼ InVisioã€Marverã€Origami çš„è®¾è®¡å·¥å…·ã€‚å°½ç®¡åœ¨ Pixate ä¸­è®¾è®¡åŸå‹æ¯”åœ¨ InVisio ä¸­èŠ±äº†æ›´å¤šæ—¶é—´ï¼Œä½†æ˜¯Pixateåšå‡ºçš„åŸå‹æ›´åŠ åƒä¸€ä¸ªåŸç”Ÿåº”ç”¨ã€‚è¿™ä¸ªåŸå‹é‡é€ äº†æˆ‘æƒ³è¦çš„å¡ç‰‡è¡Œä¸ºã€‚ ç°åœ¨è®©æˆ‘ä»¬æ¥è®²ä¸€ä¸‹å…¶ä¸­çš„è¿‡ç¨‹ã€‚Pixate å·¥å…·æ ä¸­åŒ…å«äº†layersã€action kitã€ä»¥åŠanimationsã€‚åœ¨èµ„æºåŠ è½½å®Œæˆå‡ºç°åœ¨ artboard ä¸Šåï¼Œä½ å°±å¯ä»¥åœ¨layerä¸Šå¼€å§‹å·¥ä½œäº†ï¼Œç„¶åç»§ç»­åˆ›å»ºäº¤äº’ã€‚ä¸€å¼€å§‹æˆ‘éœ€è¦è®©å¡ç‰‡æ°´å¹³ç§»åŠ¨ç„¶åå½“ä»–ä»¬è·¨è¶Šä¸´ç•Œç‚¹æ—¶ä»å±å¹•å½“ä¸­é£å‡ºã€‚åœ¨ç®€å•çš„åŠ¨ç”»å¸®åŠ©ä¸‹ï¼Œæˆ‘å®ç°äº†è¿™ä¸ªè¿‡ç¨‹ã€‚åŒæ ·æˆ‘ä¹Ÿè®©å¡ç‰‡æ”¹å˜å®ƒçš„é€æ˜åº¦å’Œåœ¨äº¤äº’è¿‡ç¨‹ä¸­è¿›è¡Œæ—‹è½¬ã€‚ ç„¶åæˆ‘è¦è®©ä¸€ä¸ªæ–°çš„å¡ç‰‡æŒ‰ç…§å°±åƒå®ƒä»èƒŒæ™¯ä¸­åŠ è½½ä¸€æ ·å‡ºç°ï¼Œæ‰€ä»¥æˆ‘éœ€è¦å¯¹å…¶è¿›è¡Œæ‹‰ä¼¸å’Œç¼©æ”¾ã€‚æˆ‘è®¾ç½®äº†ç¼©æ”¾æ¯”ä¸º3.5å€åˆ°1å€ï¼Œ3.5å€æ˜¯å¡ç‰‡åœ¨èƒŒæ™¯ä¸­çš„å¤§å°ã€‚ ä¸ºäº†æœ‰æ›´å¥½çš„æ•ˆæœï¼Œæˆ‘åŠ äº†ä¸€äº›å¼¹æ€§åŠ¨ç”»ï¼Œç„¶åå®ƒå°±å¤§åŠŸå‘Šæˆäº†ã€‚è‡³æ­¤ï¼ŒåŸå‹è®¾è®¡å°±å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¼€å‘çš„äº‹æƒ…äº†ã€‚ä¸‹é¢æˆ‘æƒ³æ€»ç»“ä¸€ä¸‹æˆ‘å¯¹ Pixate çš„æ€»ä½“å°è±¡ã€‚ä¼˜ç‚¹ï¼š åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šé¢„è§ˆ åŸå‹å¤„ç†ç®€å• ä¸éœ€è¦æœ‰ç‰¹å®šçš„åŠ¨ç”»åŸºç¡€çŸ¥è¯† åŸå‹çœ‹èµ·æ¥æ›´åƒåŸç”Ÿ App å·¥ç¨‹å…±äº«æ›´åŠ æ–¹ä¾¿ï¼ˆå¯å¯¼å‡ºåˆ°ç”µè„‘ï¼Œå¤–é“¾ï¼ŒäºŒç»´ç ï¼‰ ç¼ºç‚¹ï¼š ä¸€ä¸ªåŸå‹æ²¡æœ‰å›Šæ‹¬æ•´ä¸ª App çš„åŠŸèƒ½ï¼Œåªæ˜¯å±•ç¤ºç‹¬ç«‹çš„åŠŸèƒ½å’Œäº¤äº’ ä¸€ä¸ªå•ç‹¬çš„ artboard ä¸èƒ½å®¹çº³åŸå‹çš„æ‰€æœ‰ç•Œé¢ ä¸èƒ½å°†åŸå‹å¯¼å‡ºä¸ºä»£ç  web ç«¯åº”ç”¨æœ‰ bug åŸºç¡€çš„ asset kit éå¸¸æœ‰é™ åŠ¨ç”»æ²¡æœ‰æ—¶é—´çº¿ å°½ç®¡æœ‰è¿™ä¹ˆäº›ç¼ºç‚¹ï¼Œä½†æ˜¯ Pixate æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå®ƒèƒ½å¤Ÿè®¾è®¡å¸ˆè®¾è®¡åŸç”Ÿå¯ç‚¹å‡»çš„åŸå‹ï¼Œåˆ›å»ºå¯¼èˆªæ¨¡å¼ä»¥åŠå±å¹•é—´çš„äº¤äº’ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œå®ƒèƒ½å¤Ÿè®©æ•´ä¸ªå›¢é˜Ÿæ˜ç™½å·¥ç¨‹å¼€å‘çš„æ•´ä½“æ–¹å‘ã€‚ä½ å¯ä»¥è§‚çœ‹Jared Lodwickçš„è§†é¢‘æ•™ç¨‹æ¥äº†è§£æ›´å¤šã€‚ ç°åœ¨ä½ å·²ç»çŸ¥é“ä¸€äº›å…³äº Koloda çš„åŸå‹è®¾è®¡è¿‡ç¨‹ï¼Œæ˜¯æ—¶å€™æ¥è°ˆè°ˆæˆ‘ä»¬å¦‚ä½•å¼€å‘å‡ºç¬¬äºŒç‰ˆåŠ¨ç”»çš„ã€‚ æˆ‘ä»¬å¦‚ä½•å¼€å‘ Koloda v.2 by Eugene Andreyev ç¬¬ä¸€ç‰ˆå’Œç¬¬äºŒç‰ˆåŠ¨ç”»çš„æœ€ä¸»è¦çš„åŒºåˆ«å°±æ˜¯å¡ç‰‡çš„å¸ƒå±€ã€‚æ–°ç‰ˆåŠ¨ç”»ä¸­æœ€å‰çš„å¡ç‰‡è¢«æ”¾ç½®åœ¨å±å¹•ä¸­é—´ï¼Œä¸‹é¢çš„å¡ç‰‡åœ¨èƒŒæ™¯ä¸­æ‹‰ä¼¸ã€‚åº•éƒ¨å¡ç‰‡ä¸ä¼šéšé¡¶éƒ¨å¡ç‰‡ç§»åŠ¨è€Œåšå‡ºå“åº”ï¼Œè€Œæ˜¯åœ¨é¡¶å±‚å¡ç‰‡è¢«æ»‘å‡ºæ—¶å‡ºç°åœ¨å±å¹•ä¸­ï¼Œå‡ºç°è¿‡ç¨‹ä¸­æœ‰ä¸€ä¸ªå¼¹æ€§ç‰¹æ•ˆã€‚å¾—ç›Šäº Dima çš„åŸå‹ï¼Œç¬¬äºŒç‰ˆæ›´åŠ å®¹æ˜“å¼€å‘ã€‚é¦–å…ˆï¼ŒPixate å…è®¸æŸ¥çœ‹åŸå‹çš„æ‰€æœ‰äº¤äº’ï¼Œå…¶æ¬¡æˆ‘å¯ä»¥é€šè¿‡ Pixate æ¥æŸ¥çœ‹æ‰€æœ‰åº”ç”¨åˆ°çš„å˜åŒ–ï¼Œä»¥åŠå®ƒä»¬çš„é¡ºåºã€‚ç„¶åç®€å•åœ°è®²å®ƒä»¬å†™è¿›ä»£ç ä¸­ï¼Œä¸éœ€è¦äººä¸ºè°ƒæ•´ã€‚æœ€åï¼Œç¬¬äºŒç‰ˆ Koloda æ˜¯ä¸€ä¸ªæ—…è¡Œ app çš„ä¸€éƒ¨åˆ†ï¼Œä¸åƒç¬¬ä¸€ç‰ˆé‚£æ ·å…¨æ˜¯æ‘‡æ»šã€‚ ç¬¬ä¸€ç‰ˆï¼š Koloda v.2çš„å®ç°ä¸ºäº†å®ç° Dima è®¾è®¡çš„åŠ¨ç”»ï¼Œæˆ‘éœ€è¦ç”¨ä¸åŒçš„æ–¹å¼æ¥æ”¾ç½®å¡ç‰‡ï¼Œæ‰€ä»¥æˆ‘å°†ä¸Šä¸€ç¯‡æ–‡ç« (KolodaViewå®ç°é‚£ä¸€æ®µ)ä¸­çš„frameForCardAtIndexæš´éœ²åœ¨å¤´æ–‡ä»¶ä¸­ã€‚åœ¨ KolodaView çš„å­ç±»ä¸­æˆ‘å¤å†™äº†è¿™ä¸ªæ–¹æ³•ï¼Œç„¶åæŒ‰å¦‚ä¸‹æ–¹å¼æ¥æ”¾ç½®å¡ç‰‡ï¼š 1234567891011121314151617181920212223242526272829303132333435override func frameForCardAtIndex(index: UInt) -&gt; CGRect &#123; if index == 0 &#123; let bottomOffset:CGFloat = defaultBottomOffset let topOffset:CGFloat = defaultTopOffset let xOffset:CGFloat = defaultHorizontalOffset let width = CGRectGetWidth(self.frame ) - 2 * defaultHorizontalOffset let height = width * defaultHeightRatio let yOffset:CGFloat = topOffset let frame = CGRect(x: xOffset, y: yOffset, width: width, height: height) return frame &#125; else if index == 1 &#123; let horizontalMargin = -self.bounds.width * backgroundCardHorizontalMarginMultiplier let width = self.bounds.width * backgroundCardScalePercent let height = width * defaultHeightRatio return CGRect(x: horizontalMargin, y: 0, width: width, height: height) &#125; return CGRectZero &#125; å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæˆ‘å°† frontCardæ”¾ç½®åœ¨KolodaViewä¸­é—´ï¼Œç„¶åæ‹‰ä¼¸èƒŒæ™¯å¡ç‰‡ä¸ºå…¶åŸå§‹å¤§å°çš„1.5å€ã€‚ èƒŒæ™¯å¡ç‰‡çš„å¼¹æ€§åŠ¨ç”»å› ä¸ºèƒŒæ™¯å¡ç‰‡ä»¥å¼¹æ€§åŠ¨ç”»çš„æ–¹å¼å‡ºç°ï¼Œä»¥åŠåœ¨ç§»åŠ¨è¿‡ç¨‹ä¸­æ”¹å˜é€æ˜åº¦ï¼Œæˆ‘å†™äº†ä¸€ä¸ªæ–°çš„ä»£ç†æ–¹æ³•ï¼š 1KolodaView - func kolodaBackgroundCardAnimation(koloda: KolodaView) -&gt; POPPropertyAnimation? åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼ŒPOPAnimation è¢«åˆ›å»ºç”¨æ¥ä¼ ç»™ Kolodaã€‚ç„¶åå½“ç”¨æˆ·æ»‘åŠ¨å¡ç‰‡æ—¶ï¼Œ Koloda ç”¨å®ƒæ¥ç»™ frame çš„æ”¹å˜åšåŠ¨ç”»ã€‚å¦‚æœä»£ç†æ–¹æ³•è¿”å› nilï¼Œæ„å‘³ç€ Koloda ä½¿ç”¨é»˜è®¤çš„åŠ¨ç”»ã€‚ ä¸‹é¢ä»£ç å°±æ˜¯è¿™ä¸ªä»£ç†æ–¹æ³•çš„å®ç° 1234567891011func kolodaBackgroundCardAnimation(koloda: KolodaView) -&gt; POPPropertyAnimation? &#123; let animation = POPSpringAnimation(propertyNamed: kPOPViewFrame) animation.springBounciness = frameAnimationSpringBounciness animation.springSpeed = frameAnimationSpringSpeed return animation &#125; æ€æ ·é˜»æ­¢èƒŒæ™¯å¡ç‰‡ç§»åŠ¨ï¼ŸåŒæ ·æˆ‘ä¹Ÿæ·»åŠ äº†ä¸€ä¸ªæ–°çš„ä»£ç†æ–¹æ³•åœ¨æ–°ç‰ˆçš„ Koloda ä¸­ 1func kolodaShouldMoveBackgroundCard(koloda: KolodaView) -&gt; Bool å¦‚æœè¿”å› falseå°±æ„å‘³ç€äº¤äº’åŠ¨ç”»è¢«ç¦ç”¨ï¼ŒèƒŒæ™¯å¡ç‰‡ä¸ä¼šéšç€é¡¶å±‚å¡ç‰‡ç§»åŠ¨è€Œç§»åŠ¨ã€‚ ä¸‹é¢å°±æ˜¯è¿”å› false æ—¶çš„åŠ¨ç”»æ•ˆæœï¼š è¿™æ˜¯è¿”å› true çš„åŠ¨ç”»æ•ˆæœ å¸Œæœ›ä½ èƒ½å–œæ¬¢ç¬¬äºŒç‰ˆçš„ Kolodaï¼Œå°½æƒ…ä½¿ç”¨å®ƒå§ï¼ Dribbble GitHub]]></content>
      <categories>
        <category>ç¿»è¯‘</category>
      </categories>
      <tags>
        <tag>ç¿»è¯‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•åˆ›å»ºä¸€ä¸ªç±»ä¼¼ Tinder çš„äº¤äº’åŠ¨ç”»[è¯‘]]]></title>
    <url>%2F2015%2F08%2F21%2FHow-We-Built-Tinder-Like-Koloda-Animation-in-Swift-Chinese-Translation%2F</url>
    <content type="text"><![CDATA[æœ‰æ—¶å€™æˆ‘è®¤ä¸º Tinder ä¸ä»…ä»…è®©äººä»¬é‡è§å½¼æ­¤ï¼Œæ›´å¤šçš„æ˜¯å®ƒå¼•é¢†äº†ä¸€ç§äº¤äº’è®¾è®¡è¶‹åŠ¿ã€‚æ‰€ä»¥æˆ‘ä»¬éå¸¸è‚¯å®šåœ°è¯´ Tinder å·²ç»å®Œæˆäº†ä»–çš„å†å²ä½¿å‘½ï¼Œå¯ä»¥å®‰å¿ƒç­‰å¾…ç€ä¸‹ä¸€ä¸ª Tinder å‡ºç°ã€‚åŸæ–‡:How We Built Tinder-Like Koloda Animation in Swift Tinder çš„å³æ»‘å–œæ¬¢ï¼Œå·¦æ»‘å¿½ç•¥ä¸ä»…ä»…åœ¨çº¦ä¼šï¼ˆpaoï¼‰åº”ç”¨ä¸­å¾ˆæµè¡Œï¼Œåœ¨è´­ç‰© App ä¸­ä¹Ÿå¾ˆæµè¡Œï¼Œæ¯”å¦‚Fancyï¼Œä¹Ÿæ˜¯åƒ Tinder ä¸€æ ·æ˜¯æ»‘åŠ¨å–œæ¬¢çš„å½¢å¼ã€‚ä»–ä»¬ä¹‹æ‰€ä»¥æ‰ç”¨è¿™ç§äº¤äº’å½¢å¼æ˜¯å› ä¸ºè¿™ç§å¡ç‰‡å¼çš„äº¤äº’ç¡®å®æ·±å¾—ç”¨æˆ·æ¬¢å¿ƒã€‚å¡ç‰‡ä¸Šçš„å†…å®¹å¸å¼•äº†ç”¨æˆ·çš„æ³¨æ„åŠ›ä¿ƒä½¿ä»–ä»¬å»è¿›è¡Œä¸€ç³»åˆ—æ“ä½œï¼Œè¿›è€Œæé«˜äº†ç”¨æˆ·å‚ä¸åº¦ã€‚è¿˜æœ‰è®¸å¤šä¸åŒç§ç±» App ä¹Ÿæ˜¯ç”¨è¿™ç§åƒ Tinder ä¸€æ ·çš„å¡ç‰‡å¼æ»‘åŠ¨äº¤äº’çš„ä¾‹å­ï¼Œæ¯”å¦‚Uptopï¼Œå°±è¿è°·æ­Œæµè§ˆå™¨ iOS å®¢æˆ·ç«¯ä¹Ÿæ˜¯ç”¨è¿™ç§å¡ç‰‡å½¢å¼æ¥ç®¡ç†ä¹¦ç­¾ã€‚ æˆ‘ä»¬æŠŠå¡ç‰‡å¼å¸ƒå±€ä»¥åŠåŸºäºæ»‘åŠ¨çš„äº¤äº’ä½œä¸ºä»Šå¹´çš„äº¤äº’è®¾è®¡è¶‹åŠ¿ï¼Œæˆ‘ä»¬çš„è¿™ç¯‡æ–‡ç« æœ‰ç›¸å…³ä»‹ç»ã€‚ä¹‹åæˆ‘ä»¬çš„è®¾è®¡å¸ˆDmitry Goncharovåˆ›å»ºäº†ä¸€ä¸ªç±»ä¼¼ Tinder äº¤äº’çš„åŠ¨ç”»ï¼Œå®é™…ä¸Šä»–æ˜¯æ•…æ„è¿™ä¹ˆåšçš„ã€‚æˆ‘ä»¬æŠŠæˆ‘ä»¬çš„è¿™ç§ç±»ä¼¼ Tinder åŸºäºå¡ç‰‡å¼çš„åŠ¨ç”»å‘½åä¸ºKolodaï¼Œåœ¨ä¹Œå…‹å…°è¯­ä¸­å®ƒçš„æ„æ€æ˜¯ç”²æ¿ï¼ˆå¡ç‰‡ï¼‰ï¼Œå¬èµ·æ¥éå¸¸æœ‰è¶£ã€‚è¿™ä¸ªç»„ä»¶èƒ½å¤Ÿè¢«ä¸åŒ app ä½¿ç”¨ï¼Œå¦‚æœåŠ ä¸Šçº¦ä¼šï¼ˆpaoï¼‰åœ°ç‚¹çš„è¯ï¼Œç”šè‡³åœ¨ Tinder ä¸­ä¹Ÿå¾ˆå®ç”¨ã€‚Dmitriyæå‡ºäº†è¿™ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬çš„iOSå·¥ç¨‹å¸ˆå®ç°äº†è¿™ä¸ªæƒ³æ³•ã€‚è¯¦è§GitHubã€‚ï¼ˆè¯‘è€…æ³¨ï¼šObjective-C ç‰ˆè¯¦è§è¿™é‡Œï¼‰ã€‚ æˆ‘ä»¬å¦‚ä½•å®ç° Koloda åŠ¨ç”» by Eugene Andreyev Tinderçš„æ»‘åŠ¨å–œæ¬¢ç•Œé¢è¢«è®¸å¤šä¸åŒçš„ App å€Ÿé‰´ï¼Œä¹Ÿæœ‰ä¸€äº›ç°æˆçš„åº“æ¥ç»™å¼€å‘è€…ä½¿ç”¨ã€‚é¦–å…ˆï¼Œæˆ‘çœ‹äº†MDCSwipeToChooseä»¥åŠTinderSimpleSwipeCardsï¼Œäº‹å®è¯æ˜ï¼Œå®ƒä»¬å¹¶ä¸èƒ½å®Œç¾çš„å®ç°æˆ‘çš„éœ€æ±‚ã€‚æˆ‘æƒ³è¦çš„åŠ¨ç”»è¦éå¸¸ç®€å•è€Œä¸”æ–¹ä¾¿ï¼Œå°±åƒUITableView é‚£æ ·ç”±æ•°æ®æºæ¥é©±åŠ¨ã€‚å› æ­¤ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªè‡ªå®šä¹‰ç»„ä»¶æ¥æ„å»ºè¿™ä¸ªåŠ¨ç”»ã€‚ä¸»è¦åˆ†ä¸ºå¦‚ä¸‹ä¸‰ä¸ªéƒ¨åˆ†ï¼š DraggableCardViewï¼šç”¨æ¥å±•ç¤ºå†…å®¹çš„å¡ç‰‡å¼å›¾ OverlayViewï¼šé®ç½©è§†å›¾ï¼Œæ ¹æ®ç”¨æˆ·æ‰‹åŠ¿æ–¹å‘ï¼ˆå·¦ã€å³ï¼‰æ¥åŠ¨æ€æ”¹å˜ KolodaViewï¼šç”¨æ¥æ§åˆ¶åŠ è½½å’Œå¡ç‰‡ä¹‹é—´çš„äº¤äº’çš„è§†å›¾ DraggableCardViewçš„å®ç°æ­£å¦‚æˆ‘å‰é¢æåˆ°çš„é‚£æ ·ï¼ŒDraggableCardViewæ˜¯ç”¨æ¥å±•ç¤ºå†…å®¹çš„å¡ç‰‡è§†å›¾ã€‚ç½‘ä¸Šæœ‰å¾ˆå¤šæ•™ç¨‹é˜è¿°äº† Tinder æ»‘åŠ¨åŠ¨ç”»çš„åŸç†ï¼Œæˆ‘é€‰æ‹©äº†å…¶ä¸­ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œåšäº†ä¸€äº›æ”¹åŠ¨ï¼Œç„¶ååˆ©ç”¨UIPanGestureRecognizer å’Œ CGAffineTransformå®ç°äº† DraggableCardViewã€‚éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950//è¯‘è€…æ³¨ï¼šåŸæ–‡æ˜¯ç”¨ swift å†™çš„ï¼Œæˆ‘ç´¢æ€§ç¿»è¯‘æˆäº† OCï¼Œä¸‹åŒ- (void)panGestureRecognized:(UIPanGestureRecognizer *)pan&#123; self.xDistanceFromCenter = [pan translationInView:self].x; self.yDistanceFromCenter = [pan translationInView:self].y; CGPoint location = [pan locationInView:self]; switch (pan.state) &#123; case UIGestureRecognizerStateBegan: &#123; self.originalLocation = self.center; self.dragBegin = YES; self.animationDirection = location.y &gt;= self.frame.size.height / 2 ? -1.0 : 1.0; self.layer.shouldRasterize = YES; &#125; break; case UIGestureRecognizerStateChanged: &#123; CGFloat rotationStrength = MIN(self.xDistanceFromCenter / self.frame.size.width, kRotationMax); CGFloat rotationAngle = self.animationDirection * kDefaultRotationAngle * rotationStrength; CGFloat scaleStrength = 1 - ((1 - kScaleMin) * fabs(rotationStrength)); CGFloat scale = MAX(scaleStrength, kScaleMin); self.layer.rasterizationScale = scale * [UIScreen mainScreen].scale; CGAffineTransform transform = CGAffineTransformMakeRotation(rotationAngle); CGAffineTransform scaleTransform = CGAffineTransformScale(transform, scale, scale); self.transform = scaleTransform; self.center = CGPointMake(self.originalLocation.x + self.xDistanceFromCenter, self.originalLocation.y + self.yDistanceFromCenter); [self updateOverlayWithFinishPercent:self.xDistanceFromCenter / self.frame.size.width]; if ([self.delegate respondsToSelector:@selector(cardView:draggedWithFinishPercent:)]) &#123; [self.delegate cardView:self draggedWithFinishPercent:MIN(fabs(self.xDistanceFromCenter * 100 / self.frame.size.width), 100)]; &#125; &#125; break; case UIGestureRecognizerStateEnded: &#123; [self swipeMadeAction]; self.layer.shouldRasterize = NO; &#125; break; default: break; &#125;&#125; å½“ç”¨æˆ·æ‹–æ‹½æœ€å‰é¢çš„å¡ç‰‡è§†å›¾æ—¶,å®ƒå°±ç¦»äº‹ä»¶è§¦å‘è¾¹ç¼˜è¶Šæ¥è¶Šè¿‘ï¼Œå½“è¾¾åˆ°è§¦å‘è¾¹ç¼˜æ—¶ï¼Œå®ƒå°±ä»å±å¹•ä¸­æ¶ˆå¤±äº†ã€‚åˆ°è§¦å‘è¾¹ç¼˜çš„è·ç¦»ç”¨ç™¾åˆ†æ¯”æ¥è¡¨ç¤ºã€‚åœ¨é¡¶éƒ¨å¡ç‰‡è§†å›¾è¢«æ‹–æ‹½çš„è¿‡ç¨‹ä¸­ï¼Œåº•éƒ¨çš„å¡ç‰‡ä¹Ÿä¼šæœ‰ç›¸åº”çš„åŠ¨ä½œï¼Œè¦ä¹ˆæ˜¯æ”¾å¤§è¦ä¹ˆæ˜¯ç¼©å°ã€‚æ¢è€Œè¨€ä¹‹ï¼Œé¡¶å±‚å’Œåº•å±‚çš„åŠ¨ç”»æ˜¯åŒæ­¥çš„ã€‚åŒæ ·é®ç½©ä¹Ÿä¼šåœ¨ç§»åŠ¨çš„æ—¶å€™å®æ—¶æ›´æ–°ï¼Œåœ¨å®æ—¶æ›´æ–°åŠ¨ç”»è¿‡ç¨‹ä¸­ï¼Œå®ƒçš„é€æ˜åº¦ä»5%ï¼ˆå‡ ä¹ä¸å¯è§ï¼‰åˆ°100%ï¼ˆæ¸…æ™°å¯è§ï¼‰ã€‚ ä¸ºäº†é˜²æ­¢å¡ç‰‡è¾¹ç¼˜å˜å¾—é”¯é½¿åŒ–ï¼Œæˆ‘ä½¿ç”¨äº†layerçš„shouldRasterizeå±æ€§ã€‚åŒæ—¶æˆ‘ä¹Ÿè¦è€ƒè™‘åˆ°å½“å¡ç‰‡æ²¡æœ‰è¢«æ‹–æ‹½åˆ°è§¦å‘ç‚¹æ—¶å¦‚ä½•é‡ç½®å®ƒçš„çŠ¶æ€ã€‚æˆ‘ä½¿ç”¨äº† Facebook çš„ Popæ¡†æ¶æ¥è®¾ç½®å…¶é‡ç½®çŠ¶æ€ä»¥åŠæ¢å¤ä¸Šä¸€æ­¥(undo)çš„åŠ¨ç”»ã€‚å¦‚æœä½ æœ‰å°è±¡çš„è¯ï¼Œæ‰€æœ‰Paperåº”ç”¨ä¸­çš„åŠ¨ç”»å’Œè¿‡æ¸¡è½¬æ¢åŠ¨ç”»éƒ½æ˜¯ä½¿ç”¨è¿™ä¸ªæ¡†æ¶æ¥å®Œæˆçš„ã€‚å®ƒæ”¯æŒåŠ¨æ€å¼¹æ€§åŠ¨ç”»ï¼Œä¹Ÿå…è®¸åˆ›å»ºä»»ä½•ç‰©ç†ç°å®ä¸­çš„äº¤äº’åŠ¨ç”»ï¼Œå¯å–œçš„æ˜¯å®ƒä»…ä»…åªéœ€è¦å¾ˆå°‘çš„å‡ è¡Œä»£ç å°±å¯ä»¥å®ç°ã€‚ OverlayViewçš„å®ç°OverlayViewæ˜¯åœ¨é¡¶éƒ¨å¡ç‰‡ View è¿›è¡ŒåŠ¨ç”»æ—¶è¢«æ·»åŠ ä¸Šå»çš„ï¼Œå®ƒåªæœ‰ä¸€ä¸ªåä¸ºoverlayStateçš„å±æ€§ï¼Œè¿™ä¸ªå±æ€§æœ‰ä¸¤ä¸ªå¯é€‰å€¼ï¼šå½“ç”¨æˆ·æ‹–åŠ¨å¡ç‰‡åˆ°å·¦è¾¹ï¼ŒoverlayStateå°±æ·»åŠ ä¸€ä¸ªçº¢è‰²çš„é®ç½©åˆ°å¡ç‰‡è§†å›¾ä¸Šï¼Œåä¹‹ç”¨æˆ·æ‹–æ‹½åˆ°å³è¾¹ï¼Œè¿™ä¸ªå±æ€§è¢«è®¾ç½®ä¸ºå¦ä¸€ä¸ªå¯é€‰å€¼ï¼Œä½¿å¾—å¡ç‰‡çš„é®ç½©å˜æˆç»¿è‰²ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šæˆ‘åœ¨æŠŠä»£ç ç¿»è¯‘æˆ OC æ—¶å¯¹å˜é‡ååšäº†äº›è®¸æ”¹åŠ¨ï¼ŒoverlayStateæ”¹æˆäº†typeï¼Œå…·ä½“å‚è§ GitHubï¼Œä¸‹åŒï¼‰ã€‚ä¸ºäº†å®ç°é®ç½©çš„è‡ªå®šä¹‰è¡Œä¸ºï¼Œæˆ‘ä»¬å¯ä»¥ç»§æ‰¿OverlayViewï¼Œç„¶åé‡è½½overlayStateçš„didSetæ–¹æ³•ã€‚å¤§è‡´ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435//.h#import &lt;UIKit/UIKit.h&gt;#import "OverlayView.h"@interface CustomOverlayView : OverlayView@end//.m#import "CustomOverlayView.h"@interface CustomOverlayView ()@property (weak, nonatomic) IBOutlet UIImageView *imageView;@end@implementation CustomOverlayView- (void)setType:(OverlayType)type&#123; switch (type) &#123; case OverlayTypeLeft: self.imageView.image = [UIImage imageNamed:@"noOverlayImage"]; break; case OverlayTypeRight: self.imageView.image = [UIImage imageNamed:@"yesOverlayImage"]; break; case OverlayTypeNone: default: self.imageView.image = nil; break; &#125;&#125;@end KolodaViewçš„å®ç°KolodaViewç±»è´Ÿè´£å¡ç‰‡çš„åŠ è½½ä»¥åŠç®¡ç†å·¥ä½œã€‚ä½ å¯ä»¥é€šè¿‡ä»£ç æˆ–è€…Interface Builderæ¥å®ç°ã€‚ç„¶åä½ å°±å¯ä»¥ä¸ºå…¶æŒ‡å®šdataSourceä»¥åŠdelegate(å¯é€‰)ã€‚æœ€åä½ åº”è¯¥å®ç°dataSourceä¸­çš„å¦‚ä¸‹æ–¹æ³•ï¼š 1234567891011@protocol SwipeViewDataSource &lt;NSObject&gt;@required- (NSUInteger)swipeViewNumberOfCards:(SwipeView *)swipeView;- (UIView *)swipeView:(SwipeView *)swipeView cardAtIndex:(NSUInteger)index;- (OverlayView *)swipeView:(SwipeView *)swipeView cardOverlayAtIndex:(NSUInteger)index;@end æˆ‘ä»¬ä½¿ç”¨äº†ä»£ç†æ–¹æ³•è€Œä¸æ˜¯å›è°ƒ(block)çš„æ–¹å¼æ¥è·å–ç›¸å…³æ•°æ®ã€‚ å‡ ä½•è§£é‡Šè¿˜è®°å¾—æˆ‘ä»¬å…³äºå¼€å‘å®‰å“Guillotineèœå•åŠ¨ç”»çš„æ•…äº‹å—ï¼Ÿåœ¨é‚£ä¸ªæ•…äº‹ä¸­æˆ‘ä»¬çš„å®‰å“å·¥ç¨‹å¸ˆDmytro Denysenkoé‡‡ç”¨é«˜ä¸­æ•°å­¦çŸ¥è¯†æ¥è®¡ç®—ä¸€ä¸ªè‡ªå®šä¹‰çš„å·®å€¼ã€‚å‡ ä½•çŸ¥è¯†åœ¨æˆ‘çš„ iOS å¼€å‘ç”Ÿæ¶¯ä¸­ä¹Ÿå‘æŒ¥äº†å¾ˆå¤§çš„ä½œç”¨ï¼ åŠ¨ç”»è¿‡ç¨‹ä¸­æœ€æœ‰è¶£çš„ä¸€ä»¶äº‹å°±æ˜¯å½“ç”¨æˆ·åœ¨æ‹–æ‹½é¡¶éƒ¨å¡ç‰‡æ—¶ï¼Œä¸‹é¢çš„å¡ç‰‡ä¹Ÿä¼šè·Ÿç€ç§»åŠ¨ã€‚æˆ‘æƒ³è®©KolodaåŠ¨ç”»æ›´åŠ çµæ´»ï¼Œæ‰€ä»¥æˆ‘ç®€å•åœ°æŒ‡å®šäº†æƒ³è¦åœ¨å±å¹•ä¸Šå±•ç¤ºçš„å¡ç‰‡æ•°ï¼Œç„¶åæˆ‘å°±æ‹¿å‡ºçº¸å°±å¼€å§‹è®¡ç®—ã€‚ KolodaViewéœ€è¦å±•ç¤ºä½äºé¡¶å±‚å¡ç‰‡ä¹‹ä¸‹çš„å¡ç‰‡æ­£ç¡®çš„æ•°é‡ï¼Œç„¶åè®©å®ƒä»¬åœ¨åŠ¨ç”»å¼€å§‹çš„æ—¶å€™å æ®æ­£ç¡®çš„ä½ç½®ã€‚ä¸ºäº†å®ç°å®ƒï¼Œæˆ‘éœ€è¦è®¡ç®—æ‰€æœ‰å¡ç‰‡çš„frameï¼Œè¿™ä¸ªæ˜¯é€šè¿‡ç»™å…¶ä¸­æ¯ä¸ªå…ƒç´ æ·»åŠ å¯¹åº”çš„åºå·æ¥å®ç°çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œç¬¬ä¸€ä¸ªå¡ç‰‡è§†å›¾çš„åºå·æ˜¯[i]ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªå°±æ˜¯[i+1],ç¬¬ä¸‰ä¸ªå°±æ˜¯[i+2],ä»¥æ­¤ç±»æ¨ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä½ å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°ç¬¬ä¸€å¼ å¡ç‰‡çš„frameå’Œsizeçš„è®¡ç®—è¿‡ç¨‹ã€‚ ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415- (CGRect)frameForCardAtIndex:(NSUInteger)index&#123; CGFloat bottomOffset = 0; CGFloat topOffset = kBackgroundCardsTopMargin * (self.visibleCardsCount - 1); CGFloat xOffset = kBackgroundCardsLeftMargin * index; CGFloat scalePercent = kBackgroundCardsScalePercent; CGFloat width = CGRectGetWidth(self.frame) * pow(scalePercent, index); CGFloat height = (CGRectGetHeight(self.frame) - bottomOffset - topOffset) * pow(scalePercent, index); CGFloat multiplier = index &gt; 0 ? 1.0 : 0.0; CGRect previousCardFrame = index &gt; 0 ? [self frameForCardAtIndex:MAX(index - 1, 0)] : CGRectZero; CGFloat yOffset = (CGRectGetHeight(previousCardFrame) - height + previousCardFrame.origin.y + kBackgroundCardsTopMargin) * multiplier; CGRect frame = CGRectMake(xOffset, yOffset, width, height); return frame;&#125; ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†åºå·ã€å¡ç‰‡frameä»¥åŠåŠ¨ç”»ç»“æŸçš„ç™¾åˆ†æ¯”ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆè½»æ¾çš„è®¡ç®—å‡ºå½“ä¸Šä¸€ä¸ªå¡ç‰‡è¢«æ»‘å‡ºå±å¹•æ—¶ä¸‹ä¸€ä¸ªå¡ç‰‡åº”è¯¥å‡ºç°çš„ä½ç½®ã€‚ä¹‹åï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å®ç°ä¸€ä¸ªç™¾åˆ†æ¯”é©±åŠ¨åŠ¨ç”»ï¼ˆPercentDrivenAnimationï¼‰ã€‚æœ€åæˆ‘ç»™è¿™ä¸ªç®€å•æ˜“ç”¨çš„ç»„ä»¶å–äº†ä¸ªæœ‰è¶£çš„åå­—â€“Kolodaã€‚ä»»ä½•å¼€å‘è€…éƒ½å¯ä»¥è‡ªå®šä¹‰å®ƒï¼Œé€šè¿‡è®¾ç½®å…¶å†…å®¹è§†å›¾ä»¥åŠé®ç½©è§†å›¾ã€‚è¿‡äº›æ—¶å€™ï¼Œæˆ‘æƒ³å®ç°è‡ªå®šä¹‰åŠ¨ç”»ä»¥åŠframeçš„è®¡ç®—æ–¹å¼ï¼Œè¿™æ ·å¼€å‘è€…ä»¬å°±å¯ä»¥ä½¿ç”¨ä»–ä»¬è‡ªå·±åˆ«å…·ä¸€æ ¼çš„ç»„ä»¶ã€‚KolodaView çš„ä»£ç è¯¦è§GitHubã€‚ è¯‘è€…æ³¨ï¼šObjC ç‰ˆæœ¬å¯ä»¥å‚è§Koloda-ObjC]]></content>
      <categories>
        <category>ç¿»è¯‘</category>
      </categories>
      <tags>
        <tag>ç¿»è¯‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AVFoundationå’Œ GPUImageåˆæ¢]]></title>
    <url>%2F2014%2F08%2F24%2FAVFoundation-And-GPUImage%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨åšè§†é¢‘ç›¸å…³çš„ä¸œè¥¿ï¼Œç„¶åç†Ÿæ‚‰äº†ä¸€ä¸‹AVFoundationæ¡†æ¶ï¼Œä»¥åŠå¼ºå¤§çš„å¼€æºåº“GPUImageã€‚åœ¨è¿™é‡Œè®°å½•è¿™ä¸ªè¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼Œä»¥åŠè§£å†³çš„æ–¹æ³•ã€‚ AVFoundationçš„ä¸€äº›åŸºæœ¬æ¦‚å¿µæ ¹æ®è‹¹æœçš„å®˜æ–¹æ–‡æ¡£ï¼ŒAVFoundationæ˜¯ç”¨æ¥æ’­æ”¾å’Œåˆ›å»ºå®æ—¶çš„è§†å¬åª’ä½“æ•°æ®çš„æ¡†æ¶ï¼ŒåŒæ—¶æä¾›Objective-Cæ¥å£æ¥æ“ä½œè¿™äº›è§†å¬æ•°æ®ï¼Œæ¯”å¦‚ç¼–è¾‘ï¼Œæ—‹è½¬ï¼Œé‡ç¼–ç ã€‚æœ¬æ–‡ç€é‡è®²çš„æ˜¯è§†é¢‘çš„å½•åˆ¶å’Œç¼–è¾‘å’ŒGPUImageçš„ä¸€äº›ç®€å•ä½¿ç”¨ï¼Œå…¶ä»–çš„éƒ½æ˜¯ä¸€ç¬”å¸¦è¿‡ã€‚æ¥çœ‹ä¸‹è‹¹æœæ–‡æ¡£çš„ä¸€ä¸ªæ¡†æ¶å›¾ã€‚ ç›¸å…³ç±» AVAsset AVAssetTrack AVComposition AVVideoComposition AVAudioMix AVMutableAudioMixInputParameter AVMutableVideoCompositionInstrution AVMutableVideoCompositionLayerInstrution ç®€å•çš„æ’­æ”¾å¯ä»¥ä½¿ç”¨MPMoviePlayerControlleræˆ–è€…MPMovieViewControllerå°±è¡Œ,ç®€å•çš„å½•åˆ¶å¯ä»¥ç›´æ¥ä½¿ç”¨UIImagePickerControllerã€‚åŒæ ·ç®€å•çš„å£°éŸ³æ’­æ”¾ç›´æ¥ä½¿ç”¨AVAudioPlayerï¼Œç®€å•çš„å½•åˆ¶ç›´æ¥ä½¿ç”¨AVAduioRecorderã€‚å¦‚æœä½ æƒ³è¦æœ‰æ›´å¤šçš„æ“ä½œï¼Œå¯ä½¿ç”¨å„ç§å¤æ‚çš„æ–¹å¼æ¥æ§åˆ¶æ’­æ”¾ï¼Œæ¯”å¦‚åœ¨åŒä¸€æ—¶åˆ»ä¸ºåŒä¸€ä¸ªassetçš„ä¸åŒç‰‡æ®µä½¿ç”¨ä¸åŒçš„åˆ†è¾¨ç‡æ¸²æŸ“ï¼Œplayitemæ¥ç®¡ç†assetçš„å‘ˆç°çŠ¶æ€å’Œæ–¹å¼,playitemtrackç®¡ç†assetä¸­çš„è½¨é“ï¼ˆtrackï¼‰çŠ¶æ€ã€‚ åœ¨AVFoudationæ¡†æ¶ä¸­æœ€æ ¸å¿ƒçš„ç±»å°±æ˜¯AVAssetï¼Œä»–æ˜¯ç”±ä¸€ç³»åˆ—çš„åª’ä½“æ•°æ®ç»„æˆçš„ï¼ŒåŒ…æ‹¬ä½†ä¸é™äº:æ—¶é—´ã€å¤§å°(size)ã€æ ‡é¢˜ã€å­—å¹•ç­‰ã€‚å…¶ä¸­æ¯ä¸€ä¸ªå•ç‹¬çš„åª’ä½“æ•°æ®ç§°ä¸ºè½¨é“(track)ã€‚åŒæ ·å‰ªè¾‘æ“ä½œä¸­ï¼ŒAVMutableCompositionæ˜¯ä¸€ä¸ªæ ¸å¿ƒç±»ã€‚ è¿™é‡Œåˆä¸€ä¸ªé‡è¦çš„ä¸œè¥¿å°±æ˜¯CMTime,å®ƒæ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œå®šä¹‰å¦‚ä¸‹: typedef struct{ CMTimeValue value; CMTimeScale timescale; CMTimeFlags flags; CMTimeEpoch epoch;} CMTime;é€šå¸¸æ—¶é—´æ˜¯ç­‰äºvalue/timescaleçš„ï¼Œæ‰€ä»¥ä¸¤ä¸ªæœ‰ç›¸åŒæ—¶é—´çš„CMTimeå®ƒä»¬çš„timescaleå¹¶ä¸ä¸€å®šç›¸åŒã€‚å…³äºæ›´å¤šCMTimeçš„å†…å®¹å¯ä»¥çœ‹è¿™é‡Œã€‚ è¿›é˜¶è§†é¢‘çš„å½•åˆ¶è¿™é‡Œç”¨çš„æ˜¯ç³»ç»ŸåŸç”Ÿå½•åˆ¶,å…³äºå½•åˆ¶é€šå¸¸ç”¨åˆ°çš„å‡ ä¸ªç±»å°±æ˜¯AVCaptureDeviceã€AVCaptureSessionã€AVCaptureDeviceInputã€AVCaptureOutput,åŒæ ·ï¼Œæ¥çœ‹ä¸€å¼ å›¾ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœä½ æƒ³ä¿®æ”¹è§†é¢‘çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚æ‹æ‘„åœ°ç‚¹ç­‰ï¼Œå¯ä»¥æ‹¿åˆ°outputçš„metadataæ¥ä¿®æ”¹ã€‚å¤§è‡´ä»£ç å¦‚ä¸‹: 1234567NSMutableArray *array = [output.metadta mutableCopy];AVMutableMetadataItem *item = [[AVMutableMetadataItem alloc] init];item.keyspace = ...;item.key = ...;item.value = ...;[array addObject:item];output.metadata = array; å¦‚æœå½•åˆ¶æ—¶å€™æƒ³è¦å¾—åˆ°æŒ‡å®šçš„è§†é¢‘sizeå¿…é¡»å…ˆæŒ‡å®šåˆ†è¾¨ç‡ï¼Œåƒè¿™æ · 1234567if ([session canSetSessionPreset:AVCaptureSessionPreset640x480])&#123; session.sessionPreset = AVCaptureSessionPreset640x480;&#125;else &#123; //è®¾ç½®å¤±è´¥&#125; åˆ‡æ¢æ‘„åƒå¤´æˆ–å…¶ä»–è¾“å…¥æºå¿…é¡»åœ¨beginConfigurationå’ŒcommitConfigurationä¹‹é—´æ¥å¤„ç†ï¼Œå¤§è‡´æ˜¯è¿™æ · 123456[session beginConfiguration];//ç§»é™¤æŸä¸ªè¾“å…¥æº//å†æ·»åŠ æŸä¸ªè¾“å…¥æº//å†ä¸ºæ–°æ·»åŠ çš„è¾“å…¥æºè¿›è¡Œå¿…è¦çš„ç›¸å…³è®¾ç½®//...å…¶ä»–æ“ä½œ[session commitConfiguration]; å¦‚æœæƒ³å¯¹å®æ—¶è§†é¢‘å¸§è¿›è¡Œç›¸å…³çš„æ¸²æŸ“æ“ä½œ,é€šè¿‡ setSampleBufferDelegate:queue:æ–¹æ³•æ¥ä¸ºoutputè®¾ç½®ä»£ç†ï¼ŒåŒæ—¶å¿…é¡»æŒ‡å®šqueueï¼Œä»£ç†æ–¹æ³•å°†ä¼šåœ¨è¿™äº›queueä¸Šé¢è¢«è°ƒç”¨ã€‚å¯ä»¥åœ¨è‡ªå·±çš„ç±»é‡Œé¢å®ç°AVCaptureVideoDataOutputçš„åè®®æ–¹æ³•,é€šè¿‡å®ç°captureOutput:didOutputSampleBuffer:fromConnection:æ¥æ‹¿åˆ°è§†é¢‘çš„æ¯ä¸€å¸§ï¼Œé»˜è®¤æƒ…å†µä¸‹è¿™äº›è§†é¢‘å¸§ä¼šè¢«ç”¨æœ€æœ‰æ•ˆçš„æ ¼å¼æ¥è¾“å‡ºåˆ°output,å½“ç„¶ä¹Ÿå¯ä»¥åœ¨æ‹æ‘„ä¹‹å‰å°±ä¸ºoutputè¿›è¡Œç›¸å…³è®¾ç½®ã€‚ 123AVCaptureVideoDataOutput *videoDataOutput = [AVCaptureVideoDataOutput new];NSDictionary *newSettings =@&#123; (NSString *)kCVPixelBufferPixelFormatTypeKey : @(kCVPixelFormatType_32BGRA) &#125;;videoDataOutput.videoSettings = newSettings; è¯´äº†è¿™ä¹ˆå¤šï¼Œæ„Ÿè§‰å¾ˆè™šï¼Œè¿˜æ˜¯ç›´æ¥ä¸Šä»£ç ï¼Œå°†ä»¥ä¸Šéƒ¨åˆ†è¡”æ¥èµ·æ¥ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768//è‡ªå®šä¹‰æ–¹æ³•ï¼Œå°æ¼”ç¤ºåªæ·»åŠ äº†è§†é¢‘ï¼Œæ²¡æœ‰æ·»åŠ å£°éŸ³ï¼Œæ·»åŠ å£°éŸ³ç±»ä¼¼- (void)yourCustomMethodName&#123; AVCaptureSession *session = [[AVCaptureSession alloc] init]; if ([session canSetSessionPreset:AVCaptureSessionPreset640x480])&#123; session.sessionPreset = AVCaptureSessionPreset640x480; &#125; else &#123; //è®¾ç½®å¤±è´¥ &#125; AVCaptureDevice *device = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo]; NSError *error = nil; AVCaptureDeviceInput *input = [AVCaptureDeviceInput deviceInputWithDevice:device error:&amp;error]; if (!input) &#123; // Handle the error appropriately. &#125; if(session canAddInput:input)&#123; [session addInput:input]; &#125; AVCaptureVideoDataOutput *output = [[AVCaptureVideoDataOutput alloc] init]; if(session canAddOutput:output)&#123; [session addOutput:output]; &#125; output.videoSettings =@&#123; (NSString *)kCVPixelBufferPixelFormatTypeKey : @(kCVPixelFormatType_32BGRA) &#125;; //è®¾ç½®å¸§ç‡(FPS),æ¯ç§’15å¸§ output.minFrameDuration = CMTimeMake(1, 15); dispatch_queue_t queue = dispatch_queue_create("CustomQueue", NULL); [output setSampleBufferDelegate:self queue:queue]; dispatch_release(queue) NSString *mediaType = AVMediaTypeVideo; //ç”¨æ¥æ˜¾ç¤ºå½•åˆ¶çš„å®æ—¶ç”»é¢ AVCaptureVideoPreviewLayer *captureVideoPreviewLayer = [[AVCaptureVideoPreviewLayer alloc] initWithSession:session]; [self.view.layer addSublayer:captureVideoPreviewLayer]; //ç”¨æˆ·æ˜¯å¦å…è®¸å¯ç”¨æ‘„åƒå¤´ [AVCaptureDevice requestAccessForMediaType:mediaType completionHandler:^(BOOL granted) &#123; if (granted) &#123; //Granted access to mediaType [self setDeviceAuthorized:YES]; [session startRunning]; &#125; else &#123; //Not granted access to mediaType dispatch_async(dispatch_get_main_queue(), ^&#123; [[[UIAlertView alloc] initWithTitle:@"AVCam!" message:@"AVCam doesn't have permission to use Camera, please change privacy settings" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil] show]; [self setDeviceAuthorized:NO]; &#125;); &#125; &#125;];&#125;//åè®®æ–¹æ³•,è·å–æ¯ä¸€å¸§ï¼Œå°†æ¯ä¸€å¸§è½¬æ¢æˆå›¾ç‰‡ï¼Œä½ ä¹Ÿå¯ä»¥è¿›è¡Œå…¶ä»–çš„æ¸²æŸ“æ“ä½œ- (void)captureOutput:(AVCaptureOutput *)captureOutput didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer fromConnection:(AVCaptureConnection *)connection &#123; UIImage *image = imageFromSampleBuffer(sampleBuffer);&#125; ä¸Šé¢æ¼”ç¤ºäº†å¦‚ä½•å–å¾—æ¯ä¸€å¸§å®æ—¶ç”»é¢,å¦‚æœæƒ³è¦ç›´æ¥å­˜æˆè§†é¢‘å¯ä½¿ç”¨AVCaptureMovieFileOutput,å¦‚ä¸‹ 123456AVCaptureMovieFileOutput *movieFileOutput = [[AVCaptureMovieFileOutput alloc] init];NSURL *fileURL = ...; //å­˜æ”¾ä½ç½®//æŒ‡å®šä»£ç†[aMovieFileOutput startRecordingToOutputFileURL:fileURL recordingDelegate:delete];//ä¹Ÿå¯ä»¥ä¸ºå…¶æŒ‡å®šoutputSettingsåŒæ ·ä»£ç†å¿…é¡»å®ç°åè®®æ–¹æ³•captureOutput:didFinishRecordingToOutputFileAtURL:fromConnections:error:, å½“ç„¶è¿˜æœ‰å…¶ä»–å„ç§å…·ä½“çš„è®¾ç½®ï¼Œå¦‚å¯¹ç„¦ã€æ›å…‰ã€é—ªå…‰ç¯ä»¥åŠç™½å¹³è¡¡ç­‰ç­‰å‡å¯ä»¥é€šè¿‡KVOæ¥è®¾ç½®ï¼Œæ¯æ¬¡è®¾ç½®å‰éƒ½åŠ ä¸€ä¸ªåˆ¤æ–­ï¼Œæ˜¯å¦æ”¯æŒæŒ‡å®šæ¨¡å¼,åœ¨è¿™é‡Œä¸åšè¯¦ç»†å™è¿°äº†,è¿™é‡Œä½ å¯ä»¥çœ‹åˆ°æ›´å¤šã€‚ è§†é¢‘çš„å‰ªè¾‘è§†é¢‘çš„å‰ªè¾‘åŒ…æ‹¬ä½†ä¸é™äº:è£å‰ªã€æ—‹è½¬(æ”¹å˜transform)ã€æ·»åŠ æ°´å°ã€æ·»åŠ å­—å¹•ã€åˆå¹¶ç­‰ã€‚å…³äºå‰ªè¾‘ï¼Œæ— éå°±æ˜¯å–å‡ºè§†é¢‘ä¸­çš„è½¨é“(è§†é¢‘å’ŒéŸ³é¢‘),ç„¶åå¯¹è½¨é“è¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œå˜å¯ä»¥å¾—åˆ°å„ç§æƒ³è¦çš„æ•ˆæœã€‚é¦–å…ˆæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹é¢ä¸€å¼ å›¾ AVMutableCompositionæ˜¯æ•´ä¸ªè§†é¢‘å‰ªè¾‘è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒï¼Œä¸‹é¢ç€é‡è®²è§£è¿™ä¸ªç±»ã€‚AVMutableCompositionå’ŒAVAssetä¸€æ ·å«æœ‰å¤šä¸ªè§†/éŸ³é¢‘è½¨é“ï¼Œä½†æ˜¯æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒå¯ä»¥å°†å¤šä¸ªAVAssetTrackåˆå¹¶åˆ°ä¸€èµ·ï¼Œæ¯”å¦‚åœ¨è§†é¢‘åˆå¹¶æ—¶ï¼Œå¯ä»¥ç›´æ¥å°†å¤šæ®µè§†é¢‘æ‹¼æ¥åˆ°ä¸€ä¸ªè½¨é“(AVMutableCompositonTrcak)ï¼ŒéŸ³é¢‘ä¹Ÿä¸€æ ·ã€‚é€šè¿‡å€ŸåŠ©AVMutableVideoCompositionå’ŒAVMutableAudioMixæ¥è®¾ç½®æ¯ä¸€æ®µçš„è§†/éŸ³é¢‘çš„å±æ€§ï¼Œä»è€Œè¾¾åˆ°æƒ³è¦çš„è§†å¬æ•ˆæœï¼Œæ¯”å¦‚è§†é¢‘åˆ‡æ¢å¤„çš„æ·¡å…¥æ·¡å‡ºï¼Œå£°éŸ³çš„æ¸å˜ï¼Œå­—å¹•ç­‰ç­‰ã€‚å…³äºä¸Šå›¾çš„è§£é‡Š:é¦–å…ˆé€šè¿‡å°†asseté‡Œé¢çš„è½¨é“åŠ è½½åˆ°compositionçš„å„è½¨é“ï¼Œç„¶åé€šè¿‡audioMixå’ŒvideoCompositionå¯¹æŸä¸ªè½¨é“è¿›è¡Œå¯¹åº”æ“ä½œ,è®¾ç½®å…¶ç›¸å…³å±æ€§ã€‚å…¶ä¸­è¦ç”¨åˆ°çš„å…·ä½“æ–¹æ³•å¯ä»¥å‚è§è¿™é‡Œã€‚ å…¶ä¸­å›¾ä¸­1ï¼Œ2ï¼Œ3ç”¨åˆ°çš„æ–¹æ³•ä¸º 123456[1][mutableComposition addMutableTrackWithMediaType:AVMediaTypeVideo preferredTrackID:kCMPersistentTrackID_Invalid][2][AVMutableAudioMixInputParameters audioMixInputParametersWithTrack:mutableCompositionAudioTrack];`[3][AVMutableVideoCompositionLayerInstruction videoCompositionLayerInstructionWithAssetTrack:mutableCompositionVideoTrack] å…³äºè§†é¢‘çš„å‰ªè¾‘çš„ä»£ç å¯ä»¥å‚è§è‹¹æœç»™å‡ºçš„å®˜æ–¹Demoä»¥åŠRaywendrichä¸Šçš„ä¸¤ç¯‡æ–‡ç« 1,2ã€‚ GPUImageä»€ä¹ˆ?!ä½ æ²¡å¬è¯´è¿‡GPUImage?!é‚£ä½ èµ¶ç´§å»çœ‹çœ‹å®ƒçš„ç›¸å…³ä»‹ç»ã€‚GPUImageæ˜¯ä¸€ä¸ªåŸºäºOpenGL ESçš„ä¸€ä¸ªå¼ºå¤§çš„å›¾åƒ/è§†é¢‘å¤„ç†åº“,å°è£…å¥½äº†å„ç§æ»¤é•œåŒæ—¶ä¹Ÿå¯ä»¥ç¼–å†™è‡ªå®šä¹‰çš„æ»¤é•œã€‚è‡³äºä»–åˆ°åº•æ˜¯å¦‚ä½•å¼ºå¤§,ç”¨äº†å°±çŸ¥é“ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸æ˜¯ä¸ºäº†ä»‹ç»å®ƒï¼Œè€Œæ˜¯åˆ—å‡ºä¸€äº›æˆ‘åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ³•ã€‚ åˆ†æ®µå½•åˆ¶åœ¨ä½¿ç”¨GPUImageVideoCameraæ¥å½•åˆ¶çš„æ—¶å€™,å¯èƒ½éœ€è¦åˆ†æ®µå½•åˆ¶,åœ¨GPUImageç»™å‡ºçš„è§†é¢‘å½•åˆ¶Demoä¸­ç›´æ¥åªæ˜¯å½•åˆ¶ä¸€æ¬¡ï¼Œç„¶è€Œæœ‰æ—¶å€™éœ€æ±‚å¯èƒ½æ˜¯è¦å½•åˆ¶å¤šæ¬¡ï¼Œå¦‚æœæ­¤æ—¶æŒ‰ç…§Demoçš„æ–¹æ³•æ¯æ¬¡å½•åˆ¶éƒ½è¦åˆ›å»ºä¸€ä¸ªmovieWriter,è¿™æ ·å­çš„è¯æ¯æ¬¡éƒ½ä¼šåœ¨é‡æ–°åˆ›å»ºmovieWriterå¹¶å°†å®ƒè®¾ç½®ä¸ºvideoCameraçš„audioEncodingTargetæ—¶å€™ï¼Œç•Œé¢éƒ½ä¼šå¡é¡¿ä¸€ä¸‹ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿå› ä¸ºvideoCameraé»˜è®¤æ˜¯ä¸å½•åˆ¶å£°éŸ³çš„ï¼Œè€Œæ¯æ¬¡åˆ›å»ºmovieWriterçš„æ—¶å€™éƒ½ç”¨åˆ°äº†movieWriter.hasAudioTrack = YES;,åŠç”¨è¿™ä¸ªä¹‹åvideoCameraä¼šè‡ªåŠ¨å»æ·»åŠ å£°éŸ³è¾“å…¥æº,å‡†å¤‡ä¸€äº›æ•°æ®ï¼Œæ‰€ä»¥è¿™ä¸ªè¿‡ç¨‹ä¼šå¯¼è‡´ç•Œé¢å¡é¡¿ä¸€ä¸‹ï¼Ÿè¿™è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå¦‚æœä½ æœ‰è¿›åˆ°videoCameraçš„å¤´æ–‡ä»¶å»çœ‹çš„è¯ä½ ä¼šå‘ç°è¿™ä¹ˆä¸€ä¸ªæ–¹æ³•å’Œå®ƒçš„æ³¨é‡Š 1234567//Add audio capture to the session. Adding inputs and outputs freezes //the capture session momentarily, so you can use this method to add //the audio inputs and outputs early, if youâ€™re going to set the //audioEncodingTarget later. Returns YES is the audio inputs and //outputs were added, or NO if they had already been added.-(BOOL)addAudioInputsAndOutputs; æ³¨é‡Šçš„å¤§æ„æ˜¯:å½•åˆ¶çš„æ—¶å€™æ·»åŠ å£°éŸ³,æ·»åŠ è¾“å…¥æºå’Œè¾“å‡ºæºä¼šæš‚æ—¶ä¼šä½¿å½•åˆ¶æš‚æ—¶å¡ä½,æ‰€ä»¥åœ¨è¦ä½¿ç”¨å£°éŸ³çš„æƒ…å†µä¸‹è¦å…ˆè°ƒç”¨è¯¥æ–¹æ³•æ¥é˜²æ­¢å½•åˆ¶è¢«å¡ä½ã€‚è¿™ä¸åˆšå¥½å°±è§£å†³äº†ä¸Šé¢çš„è¿™ä¸ªé—®é¢˜å—ï¼Ÿæ‰€ä»¥é—®é¢˜å°±è¿åˆƒè€Œè§£äº†,å› ä¸ºæ²¡çœ‹åˆ°è¿™ä¸ª,èµ°äº†ä¸å°‘å¼¯è·¯,æµªè´¹äº†å¥½é•¿æ—¶é—´ã€‚ å…³äºåˆ†æ®µå½•åˆ¶,å¯èƒ½æœ‰è¿™ä¹ˆä¸€ä¸ªéœ€æ±‚å°±æ˜¯æ‰€æœ‰ç‰‡æ®µéƒ½æ˜¯å­˜äºä¸€ä¸ªæ–‡ä»¶ä¸­è€Œä¸æ˜¯å½•åˆ¶å®Œæˆåå°†å„æ®µåˆå¹¶åˆ°ä¸€ä¸ªè§†é¢‘æ–‡ä»¶ä¸­ã€‚è¿™ä¸¤ä¸ªä¸œè¥¿æˆ–è®¸ä¼šå¸®åˆ°ä½ åˆ†æ®µå½•åˆ¶çš„å®ç°,GPUImageExtendã€‚å‰è€…æ˜¯åŸºäºç³»ç»Ÿçš„åˆ†æ®µå½•åˆ¶çš„å®ç°,åè€…æ˜¯GPUImageMoiveWriterçš„ä¸€ä¸ªå­ç±»ã€‚ æ‰€è§å³æ‰€å¾—åœ¨å½•åˆ¶çš„æ—¶å€™,ä½¿ç”¨GPUImageViewæ¥æ˜¾ç¤º,å› ä¸ºç»™GPUImageViewè®¾ç½®çš„å¤§å°æ˜¯320*320çš„,å¦‚æœä¸è®¾ç½®å®ƒçš„å¡«å……æ¨¡å¼(fillMode)å®ƒæ˜¯é»˜è®¤ä½¿ç”¨kGPUImageFillModePreserveAspectRatioå³ä¿æŒé•¿å®½æ¯”,å…¶ä½™ç©ºç™½å¤„ä½¿ç”¨èƒŒæ™¯è‰²å¡«å……,å¦‚æœè¦è®¾ç½®æˆæ–¹å½¢å°±å¾—ä½¿ç”¨kGPUImageFillModePreserveAspectRatioAndFill,ä½†æ˜¯è¿™ä¸ªæ—¶å€™é—®é¢˜åˆæ¥äº†å‡è®¾ä½ æ˜¯ç”¨çš„å½•åˆ¶åˆ†è¾¨ç‡æ˜¯960x540,æ˜¾ç¤ºçš„ç”»é¢åˆ™åªä¼šæ˜¾ç¤ºä¸­é—´çš„540x540çš„ç”»é¢,è¿™ä¸ªæ—¶å€™å¦‚æœmovieWriterçš„sizeè®¾ç½®ä¸º540x540,åˆ™æœ€åä¿å­˜çš„è§†é¢‘æ˜¯å¤±çœŸçš„å› ä¸º960è¢«å‹åˆ°äº†540ï¼Œæ•´ä¸ªç”»é¢å˜æ‰äº†ã€‚è¿™ä¸ªæ—¶å€™æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆ 1.ä½¿ç”¨GPUImageCropFilter,é€šè¿‡è®¾ç½®å…¶cropRegionæ¥è£å‡ºä¸­é—´540x540éƒ¨åˆ†ã€‚å…³äºcropRegionè¦æ³¨æ„å®ƒæ˜¯ä¸€ä¸ªCGRect,å®ƒå¯¹åæ ‡ç³»åšäº†ä¸€ä¸ªå½’ä¸€åŒ–å¤„ç†,æ‰€ä»¥è®©æ‰€æœ‰çš„å–å€¼éƒ½åœ¨0.0~1.0èŒƒå›´å†…,æ¯”å¦‚960x540è£å‰ªè‡³ä¸­é—´540x540éƒ¨åˆ†åˆ™cropRegionä¸º(0,((960-540)/2)/960,1,540/960) 2.æ”¹å˜videoCompositionçš„perferTransfomä½¿å…¶åªæ˜¾ç¤ºä¸­é—´çš„540x540ã€‚è¿™æ ·å°±å®Œæˆäº†æ‰€è§å³æ‰€å¾—ã€‚ å…³äºGPUImageçš„å®æ—¶æ»¤é•œæ·»åŠ æˆ–ç»™å·²å­˜åœ¨çš„è§†é¢‘æ·»åŠ æ»¤é•œ,Demoéƒ½ç»™å‡ºäº†è¯¦ç»†è¿‡ç¨‹,ä¾è‘«èŠ¦ç”»ç“¢å³å¯ã€‚æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯,åœ¨ä¸€äº›æ“ä½œå®Œæˆçš„æ—¶å€™æ³¨æ„removeTarget,è¿˜æœ‰å°±æ˜¯åœ¨ä½¿ç”¨movieFileæ¥æ’­æ”¾å·²å­˜åœ¨è§†é¢‘å¹¶æ·»åŠ æ»¤é•œçš„æ—¶å€™æ˜¯æ²¡æœ‰å£°éŸ³çš„,è¿™æ˜¯è¿™ä¸ªåº“çš„ä¸€ä¸ªç¼ºé™·,Githubä¸Šæœ‰äººæäº†è¿™ä¸ªissueå’Œä¸€äº›è§£å†³åŠæ³•ã€‚åŒæ—¶åœ¨ç”¨movieFileå¤„ç†è§†é¢‘çš„æ—¶å€™åœ¨åˆ‡æ¢æ»¤é•œçš„æ—¶å€™æœ€å¥½å…ˆcancelProcessingä¸ç„¶ä¼šæœ‰é»‘å±æˆ–å¡é¡¿ç°è±¡å‡ºç°ã€‚åŒæ ·å¦‚æœä½ æ˜¯ç”¨è€ç‰ˆæœ¬çš„GPUImageçš„æ—¶å€™,å¯èƒ½ä¼šé‡åˆ°ç¬¬ä¸€å¸§æ˜¯çº¢è‰²çš„ç°è±¡,æœ‰äººæå‡ºè¿™ä¸ªissueå,ä½œè€…ä¿®å¤äº†è¿™ä¸ªbug,åˆ‡æ¢åˆ°æœ€æ–°ç‰ˆçš„æ—¶å€™å°±ä¸ä¼šæœ‰è¿™ç§æƒ…å†µå‘ç”Ÿã€‚å‘ç”Ÿè¿™ç§æƒ…å†µçš„åŸå› æ˜¯è§†é¢‘æ‰å¸§,å¯¼è‡´éŸ³é¢‘å’Œè§†é¢‘ä¸åŒæ­¥ã€‚ æ€»ç»“AVFoundationè¿˜æ˜¯æœ‰å¾ˆå¤šä¸œè¥¿å»åšæ·±å±‚æ¬¡çš„æŒ–æ˜,GPUImageä¹Ÿæ˜¯ä¸€æ ·,æœ‰äº†è¿™ä¸ªå¼ºå¤§çš„åº“,è§£å†³ä¸€äº›äº‹æƒ…èŠ‚çœäº†å¤§é‡æ—¶é—´ã€‚è¿™æ¬¡ä»…ä»…æ˜¯ä¸€ä¸ªå°å°çš„å°è¯•,å¯¹äºå¾ˆå¤šä¸œè¥¿éƒ½æ˜¯æµ…å°åˆ™æ­¢,æ–‡ä¸­éš¾å…ä¼šæœ‰é”™è¯¯,æ¬¢è¿åœ¨è¯„è®ºä¸­æŒ‡æ­£ã€‚å¦‚æœä½ åœ¨ä½¿ç”¨GPUImageå’ŒAVFoundationæœ‰ä»€ä¹ˆå¥½çš„å¿ƒå¾—æˆ–è€…å¯¹ä¸€äº›é—®é¢˜æœ‰ç›¸åº”çš„è§£å†³æ–¹æ¡ˆ,ä¸å¦¨åœ¨è¯„è®ºä¸­åˆ†äº«ä¸€ä¸‹ã€‚]]></content>
      <categories>
        <category>æ¡†æ¶å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>åŸåˆ›</tag>
        <tag>AVFoundation</tag>
        <tag>GPUImage</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é«˜æ•ˆåˆ©ç”¨ä½ çš„Xcode[è¯‘]]]></title>
    <url>%2F2014%2F07%2F23%2FUsing-Xcode-Efficiently%2F</url>
    <content type="text"><![CDATA[å¥½è±åç”µå½±é‡Œç»å¸¸çœ‹åˆ°é»‘å®¢ä»¬æ‰‹æŒ‡åœ¨é”®ç›˜ä¸Šé£é€Ÿè·³è·ƒ,åŒæ—¶ç»ˆç«¯ä¸Šçš„ä»£ç ä¹Ÿéšç€é£èˆã€‚å¦‚æœä½ ä¹Ÿæƒ³åƒç”µå½±é‡Œé‚£æ ·,é‚£ä¹ˆä½ æ¥å¯¹åœ°æ–¹äº†ã€‚è¿™ç¯‡æ•™ç¨‹å°†ä¼šæ•™ä½ åœ¨Xcodeç¼–ç¨‹ä¸­æ›´åƒç¨‹åºå‘˜,ä½ å¯ä»¥ç§°ä¹‹ä¸ºé­”æ³•ã€ç–¯ç‹‚çš„æŠ€æœ¯ã€å¥½è¿å½“å¤´æˆ–è€…é»‘å®¢ã€‚æ¯«æ— ç–‘é—®,åœ¨å­¦ä¹ å®Œæœ¬æ•™ç¨‹ä¹‹å,ä¸ç®¡ä½ æ€ä¹ˆè®¤ä¸º,éƒ½ä¼šæ„Ÿè§‰å¾ˆé…·,åŒæ—¶èƒ½æ›´é«˜æ•ˆåœ°è¿ç”¨Xcode,ç”šè‡³å¯ä»¥é€šè¿‡è¿™äº›æ–°å‘ç°ä½¿ä½ çš„ä»£ç å…äºæ¯ç­ã€‚ åŸæ–‡åœ°å€ å¼€å§‹è¦çœ‹èµ·æ¥å¾ˆé…·,æ‰€ä»¥æœ‰ä¸€äº›å¿…ä¸å¯å°‘çš„å› ç´ .ä¸‹é¢åˆ—å‡ºæ¥çš„æ˜¯å…¶ä¸­ä¸€éƒ¨åˆ† å¿«é€Ÿæ‰§è¡Œä»»åŠ¡ ç²¾å‡† ç®€æ´ç¾è§‚çš„ä»£ç  è¦è¡¨ç°åœ°æ›´é…·,ä½ å¯ä»¥è¯•ç€ä¸ç”¨é¼ æ ‡æˆ–è€…è§¦æ‘¸æ¿æ¥å®Œæˆæ•™ç¨‹ä¸­çš„æ¯ä¸€ä¸ªä»»åŠ¡.å­¦ä¹ ä¹‹æ—…å°†ä»å­¦ä¹ ä¸€äº›å®ç”¨çš„XcodeåŠŸèƒ½å¼€å§‹,ç„¶åé€šè¿‡ä¿®å¤ä¸€äº›åœ¨CardTiltä¸­çš„ä¸€äº›bugæ¥è®­ç»ƒã€‚æœ€åä½ å°†æ•´ç†ä¸€ä¸‹ä½ çš„ä»£ç ,ä½¿æ•´ä¸ªç•Œé¢çœ‹èµ·æ¥æ›´æ•´æ´ã€‚åœ¨å­¦ä¹ è¯¥æ•™ç¨‹æ—¶,è¦è®°ä½:å®ƒä¸æ˜¯æ•™ä½ åšä¸€ä¸ªapp,è€Œæ˜¯æ•™ä½ æ¯”ä»¥å‰æ›´æœ‰æ•ˆåœ°åˆ©ç”¨Xcodeæ¥å¼€å‘appã€‚è¿™ç¯‡æ•™ç¨‹å»ºç«‹åœ¨ä½ å¯¹Xcodeæœ‰ä¸€ä¸ªåŸºæœ¬çš„äº†è§£çš„åŸºç¡€ä¸Š,ç„¶åç€é‡äºæé«˜ä½ çš„å·¥ä½œæ•ˆç‡ã€‚æ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„ç¼–ç¨‹ä¹ æƒ¯,æœ¬æ•™ç¨‹å¹¶éå¼ºåˆ¶ä½ å½¢æˆæŸç§é£æ ¼ã€‚è‡ªå§‹è‡³ç»ˆ,æœ¬æ•™ç¨‹ä¸­ä½ ä¼šçœ‹åˆ°æŸäº›å‘½ä»¤çš„æ›¿ä»£å“,éšç€æœ¬æ•™ç¨‹çš„å­¦ä¹ ,è¯·é›†ä¸­ç²¾åŠ›åœ¨æç‚¼å’Œå½¢æˆä½ è‡ªå·±çš„ç¼–ç¨‹é£æ ¼,ä¸è¦è®©å¾®å°çš„é”™è¯¯å½±å“ä½ ã€‚ å¦‚æœä½ å¯¹äºXcodeä¸æ˜¯å¾ˆç†Ÿæ‚‰,å»ºè®®å…ˆå­¦ä¹ ä¸‹é¢ä¸¤ç¯‡æ•™ç¨‹ã€‚(æ•™ç¨‹1å’Œæ•™ç¨‹2) ä¸‹è½½ CardTilt-starter,ç„¶åå°±å¯ä»¥æ„‰å¿«åœ°å†™ä»£ç äº†ã€‚ æ—¥å¸¸Xcodeä»»åŠ¡æœ‰ä¸€äº›åœ¨Xcodeä¸­ä½ ç»å¸¸ä½¿ç”¨çš„æŠ€å·§,è¿™ä¸€éƒ¨åˆ†è®©ä½ æ›´è¿‘è·ç¦»çš„æ¥è§¦è¿™äº›æŠ€å·§,ç„¶åè®²è§£ä¸€äº›æ½‡æ´’åº”å¯¹å®ƒä»¬çš„ä¸€äº›å¦™æ‹›ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­,ä½ ä¼šåœ¨è¿™äº›å¦™æ‹›çš„åŸºç¡€ä¸Šå‘ç°ä½¿ç”¨å®ƒä»¬çš„æ–°æ–¹æ³•ã€‚è¿™äº›æŠ€å·§å°†æˆä¸ºä½ ç¼–ç¨‹å·¥å…·è…°å¸¦ä¸Šçš„å¿è€…ä¹‹æ˜Ÿã€‚åœ¨Xcodeä¸­æ‰“å¼€ä¹‹å‰ä¸‹è½½å¥½çš„å·¥ç¨‹CardTilt,å…ˆä¸è¦æ€¥ç€å»çœ‹ä»£ç ,å…ˆå°†ä½ Xcodeçš„çª—å£å’Œä¸‹å›¾æ¥ä¸€ä¸€å¯¹åº”ã€‚ æ˜¯ä¸æ˜¯å‘ç°ä½ çš„çª—å£å’Œå›¾ä¸­å¹¶ä¸å¯¹åº”,å…ˆåˆ«ç€æ€¥ã€‚åœ¨ä¸‹é¢ä»‹ç»çš„å¿«æ·é”®éƒ¨åˆ†,ä½ å°†ä¼šå­¦åˆ°å¦‚ä½•è½»æ¾åœ°æ˜¾ç¤ºä»¥åŠéšè—è¿™äº›å¯¹åº”çš„çª—å£ã€‚ ä¸‹é¢æ˜¯ç»„æˆçª—å£çš„æ¯ä¸€ä¸ªç‹¬ç«‹åŒºåŸŸçš„å¿«é€Ÿæµè§ˆ: The Toolbar(å·¥å…·æ ): ä½ é€‰æ‹©è§†å›¾,è¿è¡Œapp,åœ¨ä¸åŒå¸ƒå±€ç•Œé¢åˆ‡æ¢çš„åœ°æ–¹ The Navigation Area(å¯¼èˆªåŒº): å¯¼èˆªä½ æ•´ä¸ªå·¥ç¨‹,è­¦å‘Š,æŠ¥é”™ç­‰çš„åœ°æ–¹ The Editing Area(ç¼–è¾‘åŒº): æ‰€æœ‰å¥‡è¿¹è¯ç”Ÿçš„åœ°æ–¹,åŒ…æ‹¬å®ƒä¸Šæ–¹çš„Jump bar The Utility Area(å·¥å…·åŒº): åŒ…å«æ£€æµ‹å™¨å’Œä¸€äº›åº“ The Debugging Area(è°ƒè¯•åŒº): åŒ…æ‹¬è°ƒè¯•çª—å£å’Œå˜é‡æ£€æµ‹å™¨ ä¸Šé¢åˆ—å‡ºçš„æ‰€æœ‰è§†å›¾åŒºåŸŸéƒ½æ˜¯Xcodeçš„å¿…è¦ç»„æˆéƒ¨åˆ†,å®ƒä»¬ä¹Ÿæ˜¯åœ¨ä½ å¼€å‘è¿‡ç¨‹ä¸­å¯èƒ½éœ€è¦ç”¨åˆ°çš„,å¼€å‘è¿‡ç¨‹ä¸­é€šå¸¸ä¸éœ€è¦å°†ä»–ä»¬ä¸€æ¬¡æ€§åŒæ—¶æ˜¾ç¤ºå‡ºæ¥,ä¸‹é¢å°†ä»‹ç»ä¸€äº›å¿«æ·é”®,å°†ä¼šæ•™ä½ å¿«é€Ÿæ˜¾ç¤º/éšè—è¿™äº›è§†å›¾åŒºåŸŸã€‚ å¿«æ·é”®åœ¨è¿™ä¸€éƒ¨åˆ†,ä½ å°†é¦–å…ˆå­¦åˆ°æ€ä¹ˆæŒæ¡è¿™äº›å¿«æ·é”®,å¾—ç›Šäºä¸€äº›æ¨¡å¼,æœ€æœ‰æ•ˆçš„å¿«æ·é”®éå¸¸å®¹æ˜“è®°ã€‚ ç¬¬ä¸€ä¸ªéœ€è¦çŸ¥é“çš„æ˜¯Xcodeçš„å„åŒºåŸŸä¸ä¿®é¥°é”®çš„å…³ç³»,ä¸‹é¢æ˜¯ä¸€ä¸ªå¿«é€Ÿæµè§ˆ Command (âŒ˜):ç”¨æ¥å¯¼èˆª,æ§åˆ¶å¯¼èˆªåŒºåŸŸ Alt (â‡): æ§åˆ¶å³è¾¹çš„ä¸€äº›ä¸œè¥¿,æ¯”å¦‚Assistant Editor,utility editor Control: ç¼–è¾‘åŒºåŸŸä¸Šçš„Jump barçš„ä¸€äº›äº¤äº’ ç¬¬äºŒä¸ªéœ€è¦çŸ¥é“çš„æ—¶æ•°å­—é”®å’Œæ ‡ç­¾æ çš„å…³ç³»,å°†æ•°å­—é”®å’Œä¸Šé¢æåˆ°çš„ä¿®é¥°é”®ç»„åˆå¯ä»¥åœ¨æ ‡ç­¾é¡µä¹‹é—´æ¥å›åˆ‡æ¢ã€‚é€šå¸¸æ•°å­—é”®å¯¹åº”æ ‡ç­¾é¡µçš„ç´¢å¼•ä½ç½®(ä»1å¼€å§‹),0é€šå¸¸ç”¨æ¥æ˜¾ç¤º/éšè—åŒºåŸŸã€‚å®ƒè¿˜èƒ½å†ç›´è§‚ä¸€ç‚¹å—? ä¸‹é¢æ˜¯æœ€å¸¸ç”¨çš„ç»„åˆé”®: Command 1~ 8: è·³è½¬åˆ°å¯¼èˆªåŒºçš„ä¸åŒä½ç½® Command 0 :æ˜¾ç¤º/éšè—å¯¼èˆªåŒº Command Alt 1~ 6:åœ¨ä¸åŒæ£€æµ‹å™¨ä¹‹é—´è·³è½¬ Command Alt 0: æ˜¾ç¤º/å…³é—­å·¥å…·åŒº. Control Command Alt 1~4: åœ¨ä¸åŒåº“ä¹‹é—´è·³è½¬ Control 1~ 6: åœ¨Jump barçš„ä¸åŒæ ‡ç­¾é¡µçš„è·³è½¬ã€‚ æœ€åä¹Ÿæ˜¯æœ€ç®€å•çš„å°±æ˜¯å›è½¦é”®,å½“å®ƒå’ŒCommandç»„åˆä½¿ç”¨æ—¶,å¯ä»¥æ˜¯ä½ åœ¨Xcodeä¸­ä¸åŒç¼–è¾‘å™¨æ¥å›åˆ‡æ¢. Command + Enter: æ˜¾ç¤ºæ ‡å‡†å•çª—å£ç¼–è¾‘å™¨ Command Alt Enter:ä½ å¯ä»¥çŒœä¸‹å®ƒçš„ä½œç”¨,å®ƒçš„åŠŸèƒ½æ˜¯æ‰“å¼€Assistant editor Command Alt Shift Enter: æ‰“å¼€ç‰ˆæœ¬æ§åˆ¶ç¼–è¾‘å™¨ åŒæ ·é‡è¦çš„æ˜¯æ˜¾ç¤º/éšè—è°ƒè¯•åŒºçš„å¿«æ·é”®æ˜¯ Command + Shift + Y,è¦è®°ä½è¿™ä¸ªä½ å¯ä»¥é€šè¿‡è¿™å¥è¯æ¥è®°å¿†â€œY is my code not working?â€(è¯‘è€…æ³¨:Yè°éŸ³Why)ã€‚å¦‚æœä½ å¿˜è®°äº†ä¸€äº›å¿«æ·é”®,ä½ å¯ä»¥åœ¨Xcodeçš„èœå•æ Navigateä¸€é¡¹ä¸­æ‰¾åˆ°å¤§éƒ¨åˆ†å¿«æ·é”®ã€‚åœ¨å³å°†å®Œæˆè¿™ä¸€éƒ¨åˆ†çš„å­¦ä¹ ä¹‹æ—¶,ä½ ä¼šæƒŠå¥‡çš„å‘ç°ä½ ä»…ä»…åªæ˜¯ç”¨äº†é”®ç›˜å°±è®©Xcodeå‘ç”Ÿè¿™å„ç§å˜æ¢ã€‚ Xcodeçš„è¡Œä¸ºä½¿ç”¨å¿«æ·é”®æ¥ç®¡ç†Xcodeçš„ç•Œé¢å´æ˜¯æŒºæ£’,æœ‰æ²¡æœ‰æƒ³è¿‡æ›´æ£’çš„äº‹æƒ…?æ¯”å¦‚è®©Xcodeè‡ªåŠ¨è½¬æ¢åˆ°ä½ æƒ³çœ‹åˆ°çš„ç•Œé¢ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†å­¦åˆ°æ›´é…·çš„ä¸œè¥¿ã€‚ å¹¸è¿çš„æ˜¯,Xcodeæä¾›çš„Behaviors(è¡Œä¸º)å¯ä»¥è®©ä½ è½»æ˜“åœ°å®ç°ä¸Šé¢çš„äº‹æƒ…ã€‚å®ƒä»¬æ˜¯ä¸€ç»„å®šä¹‰å¥½çš„æœ‰æŒ‡å®šäº‹ä»¶è§¦å‘çš„åŠ¨ä½œ,æ¯”å¦‚buildä¸€ä¸ªå·¥ç¨‹ã€‚è¿™é‡Œçš„åŠ¨ä½œçš„èŒƒå›´ä»æ”¹å˜ç•Œé¢åˆ°è¿è¡Œä¸€ä¸ªè‡ªå®šä¹‰è„šæœ¬æ–‡ä»¶ã€‚æ¥çœ‹ä¸€ä¸ªä¾‹å­,å¿«é€Ÿä¿®æ”¹ä¸‹è½½å¥½çš„å·¥ç¨‹çš„CTAppDelegate.mæ–‡ä»¶,ä½¿å…¶è¿è¡Œæ—¶ä¼šç”Ÿæˆè°ƒè¯•çª—å£è¾“å‡º,ç”¨ä¸‹é¢çš„æ–¹æ³•æ›¿ä»£didFinishLaunchingWithOptionsæ–¹æ³• 1234567- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions&#123; [[UIApplication sharedApplication] setStatusBarHidden:YES]; // Override point for customization after application launch. NSLog(@&quot;Show me some output!&quot;); return YES;&#125; è¿è¡Œç¨‹åº,ç„¶åä»”ç»†è§‚å¯Ÿè°ƒè¯•åŒº,ä½ ä¼šå‘ç°è°ƒè¯•åŒºéšç€appè¿è¡Œè€Œå‡ºç°,å¦‚ä¸‹æ‰€ç¤º æ¥çœ‹çœ‹æ˜¯ä»€ä¹ˆå®šä¹‰äº†ä¸Šé¢çš„äº‹ä»¶,åœ¨Xcode-&gt;Behaviors-&gt;Edit Behaviorsæ‰“å¼€Behavioråå¥½è®¾ç½®,åœ¨å·¦ä¾§ä½ å°†çœ‹åˆ°æ‰€æœ‰äº‹ä»¶é›†åˆ,åœ¨å³è¾¹æ˜¯è¯¥äº‹ä»¶å¯ä»¥è§¦å‘çš„ä¸€äº›åˆ—åŠ¨ä½œã€‚ç‚¹å‡»Runningæ ä¸‹çš„Generates output,ç„¶åå‘ç°å®ƒè¢«è®¾ç½®æˆç”¨æ¥æ˜¾ç¤ºè°ƒè¯•åŒºã€‚ ä¸€äº›æ¨èçš„è¡Œä¸ºæ ¹æ®ä½ çš„å¼€å‘ç¯å¢ƒ,æˆ‘æ¨èçš„ä¸¤ç§ä¸åŒçš„Generates outputäº‹ä»¶è§¦å‘åŠ¨ä½œé›†ã€‚å¦‚æœä½ æœ‰å¤šä¸ªå±å¹•,è¯•ç€ä½¿ç”¨ç¬¬ä¸€ç§,å¦‚æœæ˜¯å•æ˜¾ç¤ºå™¨,è¯•ç€è°ƒåˆ°ç¬¬äºŒç§æ–¹æ³•ã€‚ æ–¹æ³•ä¸€å¦‚æœä½ åœ¨ä¸¤ä¸ªæˆ–è€…å¤šä¸ªå±å¹•ä¸Šå¼€å‘,æŠŠè°ƒè¯•åŒºæ”¾åˆ°ç¬¬äºŒå±å¹•æ˜¯ä¸æ˜¯æ›´åŠ æ–¹ä¾¿,ä½ å¯ä»¥å‘ä¸‹é¢è¿™æ ·è®¾ç½® ç°åœ¨,è¿è¡Œç¨‹åº,ç„¶åä½ ä¼šçœ‹åˆ°ä¸€ä¸ªåˆ†ç¦»çš„çª—å£å‡ºç°,å°†å®ƒæ”¾åˆ°ä½ çš„ç¬¬äºŒå±å¹•ä¸Š,æ˜¯ä¸æ˜¯æ•ˆç‡é«˜äº†ä¸å°‘? æ–¹æ³•äºŒå¦‚æœæ˜¯å•å±,é€šè¿‡éšè—å·¥å…·æ¿ä»¥åŠè®¾ç½®è¾“å‡ºçª—å£å æ®æ•´ä¸ªè°ƒè¯•åŒºä½¿è¾“å‡ºçª—å£çš„æœ‰æ•ˆåŒºåŸŸæœ€å¤§åŒ–,è®¾ç½®å¦‚ä¸‹ ç„¶åè¿è¡Œç¨‹åº,ç„¶åè§‚å¯ŸXcode,çœ‹å®ƒæ˜¯ä¸æ˜¯æŒ‰ç…§ä½ çš„å‘½ä»¤åœ¨æ‰§è¡Œã€‚ å½“ç¨‹åºæš‚åœçš„æ—¶å€™,ä½ å¯èƒ½ä¹Ÿæƒ³æ”¹å˜Xcodeçš„è¡Œä¸º,åˆ°Runningæ ä¸‹çš„Pausesäº‹ä»¶,ç„¶åæ”¹å˜å…¶è®¾ç½®,å‘ä¸‹é¢è¿™æ ·: ç°åœ¨æ— è®ºä½•æ—¶ä½ è®¾ç½®äº†æ–­ç‚¹,ä½ å°†ä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„åä¸ºfixçš„å±•ç¤ºå˜é‡å’Œè¾“å‡ºçª—å£çš„æ ‡ç­¾é¡µ,ç„¶åè‡ªåŠ¨å¯¼èˆªåˆ°ç¬¬ä¸€ä¸ªissueã€‚ ä½ å°†è¦åˆ›å»ºçš„æœ€åä¸€ä¸ªè¡Œä¸ºæ˜¯æˆ‘ä¸ªäººæœ€å–œæ¬¢çš„ä¸€ä¸ª,å®ƒæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰è¡Œä¸ºâ€”è®¾ç½®ä¸€ä¸ªå¿«æ·é”®ã€‚å½“è¢«è§¦å‘çš„æ—¶å€™,å®ƒä½¿Xcodeè½¬å˜åˆ°æˆ‘æŒ‡å®šçš„ä¸ºä¸‹ä¸€æ¬¡å¼€å‘è€Œä¼˜åŒ–çš„å¸ƒå±€,åä¸ºDev Modeã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç‚¹å‡»Behavioråå¥½è®¾ç½®çš„å·¦ä¸‹è§’çš„+,ç„¶åå°†å…¶å–åä¸ºDev Mode,åŒå‡»Dev Modeå³è¾¹çš„Command (âŒ˜)ç¬¦å·ç„¶åè¾“å…¥Command .æ¥å®šä¹‰ä¸€ä¸ªå¿«æ·é”® æ¥ä¸‹æ¥ä¸ºè¯¥äº‹ä»¶è®¾ç½®ç›¸åº”åŠ¨ä½œ: ç°åœ¨,åªè¦ä½ æŒ‰ä¸‹command .å°±ä¼šè§¦å‘ä¸Šé¢è®¾ç½®çš„åŠ¨ä½œ,å³å‡ºç°ä¸€ä¸ªç›¸åŒçš„æ•´æ´çš„å¼€å‘ç•Œé¢ã€‚ ä¸‹é¢å°†ä»‹ç»Xcode tab name,å’Œè¡Œä¸ºé…åˆèµ·æ¥ä½¿ç”¨å ªç§°å®Œç¾ã€‚ Xcode Tab Names(Xcodeæ ‡ç­¾å):å¯ä»¥é€šè¿‡åŒå‡»æ ‡ç­¾é¡µçš„æ ‡é¢˜æ¥ä¿®æ”¹æ ‡ç­¾é¡µçš„åç§°,å¯¹äºå®ƒæœ¬èº«æ¥è¯´æ˜¯ä¸€ä¸ªæ— ç”¨çš„åŠŸèƒ½,ä½†æ˜¯å½“å®ƒå’Œè¡Œä¸ºç»“åˆèµ·æ¥ä½¿ç”¨æ—¶å°±å˜å¾—éå¸¸å¼ºå¤§äº†ã€‚åœ¨ä¸Šé¢çš„ç¬¬äºŒä¸ªä¾‹å­ä¸­,å½“æ”¹å˜Pausesè¡Œä¸ºæ—¶,å‘½åäº†ä¸€ä¸ªå«fixçš„æ ‡ç­¾é¡µ,è¿™å°±æ„å‘³ç€å½“è¡Œä¸ºè¢«è§¦å‘æ—¶,Xcodeå°†ä¼šä½¿ç”¨fixæ ‡ç­¾é¡µ(å¦‚æœå­˜åœ¨),å¦‚æœä¸å­˜åœ¨,å®ƒä¼šæ–°å»ºä¸€ä¸ªåä¸ºfixçš„æ ‡ç­¾é¡µã€‚å¦ä¸€ä¸ªä¾‹å­å°±æ˜¯å¤šå±Startsè¡Œä¸º,å¦‚æœä¸€ä¸ªåä¸ºDebugçš„æ ‡ç­¾é¡µåœ¨ä¹‹å‰è¿è¡Œæ—¶è¢«æ‰“å¼€,å®ƒå°†ä¼šå¤ç”¨è¿™ä¸ªæ ‡ç­¾é¡µè€Œä¸æ˜¯é‡æ–°åˆ›å»ºä¸€ä¸ªã€‚ç”¨è¿™ç§æ–¹å¼,ä½ å¯ä»¥åˆ›å»ºéå¸¸æœ‰è¶£çš„è¡Œä¸ºã€‚ åˆ°ç°åœ¨ä¸ºæ­¢,æˆ‘ä»¬å¯ä»¥èŠ±ç‚¹æ—¶é—´æ¥å›é¡¾ä¸€ä¸‹åˆšæ‰çš„è¡Œä¸º,ä¸è¦ç€æ€¥,æœ¬æ•™ç¨‹ä¼šç­‰ç€ä½ ã€‚ å°æµ‹éªŒåœ¨æ¥ä¸‹æ¥çš„éƒ¨åˆ†,ä½ å°†åœ¨æµ‹éªŒä¸­ç”¨åˆ°ä¸Šé¢æ‰€å­¦åˆ°çš„æŠ€å·§,ç„¶ååœ¨CardTilté¡¹ç›®ä¸­å­¦åˆ°ä¸€äº›æ–°çš„æŠ€å·§ã€‚ è¿è¡ŒCardTilté¡¹ç›®ä¸­ï¼Œä½ çœ‹åˆ°å¦‚ä¸‹ç”»é¢ å®ƒä¸æ˜¯ä½ æœŸå¾…çœ‹åˆ°çš„ç”»é¢ï¼Ÿæ˜¯æ—¶å€™æ¶ˆç­è¿™äº›bugäº†ï¼ é”å®šbugappä¼¼ä¹åœ¨åŠ è½½æ•°æ®æ—¶å‡ºç°äº†é—®é¢˜ï¼Œä½ çš„ä»»åŠ¡å°±æ˜¯æ¶ˆç­å®ƒä»¬ã€‚æ‰“å¼€CTMainViewController.mæ–‡ä»¶ç„¶åè¿›å…¥å¼€å‘æ¨¡å¼Dev Modeï¼Œå¿«æ·é”®ä¸ºä¹‹å‰è®¾ç½®çš„commandã€‚æ³¨æ„viewDidloadæ–¹æ³•ä¸­çš„å‰å‡ è¡Œ 123self.dataSource = [[CTTableViewDataSource alloc] init];self.view.dataSource = self.dataSource;self.view.delegate = self; çœ‹èµ·æ¥CTTableViewDataSourceå®ç°äº†UITableViewDataSourceåè®®ï¼Œä¸ºtableviewæä¾›äº†æ•°æ®ã€‚æ˜¯æ—¶å€™å±•ç°ä½ Xcodeçš„æŠ€æœ¯äº†ï¼ŒæŒ‰ä½commandé”®ï¼ŒåŒæ—¶ç‚¹å‡»CTTableViewDataSourceåœ¨ç¼–è¾‘å™¨ä¸­æ¥æ‰“å¼€CTTableViewDataSource.hã€‚CTTableViewDataSource.måº”è¯¥å·²ç»åœ¨ä½ çš„Assistant Editorï¼Œå¦‚æœä¸æ˜¯è¿™æ ·çš„è¯ï¼Œæ‰“å¼€é¡¶éƒ¨çš„Jump Barï¼Œåƒä¸‹å›¾ä¸€ä¸€æ ·åˆ‡æ¢åˆ°Assistant Editorçš„counterpartsæ¨¡å¼ã€‚ ç¿»çœ‹ä»£ç ï¼Œä½ ä¼šå‘ç°æ•°ç»„membersè£…è½½æ•°æ®ï¼ŒloadDataæ–¹æ³•ä»bundleä¸­åŠ è½½æ•°æ®è‡³æ•°ç»„membersã€‚åœ¨assistant editorå³è¾¹ä»»æ„ä½ç½®é¼ æ ‡å³å‡»ï¼Œé€‰æ‹©Open in Primary Editorï¼Œå°±ä¼šåœ¨Primary Editorä¸­æ‰“å¼€CTTableViewDataSource.mæ–‡ä»¶ï¼Œä¸‹é¢åŠ¨ç”»æ˜¯è¯¥æ­¥éª¤çš„å±•ç¤ºï¼š ä¸ºäº†çœ‹èµ·æ¥æ›´é…·ç‚«ï¼Œä½ å¯ä»¥åœ¨ä¸ç”¨é¼ æ ‡çš„æƒ…å†µä¸‹å®Œæˆä¸Šé¢çš„æ‰€æœ‰äº‹æƒ…ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š 1.åŒæ—¶æŒ‰ä½Command + Shift + Oï¼Œåœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥CTMainViewController.mï¼Œç„¶åå›è½¦æ¥æ‰“å¼€è¯¥æ–‡ä»¶ã€‚ 2.Command + . è¿›å…¥Enter Devæ¨¡å¼ ã€‚ 3.å°†é¼ æ ‡æ”¾åœ¨ CTTableViewDataSource ä¸Šï¼Œç„¶åæŒ‰ä½Command + Control + Jï¼Œè·³è½¬è‡³CTTableViewDataSourceå®šä¹‰å¤„ã€‚ 4.æŒ‰ä½ Command + J, -&gt; ç„¶åæŒ‰ä¸‹å›è½¦ï¼Œæ¥è½¬æ¢ assistant editor çš„ç„¦ç‚¹ 5.æŒ‰ä½ ctrl +4 æ¥ä¸‹æ‹‰ Jump Barï¼Œç„¶åä½¿ç”¨æ–¹å‘é”®å’Œå›è½¦é”®æ¥é€‰æ‹© counterparts 6.æŒ‰ä½ Command + Altï¼Œåœ¨ primary editor ä¸­æ‰“å¼€ CTTableViewDataSource.m æ–‡ä»¶ 7.ä¸Šé¢çš„ç»“æœæ­¥éª¤çœ‹èµ·æ¥ä¸å‘¢ä¹ˆé«˜æ•ˆï¼Œä½†æ˜¯å®ƒè®©ä½ çœ‹èµ·æ¥å¾ˆé…·ã€‚ ä¿®å¤bugåœ¨self.members = json[@â€Teamâ€];æ‰“ä¸Šæ–­ç‚¹æ¥ç¡®å®šæ•°æ®æ˜¯å¦éƒ½è¢«è£…è½½åˆ°æ•°ç»„memberså½“ä¸­ï¼Œç„¶åè¿è¡Œç¨‹åºã€‚ å¦‚æœå¯¹äºåŸºæœ¬çš„è®¾ç½®æ–­ç‚¹å’Œè°ƒè¯•ä¸å¤ªç†Ÿæ‚‰ï¼Œå¯ä»¥å…ˆçœ‹çœ‹è¿™ç¯‡æ•™ç¨‹ã€‚ å°±åƒä½ ä¹‹å‰åœ¨Xcodeè¡Œä¸ºçœ‹åˆ°çš„ä¸€æ ·ï¼ŒGenerates outputå°†é¦–å…ˆè¢«è§¦å‘ï¼Œç´§æ¥ç€Pauseè¡Œä¸ºè¢«è§¦å‘ã€‚å› ä¸ºä½ ä¹‹å‰åœ¨Pauseæœ‰è¿‡è‡ªå®šä¹‰è®¾ç½®ï¼Œæ‰€ä»¥Xcodeä¼šæ–°å»ºä¸€ä¸ªåä¸ºfixçš„æ ‡ç­¾é¡µï¼Œå®ƒä¸“ä¸ºè°ƒè¯•è€Œè®¾ã€‚ å°†ç›®å…‰åˆ‡æ¢åˆ°å˜é‡æ£€æµ‹å™¨variable inspectorï¼Œä½ ä¼šå‘ç°æ•°ç»„membersæ˜¯nilï¼Œåœ¨loadDataæ–¹æ³•æ•°ç»„membersè¢«å¡«å……ï¼Œä»£ç å¦‚ä¸‹ 12NSDictionary *json = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&amp;error];self.members = json[@&quot;Team&quot;]; åœ¨å˜é‡æ£€æµ‹å™¨ä¸­æŸ¥çœ‹jsonï¼Œçœ‹å…¶æ˜¯å¦è¢«æ­£ç¡®åŠ è½½ï¼Œä½ ä¼šå‘ç°æ•°æ®ä¸­çš„ç¬¬ä¸€ä¸ªå€¼æ˜¯@â€RWTeamâ€è€Œä¸æ˜¯@â€Teamâ€ï¼Œå½“åŠ è½½æ•°ç»„membersæ—¶ï¼Œè¿™ä¸ªå€¼æ˜¯é”™çš„ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªbugã€‚ è®©æˆ‘ä»¬æŒ‰ä¸‹é¢æ­¥éª¤æ¥ä¿®å¤è¿™ä¸ªbugï¼š ä½¿ç”¨command + .æ¥è¿›å…¥å¼€å‘æ¨¡å¼ æŒ‰ä½Command + Option + Jè·³è‡³filter barç„¶åè¾“å…¥teammember ç„¶åæŒ‰ä½AltåŒæ—¶ç‚¹å‡»TeamMembers.jsonåœ¨assistant editoræ¥æ‰“å¼€å®ƒ æœ€åï¼Œä½¿ç”¨â€Teamâ€æ¥æ›¿æ¢â€RWTeamâ€ ä¸‹å›¾æ˜¯ä¸Šé¢å››æ­¥çš„ä¸€ä¸ªåŠ¨ç”» ç°åœ¨ç§»é™¤æ–­ç‚¹ï¼Œç„¶åè¿è¡Œç¨‹åºï¼Œå®ƒçœ‹èµ·æ¥åº”è¯¥åƒè¿™ä¸ªæ ·å­ã€‚ æ˜¯ä¸æ˜¯çœ‹èµ·æ¥æ¯”ä¹‹å‰è¦å¥½ä¸€ç‚¹äº†ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›bugï¼Œæ¯”å¦‚Rayå’ŒBriançš„æ ‡é¢˜æè¿°æ ä¸è§äº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ä¿®å¤è¿™äº›bugæ¥å­¦åˆ°æ›´å¤šé…·ç‚«çš„æŠ€å·§ã€‚ åŠ é€Ÿä½ åº”è¯¥å·²ç»çŸ¥é“UITableViewCellsåœ¨tableView:cellForRowAtIndexPath:æ–¹æ³•ä¸­è¢«åŠ è½½ï¼Œæ‰€ä»¥ç”¨Open Quicklyæ¥å¯¼èˆªåˆ°è¯¥æ–¹æ³•ï¼Œç„¶åæŒ‰ç…§ä¸‹é¢æ­¥éª¤ï¼š æŒ‰ä¸‹Command + Shift + Oæ¥å‘¼å‡ºOpen Quickly è¾“å…¥cellForRow æŒ‰ä¸‹å›è½¦æ¥æ‰“å¼€å®ƒ æŒ‰ä½commandç„¶åç‚¹å‡»setupWithDictionaryæ¥è·³è½¬è‡³å…¶å®šä¹‰å¤„ï¼Œç„¶åä½ ä¼šå‘ç°ä¸€äº›ç”¨æ¥åŠ è½½æè¿°çš„ä»£ç  12NSString *aboutText = dictionary[@&quot;about&quot;]; // Should this be aboot? self.aboutLabel.text = [aboutText stringByReplacingOccurrencesOfString:@&quot;\\n&quot; withString:@&quot;\n&quot;]; å®ƒä½¿ç”¨dictionary[@â€aboutâ€]ä¸­çš„æ•°æ®æ¥åŠ è½½labelã€‚ æ¥ä¸‹æ¥å‘¼å‡ºOpen Quicklyï¼Œç„¶åæ‰“å¼€TeamMembers.jsonï¼Œä½¿ç”¨alt + commandåœ¨Assistant Editorä¸­æ‰“å¼€ã€‚æ£€æŸ¥aboutçš„å€¼ï¼Œç„¶åä½ ä¼šå‘ç°æœ‰äººå°†aboutæ‹¼å†™æˆäº†abootï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¨å±€çš„Find and Replaceæ¥ä¿®å¤è¿™ä¸ªbugã€‚å½“ç„¶ä½ å¯ä»¥åœ¨æ–‡ä»¶ä¸­ç›´æ¥åšè¿™ä»¶äº‹ï¼Œä½†æ˜¯ä½¿ç”¨find navigateçœ‹èµ·æ¥æ›´é…·ã€‚æ‰“å¼€find navigateï¼Œç„¶åé€šè¿‡é¡¶éƒ¨çš„jump baråˆ‡æ¢åˆ°æ›¿æ¢(replace)æ¨¡å¼ï¼Œè¾“å…¥aboot,ç„¶åå›è½¦ã€‚ åœ¨TeamMembers.jsonæ–‡ä»¶ä¹‹å¤–è¿˜æœ‰ä¸€ä¸ªåœ°æ–¹ä½¿ç”¨åˆ°äº†abootï¼Œåˆ«æ‹…å¿ƒï¼Œé€‰ä¸­CTCardCell.mçš„æœç´¢ç»“æœï¼Œç„¶åæŒ‰ä¸‹Deleteï¼Œå°†é¼ æ ‡ç§»è‡³replace filedï¼Œç„¶åè¾“å…¥aboutï¼Œç‚¹å‡»Replace Allï¼Œä¸€åˆ‡å®Œæˆã€‚æ•´ä¸ªè¿‡ç¨‹çœ‹èµ·æ¥æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š è¿›é˜¶æŠ€å·§:ä½¿ç”¨ Command + Shift + Option + F æ¥æ‰“å¼€ Find navigator çš„æ›¿æ¢æ¨¡å¼ï¼Œå¦‚æœä½ å«Œéº»çƒ¦ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Command + Shift + F æ¥æ‰“å¼€ Find navigator çš„æŸ¥æ‰¾æ¨¡å¼ï¼Œå¦‚æœä½ è¿˜å«Œéº»çƒ¦ï¼Œä½¿ç”¨ command + 3 æ¥æ‰“å¼€ Find navigatorï¼Œç„¶åå¼€å¯æŸ¥æ‰¾æˆ–è€…æ›¿æ¢æ¨¡å¼ï¼Œé€‰æ‹©ä¸€ç§æœ€é€‚åˆè‡ªå·±çš„æ–¹å¼å°±å¥½ã€‚ è¿è¡Œç¨‹åºï¼Œçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ è®©è®¾è®¡å¸ˆé«˜å…´ä»Šå¤©çš„è°ƒè¯•ä»»åŠ¡åˆ°æ­¤å°±ç»“æŸäº†ï¼Œç»™è‡ªå·±ä¸€ç‚¹æŒå£°ï¼Œç„¶åå¼€å§‹è¿è¡Œç¨‹åºã€‚åœ¨ä½ å°†å®ƒå±•ç¤ºç»™åˆ«äººä¹‹å‰ï¼Œéœ€è¦å…ˆç¡®å®šappçš„ç•Œé¢æ˜¯å®Œç¾çš„ã€‚å°¤å…¶å½“è¿™ä¸ªäººæ˜¯éå¸¸è®¤çœŸçš„è®¾è®¡å¸ˆçš„æ—¶å€™ï¼Œè¿™ä¸€éƒ¨åˆ†æ•™ä½ ä¸€äº›å…³äºinterface builderçš„æŠ€å·§ï¼Œè®©ä½ å˜å¾—æ›´é…·ã€‚ æ‰“å¼€Mainstoryboard.storyboardï¼Œé€šå¸¸ä½ æƒ³åœ¨æ‰“å¼€interface builderçš„åŒæ—¶æ‰“å¼€standard editorå’Œå·¥å…·åŒº(utilities area)ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªæ–°çš„å«åšIB Modeçš„è¡Œä¸ºï¼Œå½“ä½ åœ¨çœ‹ä¸‹é¢çš„è‡ªå®šä¹‰å‘æ”¾ä¹‹å‰ï¼Œè¯•ç€è‡ªå·±åˆ›å»ºä¸€ä¸ªç„¶åè‡ªå®šä¹‰ï¼Œä¸å¿…è¦å®Œå…¨ä¸€è‡´ã€‚ æˆ‘å°†è¿™ä¸ªæ¨¡å¼çš„å¿«æ·é”®è®¾ç½®ä¸ºCommand Option .ï¼Œç°åœ¨ä½ å°†çœ‹åˆ°ä¸€ä¸ªèˆ’æœçš„Interface Builderç•Œé¢ï¼Œçœ‹çœ‹CTCardCellã€‚é¦–å…ˆä½ æƒ³è®©mainViewå¤„äºContentViewçš„æ­£ä¸­å¤®ã€‚æœ‰ä¸¤ç§æŠ€å·§å¯ä»¥å®Œæˆè¿™ä¸ªéœ€æ±‚ï¼š æŒ‰ä½Control + Shiftï¼Œç„¶ååœ¨mainViewçš„ä»»æ„ä½ç½®é¼ æ ‡å·¦å‡»ï¼Œä½ å°†çœ‹åˆ°ä¸€ä¸ªå¼¹å‡ºè§†å›¾è®©ä½ é€‰æ‹©åœ¨å…‰æ ‡ä¸‹çš„æ‰€æœ‰è§†å›¾ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è¿™ä¸ªæ–¹æ³•è®©ä½ è½»æ¾çš„å°±èƒ½é€‰ä¸­mainViewï¼Œå°½ç®¡cardbgé®ä½äº†å®ƒã€‚é€‰ä¸­mainViewä¹‹åï¼ŒæŒ‰ä½Altç„¶ååœ¨ContentViewçš„è¾¹ç¼˜ç§»åŠ¨é¼ æ ‡ï¼Œæ¥çœ‹å®ƒä»¬ä¹‹é—´çš„é—´éš”ã€‚ä¸‹é¢æ˜¯è¿™ä¸ªè¿‡ç¨‹çš„ä¸€ä¸ªåŠ¨ç”»ï¼š åŸæ¥å¯¹å…¶å¹¶ä¸æ˜¯é‚£ä¹ˆä¼˜é›…ï¼Œçœ‹èµ·æ¥ä¹Ÿä¸æ˜¯å¾ˆé…·ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥è°ƒæ•´è§†å›¾çš„å¤§å°ã€‚ç‚¹å‡»Editor-&gt;Canvas-&gt;Live Autoresizingæ¥ä½¿å­è§†å›¾åœ¨çˆ¶è§†å›¾å°ºå¯¸æ”¹å˜çš„æ—¶å€™å¼ºåˆ¶è°ƒæ•´å¤§å°ã€‚æŒ‰ä½AltåŒæ—¶æ‹–æ‹½mainViewçš„ä¸€è§’ï¼Œç›´åˆ°æ¯è¾¹çš„è·ç¦»ä¸º15. æ‹–æ‹½æ˜¯åƒç´ ç‚¹çº§åˆ«çš„æŠ€å·§ï¼Œä½ å¯ä»¥å°è¯•ä¸åŒçš„è°ƒæ•´çš„å¤„ç†æ–¹æ³•ï¼Œå°±åƒä¸‹é¢åŠ¨ç”»ä¸€æ ·ã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæ›´å€¾å‘äºä½¿ç”¨Size Inspectoræ¥è°ƒæ•´å¤æ‚çš„å¸ƒå±€ï¼Œè€Œéç”¨é¼ æ ‡æ¥æ‹–æ‹½ã€‚ è¯•ç€ä½¿ç”¨ç›¸åŒçš„æŠ€å·§æ¥å¯¹é½titleLabelã€locationLabelã€aboutLabel,è®©ä»–ä»¬ç«–ç›´æ–¹å‘ä¸Šçš„é—´éš”ä¸º0ã€‚æŒ‰ä½Altæ¥æŸ¥çœ‹é¼ æ ‡ç§»åŠ¨æ—¶ï¼Œä¸‰ä¸ªlabelä¹‹é—´çš„é—´éš”ã€‚æœ‰å‘ç°ä¸‰ä¸ªlabelçš„å·¦è¾¹ç¼˜å¹¶æ²¡æœ‰å¯¹é½å—ï¼Ÿè®¾è®¡å¸ˆè‚¯å®šæƒ³è®©nameLabelå’ŒwebLabelé å·¦å¯¹é½ã€‚ä½¿ç”¨Vertical Guideå¯ä»¥æ˜‚æˆ‘ä»¬è½»æ¾å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚é€‰ä¸­cardbgï¼Œç„¶åç‚¹å‡»èœå•æ çš„Editor-&gt;Add Vertical Guideï¼Œè¿™ä¸ªæ­¥éª¤çš„å¿«æ·é”®æ˜¯Command |ï¼Œhorizontal guideçš„å¿«æ·é”®æ˜¯Command -ï¼Œè¿™ä¸¤ä¸ªå¿«æ·é”®æ˜¯æœ€å¯è§†åŒ–çš„ã€‚å½“è§†å›¾ä¸Šæœ‰äº†vertical guideä¹‹åï¼Œå°†å…¶ä»cardbgçš„å·¦è¾¹ç¼˜æ‹–10ä¸ªç‚¹ã€‚ç„¶åæ‰€æœ‰è§†å›¾å°†ä¼šç´§è´´vertical guideï¼Œå¯¹çš„éå¸¸æ•´é½ï¼Œç»§ç»­ä¸ºå…¶ä»–çš„labelè¿›è¡Œå¯¹å…¶æ“ä½œã€‚ Xcodeå¹¶ä¸é‚£ä¹ˆå®Œç¾ï¼Œæœ‰æ—¶å€™å¯èƒ½åœ¨ä½ åˆ›å»ºguidelineçš„æ—¶å€™å‡ºç°ä¸€äº›é—®é¢˜ï¼Œå¯ä»¥æ‰“å¼€å…¶ä»–æ–‡ä»¶ç„¶åå†åˆ‡å›åˆ°storyboardé¡µé¢ï¼Œç„¶åstoryboardä¼šè¢«é‡æ–°åŠ è½½ï¼Œè¿™ä¸ªæ—¶å€™é—®é¢˜ä¸€èˆ¬ä¼šè‡ªåŠ¨è§£å†³ã€‚è®©ä½ æ›´é…·çš„å»ºè®®ï¼šæ‰€æœ‰çš„è§†å›¾èƒ½ç´§è´´åœ¨guidelineä¸Šæ‰æ˜¯æœ€å¥½çš„ï¼Œguidelineæ²¡æœ‰å¿…è¦åœ¨åŒä¸€ä¸ªå±‚çº§ã€‚ ä¸‹å›¾æ˜¯ä¸Šé¢å¯¹é½è¿‡ç¨‹çš„ä¸€ä¸ªå›æ”¾ï¼š æˆ‘æ•¢æ‰“èµŒä½ ç°åœ¨è¿«ä¸åŠå¾…çš„æƒ³æŠŠä½ åšçš„å±•ç¤ºç»™ä½ çš„è®¾è®¡å¸ˆçœ‹ï¼ æå‡å’Œè¶…è¶Šä¸Šé¢çš„æ­¥éª¤è®©ä½ å¾—åˆ°äº†ä¸€ä¸ªå®ç”¨çš„appï¼ŒåŒæ—¶è®©ä½ çš„è®¾è®¡å¸ˆä¹Ÿæ„Ÿåˆ°å¾ˆæ»¡æ„ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯è®©ä»£ç å˜å¾—æ›´ä¸ºç®€æ´ã€‚ å¿«é€Ÿæ‰“å¼€(Command + Shift + O)CTCardCell.mï¼Œè®°å¾—è¿›å…¥Dev Mode(Command .)ï¼Œä½ åº”è¯¥ä¸ä¼šå¿˜äº†è¿™äº›å¿«æ·é”®å§ã€‚ çœ‹ä¸‹CTCardCell.mé¡¶éƒ¨å‡Œä¹±çš„å±æ€§åˆ—è¡¨ 1234567891011121314@property (weak, nonatomic) IBOutlet UILabel *locationLabel;@property (strong, nonatomic) NSString *website;@property (weak, nonatomic) IBOutlet UIButton *fbButton;@property (weak, nonatomic) IBOutlet UIImageView *fbImage;@property (strong, nonatomic) NSString *twitter;@property (weak, nonatomic) IBOutlet UIButton *twButton;@property (weak, nonatomic) IBOutlet UILabel *webLabel;@property (weak, nonatomic) IBOutlet UIImageView *profilePhoto;@property (strong, nonatomic) NSString *facebook;@property (weak, nonatomic) IBOutlet UIImageView *twImage;@property (weak, nonatomic) IBOutlet UILabel *aboutLabel;@property (weak, nonatomic) IBOutlet UIButton *webButton;@property (weak, nonatomic) IBOutlet UILabel *nameLabel;@property (weak, nonatomic) IBOutlet UILabel *titleLabel; åœ¨è¿™éƒ¨åˆ†ï¼Œä½ å°†åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰æœåŠ¡ä»¥æ‰§è¡Œè„šæœ¬å‘½ä»¤æ¥å®ç°å±æ€§çš„å¿«é€Ÿæ•´é½åœ°æ’åˆ—ã€‚ å¦‚æœå¯¹äºè¿™äº›è„šæœ¬å‘½ä»¤è¿˜ä¸ç†Ÿæ‚‰ï¼Œå®ƒä»¬æ˜¯ç›¸å½“å¥½ç†è§£çš„ã€‚æ’åº(sort)æ˜¯æŒ‰ç…§å­—æ¯é¡ºåºæ¥çš„ï¼Œuniqæ˜¯ä¼šåˆ é™¤æ‰€æœ‰é‡å¤çš„è¡Œæ•°ã€‚uniqåœ¨è¿™é‡Œå¯èƒ½æ´¾ä¸ä¸Šç”¨åœºï¼Œä½†æ˜¯ç”¨å®ƒæ¥ç®¡ç†#importï¼Œé‚£æ˜¯æå¥½çš„ã€‚ Mac OS Xå…è®¸ä½ åˆ›å»ºæ•´ä¸ªæ“ä½œç³»ç»Ÿå…¨å±€é€šç”¨çš„æœåŠ¡ï¼Œä½ å°†ç”¨å®ƒæ¥åˆ›å»ºä¸€ä¸ªç”¨åœ¨Xcodeä¸­çš„è„šæœ¬æœåŠ¡ï¼ŒæŒ‰å¦‚ä¸‹æ­¥éª¤æ¥è®¾ç½® ä½¿ç”¨Spotlightæ¥æœç´¢Automatorï¼Œå¹¶æ‰“å¼€å®ƒç„¶åç‚¹å‡»File-&gt;Newï¼Œå¹¶é€‰æ‹©æœåŠ¡(service)ä¸€é¡¹åœ¨Actionsç­›é€‰æ ï¼Œè¾“å…¥shellï¼Œç„¶ååŒå‡»è¿è¡Œshellè„šæœ¬Run Shell Scriptåœ¨æ–°æ·»åŠ çš„æœåŠ¡çš„èœå•æ ä¸Š,æ£€æŸ¥Output replaces selected textå°†è„šæœ¬å†…å®¹åˆ‡æ¢è‡³sort | uniqåŒæ—¶æŒ‰ä¸‹command sï¼Œå°†æœåŠ¡ä¿å­˜ä¸º Sort &amp; Uniqæœ€ç»ˆçš„çª—å£çœ‹èµ·æ¥æ˜¯è¿™ä¸ªæ ·å­ï¼š åˆ‡å›åˆ°Xcodeï¼Œç„¶åé€‰ä¸­CTCardCell.mä¸­çš„é‚£ç‰‡æ··ä¹±çš„å±æ€§åŒºåŸŸï¼Œå³å‡»ï¼Œé€‰æ‹©Services -&gt; Sort &amp; Uniqï¼Œç„¶åè§‚å¯Ÿæ‰§è¡Œä¹‹åä»£ç æ˜¯å¤šä¹ˆçš„æ•´æ´ã€‚ä½ å¯ä»¥çœ‹ä¸‹é¢çš„ä¸€ä¸ªç¤ºæ„å›¾ï¼š ä»£ç ç‰‡æ®µè¿›è¡Œåˆ°è¿™é‡Œï¼Œæ„å‘³ç€é‚£äº›åŸºæœ¬çš„å¯ä»¥è®©ä½ çœ‹èµ·æ¥é…·é…·çš„è°ƒè¯•ä»»åŠ¡å·²ç»å‘Šä¸€æ®µè½äº†ï¼Œæ¥ä¸‹æ¥æˆ‘å¸Œæœ›ä½ è§‰å¾—æ›´é…·ã€‚ä½ å¯å®šæƒ³å­¦æ›´å¤šæŠ€å·§ï¼Œå¹¸è¿çš„æ˜¯ï¼Œè¿™æ˜¯æœ€ååˆ†äº«çš„ä¸€ä¸ªæŠ€å·§ã€‚ ä½ ä¹‹å‰å¯èƒ½å·²ç»ä½¿ç”¨è¿‡Xcodeçš„ä»£ç ç‰‡æ®µ(Code Snippets)åŠŸèƒ½äº†ï¼Œä¸€äº›å¸¸è§çš„æ˜¯for inç‰‡æ®µå’Œdispatch_afterç‰‡æ®µã€‚åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œä½ å°†å­¦ä¼šå¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰çš„ä»£ç ç‰‡æ®µï¼Œå½“ä½ é‡ç”¨è¿™äº›ä»£ç ç‰‡æ®µæ—¶ï¼Œçœ‹èµ·æ¥éå¸¸æ£’ã€‚ä½ å°†åˆ›å»ºçš„æ˜¯è·å–å•ä¾‹çš„ä»£ç ç‰‡æ®µã€‚ å¦‚æœä½ ä¸ç†Ÿæ‚‰å•ä¾‹æ¨¡å¼ï¼Œå¯ä»¥çœ‹çœ‹è¿™ä¸ªæ•™ç¨‹ã€‚ ä¸‹é¢å¯èƒ½æ˜¯ä½ ä½¿ç”¨å•ä¾‹æ¨¡å¼çš„å¸¸ç”¨ä»£ç æ¨¡æ¿ 12345678+ (instancetype)sharedObject &#123; static id _sharedInstance = nil; static dispatch_once_t oncePredicate; dispatch_once(&amp;oncePredicate, ^&#123; _sharedInstance = [[self alloc] init]; &#125;); return _sharedInstance;&#125; éå¸¸é…·çš„æ˜¯è¿™ä»½ç‰‡æ®µä¹ŸåŒ…å«äº†dispatch_oncepç‰‡æ®µã€‚ åœ¨å·¥ç¨‹CardTiltåˆ›å»ºä¸€ä¸ªåä¸ºç»§æ‰¿è‡ªNSObjectåä¸ºSingletonObjectçš„æ–°ç±»ï¼Œä½ ä¸éœ€è¦ä¸ºå®ƒåšä»»ä½•äº‹ï¼Œé™¤äº†ä½œä¸ºæ‹–æ‹½ä»£ç ç‰‡æ®µçš„ä¸€ä¸ªåœ°æ–¹ã€‚ æŒ‰ä¸‹é¢æ­¥éª¤ï¼š åœ¨@implementation çš„ä¸‹ä¸€è¡Œç²˜è´´ä¸Šé¢çš„ä»£ç åˆ°SingletonObject.m ç”¨å¿«æ·é”®Command Option Control 2æ¥æ‰“å¼€ä»£ç ç‰‡æ®µåº“ï¼Œåœ¨ä»£ç ç‰‡æ®µåº“ä¸­ä½ ä¼šçœ‹åˆ°é»˜è®¤çš„åŒ…å«åœ¨Xcodeä¸­çš„ä»£ç ç‰‡æ®µåº“ã€‚ é€‰ä¸­æ•´ä¸ª+sharedObjectæ–¹æ³•ï¼Œå°†å…¶æ‹–æ‹½åˆ°ä»£ç ç‰‡æ®µåº“ä¸­ã€‚çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š æ–°åˆ›å»ºçš„ä»£ç ç‰‡æ®µå°†ä¼šåœ¨ä»£ç ç‰‡æ®µåº“çš„æœ€åº•éƒ¨ï¼Œä½ å¯ä»¥å°†å…¶æ‹–æ‹½åˆ°ä»»ä½•ä½ æƒ³æ‹–æ‹½çš„æ–‡ä»¶å½“ä¸­å»ï¼Œè®©æˆ‘ä»¬æ¥å°è¯•ä¸€ä¸‹ã€‚ åŒå‡»åˆšåˆšæ–°å»ºçš„ä»£ç ç‰‡æ®µï¼Œç„¶åç‚¹å‡»edit.å¼¹å‡ºçš„è§†å›¾éå¸¸ä½¿ç”¨ï¼Œå®é™…ä¸Šå®ƒä»¬éƒ½å¾ˆé‡è¦ï¼Œæ‰€ä»¥åšä¸ªç®€çŸ­çš„è§£é‡Šã€‚ Title and Summaryï¼šä»£ç ç‰‡æ®µåº“ä¸­è¯¥ä»£ç ç‰‡æ®µçš„åå­—å’Œç®€è¿° Platform and Language:ä»£ç ç‰‡æ®µåŒ¹é…çš„å¹³å°å’Œç¼–ç¨‹è¯­è¨€ Completion Shortcut:åœ¨Xcodeä¸­è¾“å…¥çš„å¿«æ·é”® Completion Scopes:ä»£ç ç‰‡æ®µä½œç”¨çš„èŒƒå›´ï¼Œè¿™å¯¹äºä¿æŒä»£ç ç‰‡æ®µåº“æ•´æ´æ¥è¯´åæå¥½çš„ã€‚å‘ä¸‹é¢ä¸€æ ·å¡«å……é‡Œé¢çš„å±æ€§ï¼š ä»¤ç‰Œå½“ä½ åŠ å…¥ä»¤ç‰Œæ—¶ï¼Œä»£ç ç‰‡æ®µå°†ä¼šå˜å¾—éå¸¸å¼ºå¤§ï¼Œå› ä¸ºå®ƒå…è®¸ä½ åœ¨ç‰‡æ®µä¸­æ ‡è®°ä»£ç ï¼Œè€Œä¸éœ€è¦ç¡¬ç¼–ç ã€‚é€šè¿‡ä½¿ç”¨Tabé”®ä½¿å¾—ä»–ä»¬éå¸¸å®¹æ˜“ä¿®æ”¹ï¼Œå°±åƒè‡ªåŠ¨è¡¥å…¨ä¸€æ ·ã€‚ åœ¨ç‰‡æ®µä¸­ä»…ä»…åªè¦è¾“å…¥&lt;#TokenName#&gt;å°±å¯ä»¥æ·»åŠ ä¸€ä¸ªä»¤ç‰Œï¼Œåˆ›å»ºä¸€ä¸ªä»¤ç‰Œä½¿ç”¨shared&lt;#ObjectName#&gt;æ›¿ä»£sharedObjectï¼Œçœ‹èµ·æ¥åƒè¿™æ ·ï¼š ç‚¹å‡»Doneæ¥ä¿å­˜è¯¥ç‰‡æ®µï¼Œç„¶åæ¥ç”¨ç”¨å®ƒã€‚ åœ¨SingletonObject.mæ–‡ä»¶ä¸­è¾“å…¥singleton accessorï¼Œç„¶åå½“å®ƒå‡ºç°çš„æ—¶å€™ä½¿ç”¨è‡ªåŠ¨è¡¥å…¨ å¯¹äºç»å¸¸ä½¿ç”¨çš„ä»£ç æ¥è¯´ï¼Œåˆ›å»ºä¸€ä¸ªä»£ç ç‰‡æ®µæ˜¯éå¸¸å®ç”¨çš„ã€‚ ä½•å»ä½•ä»æ€»ç»“ä¸€ä¸‹åœ¨è¿™ä¸ªæ•™ç¨‹ä¸­ä½ æ‰€å­¦åˆ°çš„ä¸œè¥¿ï¼š ä½¿ç”¨å¿«æ·é”®æ¥æ”¹å˜Xcodeçš„å¸ƒå±€ ä½¿ç”¨è‡ªå®šä¹‰çš„è¡Œä¸ºæ¥æ”¹å˜Xcodeçš„å¸ƒå±€ ä½¿ç”¨assistant editor åœ¨Xcodeä¸­å¿«é€Ÿæ‰“å¼€æŸæ–‡ä»¶ åœ¨Find navigatoråˆ é™¤æœç´¢åˆ°çš„ç»“æœ åœ¨Interface Builderä½¿ç”¨å¿«æ·é”®å’Œguidelineæ¥å¯¹é½è§†å›¾ åˆ›å»ºä¸€ä¸ªåœ¨Xcodeä¸­ä½¿ç”¨çš„æœåŠ¡ åˆ›å»ºå¹¶ä½¿ç”¨è‡ªå®šä¹‰çš„ä»£ç ç‰‡æ®µ æœ€é‡è¦çš„æ˜¯ä½ çŸ¥é“æ€ä¹ˆå»æˆä¸ºä¸€åXcodeå¤§å¸ˆ ä¸Šé¢åˆ—å‡ºæ¥çš„å†…å®¹éƒ½å¾ˆç®€å•å¯¹å§ï¼Ÿåœ¨ä½ çš„æœ‹å‹é¢å‰å±•ç¤ºè¿™äº›ç‚«é…·çš„æŠ€å·§ï¼Œä½ çš„æœ‹å‹ä¸€å®šä¼šæƒŠå‘†ä¹Ÿä¼šç†è§£ä½ çš„å…´å¥‹ã€‚è¿˜æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥æé«˜ä½ çš„Xcodeçš„æ•ˆç‡ï¼Œæ¯”å¦‚ï¼š ä½¿ç”¨Doxygené£æ ¼çš„æ³¨é‡Š ä½¿ç”¨Xcodeæ’ä»¶ ä¸‹ä¸€æ­¥å°±æ˜¯å»å¯»æ‰¾æ–°çš„é…·ç‚«çš„æŠ€å·§ï¼Œæˆ‘å¸Œæœ›ä½ èƒ½äº«å—æ•´ä¸ªæ•™ç¨‹çš„å­¦ä¹ è¿‡ç¨‹ï¼Œå¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ã€è¯„è®ºã€æˆ–è€…æƒ³åˆ†äº«ä½ æ‰€çŸ¥é“çš„ç‚«é…·æŠ€å·§ï¼Œè¯·åœ¨ä¸‹é¢è¯„è®ºä¸­æŒ‡å‡ºã€‚]]></content>
      <categories>
        <category>ç¿»è¯‘</category>
      </categories>
      <tags>
        <tag>ç¿»è¯‘</tag>
        <tag>Xcode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æœ€è¿‘éšæƒ³åŠå­¦æœŸæ€»ç»“]]></title>
    <url>%2F2014%2F06%2F21%2FRecent-Thoughts%2F</url>
    <content type="text"><![CDATA[ä»Šå¤©6.21å·ï¼Œå­¦æ ¡ä¸€å¹´ä¸€å±Šçš„æ¯•ä¸šæ™šä¼šâ€”â€”åŒæ­ŒåŒè¡Œå¦‚æœŸè¿›è¡Œï¼Œè¿™ä¹Ÿé¢„ç¤ºç€æˆ‘ä¸‹ä¸€å¹´ä¹Ÿå³å°†æ»šè›‹,å¤–é¢æ­£è¿›è¡Œç€å¾ˆHighçš„æ³¼æ°´èŠ‚,ä»Šå¹´ä¸åƒå‰ä¸¤å¹´é‚£æ ·å»æ··è¿›æ¯•ä¸šæ¸¸è¡Œé˜Ÿä¼,è§‰å¾—æ˜å¹´å°±åˆ°è‡ªå·±äº†,ä»Šå¹´å°±ä¸å»å‡‘çƒ­é—¹äº†.ã€‚æ˜¨å¤©é™¢é‡Œçš„æ¯•ä¸šæ™šä¼šï¼Œçœ‹äº†å³å°†ç¦»å¼€çš„å­¦é•¿å­¦å§çš„å„ç§æœ‰èŠ‚æ“æ²¡èŠ‚æ“çš„è¡¨æ¼”ï¼Œè§‰å¾—å››å¹´è¿‡çš„çœŸçš„å¤ªå¿«ã€‚å›æ¥çš„è·¯ä¸Šï¼Œjbè¯´æ˜å¹´æ¯•ä¸šæ™šä¼šä½ ä¹Ÿä¸Šå»å¼¹å”±ä¸€é¦–å§ï¼Œæ„Ÿè§‰å¥½ä¼¤æ„Ÿã€‚ è¿™å­¦æœŸä¹Ÿé©¬ä¸Šè¦ç»“æŸäº†ï¼Œæ„Ÿè§‰å­¦æœŸåˆçš„è®¡åˆ’åªå®ç°äº†ä¸€åŠã€‚å‰æœŸä¸€ç›´åœ¨å¿™ç€å‡†å¤‡æ‰¾å®ä¹ ï¼Œå„ç§å……ç”µï¼Œä»æ•°æ®ç»“æ„åˆ°ç®—æ³•ï¼Œä»Cåˆ°Java,ä»Objective-Cåˆ°iOSå¼€å‘ã€‚æ„Ÿè§‰è‡ªå·±éœ€è¦å­¦çš„ä¸œè¥¿å¤ªå¤šï¼Œè€Œä»¥å‰ç§¯ç´¯çš„çŸ¥è¯†å®Œå…¨ä¸å¤Ÿã€‚åˆæœŸçš„ç½‘æ˜“ç»ˆé¢è¢«åˆ·ã€å»å“ªå„¿ç½‘ç¬”è¯•è·ªäº†ã€é˜¿é‡Œå†…æ¨ç”µè¯é¢è¯•ä¹‹åæ²¡äº†ä¸‹æ–‡ã€è…¾è®¯ç¬”è¯•æ²¡è¿‡ã€åä¸ºä¸€é¢è¿‡åè«åå…¶å¦™åœ°æ²¡äº†ä¸‹æ–‡ï¼Œä¸€ç³»åˆ—çš„å¤±è´¥è¢«æ‹’è®©æˆ‘ä¸€åº¦é™·å…¥ä¸€ä¸ªè¿·èŒ«æœŸï¼ŒåŒæ—¶å¼€å§‹åçœè‡ªå·±ï¼Œç„¶åä¸€æ­¥æ­¥è°ƒæ•´ã€‚äº”æœˆè¿‡åï¼Œå„å¤§äº’è”ç½‘å…¬å¸åŸºæœ¬å·²ç»ç»“æŸäº†å®ä¹ ç”Ÿçš„æ‹›è˜ï¼Œç”±äºä¸æƒ³è·Ÿå­¦æ ¡å®‰æ’çš„å®ä¹ ï¼Œæ‰€ä»¥æŠ¥äº†ä¸€ä¸ªè€å¸ˆçš„å®éªŒå®¤ã€‚çœ‹ç€è¯¾é¢˜æ˜¯æ™ºæ…§è€äººç³»ç»Ÿï¼Œçœ‹ç€æ„Ÿè§‰æ¯”è¾ƒå¯¹è‡ªå·±çš„å…´è¶£ï¼Œå› ä¸ºå‰æœŸä¸€ç›´åœ¨åšä¸€ä¸ªåŸºäºBLE4.0çš„æ™ºèƒ½å®¶å±…çš„iOSå®¢æˆ·ç«¯ï¼Œè§‰ç€æ™ºèƒ½åŠè‡ªåŠ¨åŒ–æ˜¯æœªæ¥çš„ä¸€ä¸ªè¶‹åŠ¿ã€‚ä½†æ˜¯è¿‡å»å‘è€å¸ˆè¿›ä¸€æ­¥äº†è§£åï¼Œå‘ç°éœ€è¦åšçš„å’Œæˆ‘æƒ³çš„å®Œå…¨èƒŒé“è€Œé©°ï¼Œç°åœ¨è¿˜åœ¨çº ç»“è¦ä¸è¦ç»§ç»­å’Œä»–åšä¸‹å»ã€‚ä¹‹åï¼Œåˆä¸€å®¶äº’è”ç½‘å…¬å¸åˆ°å­¦æ ¡å¼€å®£è®²ä¼šï¼Œä»¥åŠç°åœºç¬”è¯•ï¼Œç¬”è¯•æ—¶æ„Ÿè§‰æ¯”è¾ƒé¡ºåˆ©ï¼Œéƒ½æ˜¯ä¸€äº›å¾ˆåŸºç¡€çš„ä¸œè¥¿ï¼Œè™½ç„¶æˆ‘çš„åŸºç¡€ä¹Ÿå¹¶ä¸æ‰å®ï¼Œä½†è¿˜æ˜¯è¿‡äº†ç¬”è¯•ï¼Œæ”¶åˆ°äº†ç¬¬äºŒå¤©é¢è¯•çš„é€šçŸ¥ã€‚ç¬¬äºŒå¤©çš„æŠ€æœ¯é¢å’Œç»ˆé¢è¡¨ç°å¾—éƒ½è¿˜å¯ä»¥ï¼Œå’Œé¢è¯•å®˜ä¹Ÿå¾ˆèŠçš„æ¥ï¼Œä¸¤ä½é¢è¯•å®˜äººéƒ½å¾ˆniceã€‚æœ€åä¹Ÿæ”¶åˆ°äº†è¯¥å…¬å¸çš„å®ä¹ offerï¼Œæ„Ÿè§‰æ¯”è¾ƒå¹¸è¿ã€‚æŠ¥çš„å²—ä½æ˜¯iOSï¼Œæ­£å¯¹è‡ªå·±çš„å…´è¶£ï¼Œæ‰€ä»¥æš‘å‡è¿‡å»è¦å¥½å¥½è¡¨ç°ã€‚ åæœŸå°±æ˜¯å‡†å¤‡è€ƒè¯•,æ„Ÿè§‰å¤§ä¸‰ä»¥æ¥åŸºæœ¬æ²¡å¬è¿‡è¯¾,éƒ½æ˜¯æ²‰æµ¸åœ¨è‡ªå·±çš„ä¸–ç•Œé‡Œ,çœ‹ç¼–ç¨‹æ–¹é¢çš„ä¹¦,çœ‹iOSçš„APIæ–‡æ¡£ã€‚çªç„¶æ„Ÿè§‰è‡ªå·±çš„å…´è¶£å’Œä¸“ä¸šå·²æ²¡å¤šå¤§è”ç³»äº†,è¿™æ˜¯ä¸æ˜¯ä¸€ç§æ‚²å“€å‘¢?å‰æœŸå­¦ä¸šæˆç»©æ„Ÿè§‰å°±é‚£æ ·äº†å§ï¼Œè¾¾åˆ°äº†æœ€ä½åº•çº¿æ²¡æœ‰æŒ‚ç§‘ï¼Œéƒ½æ˜¯70å·¦å³åœ¨å¾˜å¾Šã€‚æ¥ä¸‹æ¥è¿™å‡ å¤©ä¹Ÿé©¬ä¸Šè¦è€ƒè¯•,åˆå¾—å‡†å¤‡æŠ±æŠ±ä½›è„šäº†,ä¸å¾—ä¸å…ˆæ”¾æ”¾åŸæ¥å®šçš„æ¯å¤©ä¸€ä¸ªSessionçš„è®¡åˆ’äº†,ç­‰è€ƒå®Œä¹‹å,å†ç»§ç»­ã€‚ è¿™å­¦æœŸçš„é¢è¯•ä»¥åŠå’Œä¸€äº›äººçš„æ¥è§¦è¿‡ç¨‹ä¸­,æœ‰ä¸€äº›å°è±¡æ·±åˆ»çš„åˆ‡èº«ä½“ä¼š,é‚£å°±æ˜¯ç‰›é€¼çš„äººä»–ä»¬çš„è¯´è¯æ–¹å¼éƒ½å¾ˆæœ‰å‹ï¼Œè®©äººæ„Ÿè§‰ä»€ä¹ˆäº‹åœ¨ä»–ä»¬çœ¼ä¸­éƒ½ä¸ç®—é—®é¢˜ã€‚å…¶å®ä»–ä»¬å¦‚ä»Šçš„å¯¹è‡ªå·±ç»å†çš„ä¸€ç§è½»ææ·¡å†™ç”šè‡³ä¸€ç¬”å¸¦è¿‡ï¼Œéƒ½æ˜¯åœ¨ç»å†äº†ç‰›é€¼ä¹‹å‰é‚£æ®µé»‘æš—çš„è¿·èŒ«æœŸçš„ç£¨ç»ƒå’Œé“ºå«åçš„ä¸€ç§é‡Šç„¶ã€‚ æ¥ä¸‹æ¥æš‘å‡æœŸå¾…å®Œæˆçš„äº‹æœ‰: å®ä¹ åˆ°å²—å‰,åšä¸€ä¸ªå°å‹çš„åº”ç”¨,äº‰å–ä¸Šçº¿ã€‚ å®ä¹ æœŸé—´,å¤šå¤šå­¦ä¹ ,å»ç†Ÿæ‚‰ä¸€ä¸ªå®Œæ•´çš„å¤§å‹çš„Appçš„å¼€å‘æµç¨‹,å¥½å¥½è¡¨ç°äº‰å–è½¬æ­£ã€‚ åŠ å¼ºåŸºç¡€,ä¸ºç§‹æ‹›åšå‡†å¤‡ã€‚]]></content>
      <categories>
        <category>æ‰¯æ·¡é›†</category>
      </categories>
      <tags>
        <tag>æ‚è°ˆ</tag>
        <tag>åŸåˆ›</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­å·ç½‘æ˜“è¡Œ]]></title>
    <url>%2F2014%2F03%2F19%2FInterview-In-NetEase%2F</url>
    <content type="text"><![CDATA[å‘¨ä¸‰æ¥åˆ°ç½‘æ˜“ç”µè¯ï¼Œè¯´ä¸Šæ¬¡ç”µè¯é¢è¯•é€šè¿‡äº†ï¼Œè®©æˆ‘å‘¨æœ«è¿‡å»æ­å·æ€»éƒ¨é¢è¯•ï¼Œäºæ˜¯å‘¨æœ«å°±å»äº†è¶Ÿæ­å·ã€‚è¿™ç¯‡æ–‡ç« æ˜¯å…³äºç½‘æ˜“è¿™æ¬¡é¢è¯•çš„ç›¸å…³å†…å®¹å’Œè‡ªå·±é¢è¯•åçš„æ„Ÿæƒ³ï¼Œå†™å‡ºæ¥å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ã€‚ é¢è¯•è¿‡ç¨‹3.4å·æ¥åˆ°ç½‘æ˜“çš„ç”µè¯ï¼Œè¯´é¢„çº¦ç¬¬äºŒå¤©ä¸‹åˆä¸‰ç‚¹è¿›è¡Œç”µè¯é¢è¯•ï¼Œç„¶åè‡ªå·±å°±å¼€å§‹å‡†å¤‡è‡ªæˆ‘ä»‹ç»ä»€ä¹ˆçš„ã€‚è¿™é‡Œæœ‰ä¸ªä¹Œé¾™äº‹ä»¶ï¼Œä¹‹å‰æŠ•äº†ä»½ç½‘æ˜“æ¸¸æˆçš„å®ä¹ ç”Ÿï¼ŒåŸæ¥ä»¥ä¸ºæ˜¯æ¸¸æˆå®ä¹ ç”Ÿçš„é¢è¯•ï¼Œå‡ å¤©ä¹‹åæ¥åˆ°ç½‘æ˜“æ¸¸æˆéƒ¨çš„â€œè™½ç„¶æ‚¨å¾ˆä¼˜ç§€â€¦â€çš„é‚®ä»¶ï¼Œæ‰çŸ¥é“åŸæ¥æ¸¸æˆæ˜¯æ‹›è‡³å°‘ç¡•å£«å­¦å†çš„ï¼Œè¿™æ¬¡ç”µè¯é¢è¯•å¹¶ä¸æ˜¯ç½‘æ˜“æ¸¸æˆçš„é¢è¯•ï¼ˆåæ¥æ‰æƒ³èµ·æ˜¯ä¹‹å‰æŠ•çš„ç½‘æ˜“iOSå¼€å‘å·¥ç¨‹å¸ˆå®ä¹ ç”Ÿçš„èŒä½ï¼ŒçœŸå›§~~ï¼‰ã€‚ä¸‹é¢æ˜¯ç¬¬äºŒå¤©ç”µè¯é¢è¯•çš„å¤§è‡´å†…å®¹ï¼Œè®°å¾—ä¸æ˜¯å¾ˆæ¸…æ¥šäº†ï¼Œæˆ‘å¤§è‡´è¿˜åŸä¸€ä¸‹å½“æ—¶çš„æƒ…æ™¯ã€‚å¿½ç•¥ä¸€äº›å®¢æ°”è¯­ï¼Œä¸‹é¢ç›´æ¥è¿›å…¥æ­£é¢˜ã€‚ é¢è¯•å®˜ï¼ˆä»¥ä¸‹ä»¥Qä»£æ›¿ï¼‰ï¼šä½ å­¦ä¹ iOSå¤šé•¿æ—¶é—´äº†ï¼Ÿæˆ‘ï¼ˆä¸‹é¢ä»¥Aä»£æ›¿ï¼‰ï¼šåä¸ªæœˆçš„æ ·å­ã€‚Qï¼šä½ äº†è§£MRCå’ŒARCå—ï¼ŸAï¼šå¯¹ä»–ä»¬éƒ½æœ‰ä¸€å®šçš„äº†è§£ï¼Œä½†ç”¨çš„æ›´å¤šçš„æ˜¯ARCï¼Œå½“ç„¶ä¹ŸçŸ¥é“MRCçš„è§„åˆ™åŠç”¨æ³•ï¼Œä¹Ÿæœ‰åšè¿‡ç›¸å…³Demoï¼Œç”±äºå¼€å§‹å­¦ä¹ iOSçš„æ—¶å€™ARCå·²ç»æˆä¸ºä¸€ç§è¶‹åŠ¿ï¼Œæ‰€ä»¥ç”¨çš„æ›´å¤šçš„æ˜¯ARCã€‚Qï¼šå¥½çš„ã€‚ä½ ç†Ÿæ‚‰autoreleaseå—ï¼Ÿè°ˆè°ˆå®ƒå’ŒARCçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼ŸAï¼šautoreleaseæ˜¯å°†å¯¹è±¡æ·»åŠ åˆ°NSAutoReleasePoolé‡Œé¢ï¼Œç„¶ååœ¨è°ƒç”¨[pool drain]æ–¹æ³•åï¼Œæ‰€æœ‰åœ¨é‡Šæ”¾æ± é‡Œé¢çš„å¯¹è±¡å‡è¢«releaseã€‚è€ŒARCçœ‹èµ·æ¥çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å®è´¨æ˜¯ä¸ä¸€æ ·çš„ï¼ŒARCæ˜¯ç³»ç»Ÿåœ¨é€‚å½“æ—¶å€™æ¥é‡Šæ”¾ä¸€ä¸ªå¯¹è±¡çš„ã€‚Qï¼šå—¯ã€‚ä½ äº†è§£NSObjectå’ŒNSObject Protocolå—ï¼Ÿä»–ä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¸ºä»€ä¹ˆè¦æœ‰NSobject Protocolï¼ŸAï¼šNSObjectå‡ ä¹æ˜¯iOSå¼€å‘è¿‡ç¨‹ä¸­æ‰€æœ‰ç±»çš„æ ¹ç±»ï¼ŒNSObjectåè®®æ˜¯ä¸ºäº†æ–¹ä¾¿ä¸€äº›å¹¶æ²¡æœ‰ç»§æ‰¿è‡ªNSObjectçš„è‡ªå®šä¹‰ç±»ï¼Œæ¥å®ç°NSObjectçš„ä¸€äº›æ–¹æ³•ï¼Œå› ä¸ºäºŒè€…çš„æ–¹æ³•å¤§éƒ¨åˆ†æ˜¯ä¸€æ ·çš„ã€‚Qï¼šé‚£ä½ çŸ¥é“å“ªäº›ç±»æ˜¯ä¸ç»§æ‰¿è‡ªNSObjectçš„ï¼Ÿä»¥åŠè¿™æ ·åšçš„åŸå› æ˜¯ä»€ä¹ˆï¼ŸAï¼šæ®æˆ‘ç›®å‰è§åˆ°çš„æƒ…å†µæ¥çœ‹ï¼Œè²Œä¼¼æ²¡æœ‰ï¼Œä½†è‚¯å®šæœ‰è¿™ç§ç±»ã€‚è‡³äºè¿™æ ·åšçš„åŸå› æˆ‘ä¸å¤ªæ¸…æ¥šã€‚ï¼ˆé¢è¯•å®Œågoogleäº†ä¸€ä¸‹ï¼Œå¤§æ¦‚äº†è§£äº†ç›¸å…³æƒ…å†µï¼‰Qï¼šä½ äº†è§£è¿è¡Œæ—¶å—ï¼ŸAï¼šäº†è§£ä¸€ç‚¹ç‚¹ã€‚Qï¼šå—¯ï¼Œæ²¡äº‹ï¼Œé‚£ä½ è¯´è¯´ä½ äº†è§£çš„ã€‚Aï¼šè¿è¡Œæ—¶å°±æ˜¯åœ¨è¿è¡Œæ—¶æ¥è¿›è¡Œåˆ¤æ–­ï¼Œæ¯”å¦‚å†…çœã€‚åƒrespondeToXXXè¿™äº›æ–¹æ³•åº”è¯¥éƒ½æ˜¯è¿è¡Œæ—¶æ‰æ‰§è¡Œçš„ã€‚æˆ‘çŸ¥é“çš„å¤§æ¦‚ä¹Ÿå°±è¿™ä¹ˆå¤šäº†ã€‚Qï¼šä½ ç”¨è¿‡å“ªäº›å¼€æºåº“ï¼ŸAï¼šæš‘å‡åšä¸€ä¸ªæ¸¸æˆå®¢æˆ·ç«¯çš„æ—¶å€™ç”¨è¿‡CocoaAsyncSocketã€‚Qï¼šä½ æœ‰ä»”ç»†çœ‹è¿‡å®ƒçš„æºç å—ï¼Ÿä½ è®¤ä¸ºå®ƒçš„å“ªäº›æ–¹é¢å¯ä»¥ä¼˜åŒ–å‘¢ï¼ŸAï¼šå½“æ—¶é¡¹ç›®æ¯”è¾ƒç´§ï¼Œæ‰€ä»¥ç›´æ¥æ‹¿è¿‡æ¥å°±ç”¨äº†ï¼Œå°±çœ‹äº†ä¸€äº›è‡ªå·±éœ€è¦ç”¨åˆ°çš„æ–¹æ³•çš„å®ç°ã€‚ä¼˜åŒ–çš„è¯ï¼Œæš‚æ—¶è¿˜æ²¡æœ‰æƒ³è¿‡ã€‚Qï¼šé‚£å¦‚æœä½ ç°åœ¨å†å»çœ‹è¿™ä¸ªå¼€æºåº“çš„æ—¶å€™ä½ è§‰å¾—ä½ ä¼šå­¦åˆ°å“ªäº›ä¸œè¥¿ï¼ŸAï¼šè¿™ä¸ªåº“æ˜¯åˆ†TCPå’ŒUDPçš„ï¼Œå½“æ—¶æˆ‘ä»¬ç”¨çš„æ˜¯TCPï¼Œè¿™æ¬¡å¦‚æœå†å»çœ‹çš„è¯ï¼Œåº”è¯¥å¯¹UDPä¹Ÿä¼šæœ‰ä¸€å®šçš„äº†è§£å’Œå­¦ä¹ ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥è€ƒè™‘ä¸€äº›å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ã€‚Qï¼šå¯¹äºå…¶ä»–çš„æ¯”è¾ƒç»å…¸çš„å…³äºç½‘ç»œæ–¹é¢çš„å¼€æºåº“è¿˜ç”¨è¿‡å“ªäº›ï¼ŸAï¼šAFNetworkingï¼ŒASIHttpã€‚Qï¼šå—¯ï¼Œå…¶ä»–çš„å¼€æºåº“å‘¢ï¼ŸAï¼šç”¨è¿‡é‚£ä¸ªåœ¨ios5ï¼Œ6ä¸‹å®ç°ios7æ‰å¹³é£æ ¼çš„æ§ä»¶çš„åº“ï¼Œå…¶ä»–çš„éƒ½ä¸è®°å¾—åå­—äº†ã€‚Qï¼šä½ äº†è§£è¶Šç‹±å—ï¼Ÿè¯¥æ€ä¹ˆåˆ¤æ–­è®¾å¤‡æ˜¯å¦è¶Šç‹±ï¼ŸAï¼šäº†è§£ä¸€ç‚¹ç‚¹ã€‚æ‚¨è¯´çš„æ˜¯åªç”¨ä»£ç åˆ¤æ–­å—ï¼Ÿä»£ç çš„è¯æˆ‘ä¸å¤ªæ¸…æ¥šã€‚ï¼ˆé¢è¯•ågoogleäº†ä¸€ä¸‹ï¼Œå¤§è‡´æ€æƒ³æ˜¯æ£€æµ‹æ˜¯å¦å¤šå‡ºè¶Šç‹±çš„æ–‡ä»¶ç›®å½•ï¼Œç½‘ä¸Šç°æˆçš„ä»£ç ä¹Ÿæœ‰ï¼Œéšä¾¿ä¸€æœå°±èƒ½æå®šï¼‰Qï¼šäº†è§£copyå’ŒmutableCopyå—ï¼Ÿè°ˆè°ˆäºŒè€…çš„åŒºåˆ«Aï¼šäº†è§£ã€‚copyåªæ˜¯æŒ‡é’ˆçš„å¤åˆ¶ï¼Œå±äºæµ…æ‹·è´ï¼ŒmutableCopyæ˜¯æ·±æ‹·è´ã€‚ï¼ˆä¹‹åä»–ä¸¾äº†ä¸ªä¾‹å­ï¼Œå¿˜è®°äº†ï¼Œåæ­£å°±æ˜¯NSStringå’ŒNSMutableStringçš„ä¸€äº›ä¸œè¥¿ã€‚å¦‚æœä½ æœ‰ç–‘é—®ï¼Œå¯ä»¥çœ‹çœ‹æˆ‘ä¹‹å‰çš„æ–‡ç« â€”&gt;OCå†…å­˜ç®¡ç†å­¦ä¹ ï¼‰Qï¼šæ€ä¹ˆåˆ¤æ–­ä¸€ä¸ªç±»æ˜¯å¦éµå¾ªæŸä¸ªåè®®ï¼ŸAï¼šå¯ä»¥ç”¨respondToåè®®é‡Œçš„æŸä¸ªæ–¹æ³•æ¥å®ç°ã€‚Qï¼šè¿˜æœ‰æ²¡æœ‰å…¶ä»–çš„æ–¹æ³•å‘¢ï¼ŸAï¼šå…¶ä»–çš„åº”è¯¥æœ‰ä½†æ˜¯æˆ‘ä¸çŸ¥é“ã€‚å› ä¸ºæˆ‘æœ€å¸¸ç”¨çš„å°±æ˜¯ä¸Šé¢çš„è¿™ä¸ªæ–¹æ³•ã€‚Qï¼šå‡å¦‚æˆ‘æœ‰ä¸€ä¸ªå¯¹è±¡ä¸æƒ³å®ç°ç³»ç»Ÿé»˜è®¤çš„æ–¹æ³•ï¼Œæˆ‘èƒ½å¤Ÿåšåˆ°å—ï¼ŸAï¼šå¯ä»¥ç”¨åˆ†ç±»ï¼ˆcategreyï¼‰å§ï¼Œï¼ˆè¿Ÿç–‘ç‰‡åˆ»åæƒ³æƒ³ä¸å¯¹ï¼‰ï¼Œåº”è¯¥ä¸è¡Œã€‚ï¼ˆé¢è¯•ä¹‹åï¼Œè‡ªå·±å†æƒ³äº†ä¸‹åº”è¯¥å¯ä»¥å¤å†™å…¶çˆ¶ç±»æ–¹æ³•å°±è¡Œï¼Œä¸çŸ¥é“å¯¹ä¸å¯¹ï¼‰Qï¼šä½ ç”¨è¿‡GCDå’ŒNSOperationå—ï¼Ÿå®ƒä»¬å¸¸ç”¨çš„åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿè°ˆè°ˆä½ çš„çœ‹æ³•ã€‚Aï¼šéƒ½ç”¨è¿‡ã€‚NSOperationæ˜¯å¯¹GCDçš„å°è£…ï¼Œå±äºç±»çº§åˆ«çš„ï¼ŒGCDæ˜¯åº•å±‚çš„å±äºCçº§åˆ«çš„ã€‚GCDçš„æ•ˆç‡å¯èƒ½ä¼šæ›´é«˜ï¼Œå› ä¸ºåŸºæœ¬ä¸Šå…¨æ˜¯æ‰§è¡Œblockã€‚Qï¼šä½ å¹³æ—¶ç”¨å“ªç§æ–¹å¼å‘¢ï¼ŸAï¼šä¸€èˆ¬å›¾ç‰‡åŠ è½½ç”¨çš„æ˜¯GCDï¼Œè€Œå…¶ä»–ä¸‹è½½ä»»åŠ¡ç”¨çš„æ˜¯NSOperationã€‚Qï¼šGCDèƒ½å¤Ÿéšæ—¶åœæ­¢å—ï¼ŸNSOperationå‘¢ï¼Ÿå¦‚æœèƒ½çš„è¯åˆæ˜¯è°ƒç”¨ä»€ä¹ˆæ–¹æ³•å‘¢ï¼ŸAï¼šGCDç”±äºè°ƒç”¨çš„æ˜¯blockï¼Œæ‰€ä»¥å®ƒä¸€æ—¦å¼€å§‹åœ¨æ‰§è¡Œå®Œä¹‹å‰æ˜¯ä¸èƒ½åœæ­¢æˆ–å–æ¶ˆçš„ã€‚è€ŒOperationæ˜¯å¯ä»¥çš„ï¼Œé€šè¿‡KVOå³å¯ã€‚å½“ç„¶å¦‚æœè¦å–æ¶ˆçš„è¯ï¼Œæˆ‘è®°å¾—æœ‰ä¸ªæ–¹æ³•ï¼Œåå­—è²Œä¼¼æ˜¯closeï¼Ÿï¼ˆé¢å®ŒåæŸ¥äº†ä¸‹æ˜¯cancelï¼‰ä¹‹åå°±æ˜¯æ¢äº†ä¸€ä¸ªäººï¼Œé—®äº†ä¸‹æˆ‘çš„ç›¸å…³æƒ…å†µå’Œå®ä¹ æ—¶é—´çš„å®‰æ’ï¼Œç„¶åè®©æˆ‘ç­‰ç”µè¯é€šçŸ¥ã€‚äº”å¤©ä¹‹åï¼Œæ¥åˆ°ç”µè¯ï¼Œè¯´è®©æˆ‘å‘¨å…­ä¸‹åˆå»æ­å·é¢è¯•ã€‚ç„¶åé—®äº†ä¸‹è´¹ç”¨é—®é¢˜ï¼Œæ˜¯ä¸æŠ¥é”€è·¯è´¹çš„ï¼Œæœ¬æ¥ä¸æ‰“ç®—å»äº†ï¼Œå›æ¥çœ‹çœ‹è½¦è´¹ä¹Ÿä¸è´µï¼Œäºæ˜¯æƒ³æƒ³è§‰å¾—è¿˜æ˜¯å»å§ã€‚å°±ç®—ä¸è¿‡ï¼Œä¹Ÿå½“é•¿æ¬¡ç»éªŒè¿˜å¯ä»¥é¡ºå¸¦å»è¥¿æ¹–çœ‹çœ‹ã€‚åäº†ä¸€æ™šçš„ç«è½¦ï¼Œç¬¬äºŒå¤©åˆ°ç½‘æ˜“å¤§å¦ï¼Œä¸€è¿›å¤§å…æ„Ÿè§‰è‡ªå·±æ˜¯åœŸé³–è¿›åŸï¼ˆå“ï¼Œæ²¡è§è¿‡ä¸–é¢ï¼‰ã€‚ä¸‹åˆä¸€ç‚¹åˆ°ï¼Œåœ¨å¤§å…ç­‰äº†45åˆ†é’Ÿï¼Œå°±æœ‰äººè¿‡æ¥å«æˆ‘å»é¢è¯•ï¼Œæ²¡æƒ³åˆ°è¿™æ¬¡è¿˜æ˜¯æŠ€æœ¯é¢ï¼Œæœ¬ä»¥ä¸ºæ˜¯HRé¢äº†ã€‚è¿›åˆ°ç»ç’ƒé—´ï¼Œé¢è¯•å®˜å…ˆé—®äº†æˆ‘çš„ä¸€äº›æƒ…å†µï¼Œæ€ä¹ˆæ¥çš„ï¼Œæ¥è¿™ä¹‹åä½å“ªé‡Œï¼Œçœ‹ä½ ç²¾ç¥ä¸å¤ªå¥½å•Šã€‚æˆ‘å›â€œåäº†é€šå®µç«è½¦â€ç­‰ç­‰ã€‚å¬å£°éŸ³æ„Ÿè§‰æ˜¯å’Œä¸Šä¸€æ¬¡ç”µé¢çš„æ˜¯åŒä¸€ä¸ªã€‚Qï¼šä¸Šæ¬¡é¢å®Œä¹‹åä½ æœ‰ä»€ä¹ˆæ„Ÿæƒ³ï¼Ÿé¢å®Œä¹‹åæœ‰æ²¡æœ‰å†™blogä»€ä¹ˆçš„ã€‚Aï¼šæ„Ÿè§‰è‡ªå·±å¾ˆå¤šæ–¹é¢çš„çŸ¥è¯†å¾ˆè–„å¼±ï¼Œæœ‰å¾…æé«˜ï¼Œblogå€’æ˜¯è¿˜æ²¡æ•´ç†å¥½ï¼Œåªæ˜¯ç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹ä¸Šæ¬¡é‚£äº›ä¸çŸ¥é“çš„ã€‚Qï¼šé‚£ç°åœ¨ä½ å¯¹é‚£äº›é—®é¢˜æœ‰äº†ä»€ä¹ˆæ–°çš„è®¤è¯†ï¼ŸAï¼šç„¶åæˆ‘å°±è¯´äº†ä¸€ä¸‹æˆ‘å¯¹äºé‚£äº›çŸ¥è¯†çš„ä¸€ä¸ªæ€»ç»“ã€‚Qï¼šæœ‰æ²¡æœ‰ç›¸å…³çš„é¡¹ç›®ç»éªŒå‘¢ï¼ŸAï¼šå¸®ä¸€ä¸ªå…¬å¸åšè¿‡ä¸€ä¸ªç±»ä¼¼QQæ¸¸æˆå¤§å…çš„å®¢æˆ·ç«¯ã€‚å®ç°ç™»å½•ä»¥åŠå„ä¸ªæ¸¸æˆçš„åœ¨çº¿äººæ•°æ˜¾ç¤ºï¼Œä¸»è¦æ˜¯ä»å®‰å“ç«¯åˆ°iOSç«¯çš„ç§»æ¤ã€‚Qï¼šé‚£ä½ å¯¹å®‰å“åº”è¯¥ä¹Ÿæœ‰æ‰€äº†è§£å§ï¼Œè¯´è¯´ä»–ä»¬ä¹‹é—´çš„åŒºåˆ«ï¼ŸAï¼šã€‚ã€‚ã€‚è°ˆäº†ä¸‹è‡ªå·±çš„è®¤è¯†ã€‚Qï¼šé™¤äº†è¿™äº›ï¼Œä½ è‡ªå·±å¹³æ—¶æœ‰æ²¡æœ‰åšè¿‡å°çš„ä¸œè¥¿æ¥ç©ä¸€ç©ï¼ŸAï¼šæˆ‘æå‡ºiTouchï¼Œç„¶åæ‹¿å‡ºå‡ ä¸ªæœˆå‰å†™çš„è®¡ç®—å™¨ç»™ä»–çœ‹ï¼Œç„¶åä»‹ç»äº†ä¸‹è¿™ä¸ªè®¡ç®—å™¨å®ç°çš„åŠŸèƒ½ã€‚Qï¼šï¼ˆæŠŠç©äº†ä¸€ä¸‹ï¼‰å—¯ï¼Œçœ‹èµ·æ¥è¿˜ä¸é”™ï¼Œä¸»è¦ç²¾åŠ›åº”è¯¥æ˜¯èŠ±åœ¨äº†è§£æå­—ç¬¦ä¸²ä¸Šå§ï¼ŒUIæœ‰ç‚¹ã€‚ã€‚ã€‚Aï¼šç¡®å®ï¼Œå‡ ä¹éƒ½æ˜¯å­—ç¬¦ä¸²çš„è§£æï¼Œç„¶åé€šè¿‡ç”¨æ•°ç»„æ¥æ¨¡æ‹Ÿæ ˆè¿›è€Œå®ç°æ‹¬å·çš„åŒ¹é…ã€‚UIè®¾è®¡å½“æ—¶ç¡®å®æ²¡æ€ä¹ˆåœ¨æ„ã€‚ï¼ˆå…³äºè®¡ç®—å™¨ï¼Œæºä»£ç æˆ³è¿™é‡Œï¼‰Qï¼šè¿™ä¸ªå¥½åƒæ˜¯å•æœºçš„ï¼Œæœ‰æ²¡æœ‰åšè¿‡ç½‘ç»œæ–¹é¢çš„ï¼ŸAï¼šæœ‰è¿‡ï¼Œå»å¹´çš„æ—¶å€™åŠ æ ¡å†…çš„iOSå›¢é˜Ÿï¼Œç„¶åä»–ä»¬ç»™æˆ‘çš„ä»»åŠ¡æ˜¯åšä¸€ä¸ªRSSéŸ³ä¹æ’­æ”¾å™¨ï¼Œä¸»è¦å®ç°XMLçš„è§£æï¼Œç„¶åä¸‹è½½ï¼Œè¿˜æœ‰å°±æ˜¯æ’­æ”¾å™¨çš„å®ç°ã€‚ ç„¶åæˆ‘ä¹Ÿè®°ä¸æ¸…è¿˜é—®äº†å“ªäº›é—®é¢˜ï¼Œç´§æ¥ç€ä»–æ‹¿å‡ºä¸€å¼ çº¸ï¼Œè¯´è¿™é‡Œæœ‰ä¸¤ä¸ªé¢˜ç›®ï¼Œä½ çœ‹ä¸‹ã€‚å…ˆåšç¬¬ä¸€é¢˜ã€‚ä¸€çœ‹å…¨æ˜¯é€»è¾‘é¢˜ï¼Œçªç„¶è§‰å¾—è‡ªå·±æ™ºå•†ä¸å¤Ÿç”¨ã€‚ 1.ä½ åˆ°äº†ä¸€ä¸ªåå­—è·¯å£ï¼Œä¸çŸ¥é“è¯¥å¾€å“ªè¾¹èµ°ã€‚è·¯å£æœ‰ä¸¤ä¸ªäººï¼Œä¸€äººåªè¯´çœŸè¯ï¼Œä¸€äººåªè¯´å‡è¯ï¼Œä½†ä¸çŸ¥é“è°è¯´çœŸè¯ï¼Œè°è¯´å‡è¯ã€‚é—®ï¼šä½ å¦‚ä½•æ‰èƒ½åªé—®å…¶ä¸­ä¸€ä¸ªäººé—®é¢˜ï¼Œå°±èƒ½çŸ¥é“è¯¥èµ°å“ªæ¡è·¯ã€‚ 2.ä½ åˆ°äº†ä¸€ä¸ªåå­—è·¯å£ï¼Œä¸çŸ¥é“è¯¥å¾€å“ªè¾¹èµ°ã€‚ä¸€æ¡è·¯é€šå¾€çœŸè¯æ‘ï¼Œä¸€æ¡é€šå¾€å‡è¯æ‘ï¼ŒçœŸè¯æ‘çš„äººåªè®²çœŸè¯ï¼Œå‡è¯æ‘çš„äººåªè®²å‡è¯ã€‚è¿™ä¸ªæ—¶å€™ä½ å‘ç°è·¯å£æœ‰ä¸€ä¸ªäººï¼Œå¾ˆæ˜¾ç„¶ä»–ä¸æ˜¯çœŸè¯æ‘å°±æ˜¯å‡è¯æ‘çš„æ‘æ°‘ï¼Œç°åœ¨ä½ å¦‚ä½•åªé—®ä»–ä¸€ä¸ªé—®é¢˜ï¼Œå°±èƒ½çŸ¥é“é‚£æ¡è·¯é€šå¾€å‡è¯æ‘ã€‚ çœ‹åˆ°ç¬¬ä¸€é¢˜æˆ‘æƒ³ï¼Œè¿™ç§é¢˜ç›®åº”è¯¥æ˜¯é—®å…¶ä¸­ä¸€ä¸ªäººè‡ªç›¸çŸ›ç›¾çš„é—®é¢˜ï¼Œç„¶åé€šè¿‡å›ç­”çš„å†…å®¹æ¥å¾—å‡ºç­”æ¡ˆã€‚è™½ç„¶ç‚¹å­æ˜¯å¯¹çš„ï¼Œä½†æ˜¯å°±æ˜¯ä¸çŸ¥é“æ€ä¹ˆæé—®ã€‚è¿™æ—¶å€™é¢è¯•å®˜åœ¨æ—è¾¹è¯´ï¼Œä½ å¯ä»¥æŠŠä½ çš„æƒ³æ³•è¯´å‡ºæ¥ï¼Œç„¶åæˆ‘å°±è¯´äº†ä¸€äº›ã€‚ã€‚ä½†æ˜¯åˆè¢«è‡ªå·±å¦å®šäº†ã€‚ç„¶åä»–å°±å¼€å§‹æç¤ºæˆ‘ï¼Œä¸€æ­¥æ­¥æŠŠæˆ‘å¾€ç­”æ¡ˆçš„æ–¹å‘å¸¦ï¼Œæœ€åç»ˆäºåœ¨ä»–çš„ç‚¹æ‹¨ä¸‹å¾—å‡ºäº†ç­”æ¡ˆã€‚ç¬¬äºŒé¢˜ä¹Ÿæ˜¯ä¸€æ ·çš„æƒ…å†µï¼Œåªä¸è¿‡ä¸€å¼€å§‹ä»–è¯´ï¼Œè¿™ä¸ªé¢˜ç›®æˆ‘ä¸ä¼šå†ç»™ä½ æç¤ºäº†ã€‚ç„¶åã€‚ã€‚æˆ‘åˆå¼€å§‹æƒ³ï¼Œå¥½å‡ åˆ†é’Ÿåï¼Œä»–åˆå¼€å§‹æç¤ºäº†ï¼Œè¿™æ ·ï¼Œåˆå¾—å‡ºäº†ç­”æ¡ˆã€‚æœ€åä»–æ‹¿å‡ºä¸€ä¸ªç®—æ³•é¢˜å‡ºæ¥è®©æˆ‘å†™ï¼Œå¤§è‡´å°±æ˜¯æ•°ç”µé‡Œé¢çš„æ‘©æ ¹å®šç†ï¼Œæ¯”å¦‚NOT AND Aï¼ŒBè½¬åŒ–ä¸ºNOT A OR NOT Bè¿™æ ·å­ã€‚ã€‚æˆ‘ä¸€å¼€å§‹è¯´å¯ä»¥ç”¨æ ˆæ¥å®ç°ï¼Œä½†æ˜¯ä»”ç»†æƒ³æƒ³åˆä¸å¥½ç¡®å®šï¼Œç„¶åä»–åˆæç¤ºäº†ï¼Œä½ çœ‹çœ‹äºŒå‰æ ‘ä¼šä¸ä¼šæ¯”æ ˆæ–¹ä¾¿äº›ã€‚å¤§è‡´æ€è·¯å¦‚ä¸‹ ANDï¼ˆnotï¼‰ OR / \ ---&gt; / \ A B NOT NOT / \ A B å°±æ˜¯æŠŠå‰é¢æœ‰NOTçš„ANDï¼Œå°†NOTä½œä¸ºå®ƒçš„tagï¼Œç„¶åæ“ä½œæ•°åˆ†åˆ«ä½œä¸ºå…¶å·¦å³å­©å­ï¼Œè¿™æ ·è¿›ä¸€æ­¥è½¬åŒ–ï¼Œå°†ANDï¼ˆnotï¼‰è½¬æ¢æˆORï¼Œnotä¸‹ç§»ï¼Œæ“ä½œæ•°éšä¹‹ç§»åŠ¨ã€‚åˆ°æœ€åï¼Œnotå‡è¢«ç§»åˆ°åº•å±‚ï¼Œå³å¯å®ç°æ‘©æ ¹å®šå¾‹ã€‚ç„¶åå°±é—®æˆ‘ä¸ºä»€ä¹ˆè¦ä»äº‹iOSå¼€å‘ï¼Ÿè¿™ä¹‹åå°±é—®æˆ‘å®ä¹ æ—¶é—´ï¼Œç„¶åé—®æˆ‘è¿˜æœ‰æ²¡æœ‰ä»€ä¹ˆç–‘é—®ï¼Œè¯´ç»“æœåˆ°æ—¶å€™ä¼šé€šçŸ¥æˆ‘ã€‚ä¹‹åå°±æ˜¯â€Say GoodByeâ€äº†ã€‚ ä¸€äº›æ„Ÿå—è¿™æ¬¡é¢è¯•ä¹‹åæ€»ç»“äº†ä¸€ä¸‹ï¼Œå‘ç°è‡ªå·±çš„åŸºç¡€çŸ¥è¯†æŒæ¡çš„è¿˜ä¸æ˜¯å¾ˆç‰¢å›ºï¼Œé¡¹ç›®ç»éªŒåŒ®ä¹ã€‚å°¤å…¶æ˜¯é€»è¾‘æ¨ç†é¢˜ï¼Œè‡ªå·±çš„æ€è·¯è¿˜ä¸æ˜¯å¾ˆæ¸…æ™°ï¼Œæœ‰å¾…äºè®­ç»ƒã€‚ç„¶åè§‰å¾—å¾ˆå¤šé¢è¯•ï¼Œç¬”è¯•æœ‰äº›ç‰‡é¢ï¼Œç”¨è¿™ç§ç®—æ³•é¢˜æ¥è€ƒã€‚å¦‚æœæœ‰å¤§é‡æ—¶é—´çš„è¯ï¼Œé‚£äº›åˆ·é¢˜çš„äººå¯¹äºè¿™äº›é—®é¢˜å²‚ä¸æ˜¯åˆ†åˆ†é’Ÿå°±è§£å†³äº†ï¼Œå·¥ä½œåä¸Šæ‰‹é¡¹ç›®å¦‚æœä¸èƒ½çµæ´»è¿ç”¨æ˜¯ä¸æ˜¯å’Œå½“åˆçš„é€‰æ‹”ç›®çš„ç›¸è¿èƒŒäº†ã€‚ç„¶åä»”ç»†æƒ³æƒ³ï¼Œè¿™ä¹Ÿæ˜¯æ²¡åŠæ³•çš„åŠæ³•ï¼Œåªèƒ½é€šè¿‡è¿™ç§æ–¹å¼æ¥ç­›é€‰ã€‚è¿™é‡Œä»…ä»…æ˜¯ä¸ªäººè§‚ç‚¹ï¼Œå¦‚æœè®©ä½ è§‰å¾—ä¸çˆ½è¯·å¿½ç•¥ã€‚è¿™ä¸¤æ¬¡é¢è¯•è¿‡ç¨‹ä¸­è‡ªå·±éƒ½æ²¡æœ‰ç´§å¼ æ„Ÿäº§ç”Ÿï¼Œè§‰å¾—ä¸å¯æ€è®®ï¼Œå¯èƒ½éƒ½æ˜¯è‡ªå·±æ¯”è¾ƒç†Ÿæ‚‰çš„ä¸œè¥¿ï¼Œç„¶åç°åœºçš„æ°”æ°›ä¹Ÿå¾ˆå¥½çš„ç¼˜æ•…å§ï¼Œå¸Œæœ›è¿™ç§çŠ¶æ€èƒ½å»¶ç»­ä¸‹å»ã€‚æœ€åï¼Œå…¶å®é¢è¯•å®˜äººå¾ˆå¥½ï¼Œå¾ˆniceï¼Œåœ¨æˆ‘å›ç­”ä¸ä¸Šçš„æ—¶å€™ä¸€ç›´æç¤ºæˆ‘ã€‚æ›´é‡è¦çš„ä¸€ç‚¹ï¼Œæ­¤äººæœ‰ç‚¹åƒä¸€åˆä¸­åŒå­¦ï¼Œä¸€è§é¢å°±æœ‰ç§äº²åˆ‡æ„Ÿã€‚]]></content>
      <categories>
        <category>æ‰¯æ·¡é›†</category>
      </categories>
      <tags>
        <tag>æ‚è°ˆ</tag>
        <tag>åŸåˆ›</tag>
      </tags>
  </entry>
</search>